2022-12-08 15:08:20.795 GMT [36179] FATAL:  lock file "postmaster.pid" already exists
2022-12-08 15:08:20.795 GMT [36179] HINT:  Is another postmaster (PID 36055) running in data directory "/home/parallels/Warwick/year2/IM/CW1/online_banking_instance"?
2022-12-08 15:08:55.997 GMT [36364] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:08:55.998 GMT [36364] LOG:  could not bind IPv4 address "127.0.0.1": Address already in use
2022-12-08 15:08:55.998 GMT [36364] HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.
2022-12-08 15:08:55.998 GMT [36364] WARNING:  could not create listen socket for "localhost"
2022-12-08 15:08:55.998 GMT [36364] FATAL:  could not create any TCP/IP sockets
2022-12-08 15:08:56.000 GMT [36364] LOG:  database system is shut down
2022-12-08 15:09:46.909 GMT [36585] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:09:46.909 GMT [36585] LOG:  could not bind IPv4 address "127.0.0.1": Address already in use
2022-12-08 15:09:46.909 GMT [36585] HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.
2022-12-08 15:09:46.909 GMT [36585] WARNING:  could not create listen socket for "localhost"
2022-12-08 15:09:46.909 GMT [36585] FATAL:  could not create any TCP/IP sockets
2022-12-08 15:09:46.912 GMT [36585] LOG:  database system is shut down
2022-12-08 15:11:35.856 GMT [37060] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:11:35.856 GMT [37060] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:11:35.858 GMT [37060] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:11:35.863 GMT [37061] LOG:  database system was shut down at 2022-12-08 15:11:35 GMT
2022-12-08 15:11:35.869 GMT [37060] LOG:  database system is ready to accept connections
2022-12-08 15:12:25.656 GMT [37234] FATAL:  lock file "postmaster.pid" already exists
2022-12-08 15:12:25.656 GMT [37234] HINT:  Is another postmaster (PID 37060) running in data directory "/home/parallels/Warwick/year2/IM/CW1/online_banking_instance"?
2022-12-08 15:18:01.821 GMT [37060] LOG:  received fast shutdown request
2022-12-08 15:18:01.824 GMT [37060] LOG:  aborting any active transactions
2022-12-08 15:18:01.830 GMT [37060] LOG:  background worker "logical replication launcher" (PID 37067) exited with exit code 1
2022-12-08 15:18:01.830 GMT [37062] LOG:  shutting down
2022-12-08 15:18:01.849 GMT [37060] LOG:  database system is shut down
2022-12-08 15:18:12.424 GMT [38319] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:18:12.424 GMT [38319] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:18:12.425 GMT [38319] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:18:12.429 GMT [38327] LOG:  database system was shut down at 2022-12-08 15:18:12 GMT
2022-12-08 15:18:12.434 GMT [38319] LOG:  database system is ready to accept connections
2022-12-08 15:19:50.311 GMT [38319] LOG:  received fast shutdown request
2022-12-08 15:19:50.313 GMT [38319] LOG:  aborting any active transactions
2022-12-08 15:19:50.320 GMT [38319] LOG:  background worker "logical replication launcher" (PID 38333) exited with exit code 1
2022-12-08 15:19:50.320 GMT [38328] LOG:  shutting down
2022-12-08 15:19:50.342 GMT [38319] LOG:  database system is shut down
2022-12-08 15:20:04.542 GMT [38699] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:20:04.542 GMT [38699] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:20:04.543 GMT [38699] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:20:04.548 GMT [38700] LOG:  database system was shut down at 2022-12-08 15:19:50 GMT
2022-12-08 15:20:04.555 GMT [38699] LOG:  database system is ready to accept connections
2022-12-08 15:21:56.367 GMT [38699] LOG:  received fast shutdown request
2022-12-08 15:21:56.368 GMT [38699] LOG:  aborting any active transactions
2022-12-08 15:21:56.372 GMT [38699] LOG:  background worker "logical replication launcher" (PID 38706) exited with exit code 1
2022-12-08 15:21:56.373 GMT [38701] LOG:  shutting down
2022-12-08 15:21:56.389 GMT [38699] LOG:  database system is shut down
2022-12-08 15:22:13.686 GMT [39160] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:22:13.686 GMT [39160] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:22:13.688 GMT [39160] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:22:13.693 GMT [39161] LOG:  database system was shut down at 2022-12-08 15:21:56 GMT
2022-12-08 15:22:13.699 GMT [39160] LOG:  database system is ready to accept connections
2022-12-08 15:29:11.058 GMT [39160] LOG:  received fast shutdown request
2022-12-08 15:29:11.059 GMT [39160] LOG:  aborting any active transactions
2022-12-08 15:29:11.062 GMT [39160] LOG:  background worker "logical replication launcher" (PID 39167) exited with exit code 1
2022-12-08 15:29:11.066 GMT [39162] LOG:  shutting down
2022-12-08 15:29:11.078 GMT [39160] LOG:  database system is shut down
2022-12-08 15:29:15.792 GMT [40407] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:29:15.793 GMT [40407] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:29:15.795 GMT [40407] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:29:15.800 GMT [40411] LOG:  database system was shut down at 2022-12-08 15:29:11 GMT
2022-12-08 15:29:15.807 GMT [40407] LOG:  database system is ready to accept connections
2022-12-08 15:29:45.844 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:46.518 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:46.518 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:47.197 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:47.197 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:47.894 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:47.894 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:48.452 GMT [40588] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.506 GMT [40590] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.508 GMT [40591] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.560 GMT [40594] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.608 GMT [40597] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.615 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:48.615 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:48.645 GMT [40599] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:48.689 GMT [40601] FATAL:  could not open file "global/pg_filenode.map": No such file or directory
2022-12-08 15:29:49.291 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:49.291 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:49.977 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:49.977 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:50.665 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:50.665 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:51.340 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:51.340 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:52.025 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:52.025 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:52.719 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:52.719 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:53.405 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:53.406 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:54.078 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:54.079 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:54.830 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:54.830 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:55.507 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:55.507 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:56.179 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:56.179 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:56.597 GMT [40415] LOG:  using stale statistics instead of current ones because stats collector is not responding
2022-12-08 15:29:56.598 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:56.598 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:57.278 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:57.279 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:57.979 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:57.979 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:58.656 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:58.656 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:59.337 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:29:59.337 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:00.023 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:00.023 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:00.703 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:00.703 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:01.378 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:01.378 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:02.056 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:02.056 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:02.740 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:02.740 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:03.477 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:03.477 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:04.157 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:04.157 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:04.846 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:04.846 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:05.837 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:05.837 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:06.625 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:06.626 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:07.296 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:07.296 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:07.736 GMT [40415] LOG:  using stale statistics instead of current ones because stats collector is not responding
2022-12-08 15:30:07.737 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:07.737 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:08.405 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:08.405 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:09.074 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:09.074 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:09.748 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:09.748 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:10.410 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:10.410 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:11.070 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:11.070 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:11.733 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:11.733 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:12.407 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:12.407 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:13.078 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:13.078 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:13.752 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:13.752 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:14.426 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:14.427 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:15.097 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:15.097 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:15.766 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:15.766 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:16.437 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:16.437 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:17.106 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:17.106 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:17.775 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:17.775 GMT [40416] LOG:  could not open temporary statistics file "pg_stat_tmp/global.tmp": No such file or directory
2022-12-08 15:30:18.200 GMT [40415] LOG:  using stale statistics instead of current ones because stats collector is not responding
2022-12-08 15:30:29.345 GMT [40407] LOG:  could not open file "postmaster.pid": No such file or directory
2022-12-08 15:30:29.345 GMT [40407] LOG:  performing immediate shutdown because data directory lock file is invalid
2022-12-08 15:30:29.345 GMT [40407] LOG:  received immediate shutdown request
2022-12-08 15:30:29.345 GMT [40407] LOG:  could not open file "postmaster.pid": No such file or directory
2022-12-08 15:30:29.346 GMT [40416] LOG:  could not open temporary statistics file "pg_stat/global.tmp": No such file or directory
2022-12-08 15:30:29.351 GMT [40407] LOG:  database system is shut down
2022-12-08 15:31:12.080 GMT [41032] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:31:12.080 GMT [41032] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:31:12.082 GMT [41032] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:31:12.086 GMT [41033] LOG:  database system was shut down at 2022-12-08 15:31:11 GMT
2022-12-08 15:31:12.091 GMT [41032] LOG:  database system is ready to accept connections
2022-12-08 15:34:09.911 GMT [41032] LOG:  received fast shutdown request
2022-12-08 15:34:09.913 GMT [41032] LOG:  aborting any active transactions
2022-12-08 15:34:09.915 GMT [41032] LOG:  background worker "logical replication launcher" (PID 41039) exited with exit code 1
2022-12-08 15:34:09.919 GMT [41034] LOG:  shutting down
2022-12-08 15:34:09.938 GMT [41032] LOG:  database system is shut down
2022-12-08 15:38:22.357 GMT [42658] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-08 15:38:22.357 GMT [42658] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-08 15:38:22.359 GMT [42658] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-08 15:38:22.362 GMT [42666] LOG:  database system was shut down at 2022-12-08 15:38:22 GMT
2022-12-08 15:38:22.367 GMT [42658] LOG:  database system is ready to accept connections
2022-12-08 15:42:17.359 GMT [42658] LOG:  received smart shutdown request
2022-12-08 15:42:17.373 GMT [42658] LOG:  background worker "logical replication launcher" (PID 42672) exited with exit code 1
2022-12-08 15:42:17.374 GMT [42658] LOG:  received SIGHUP, reloading configuration files
2022-12-08 15:42:17.374 GMT [42667] LOG:  shutting down
2022-12-08 15:42:17.394 GMT [42658] LOG:  database system is shut down
2022-12-09 11:37:06.202 GMT [8796] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-09 11:37:06.203 GMT [8796] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-09 11:37:06.205 GMT [8796] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-09 11:37:06.210 GMT [8797] LOG:  database system was shut down at 2022-12-09 11:36:14 GMT
2022-12-09 11:37:06.218 GMT [8796] LOG:  database system is ready to accept connections
2022-12-09 11:37:50.131 GMT [9074] ERROR:  syntax error at or near "@" at character 5
2022-12-09 11:37:50.131 GMT [9074] STATEMENT:  SET @sql_dialect = 'postgresql';
2022-12-09 11:37:50.143 GMT [9074] ERROR:  syntax error at or near ")" at character 178
2022-12-09 11:37:50.143 GMT [9074] STATEMENT:  /*create a table account with a foreign key to customer*/
	CREATE TABLE account (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    customer_id INTEGER REFERENCES customer(id),
	);
2022-12-09 11:37:50.148 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.148 GMT [9074] STATEMENT:  /*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:37:50.154 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.154 GMT [9074] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:37:50.159 GMT [9074] ERROR:  relation "credit_account" does not exist
2022-12-09 11:37:50.159 GMT [9074] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:37:50.164 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.164 GMT [9074] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:37:50.176 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.176 GMT [9074] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:37:50.180 GMT [9074] ERROR:  relation "loan" does not exist
2022-12-09 11:37:50.180 GMT [9074] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:37:50.185 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.185 GMT [9074] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:37:50.193 GMT [9074] ERROR:  relation "account" does not exist
2022-12-09 11:37:50.193 GMT [9074] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:37:50.196 GMT [9074] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:37:50.196 GMT [9074] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:37:50.196 GMT [9074] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:37:50.196 GMT [9074] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:37:50.197 GMT [9074] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:37:50.197 GMT [9074] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:37:50.197 GMT [9074] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:37:50.197 GMT [9074] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:37:50.198 GMT [9074] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:37:50.198 GMT [9074] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:43:05.355 GMT [10018] ERROR:  syntax error at or near "DIALECT" at character 9
2022-12-09 11:43:05.355 GMT [10018] STATEMENT:  SET SQL DIALECT PostgreSQL;
2022-12-09 11:43:05.355 GMT [10018] ERROR:  schema "online_banking" already exists
2022-12-09 11:43:05.355 GMT [10018] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:43:05.357 GMT [10018] ERROR:  relation "customer" already exists
2022-12-09 11:43:05.357 GMT [10018] STATEMENT:  /*create a table customer with their address as an array*/
	CREATE TABLE customer (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    address VARCHAR(255) []
	);
2022-12-09 11:43:05.357 GMT [10018] ERROR:  syntax error at or near ")" at character 178
2022-12-09 11:43:05.357 GMT [10018] STATEMENT:  /*create a table account with a foreign key to customer*/
	CREATE TABLE account (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    customer_id INTEGER REFERENCES customer(id),
	);
2022-12-09 11:43:05.362 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.362 GMT [10018] STATEMENT:  /*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:43:05.366 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.366 GMT [10018] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:43:05.372 GMT [10018] ERROR:  relation "credit_account" does not exist
2022-12-09 11:43:05.372 GMT [10018] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:43:05.377 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.377 GMT [10018] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:43:05.382 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.382 GMT [10018] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:43:05.389 GMT [10018] ERROR:  relation "loan" does not exist
2022-12-09 11:43:05.389 GMT [10018] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:43:05.394 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.394 GMT [10018] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:43:05.406 GMT [10018] ERROR:  relation "account" does not exist
2022-12-09 11:43:05.406 GMT [10018] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:43:05.408 GMT [10018] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:43:05.408 GMT [10018] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:43:05.409 GMT [10018] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:43:05.409 GMT [10018] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:43:05.409 GMT [10018] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:43:05.409 GMT [10018] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:43:05.409 GMT [10018] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:43:05.409 GMT [10018] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:43:05.409 GMT [10018] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:43:05.409 GMT [10018] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:47:19.564 GMT [10844] ERROR:  schema "online_banking" already exists
2022-12-09 11:47:19.564 GMT [10844] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:47:19.566 GMT [10844] ERROR:  relation "customer" already exists
2022-12-09 11:47:19.566 GMT [10844] STATEMENT:  /*create a table customer with their address as an array*/
	CREATE TABLE customer (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    address VARCHAR(255) []
	);
2022-12-09 11:47:19.567 GMT [10844] ERROR:  syntax error at or near ")" at character 178
2022-12-09 11:47:19.567 GMT [10844] STATEMENT:  /*create a table account with a foreign key to customer*/
	CREATE TABLE account (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    customer_id INTEGER REFERENCES customer(id),
	);
2022-12-09 11:47:19.572 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.572 GMT [10844] STATEMENT:  /*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:47:19.579 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.579 GMT [10844] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:47:19.585 GMT [10844] ERROR:  relation "credit_account" does not exist
2022-12-09 11:47:19.585 GMT [10844] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:47:19.589 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.589 GMT [10844] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:47:19.593 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.593 GMT [10844] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:47:19.598 GMT [10844] ERROR:  relation "loan" does not exist
2022-12-09 11:47:19.598 GMT [10844] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:47:19.603 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.603 GMT [10844] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:47:19.609 GMT [10844] ERROR:  relation "account" does not exist
2022-12-09 11:47:19.609 GMT [10844] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:47:19.613 GMT [10844] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:47:19.613 GMT [10844] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:47:19.614 GMT [10844] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:47:19.614 GMT [10844] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:47:19.615 GMT [10844] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:47:19.615 GMT [10844] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:47:19.618 GMT [10844] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:47:19.618 GMT [10844] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:47:19.618 GMT [10844] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:47:19.618 GMT [10844] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:48:33.730 GMT [11109] ERROR:  schema "online_banking" already exists
2022-12-09 11:48:33.730 GMT [11109] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:48:33.731 GMT [11109] ERROR:  syntax error at or near ")" at character 246
2022-12-09 11:48:33.731 GMT [11109] STATEMENT:  /*create a table customer with their address as an array*/
	
	
	
	
	
	
	
	
	
	/*create a table account with a foreign key to customer*/
	CREATE TABLE account (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    customer_id INTEGER REFERENCES customer(id),
	);
2022-12-09 11:48:33.737 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.737 GMT [11109] STATEMENT:  /*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:33.741 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.741 GMT [11109] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:33.747 GMT [11109] ERROR:  relation "credit_account" does not exist
2022-12-09 11:48:33.747 GMT [11109] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:48:33.752 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.752 GMT [11109] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:33.757 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.757 GMT [11109] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:48:33.762 GMT [11109] ERROR:  relation "loan" does not exist
2022-12-09 11:48:33.762 GMT [11109] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:48:33.768 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.768 GMT [11109] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:48:33.772 GMT [11109] ERROR:  relation "account" does not exist
2022-12-09 11:48:33.772 GMT [11109] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:48:33.774 GMT [11109] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:48:33.774 GMT [11109] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:48:33.775 GMT [11109] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:48:33.775 GMT [11109] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:48:33.775 GMT [11109] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:48:33.775 GMT [11109] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:48:33.775 GMT [11109] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:48:33.775 GMT [11109] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:48:33.776 GMT [11109] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:48:33.776 GMT [11109] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:48:58.066 GMT [11255] ERROR:  schema "online_banking" already exists
2022-12-09 11:48:58.066 GMT [11255] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:48:58.069 GMT [11255] ERROR:  relation "customer" already exists
2022-12-09 11:48:58.069 GMT [11255] STATEMENT:  /*create a table customer with their address as an array*/
	CREATE TABLE customer (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    address VARCHAR(255) []
	);
2022-12-09 11:48:58.075 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.075 GMT [11255] STATEMENT:  /*create a table account with a foreign key to customer*/
	
	
	
	
	
	/*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:58.079 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.079 GMT [11255] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:58.084 GMT [11255] ERROR:  relation "credit_account" does not exist
2022-12-09 11:48:58.084 GMT [11255] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:48:58.090 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.090 GMT [11255] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:48:58.094 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.094 GMT [11255] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:48:58.103 GMT [11255] ERROR:  relation "loan" does not exist
2022-12-09 11:48:58.103 GMT [11255] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:48:58.107 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.107 GMT [11255] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:48:58.112 GMT [11255] ERROR:  relation "account" does not exist
2022-12-09 11:48:58.112 GMT [11255] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:48:58.114 GMT [11255] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:48:58.114 GMT [11255] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:48:58.115 GMT [11255] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:48:58.115 GMT [11255] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:48:58.115 GMT [11255] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:48:58.115 GMT [11255] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:48:58.115 GMT [11255] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:48:58.115 GMT [11255] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:48:58.115 GMT [11255] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:48:58.115 GMT [11255] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:49:38.773 GMT [11430] ERROR:  schema "online_banking" already exists
2022-12-09 11:49:38.773 GMT [11430] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:49:38.776 GMT [11430] ERROR:  relation "customer" already exists
2022-12-09 11:49:38.776 GMT [11430] STATEMENT:  /*create a table customer with their address as an array*/
	CREATE TABLE customer (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    address VARCHAR(255) []
	);
2022-12-09 11:49:38.776 GMT [11430] ERROR:  syntax error at or near ")" at character 178
2022-12-09 11:49:38.776 GMT [11430] STATEMENT:  /*create a table account with a foreign key to customer*/
	CREATE TABLE account (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    customer_id INTEGER REFERENCES customer(id),
	);
2022-12-09 11:49:38.783 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.783 GMT [11430] STATEMENT:  /*create a table savings_account with a foreign key to account*/
	CREATE TABLE savings_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:49:38.788 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.788 GMT [11430] STATEMENT:  /*create a table credit_account with a foreign key to account*/
	CREATE TABLE credit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    credit_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:49:38.792 GMT [11430] ERROR:  relation "credit_account" does not exist
2022-12-09 11:49:38.792 GMT [11430] STATEMENT:  /*create a table credit_account_application with a foreign key to credit_account*/
	CREATE TABLE credit_account_application (
	    id SERIAL PRIMARY KEY,
	    credit_account_id INTEGER REFERENCES credit_account(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:49:38.798 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.798 GMT [11430] STATEMENT:  /*create a table debit_account with a foreign key to account*/
	CREATE TABLE debit_account (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    overdraft_limit NUMERIC(10,2),
	    interest_rate NUMERIC(5,2)
	);
2022-12-09 11:49:38.802 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.802 GMT [11430] STATEMENT:  /*create a table loan with a foreign key to account*/
	CREATE TABLE loan (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    current_balance NUMERIC(10,2),
	    interest_rate NUMERIC(5,2),
	    loan_amount NUMERIC(10,2),
	    loan_term INTEGER,
	    loan_start_date DATE,
	    loan_end_date DATE
	);
2022-12-09 11:49:38.806 GMT [11430] ERROR:  relation "loan" does not exist
2022-12-09 11:49:38.806 GMT [11430] STATEMENT:  /*create a table loan_application with a foreign key to loan*/
	CREATE TABLE loan_application (
	    id SERIAL PRIMARY KEY,
	    loan_id INTEGER REFERENCES loan(id),
	    is_approved BOOLEAN,
	    application_date DATE,
	    status VARCHAR(255)
	);
2022-12-09 11:49:38.812 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.812 GMT [11430] STATEMENT:  /*create a table transaction with a foreign key to account*/
	CREATE TABLE transaction (
	    id SERIAL PRIMARY KEY,
	    account_id INTEGER REFERENCES account(id),
	    transaction_date DATE,
	    transaction_type VARCHAR(255),
	    transaction_amount NUMERIC(10,2)
	);
2022-12-09 11:49:38.817 GMT [11430] ERROR:  relation "account" does not exist
2022-12-09 11:49:38.817 GMT [11430] STATEMENT:  /*create a table to log all actions*/
	CREATE TABLE log (
	    id SERIAL PRIMARY KEY,
	    date DATE,
	    action VARCHAR(255),
	    customer_id INTEGER REFERENCES customer(id),
	    account_id INTEGER REFERENCES account(id)
	);
2022-12-09 11:49:38.820 GMT [11430] ERROR:  relation "account" does not exist at character 64
2022-12-09 11:49:38.820 GMT [11430] STATEMENT:  /*insert 10 elements of sample data into account*/
	INSERT INTO account (init_date, customer_id)
	VALUES
	    ('2019-01-01', 1),
	    ('2019-01-01', 2),
	    ('2019-01-01', 3),
	    ('2019-01-01', 4),
	    ('2019-01-01', 5),
	    ('2019-01-01', 6),
	    ('2019-01-01', 7),
	    ('2019-01-01', 8),
	    ('2019-01-01', 9),
	    ('2019-01-01', 10);
2022-12-09 11:49:38.820 GMT [11430] ERROR:  relation "savings_account" does not exist at character 113
2022-12-09 11:49:38.820 GMT [11430] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-09 11:49:38.820 GMT [11430] ERROR:  relation "credit_account" does not exist at character 128
2022-12-09 11:49:38.820 GMT [11430] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:49:38.821 GMT [11430] ERROR:  relation "debit_account" does not exist at character 130
2022-12-09 11:49:38.821 GMT [11430] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-09 11:49:38.821 GMT [11430] ERROR:  relation "loan" does not exist at character 141
2022-12-09 11:49:38.821 GMT [11430] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-09 11:49:58.485 GMT [11533] ERROR:  schema "online_banking" already exists
2022-12-09 11:49:58.485 GMT [11533] STATEMENT:  /*create schema*/
	CREATE SCHEMA online_banking;
2022-12-09 11:49:58.487 GMT [11533] ERROR:  relation "customer" already exists
2022-12-09 11:49:58.487 GMT [11533] STATEMENT:  /*create a table customer with their address as an array*/
	CREATE TABLE customer (
	    id SERIAL PRIMARY KEY,
	    init_date DATE,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    address VARCHAR(255) []
	);
2022-12-09 11:55:01.374 GMT [12612] ERROR:  relation "account" does not exist at character 15
2022-12-09 11:55:01.374 GMT [12612] STATEMENT:  SELECT * FROM account;
2022-12-09 11:56:10.718 GMT [8796] LOG:  received fast shutdown request
2022-12-09 11:56:10.720 GMT [8796] LOG:  aborting any active transactions
2022-12-09 11:56:10.725 GMT [8796] LOG:  background worker "logical replication launcher" (PID 8803) exited with exit code 1
2022-12-09 11:56:10.727 GMT [8798] LOG:  shutting down
2022-12-09 11:56:10.747 GMT [8796] LOG:  database system is shut down
2022-12-09 11:56:22.126 GMT [13056] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-09 11:56:22.126 GMT [13056] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-09 11:56:22.128 GMT [13056] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-09 11:56:22.134 GMT [13057] LOG:  database system was shut down at 2022-12-09 11:56:21 GMT
2022-12-09 11:56:22.139 GMT [13056] LOG:  database system is ready to accept connections
2022-12-09 13:53:06.385 GMT [25292] ERROR:  syntax error at or near "NOT" at character 49
2022-12-09 13:53:06.385 GMT [25292] STATEMENT:  /*Drop all tables if they exist*/
	DROP TABLE IF NOT EXISTS customer;
2022-12-09 13:53:06.386 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.386 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS account;
2022-12-09 13:53:06.386 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.386 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS savings_account;
2022-12-09 13:53:06.386 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.386 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS credit_account;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS credit_account_application;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS debit_account;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS loan;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS loan_application;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS transaction;
2022-12-09 13:53:06.387 GMT [25292] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:06.387 GMT [25292] STATEMENT:  DROP TABLE IF NOT EXISTS log;
2022-12-09 13:53:13.162 GMT [25363] ERROR:  syntax error at or near "NOT" at character 49
2022-12-09 13:53:13.162 GMT [25363] STATEMENT:  /*Drop all tables if they exist*/
	DROP TABLE IF NOT EXISTS customer;
2022-12-09 13:53:13.162 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.162 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS account;
2022-12-09 13:53:13.162 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.162 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS savings_account;
2022-12-09 13:53:13.163 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.163 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS credit_account;
2022-12-09 13:53:13.163 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.163 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS credit_account_application;
2022-12-09 13:53:13.163 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.163 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS debit_account;
2022-12-09 13:53:13.163 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.163 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS loan;
2022-12-09 13:53:13.164 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.164 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS loan_application;
2022-12-09 13:53:13.164 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.164 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS transaction;
2022-12-09 13:53:13.164 GMT [25363] ERROR:  syntax error at or near "NOT" at character 15
2022-12-09 13:53:13.164 GMT [25363] STATEMENT:  DROP TABLE IF NOT EXISTS log;
2022-12-09 13:57:05.405 GMT [26125] ERROR:  cannot drop table customer because other objects depend on it
2022-12-09 13:57:05.405 GMT [26125] DETAIL:  constraint account_customer_id_fkey on table account depends on table customer
	constraint log_customer_id_fkey on table log depends on table customer
2022-12-09 13:57:05.405 GMT [26125] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 13:57:05.405 GMT [26125] STATEMENT:  /*Drop all tables if they exist*/
	DROP TABLE IF EXISTS customer;
2022-12-09 13:57:05.407 GMT [26125] ERROR:  cannot drop table account because other objects depend on it
2022-12-09 13:57:05.407 GMT [26125] DETAIL:  constraint savings_account_account_id_fkey on table savings_account depends on table account
	constraint credit_account_account_id_fkey on table credit_account depends on table account
	constraint debit_account_account_id_fkey on table debit_account depends on table account
	constraint loan_account_id_fkey on table loan depends on table account
	constraint transaction_account_id_fkey on table transaction depends on table account
	constraint log_account_id_fkey on table log depends on table account
2022-12-09 13:57:05.407 GMT [26125] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 13:57:05.407 GMT [26125] STATEMENT:  DROP TABLE IF EXISTS account;
2022-12-09 13:57:05.416 GMT [26125] ERROR:  cannot drop table credit_account because other objects depend on it
2022-12-09 13:57:05.416 GMT [26125] DETAIL:  constraint credit_account_application_credit_account_id_fkey on table credit_account_application depends on table credit_account
2022-12-09 13:57:05.416 GMT [26125] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 13:57:05.416 GMT [26125] STATEMENT:  DROP TABLE IF EXISTS credit_account;
2022-12-09 13:57:05.420 GMT [26125] ERROR:  cannot drop table loan because other objects depend on it
2022-12-09 13:57:05.420 GMT [26125] DETAIL:  constraint loan_application_loan_id_fkey on table loan_application depends on table loan
2022-12-09 13:57:05.420 GMT [26125] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 13:57:05.420 GMT [26125] STATEMENT:  DROP TABLE IF EXISTS loan;
2022-12-09 14:21:00.609 GMT [30632] ERROR:  cannot drop table customer because other objects depend on it
2022-12-09 14:21:00.609 GMT [30632] DETAIL:  constraint account_customer_id_fkey on table account depends on table customer
	constraint log_customer_id_fkey on table log depends on table customer
2022-12-09 14:21:00.609 GMT [30632] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 14:21:00.609 GMT [30632] STATEMENT:  /*Drop all tables if they exist*/
	DROP TABLE IF EXISTS customer;
2022-12-09 14:21:00.611 GMT [30632] ERROR:  cannot drop table account because other objects depend on it
2022-12-09 14:21:00.611 GMT [30632] DETAIL:  constraint credit_account_account_id_fkey on table credit_account depends on table account
	constraint loan_account_id_fkey on table loan depends on table account
	constraint savings_account_account_id_fkey on table savings_account depends on table account
	constraint debit_account_account_id_fkey on table debit_account depends on table account
	constraint transaction_account_id_fkey on table transaction depends on table account
	constraint log_account_id_fkey on table log depends on table account
2022-12-09 14:21:00.611 GMT [30632] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 14:21:00.611 GMT [30632] STATEMENT:  DROP TABLE IF EXISTS account;
2022-12-09 14:21:00.615 GMT [30632] ERROR:  cannot drop table credit_account because other objects depend on it
2022-12-09 14:21:00.615 GMT [30632] DETAIL:  constraint credit_account_application_credit_account_id_fkey on table credit_account_application depends on table credit_account
2022-12-09 14:21:00.615 GMT [30632] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 14:21:00.615 GMT [30632] STATEMENT:  DROP TABLE IF EXISTS credit_account;
2022-12-09 14:21:00.620 GMT [30632] ERROR:  cannot drop table loan because other objects depend on it
2022-12-09 14:21:00.620 GMT [30632] DETAIL:  constraint loan_application_loan_id_fkey on table loan_application depends on table loan
2022-12-09 14:21:00.620 GMT [30632] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-12-09 14:21:00.620 GMT [30632] STATEMENT:  DROP TABLE IF EXISTS loan;
2022-12-09 14:23:19.655 GMT [13056] LOG:  received fast shutdown request
2022-12-09 14:23:19.660 GMT [13056] LOG:  aborting any active transactions
2022-12-09 14:23:19.664 GMT [13056] LOG:  background worker "logical replication launcher" (PID 13063) exited with exit code 1
2022-12-09 14:23:19.665 GMT [13058] LOG:  shutting down
2022-12-09 14:23:19.695 GMT [13056] LOG:  database system is shut down
2022-12-09 14:23:26.307 GMT [31154] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-09 14:23:26.307 GMT [31154] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-09 14:23:26.309 GMT [31154] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-09 14:23:26.315 GMT [31155] LOG:  database system was shut down at 2022-12-09 14:23:26 GMT
2022-12-09 14:23:26.320 GMT [31154] LOG:  database system is ready to accept connections
2022-12-09 15:40:56.326 GMT [31154] LOG:  received smart shutdown request
2022-12-09 15:40:56.344 GMT [31154] LOG:  received SIGHUP, reloading configuration files
2022-12-09 15:40:56.371 GMT [31154] LOG:  background worker "logical replication launcher" (PID 31161) exited with exit code 1
2022-12-09 15:40:56.397 GMT [31156] LOG:  shutting down
2022-12-09 15:40:56.413 GMT [31154] LOG:  database system is shut down
2022-12-21 10:45:29.262 GMT [9903] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-21 10:45:29.265 GMT [9903] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-21 10:45:29.266 GMT [9903] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-21 10:45:29.270 GMT [9904] LOG:  database system was shut down at 2022-12-21 10:45:29 GMT
2022-12-21 10:45:29.275 GMT [9903] LOG:  database system is ready to accept connections
2022-12-21 10:45:29.838 GMT [9929] ERROR:  syntax error at or near "passwd" at character 329
2022-12-21 10:45:29.838 GMT [9929] STATEMENT:  CREATE OR REPLACE FUNCTION add_account(customer_id INTEGER, username TEXT, passwd TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'));
	    CREATE ROLE username WITH LOGIN PASSWORD passwd;
	    INSERT INTO log (log_date, log_message, customer_id)
	    VALUES (current_date, 'Account added', customer_id);
	    passed := true;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2022-12-21 11:19:48.349 GMT [9903] LOG:  received fast shutdown request
2022-12-21 11:19:48.351 GMT [9903] LOG:  aborting any active transactions
2022-12-21 11:19:48.355 GMT [9903] LOG:  background worker "logical replication launcher" (PID 9910) exited with exit code 1
2022-12-21 11:19:48.356 GMT [9905] LOG:  shutting down
2022-12-21 11:19:48.369 GMT [9903] LOG:  database system is shut down
2022-12-21 11:19:58.223 GMT [15790] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-21 11:19:58.223 GMT [15790] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-21 11:19:58.224 GMT [15790] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-21 11:19:58.228 GMT [15791] LOG:  database system was shut down at 2022-12-21 11:19:57 GMT
2022-12-21 11:19:58.234 GMT [15790] LOG:  database system is ready to accept connections
2022-12-21 11:20:46.015 GMT [15790] LOG:  received fast shutdown request
2022-12-21 11:20:46.016 GMT [15790] LOG:  aborting any active transactions
2022-12-21 11:20:46.019 GMT [15790] LOG:  background worker "logical replication launcher" (PID 15797) exited with exit code 1
2022-12-21 11:20:46.023 GMT [15792] LOG:  shutting down
2022-12-21 11:20:46.056 GMT [15790] LOG:  database system is shut down
2022-12-21 11:20:49.043 GMT [16071] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-21 11:20:49.044 GMT [16071] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-21 11:20:49.045 GMT [16071] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-21 11:20:49.049 GMT [16072] LOG:  database system was shut down at 2022-12-21 11:20:48 GMT
2022-12-21 11:20:49.055 GMT [16071] LOG:  database system is ready to accept connections
2022-12-21 11:20:49.606 GMT [16115] ERROR:  syntax error at or near "DIGEST" at character 329
2022-12-21 11:20:49.606 GMT [16115] STATEMENT:  CREATE OR REPLACE FUNCTION add_account(customer_id INTEGER, username TEXT, passwd TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'));
	    CREATE ROLE username WITH LOGIN PASSWORD DIGEST(passwd, 'sha256');
	    INSERT INTO log (log_date, log_message, customer_id)
	    VALUES (current_date, 'Account added', customer_id);
	    passed := true;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2022-12-22 13:48:08.835 GMT [16071] LOG:  received smart shutdown request
2022-12-22 13:48:08.842 GMT [16071] LOG:  background worker "logical replication launcher" (PID 16078) exited with exit code 1
2022-12-22 13:48:08.848 GMT [16071] LOG:  received SIGHUP, reloading configuration files
2022-12-22 13:48:08.855 GMT [16073] LOG:  shutting down
2022-12-22 13:48:08.903 GMT [16071] LOG:  database system is shut down
2022-12-23 10:19:55.804 GMT [5354] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:19:55.807 GMT [5354] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:19:55.809 GMT [5354] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:19:55.813 GMT [5355] LOG:  database system was shut down at 2022-12-23 10:19:55 GMT
2022-12-23 10:19:55.820 GMT [5354] LOG:  database system is ready to accept connections
2022-12-23 10:19:56.580 GMT [5388] ERROR:  "passed" is not a known variable at character 405
2022-12-23 10:19:56.580 GMT [5388] STATEMENT:  CREATE OR REPLACE FUNCTION add_account_role(username TEXT, passwd TEXT)
	RETURNS BOOLEAN AS $$
	BEGIN
	    IF NOT EXISTS (SELECT FROM pg_catalog.pg_roles WHERE rolname = username) THEN
	        EXECUTE format(
	            'CREATE USER %I WITH
	                LOGIN
	                PASSWORD %L'
	            , username
	            , passwd
	        );
	        RAISE NOTICE 'CREATED USER "%"', username;
	        passed := true;
	        RETURN passed;
	    ELSE
	        RAISE NOTICE 'USER ALREADY EXISTS';
	    END IF;
	END;
	$$ LANGUAGE plpgsql;
2022-12-23 10:19:56.581 GMT [5388] ERROR:  syntax error at or near "DIGEST" at character 329
2022-12-23 10:19:56.581 GMT [5388] STATEMENT:  CREATE OR REPLACE FUNCTION add_account(customer_id INTEGER, username TEXT, passwd TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'));
	    CREATE ROLE username WITH LOGIN PASSWORD DIGEST(passwd, 'sha256');
	    SELECT add_account_role()
	    INSERT INTO log (log_date, log_message, customer_id)
	    VALUES (current_date, 'Account added', customer_id);
	    passed := true;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2022-12-23 10:23:50.206 GMT [5354] LOG:  received fast shutdown request
2022-12-23 10:23:50.208 GMT [5354] LOG:  aborting any active transactions
2022-12-23 10:23:50.215 GMT [5354] LOG:  background worker "logical replication launcher" (PID 5361) exited with exit code 1
2022-12-23 10:23:50.216 GMT [5356] LOG:  shutting down
2022-12-23 10:23:50.265 GMT [5354] LOG:  database system is shut down
2022-12-23 10:23:53.105 GMT [6170] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:23:53.106 GMT [6170] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:23:53.107 GMT [6170] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:23:53.111 GMT [6171] LOG:  database system was shut down at 2022-12-23 10:23:52 GMT
2022-12-23 10:23:53.117 GMT [6170] LOG:  database system is ready to accept connections
2022-12-23 10:24:35.556 GMT [6170] LOG:  received fast shutdown request
2022-12-23 10:24:35.557 GMT [6170] LOG:  aborting any active transactions
2022-12-23 10:24:35.561 GMT [6170] LOG:  background worker "logical replication launcher" (PID 6177) exited with exit code 1
2022-12-23 10:24:35.563 GMT [6172] LOG:  shutting down
2022-12-23 10:24:35.604 GMT [6170] LOG:  database system is shut down
2022-12-23 10:24:38.656 GMT [6448] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:24:38.656 GMT [6448] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:24:38.658 GMT [6448] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:24:38.663 GMT [6449] LOG:  database system was shut down at 2022-12-23 10:24:38 GMT
2022-12-23 10:24:38.669 GMT [6448] LOG:  database system is ready to accept connections
2022-12-23 10:24:39.361 GMT [6474] ERROR:  syntax error at or near "PERFORM" at character 1
2022-12-23 10:24:39.361 GMT [6474] STATEMENT:  PERFORM add_account(0, 'hello', 'pass');
2022-12-23 10:28:56.606 GMT [6448] LOG:  received fast shutdown request
2022-12-23 10:28:56.609 GMT [6448] LOG:  aborting any active transactions
2022-12-23 10:28:56.614 GMT [6448] LOG:  background worker "logical replication launcher" (PID 6455) exited with exit code 1
2022-12-23 10:28:56.616 GMT [6450] LOG:  shutting down
2022-12-23 10:28:56.660 GMT [6448] LOG:  database system is shut down
2022-12-23 10:28:59.250 GMT [7309] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:28:59.251 GMT [7309] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:28:59.252 GMT [7309] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:28:59.257 GMT [7310] LOG:  database system was shut down at 2022-12-23 10:28:58 GMT
2022-12-23 10:28:59.264 GMT [7309] LOG:  database system is ready to accept connections
2022-12-23 10:28:59.987 GMT [7338] ERROR:  function digest(text, unknown) does not exist at character 113
2022-12-23 10:28:59.987 GMT [7338] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-12-23 10:28:59.987 GMT [7338] QUERY:  INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'))
2022-12-23 10:28:59.987 GMT [7338] CONTEXT:  PL/pgSQL function add_account(integer,text,text) line 4 at SQL statement
2022-12-23 10:28:59.987 GMT [7338] STATEMENT:  SELECT * FROM add_account(0, 'hello', 'pass');
2022-12-23 10:36:11.697 GMT [7309] LOG:  received fast shutdown request
2022-12-23 10:36:11.699 GMT [7309] LOG:  aborting any active transactions
2022-12-23 10:36:11.704 GMT [7309] LOG:  background worker "logical replication launcher" (PID 7316) exited with exit code 1
2022-12-23 10:36:11.705 GMT [7311] LOG:  shutting down
2022-12-23 10:36:11.722 GMT [7309] LOG:  database system is shut down
2022-12-23 10:36:14.543 GMT [8597] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:36:14.543 GMT [8597] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:36:14.545 GMT [8597] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:36:14.549 GMT [8598] LOG:  database system was shut down at 2022-12-23 10:36:14 GMT
2022-12-23 10:36:14.556 GMT [8597] LOG:  database system is ready to accept connections
2022-12-23 10:36:15.303 GMT [8623] ERROR:  insert or update on table "account" violates foreign key constraint "account_customer_id_fkey"
2022-12-23 10:36:15.303 GMT [8623] DETAIL:  Key (customer_id)=(0) is not present in table "customer".
2022-12-23 10:36:15.303 GMT [8623] CONTEXT:  SQL statement "INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'))"
	PL/pgSQL function add_account(integer,text,text) line 4 at SQL statement
2022-12-23 10:36:15.303 GMT [8623] STATEMENT:  SELECT * FROM add_account(0, 'hello', 'pass');
2022-12-23 10:40:36.530 GMT [8597] LOG:  received fast shutdown request
2022-12-23 10:40:36.532 GMT [8597] LOG:  aborting any active transactions
2022-12-23 10:40:36.534 GMT [8597] LOG:  background worker "logical replication launcher" (PID 8604) exited with exit code 1
2022-12-23 10:40:36.538 GMT [8599] LOG:  shutting down
2022-12-23 10:40:36.588 GMT [8597] LOG:  database system is shut down
2022-12-23 10:40:39.138 GMT [9452] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:40:39.138 GMT [9452] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:40:39.140 GMT [9452] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:40:39.145 GMT [9453] LOG:  database system was shut down at 2022-12-23 10:40:38 GMT
2022-12-23 10:40:39.152 GMT [9452] LOG:  database system is ready to accept connections
2022-12-23 10:40:39.861 GMT [9478] ERROR:  function add_account(unknown, integer, unknown, unknown) does not exist at character 15
2022-12-23 10:40:39.861 GMT [9478] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-12-23 10:40:39.861 GMT [9478] STATEMENT:  SELECT * FROM add_account('2019-01-01', 0, 'hello', 'pass');
2022-12-23 10:41:55.651 GMT [9452] LOG:  received fast shutdown request
2022-12-23 10:41:55.652 GMT [9452] LOG:  aborting any active transactions
2022-12-23 10:41:55.657 GMT [9452] LOG:  background worker "logical replication launcher" (PID 9459) exited with exit code 1
2022-12-23 10:41:55.659 GMT [9454] LOG:  shutting down
2022-12-23 10:41:55.710 GMT [9452] LOG:  database system is shut down
2022-12-23 10:41:58.002 GMT [9809] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:41:58.002 GMT [9809] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:41:58.004 GMT [9809] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:41:58.010 GMT [9810] LOG:  database system was shut down at 2022-12-23 10:41:57 GMT
2022-12-23 10:41:58.017 GMT [9809] LOG:  database system is ready to accept connections
2022-12-23 10:41:58.747 GMT [9835] ERROR:  column "2019-01-01" does not exist at character 27
2022-12-23 10:41:58.747 GMT [9835] STATEMENT:  SELECT * FROM add_account("2019-01-01", 0, "hello", "pass");
2022-12-23 10:42:31.732 GMT [9809] LOG:  received fast shutdown request
2022-12-23 10:42:31.733 GMT [9809] LOG:  aborting any active transactions
2022-12-23 10:42:31.737 GMT [9809] LOG:  background worker "logical replication launcher" (PID 9816) exited with exit code 1
2022-12-23 10:42:31.741 GMT [9811] LOG:  shutting down
2022-12-23 10:42:31.787 GMT [9809] LOG:  database system is shut down
2022-12-23 10:42:34.887 GMT [10051] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:42:34.887 GMT [10051] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:42:34.889 GMT [10051] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:42:34.894 GMT [10052] LOG:  database system was shut down at 2022-12-23 10:42:34 GMT
2022-12-23 10:42:34.899 GMT [10051] LOG:  database system is ready to accept connections
2022-12-23 10:42:35.589 GMT [10080] ERROR:  column "hello" does not exist at character 44
2022-12-23 10:42:35.589 GMT [10080] STATEMENT:  SELECT * FROM add_account('2019-01-01', 0, "hello", "pass");
2022-12-23 10:43:00.107 GMT [10051] LOG:  received fast shutdown request
2022-12-23 10:43:00.109 GMT [10051] LOG:  aborting any active transactions
2022-12-23 10:43:00.115 GMT [10051] LOG:  background worker "logical replication launcher" (PID 10058) exited with exit code 1
2022-12-23 10:43:00.116 GMT [10053] LOG:  shutting down
2022-12-23 10:43:00.162 GMT [10051] LOG:  database system is shut down
2022-12-23 10:43:02.423 GMT [10239] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:43:02.423 GMT [10239] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:43:02.425 GMT [10239] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:43:02.430 GMT [10240] LOG:  database system was shut down at 2022-12-23 10:43:02 GMT
2022-12-23 10:43:02.436 GMT [10239] LOG:  database system is ready to accept connections
2022-12-23 10:43:03.151 GMT [10268] ERROR:  column "pass" does not exist at character 53
2022-12-23 10:43:03.151 GMT [10268] STATEMENT:  SELECT * FROM add_account('2019-01-01', 0, 'hello', "pass");
2022-12-23 10:43:11.561 GMT [10239] LOG:  received fast shutdown request
2022-12-23 10:43:11.563 GMT [10239] LOG:  aborting any active transactions
2022-12-23 10:43:11.568 GMT [10239] LOG:  background worker "logical replication launcher" (PID 10246) exited with exit code 1
2022-12-23 10:43:11.568 GMT [10241] LOG:  shutting down
2022-12-23 10:43:11.619 GMT [10239] LOG:  database system is shut down
2022-12-23 10:43:14.018 GMT [10387] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:43:14.018 GMT [10387] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:43:14.020 GMT [10387] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:43:14.024 GMT [10388] LOG:  database system was shut down at 2022-12-23 10:43:13 GMT
2022-12-23 10:43:14.044 GMT [10387] LOG:  database system is ready to accept connections
2022-12-23 10:43:14.722 GMT [10416] ERROR:  function add_account(unknown, integer, unknown, unknown) does not exist at character 15
2022-12-23 10:43:14.722 GMT [10416] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-12-23 10:43:14.722 GMT [10416] STATEMENT:  SELECT * FROM add_account('2019-01-01', 0, 'hello', 'pass');
2022-12-23 10:44:26.345 GMT [10387] LOG:  received fast shutdown request
2022-12-23 10:44:26.346 GMT [10387] LOG:  aborting any active transactions
2022-12-23 10:44:26.352 GMT [10387] LOG:  background worker "logical replication launcher" (PID 10394) exited with exit code 1
2022-12-23 10:44:26.353 GMT [10389] LOG:  shutting down
2022-12-23 10:44:26.402 GMT [10387] LOG:  database system is shut down
2022-12-23 10:44:28.649 GMT [10712] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:44:28.649 GMT [10712] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:44:28.650 GMT [10712] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:44:28.656 GMT [10713] LOG:  database system was shut down at 2022-12-23 10:44:28 GMT
2022-12-23 10:44:28.663 GMT [10712] LOG:  database system is ready to accept connections
2022-12-23 10:44:29.380 GMT [10738] ERROR:  function add_account(date, integer, text, text) does not exist at character 15
2022-12-23 10:44:29.380 GMT [10738] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-12-23 10:44:29.380 GMT [10738] STATEMENT:  SELECT * FROM add_account(DATE '2019-01-01', 0, TEXT 'hello', TEXT 'pass');
2022-12-23 10:44:56.885 GMT [10712] LOG:  received fast shutdown request
2022-12-23 10:44:56.886 GMT [10712] LOG:  aborting any active transactions
2022-12-23 10:44:56.891 GMT [10712] LOG:  background worker "logical replication launcher" (PID 10719) exited with exit code 1
2022-12-23 10:44:56.893 GMT [10714] LOG:  shutting down
2022-12-23 10:44:56.945 GMT [10712] LOG:  database system is shut down
2022-12-23 10:44:59.756 GMT [10931] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:44:59.756 GMT [10931] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:44:59.757 GMT [10931] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:44:59.770 GMT [10935] LOG:  database system was shut down at 2022-12-23 10:44:59 GMT
2022-12-23 10:44:59.776 GMT [10931] LOG:  database system is ready to accept connections
2022-12-23 10:45:00.464 GMT [10964] ERROR:  insert or update on table "account" violates foreign key constraint "account_customer_id_fkey"
2022-12-23 10:45:00.464 GMT [10964] DETAIL:  Key (customer_id)=(0) is not present in table "customer".
2022-12-23 10:45:00.464 GMT [10964] CONTEXT:  SQL statement "INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'))"
	PL/pgSQL function add_account(integer,text,text) line 4 at SQL statement
2022-12-23 10:45:00.464 GMT [10964] STATEMENT:  SELECT * FROM add_account(0, TEXT 'hello', TEXT 'pass');
2022-12-23 10:47:02.477 GMT [10931] LOG:  received fast shutdown request
2022-12-23 10:47:02.480 GMT [10931] LOG:  aborting any active transactions
2022-12-23 10:47:02.485 GMT [10931] LOG:  background worker "logical replication launcher" (PID 10941) exited with exit code 1
2022-12-23 10:47:02.485 GMT [10936] LOG:  shutting down
2022-12-23 10:47:02.538 GMT [10931] LOG:  database system is shut down
2022-12-23 10:47:04.771 GMT [11381] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:47:04.771 GMT [11381] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:47:04.773 GMT [11381] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:47:04.778 GMT [11382] LOG:  database system was shut down at 2022-12-23 10:47:04 GMT
2022-12-23 10:47:04.784 GMT [11381] LOG:  database system is ready to accept connections
2022-12-23 10:47:05.516 GMT [11407] ERROR:  column "log_date" of relation "log" does not exist at character 18
2022-12-23 10:47:05.516 GMT [11407] QUERY:  INSERT INTO log (log_date, log_message, customer_id)
	    VALUES (current_date, 'Account added', customer_id)
2022-12-23 10:47:05.516 GMT [11407] CONTEXT:  PL/pgSQL function add_account(integer,text,text) line 7 at SQL statement
2022-12-23 10:47:05.516 GMT [11407] STATEMENT:  SELECT * FROM add_account(1, TEXT 'hello', TEXT 'pass');
2022-12-23 10:48:46.217 GMT [11381] LOG:  received fast shutdown request
2022-12-23 10:48:46.218 GMT [11381] LOG:  aborting any active transactions
2022-12-23 10:48:46.223 GMT [11381] LOG:  background worker "logical replication launcher" (PID 11388) exited with exit code 1
2022-12-23 10:48:46.223 GMT [11383] LOG:  shutting down
2022-12-23 10:48:46.269 GMT [11381] LOG:  database system is shut down
2022-12-23 10:48:48.618 GMT [11807] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 10:48:48.618 GMT [11807] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 10:48:48.620 GMT [11807] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 10:48:48.625 GMT [11808] LOG:  database system was shut down at 2022-12-23 10:48:48 GMT
2022-12-23 10:48:48.630 GMT [11807] LOG:  database system is ready to accept connections
2022-12-23 10:58:31.689 GMT [13621] ERROR:  relation "account" does not exist at character 15
2022-12-23 10:58:31.689 GMT [13621] STATEMENT:  select * from account;
2022-12-23 11:04:58.433 GMT [11807] LOG:  received fast shutdown request
2022-12-23 11:04:58.435 GMT [11807] LOG:  aborting any active transactions
2022-12-23 11:04:58.440 GMT [11807] LOG:  background worker "logical replication launcher" (PID 11814) exited with exit code 1
2022-12-23 11:04:58.440 GMT [11809] LOG:  shutting down
2022-12-23 11:04:58.457 GMT [11807] LOG:  database system is shut down
2022-12-23 11:05:15.238 GMT [14953] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-23 11:05:15.238 GMT [14953] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-23 11:05:15.240 GMT [14953] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-23 11:05:15.245 GMT [14954] LOG:  database system was shut down at 2022-12-23 11:05:14 GMT
2022-12-23 11:05:15.252 GMT [14953] LOG:  database system is ready to accept connections
2022-12-24 21:00:36.319 GMT [14958] LOG:  statistics collector's time 2022-12-24 21:00:38.499932+00 is later than backend local time 2022-12-24 21:00:36.173166+00
2022-12-24 21:00:36.320 GMT [14958] LOG:  statistics collector's time 2022-12-24 21:00:38.499932+00 is later than backend local time 2022-12-24 21:00:36.320171+00
2022-12-24 21:00:36.652 GMT [14959] LOG:  stats_timestamp 2022-12-24 21:00:38.499932+00 is later than collector's time 2022-12-24 21:00:36.651979+00 for database 0
2022-12-28 12:36:57.529 GMT [24390] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-28 12:36:57.532 GMT [24390] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-28 12:36:57.534 GMT [24390] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-28 12:36:57.539 GMT [24391] LOG:  database system was shut down at 2022-12-28 12:36:57 GMT
2022-12-28 12:36:57.544 GMT [24390] LOG:  database system is ready to accept connections
2022-12-28 12:36:58.152 GMT [24416] ERROR:  syntax error at or near "INTO" at character 147
2022-12-28 12:36:58.152 GMT [24416] STATEMENT:  CREATE OR REPLACE VIEW view_accounts AS
	SELECT id, init_date, customer_id
	FROM account
	/*insert 10 elements of sample data into customer*/
	INSERT INTO customer (init_date, first_name, last_name, date_of_birth, phone_number, address)
	VALUES
	    ('2019-01-01', 'John', 'Smith', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Jane', 'Doe', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Bob', 'Smith', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Alice', 'Doe', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'John', 'Doe', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Jane', 'Smith', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Bob', 'Doe', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Alice', 'Smith', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'John', 'Dee', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}'),
	    ('2019-01-01', 'Jane', 'Dee', '1990-01-01', '123-456-7890', '{"123 Main St", "Apt 1", "New York, NY 10001"}');
2022-12-28 12:36:58.156 GMT [24416] ERROR:  insert or update on table "account" violates foreign key constraint "account_customer_id_fkey"
2022-12-28 12:36:58.156 GMT [24416] DETAIL:  Key (customer_id)=(1) is not present in table "customer".
2022-12-28 12:36:58.156 GMT [24416] STATEMENT:  /*insert elements of sample data into account*/
	INSERT INTO account (init_date, customer_id, username, passwd)
	VALUES
	    ('2019-01-01', 1, 'JohnSmith', '4e1b8f5bacb39b35f0a97f962871b2d4d5b5e935c34db051b45e3cc5f5b5d5c5'),
	    ('2017-01-01', 2, 'JaneDoe', 'f0d5d3c9cf9b5b8c3b3e5e5ce5b5d5c8f5e5b5c5d9d5c5f5b5b5b5f5b5d5b5b5'),
	    ('2018-01-01', 3, 'BobSmith', 'e4e9b5b5b5b5e9e9e9b5b5b5e9e9b5b5b5b5b5b5e9e9e9e9b5b5b5e9b5b5b5b5'),
	    ('2015-01-01', 4, 'AliceDoe', 'c5d5d5b5b5b5b5b5b5d5d5d5d5b5b5b5b5b5b5d5d5d5d5b5b5b5b5b5b5b5b5'),
	    ('2016-01-01', 5, 'JohnDoe', 'a9d9b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5'),
	    ('2016-01-01', 6, 'JaneSmith', 'f5e9e9e9b5b5b5e9e9e9e9b5b5b5e9e9e9e9b5b5b5e9e9e9e9b5b5b5e9e9e9'),
	    ('2017-01-01', 7, 'BobDoe', 'd5d5d5d5b5b5b5b5b5d5d5d5d5b5b5b5b5b5d5d5d5d5b5b5b5b5b5b5b5b5b5'),
	    ('2014-01-01', 8, 'AliceSmith', 'b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5b5'),
	    ('2016-01-01', 9, 'JohnDee', 'e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5'),
	    ('2017-01-01', 10, 'JaneDee', 'c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5');
2022-12-28 12:36:58.157 GMT [24416] ERROR:  insert or update on table "savings_account" violates foreign key constraint "savings_account_account_id_fkey"
2022-12-28 12:36:58.157 GMT [24416] DETAIL:  Key (account_id)=(1) is not present in table "account".
2022-12-28 12:36:58.157 GMT [24416] STATEMENT:  /*insert 8 elements of sample data into savings_account with different amounts and interest rates*/
	INSERT INTO savings_account (account_id, current_balance, interest_rate)
	VALUES
	    (1, 1000.00, 0.01),
	    (2, 2000.00, 0.02),
	    (3, 3000.00, 0.03),
	    (4, 4000.00, 0.04),
	    (5, 5000.00, 0.05),
	    (6, 6000.00, 0.06),
	    (7, 7000.00, 0.07),
	    (8, 8000.00, 0.08);
2022-12-28 12:36:58.159 GMT [24416] ERROR:  insert or update on table "credit_account" violates foreign key constraint "credit_account_account_id_fkey"
2022-12-28 12:36:58.159 GMT [24416] DETAIL:  Key (account_id)=(1) is not present in table "account".
2022-12-28 12:36:58.159 GMT [24416] STATEMENT:  /*insert 8 elements of sample data into credit_account with different amounts, credit limits, and interest rates*/
	INSERT INTO credit_account (account_id, current_balance, credit_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-28 12:36:58.162 GMT [24416] ERROR:  insert or update on table "debit_account" violates foreign key constraint "debit_account_account_id_fkey"
2022-12-28 12:36:58.162 GMT [24416] DETAIL:  Key (account_id)=(1) is not present in table "account".
2022-12-28 12:36:58.162 GMT [24416] STATEMENT:  /*insert 8 elements of sample data into debit_account with different amounts, overdraft limits, and interest rates*/
	INSERT INTO debit_account (account_id, current_balance, overdraft_limit, interest_rate)
	VALUES
	    (1, 1000.00, 10000.00, 0.01),
	    (2, 2000.00, 20000.00, 0.02),
	    (3, 3000.00, 30000.00, 0.03),
	    (4, 4000.00, 40000.00, 0.04),
	    (5, 5000.00, 50000.00, 0.05),
	    (6, 6000.00, 60000.00, 0.06),
	    (7, 7000.00, 70000.00, 0.07),
	    (8, 8000.00, 80000.00, 0.08);
2022-12-28 12:36:58.164 GMT [24416] ERROR:  insert or update on table "loan" violates foreign key constraint "loan_account_id_fkey"
2022-12-28 12:36:58.164 GMT [24416] DETAIL:  Key (account_id)=(1) is not present in table "account".
2022-12-28 12:36:58.164 GMT [24416] STATEMENT:  /*insert 8 elements of sample data into loan with different amounts, interest rates, loan terms, and loan start and end dates*/
	INSERT INTO loan (account_id, loan_amount, interest_rate, loan_term, loan_start_date, loan_end_date)
	VALUES
	    (1, 1000.00, 0.01, 12, '2019-01-01', '2020-01-01'),
	    (2, 2000.00, 0.02, 12, '2019-01-01', '2020-01-01'),
	    (3, 3000.00, 0.03, 12, '2019-01-01', '2020-01-01'),
	    (4, 4000.00, 0.04, 12, '2019-01-01', '2020-01-01'),
	    (5, 5000.00, 0.05, 12, '2019-01-01', '2020-01-01'),
	    (6, 6000.00, 0.06, 12, '2019-01-01', '2020-01-01'),
	    (7, 7000.00, 0.07, 12, '2019-01-01', '2020-01-01'),
	    (8, 8000.00, 0.08, 12, '2019-01-01', '2020-01-01');
2022-12-28 12:36:58.182 GMT [24416] ERROR:  insert or update on table "account" violates foreign key constraint "account_customer_id_fkey"
2022-12-28 12:36:58.182 GMT [24416] DETAIL:  Key (customer_id)=(1) is not present in table "customer".
2022-12-28 12:36:58.182 GMT [24416] CONTEXT:  SQL statement "INSERT INTO account (init_date, customer_id, username, passwd)
	    VALUES (current_date, customer_id, username, DIGEST(passwd, 'sha256'))"
	PL/pgSQL function add_account(integer,text,text) line 4 at SQL statement
2022-12-28 12:36:58.182 GMT [24416] STATEMENT:  SELECT * FROM add_account(1, TEXT 'hello', TEXT 'pass');
2022-12-28 12:38:42.477 GMT [24721] ERROR:  syntax error at or near "select" at character 35
2022-12-28 12:38:42.477 GMT [24721] STATEMENT:  set search_path to online_banking
	select * from customer;
2022-12-28 12:39:15.530 GMT [24721] ERROR:  relation "bank" does not exist at character 15
2022-12-28 12:39:15.530 GMT [24721] STATEMENT:  select * from bank
	;
2022-12-28 12:39:24.236 GMT [24721] ERROR:  relation "customer" does not exist at character 15
2022-12-28 12:39:24.236 GMT [24721] STATEMENT:  select * from customer;
2022-12-28 12:44:39.839 GMT [24721] ERROR:  syntax error at or near "inset" at character 1
2022-12-28 12:44:39.839 GMT [24721] STATEMENT:  inset into online_banking.customer
	('2019-01-01', 'john', 'smith', '1990-01-01','122-145-7896', '{"123 Main St", "Apt 1", "New York, NY 10001"});
	';
	)
	;
2022-12-28 12:45:07.984 GMT [24721] ERROR:  syntax error at or near "'2019-01-01'" at character 38
2022-12-28 12:45:07.984 GMT [24721] STATEMENT:  insert into online_banking.customer
	('2019-01-01', 'john', 'smith', '1990-01-01','122-145-7896', '{"123 Main St", "Apt 1", "New York, NY 10001"}');
2022-12-28 12:47:52.800 GMT [24390] LOG:  received fast shutdown request
2022-12-28 12:47:52.802 GMT [24390] LOG:  aborting any active transactions
2022-12-28 12:47:52.805 GMT [24390] LOG:  background worker "logical replication launcher" (PID 24397) exited with exit code 1
2022-12-28 12:47:52.806 GMT [24392] LOG:  shutting down
2022-12-28 12:47:52.821 GMT [24390] LOG:  database system is shut down
2022-12-28 12:47:58.094 GMT [27915] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-28 12:47:58.094 GMT [27915] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-28 12:47:58.096 GMT [27915] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-28 12:47:58.100 GMT [27916] LOG:  database system was shut down at 2022-12-28 12:47:57 GMT
2022-12-28 12:47:58.110 GMT [27915] LOG:  database system is ready to accept connections
2022-12-28 17:03:07.782 GMT [27915] LOG:  received SIGHUP, reloading configuration files
2022-12-28 17:03:07.784 GMT [27915] LOG:  received smart shutdown request
2022-12-28 17:03:07.900 GMT [27915] LOG:  background worker "logical replication launcher" (PID 27922) exited with exit code 1
2022-12-28 17:03:07.900 GMT [27917] LOG:  shutting down
2022-12-28 17:03:07.974 GMT [27915] LOG:  database system is shut down
2022-12-29 10:55:08.264 GMT [12197] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 10:55:08.267 GMT [12197] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 10:55:08.269 GMT [12197] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 10:55:08.275 GMT [12198] LOG:  database system was shut down at 2022-12-29 10:55:07 GMT
2022-12-29 10:55:08.281 GMT [12197] LOG:  database system is ready to accept connections
2022-12-29 10:56:55.656 GMT [12197] LOG:  received fast shutdown request
2022-12-29 10:56:55.658 GMT [12197] LOG:  aborting any active transactions
2022-12-29 10:56:55.663 GMT [12197] LOG:  background worker "logical replication launcher" (PID 12204) exited with exit code 1
2022-12-29 10:56:55.664 GMT [12199] LOG:  shutting down
2022-12-29 10:56:55.724 GMT [12197] LOG:  database system is shut down
2022-12-29 10:56:58.614 GMT [12627] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 10:56:58.614 GMT [12627] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 10:56:58.616 GMT [12627] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 10:56:58.621 GMT [12628] LOG:  database system was shut down at 2022-12-29 10:56:58 GMT
2022-12-29 10:56:58.627 GMT [12627] LOG:  database system is ready to accept connections
2022-12-29 10:56:59.337 GMT [12656] ERROR:  column "id" specified more than once
2022-12-29 10:56:59.337 GMT [12656] STATEMENT:  CREATE OR REPLACE VIEW view_savings_accounts AS
	SELECT account.id, savings_account.id, savings_account.account_id, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN account ON savings_account.account_id = account.id;
2022-12-29 10:56:59.403 GMT [12656] ERROR:  relation "view_savings_accounts" does not exist at character 15
2022-12-29 10:56:59.403 GMT [12656] STATEMENT:  SELECT * FROM view_savings_accounts;
2022-12-29 10:57:38.493 GMT [12627] LOG:  received fast shutdown request
2022-12-29 10:57:38.494 GMT [12627] LOG:  aborting any active transactions
2022-12-29 10:57:38.499 GMT [12627] LOG:  background worker "logical replication launcher" (PID 12634) exited with exit code 1
2022-12-29 10:57:38.501 GMT [12629] LOG:  shutting down
2022-12-29 10:57:38.550 GMT [12627] LOG:  database system is shut down
2022-12-29 10:57:40.726 GMT [12861] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 10:57:40.726 GMT [12861] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 10:57:40.728 GMT [12861] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 10:57:40.733 GMT [12862] LOG:  database system was shut down at 2022-12-29 10:57:40 GMT
2022-12-29 10:57:40.740 GMT [12861] LOG:  database system is ready to accept connections
2022-12-29 10:57:41.441 GMT [12887] ERROR:  column "account_id" specified more than once
2022-12-29 10:57:41.441 GMT [12887] STATEMENT:  CREATE OR REPLACE VIEW view_savings_accounts AS
	SELECT account.id AS account_id, savings_account.id, savings_account.account_id, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN account ON savings_account.account_id = account.id;
2022-12-29 10:57:41.506 GMT [12887] ERROR:  relation "view_savings_accounts" does not exist at character 15
2022-12-29 10:57:41.506 GMT [12887] STATEMENT:  SELECT * FROM view_savings_accounts;
2022-12-29 10:58:00.606 GMT [12861] LOG:  received fast shutdown request
2022-12-29 10:58:00.608 GMT [12861] LOG:  aborting any active transactions
2022-12-29 10:58:00.614 GMT [12861] LOG:  background worker "logical replication launcher" (PID 12868) exited with exit code 1
2022-12-29 10:58:00.614 GMT [12863] LOG:  shutting down
2022-12-29 10:58:00.667 GMT [12861] LOG:  database system is shut down
2022-12-29 10:58:02.746 GMT [13037] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 10:58:02.746 GMT [13037] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 10:58:02.748 GMT [13037] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 10:58:02.753 GMT [13038] LOG:  database system was shut down at 2022-12-29 10:58:02 GMT
2022-12-29 10:58:02.760 GMT [13037] LOG:  database system is ready to accept connections
2022-12-29 13:49:25.146 GMT [13037] LOG:  received fast shutdown request
2022-12-29 13:49:25.149 GMT [13037] LOG:  aborting any active transactions
2022-12-29 13:49:25.154 GMT [13037] LOG:  background worker "logical replication launcher" (PID 13044) exited with exit code 1
2022-12-29 13:49:25.154 GMT [13039] LOG:  shutting down
2022-12-29 13:49:25.170 GMT [13037] LOG:  database system is shut down
2022-12-29 13:49:32.282 GMT [22820] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 13:49:32.283 GMT [22820] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 13:49:32.285 GMT [22820] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 13:49:32.290 GMT [22821] LOG:  database system was shut down at 2022-12-29 13:49:31 GMT
2022-12-29 13:49:32.296 GMT [22820] LOG:  database system is ready to accept connections
2022-12-29 13:56:27.074 GMT [22820] LOG:  received fast shutdown request
2022-12-29 13:56:27.076 GMT [22820] LOG:  aborting any active transactions
2022-12-29 13:56:27.081 GMT [22820] LOG:  background worker "logical replication launcher" (PID 22827) exited with exit code 1
2022-12-29 13:56:27.082 GMT [22822] LOG:  shutting down
2022-12-29 13:56:27.098 GMT [22820] LOG:  database system is shut down
2022-12-29 13:56:29.695 GMT [24272] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 13:56:29.696 GMT [24272] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 13:56:29.698 GMT [24272] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 13:56:29.702 GMT [24273] LOG:  database system was shut down at 2022-12-29 13:56:29 GMT
2022-12-29 13:56:29.708 GMT [24272] LOG:  database system is ready to accept connections
2022-12-29 13:56:30.436 GMT [24301] ERROR:  table name "loan" specified more than once
2022-12-29 13:56:30.436 GMT [24301] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT customer.first_name, customer.last_name, loans.customer_id, loans.account_id, loans.loan_start_date FROM customer
	INNER JOIN
	    (SELECT account.customer_id, loan.id, loan.account_id, loan.loan_start_date
	    FROM loan
	    INNER JOIN loan ON loan.account_id = account.account_id) AS loans
	ON customer.id = loans.customer_id;
2022-12-29 13:56:30.563 GMT [24301] ERROR:  relation "view_loans" does not exist at character 15
2022-12-29 13:56:30.563 GMT [24301] STATEMENT:  SELECT * FROM view_loans;
2022-12-29 13:57:53.107 GMT [24272] LOG:  received fast shutdown request
2022-12-29 13:57:53.110 GMT [24272] LOG:  aborting any active transactions
2022-12-29 13:57:53.116 GMT [24272] LOG:  background worker "logical replication launcher" (PID 24279) exited with exit code 1
2022-12-29 13:57:53.116 GMT [24274] LOG:  shutting down
2022-12-29 13:57:53.170 GMT [24272] LOG:  database system is shut down
2022-12-29 13:57:55.116 GMT [24613] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 13:57:55.117 GMT [24613] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 13:57:55.118 GMT [24613] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 13:57:55.123 GMT [24614] LOG:  database system was shut down at 2022-12-29 13:57:54 GMT
2022-12-29 13:57:55.129 GMT [24613] LOG:  database system is ready to accept connections
2022-12-29 13:57:55.862 GMT [24639] ERROR:  column account.account_id does not exist at character 308
2022-12-29 13:57:55.862 GMT [24639] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT customer.first_name, customer.last_name, loans.customer_id, loans.account_id, loans.loan_start_date FROM customer
	INNER JOIN
	    (SELECT account.customer_id, loan.id, loan.account_id, loan.loan_start_date
	    FROM loan
	    INNER JOIN account ON loan.account_id = account.account_id) AS loans
	ON customer.id = loans.customer_id;
2022-12-29 13:57:55.956 GMT [24639] ERROR:  relation "view_loans" does not exist at character 15
2022-12-29 13:57:55.956 GMT [24639] STATEMENT:  SELECT * FROM view_loans;
2022-12-29 13:58:32.304 GMT [24613] LOG:  received fast shutdown request
2022-12-29 13:58:32.307 GMT [24613] LOG:  aborting any active transactions
2022-12-29 13:58:32.313 GMT [24613] LOG:  background worker "logical replication launcher" (PID 24620) exited with exit code 1
2022-12-29 13:58:32.313 GMT [24615] LOG:  shutting down
2022-12-29 13:58:32.375 GMT [24613] LOG:  database system is shut down
2022-12-29 13:58:34.265 GMT [24828] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 13:58:34.266 GMT [24828] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 13:58:34.267 GMT [24828] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 13:58:34.272 GMT [24829] LOG:  database system was shut down at 2022-12-29 13:58:33 GMT
2022-12-29 13:58:34.279 GMT [24828] LOG:  database system is ready to accept connections
2022-12-29 14:07:09.371 GMT [24828] LOG:  received fast shutdown request
2022-12-29 14:07:09.372 GMT [24828] LOG:  aborting any active transactions
2022-12-29 14:07:09.380 GMT [24828] LOG:  background worker "logical replication launcher" (PID 24835) exited with exit code 1
2022-12-29 14:07:09.380 GMT [24830] LOG:  shutting down
2022-12-29 14:07:09.401 GMT [24828] LOG:  database system is shut down
2022-12-29 14:07:11.553 GMT [26450] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:07:11.553 GMT [26450] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:07:11.554 GMT [26450] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:07:11.560 GMT [26451] LOG:  database system was shut down at 2022-12-29 14:07:11 GMT
2022-12-29 14:07:11.568 GMT [26450] LOG:  database system is ready to accept connections
2022-12-29 14:07:12.287 GMT [26479] ERROR:  column loan.loan_id does not exist at character 324
2022-12-29 14:07:12.287 GMT [26479] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT customer.first_name, customer.last_name, loans.customer_id, loans.account_id, loans.loan_start_date FROM customer
	INNER JOIN
	    (SELECT account.customer_id, loan.id, loan.account_id, loan.loan_start_date
	    FROM (
	        SELECT loan.id, loan.account_id, loan.loan_start_date, loan.loan_id, loan.is_approved FROM loan
	        INNER JOIN loan_application ON loan.id = loan_application.loan_id
	    ) AS loan
	    INNER JOIN account ON loan.account_id = account.id) AS loans
	ON customer.id = loans.customer_id;
2022-12-29 14:07:12.353 GMT [26479] ERROR:  relation "view_loans" does not exist at character 15
2022-12-29 14:07:12.353 GMT [26479] STATEMENT:  SELECT * FROM view_loans;
2022-12-29 14:07:49.381 GMT [26450] LOG:  received fast shutdown request
2022-12-29 14:07:49.382 GMT [26450] LOG:  aborting any active transactions
2022-12-29 14:07:49.389 GMT [26450] LOG:  background worker "logical replication launcher" (PID 26457) exited with exit code 1
2022-12-29 14:07:49.389 GMT [26452] LOG:  shutting down
2022-12-29 14:07:49.444 GMT [26450] LOG:  database system is shut down
2022-12-29 14:07:51.285 GMT [26682] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:07:51.285 GMT [26682] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:07:51.286 GMT [26682] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:07:51.292 GMT [26685] LOG:  database system was shut down at 2022-12-29 14:07:50 GMT
2022-12-29 14:07:51.297 GMT [26682] LOG:  database system is ready to accept connections
2022-12-29 14:11:21.415 GMT [26682] LOG:  received fast shutdown request
2022-12-29 14:11:21.417 GMT [26682] LOG:  aborting any active transactions
2022-12-29 14:11:21.421 GMT [26682] LOG:  background worker "logical replication launcher" (PID 26692) exited with exit code 1
2022-12-29 14:11:21.421 GMT [26687] LOG:  shutting down
2022-12-29 14:11:21.466 GMT [26682] LOG:  database system is shut down
2022-12-29 14:11:23.366 GMT [27482] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:11:23.366 GMT [27482] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:11:23.368 GMT [27482] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:11:23.372 GMT [27483] LOG:  database system was shut down at 2022-12-29 14:11:23 GMT
2022-12-29 14:11:23.376 GMT [27482] LOG:  database system is ready to accept connections
2022-12-29 14:12:05.649 GMT [27482] LOG:  received fast shutdown request
2022-12-29 14:12:05.650 GMT [27482] LOG:  aborting any active transactions
2022-12-29 14:12:05.655 GMT [27482] LOG:  background worker "logical replication launcher" (PID 27489) exited with exit code 1
2022-12-29 14:12:05.656 GMT [27484] LOG:  shutting down
2022-12-29 14:12:05.697 GMT [27482] LOG:  database system is shut down
2022-12-29 14:12:07.593 GMT [27715] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:12:07.594 GMT [27715] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:12:07.595 GMT [27715] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:12:07.601 GMT [27722] LOG:  database system was shut down at 2022-12-29 14:12:07 GMT
2022-12-29 14:12:07.606 GMT [27715] LOG:  database system is ready to accept connections
2022-12-29 14:12:08.190 GMT [27751] ERROR:  missing FROM-clause entry for table "loan" at character 146
2022-12-29 14:12:08.190 GMT [27751] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT customer.first_name, customer.last_name, loans.customer_id, loans.account_id, loans.loan_start_date, loan.is_approved FROM customer
	INNER JOIN
	    (SELECT account.customer_id, loan.id, loan.account_id, loan.loan_start_date
	    FROM (
	        SELECT loan.id, loan.account_id, loan.loan_start_date, loan_application.loan_id, loan_application.is_approved FROM loan
	        INNER JOIN loan_application ON loan.id = loan_application.loan_id
	    ) AS loan
	    INNER JOIN account ON loan.account_id = account.id) AS loans
	ON customer.id = loans.customer_id;
2022-12-29 14:12:08.246 GMT [27751] ERROR:  relation "view_loans" does not exist at character 15
2022-12-29 14:12:08.246 GMT [27751] STATEMENT:  SELECT * FROM view_loans;
2022-12-29 14:13:16.320 GMT [27715] LOG:  received fast shutdown request
2022-12-29 14:13:16.321 GMT [27715] LOG:  aborting any active transactions
2022-12-29 14:13:16.325 GMT [27715] LOG:  background worker "logical replication launcher" (PID 27729) exited with exit code 1
2022-12-29 14:13:16.325 GMT [27724] LOG:  shutting down
2022-12-29 14:13:16.363 GMT [27715] LOG:  database system is shut down
2022-12-29 14:13:18.061 GMT [28028] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:13:18.062 GMT [28028] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:13:18.063 GMT [28028] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:13:18.068 GMT [28029] LOG:  database system was shut down at 2022-12-29 14:13:17 GMT
2022-12-29 14:13:18.075 GMT [28028] LOG:  database system is ready to accept connections
2022-12-29 14:14:08.899 GMT [28028] LOG:  received fast shutdown request
2022-12-29 14:14:08.901 GMT [28028] LOG:  aborting any active transactions
2022-12-29 14:14:08.905 GMT [28028] LOG:  background worker "logical replication launcher" (PID 28036) exited with exit code 1
2022-12-29 14:14:08.905 GMT [28030] LOG:  shutting down
2022-12-29 14:14:08.942 GMT [28028] LOG:  database system is shut down
2022-12-29 14:14:10.836 GMT [28335] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:14:10.837 GMT [28335] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:14:10.838 GMT [28335] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:14:10.843 GMT [28336] LOG:  database system was shut down at 2022-12-29 14:14:10 GMT
2022-12-29 14:14:10.849 GMT [28335] LOG:  database system is ready to accept connections
2022-12-29 14:28:55.849 GMT [28335] LOG:  received fast shutdown request
2022-12-29 14:28:55.851 GMT [28335] LOG:  aborting any active transactions
2022-12-29 14:28:55.855 GMT [28335] LOG:  background worker "logical replication launcher" (PID 28342) exited with exit code 1
2022-12-29 14:28:55.855 GMT [28337] LOG:  shutting down
2022-12-29 14:28:55.869 GMT [28335] LOG:  database system is shut down
2022-12-29 14:28:57.760 GMT [31336] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:28:57.760 GMT [31336] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:28:57.762 GMT [31336] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:28:57.766 GMT [31337] LOG:  database system was shut down at 2022-12-29 14:28:57 GMT
2022-12-29 14:28:57.770 GMT [31336] LOG:  database system is ready to accept connections
2022-12-29 14:28:58.407 GMT [31376] ERROR:  column credit_account_application.credit_account_i does not exist at character 580
2022-12-29 14:28:58.407 GMT [31376] HINT:  Perhaps you meant to reference the column "credit_account_application.credit_account_id".
2022-12-29 14:28:58.407 GMT [31376] STATEMENT:  CREATE OR REPLACE VIEW view_credit_accounts AS
	SELECT customer.first_name, customer.last_name, credit_accounts.customer_id, credit_accounts.id, credit_accounts.is_approved FROM customer
	INNER JOIN
	    (SELECT account.customer_id, credit_account.id, credit_account.account_id, credit_account.is_approved
	    FROM (
	        SELECT credit_account.id, credit_account.account_id, credit_account.interest_rate, credit_account_application.credit_account_id, credit_account_application.is_approved FROM credit_account
	        INNER JOIN credit_account_application ON credit_account.id = credit_account_application.credit_account_i
	    ) AS credit_account
	    INNER JOIN account on credit_account.account_id = account.id) AS credit_accounts
	ON customer.id = credit_accounts.customer_id
	ORDER BY customer.last_name ASC;
2022-12-29 14:35:36.783 GMT [31336] LOG:  received fast shutdown request
2022-12-29 14:35:36.785 GMT [31336] LOG:  aborting any active transactions
2022-12-29 14:35:36.788 GMT [31336] LOG:  background worker "logical replication launcher" (PID 31343) exited with exit code 1
2022-12-29 14:35:36.793 GMT [31338] LOG:  shutting down
2022-12-29 14:35:36.806 GMT [31336] LOG:  database system is shut down
2022-12-29 14:35:38.640 GMT [32653] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 14:35:38.640 GMT [32653] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 14:35:38.642 GMT [32653] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 14:35:38.646 GMT [32654] LOG:  database system was shut down at 2022-12-29 14:35:38 GMT
2022-12-29 14:35:38.652 GMT [32653] LOG:  database system is ready to accept connections
2022-12-29 15:02:28.429 GMT [32653] LOG:  received fast shutdown request
2022-12-29 15:02:28.431 GMT [32653] LOG:  aborting any active transactions
2022-12-29 15:02:28.433 GMT [32653] LOG:  background worker "logical replication launcher" (PID 32660) exited with exit code 1
2022-12-29 15:02:28.435 GMT [32655] LOG:  shutting down
2022-12-29 15:02:28.451 GMT [32653] LOG:  database system is shut down
2022-12-29 15:02:40.462 GMT [37653] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2022-12-29 15:02:40.462 GMT [37653] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-29 15:02:40.464 GMT [37653] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2022-12-29 15:02:40.469 GMT [37654] LOG:  database system was shut down at 2022-12-29 15:02:40 GMT
2022-12-29 15:02:40.473 GMT [37653] LOG:  database system is ready to accept connections
2022-12-29 15:02:41.092 GMT [37699] ERROR:  syntax error at or near "EXEC" at character 1
2022-12-29 15:02:41.092 GMT [37699] STATEMENT:  EXEC add_account(1, TEXT 'hello', TEXT 'pass');
2022-12-29 15:20:59.746 GMT [37653] LOG:  received smart shutdown request
2022-12-29 15:20:59.756 GMT [37653] LOG:  background worker "logical replication launcher" (PID 37660) exited with exit code 1
2022-12-29 15:20:59.757 GMT [37655] LOG:  shutting down
2022-12-29 15:20:59.764 GMT [37653] LOG:  received SIGHUP, reloading configuration files
2022-12-29 15:20:59.776 GMT [37653] LOG:  database system is shut down
2023-01-06 12:15:00.516 GMT [17876] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 12:15:00.517 GMT [17876] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 12:15:00.528 GMT [17876] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 12:15:00.534 GMT [17888] LOG:  database system was shut down at 2023-01-06 12:15:00 GMT
2023-01-06 12:15:00.539 GMT [17876] LOG:  database system is ready to accept connections
2023-01-06 12:15:01.101 GMT [17913] ERROR:  syntax error at or near "CREATE" at character 166
2023-01-06 12:15:01.101 GMT [17913] STATEMENT:  CREATE TABLE IF NOT EXISTS customer_account (
	    customer_id SERIAL PRIMARY KEY REFERENCES customer(id),
	    account_id SERIAL PRIMARY KEY REFERENCES account(id)
	)
	CREATE TABLE IF NOT EXISTS account (
	    id SERIAL PRIMARY KEY,
	    open_date DATE,
	    account_balance INT,
	    account_type TINYINT
	)
	CREATE ROLE manager LOGIN WITH PASSWORD 'manager';
2023-01-06 12:15:01.101 GMT [17913] ERROR:  syntax error at or near "WITH" at character 29
2023-01-06 12:15:01.101 GMT [17913] STATEMENT:  CREATE ROLE employee1 LOGIN WITH PASSWORD 'employee1';
2023-01-06 12:15:01.102 GMT [17913] ERROR:  syntax error at or near "WITH" at character 29
2023-01-06 12:15:01.102 GMT [17913] STATEMENT:  CREATE ROLE employee2 LOGIN WITH PASSWORD 'employee2';
2023-01-06 12:15:01.102 GMT [17913] ERROR:  syntax error at or near "WITH" at character 29
2023-01-06 12:15:01.102 GMT [17913] STATEMENT:  CREATE ROLE employee3 LOGIN WITH PASSWORD 'employee3';
2023-01-06 12:15:01.103 GMT [17913] ERROR:  syntax error at or near "WITH" at character 29
2023-01-06 12:15:01.103 GMT [17913] STATEMENT:  CREATE ROLE employee4 LOGIN WITH PASSWORD 'employee4';
2023-01-06 12:15:01.103 GMT [17913] ERROR:  syntax error at or near "WITH" at character 29
2023-01-06 12:15:01.103 GMT [17913] STATEMENT:  CREATE ROLE employee5 LOGIN WITH PASSWORD 'employee5';
2023-01-06 12:15:40.217 GMT [17876] LOG:  received fast shutdown request
2023-01-06 12:15:40.219 GMT [17876] LOG:  aborting any active transactions
2023-01-06 12:15:40.224 GMT [17876] LOG:  background worker "logical replication launcher" (PID 17894) exited with exit code 1
2023-01-06 12:15:40.224 GMT [17889] LOG:  shutting down
2023-01-06 12:15:40.251 GMT [17876] LOG:  database system is shut down
2023-01-06 12:15:42.545 GMT [18116] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 12:15:42.546 GMT [18116] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 12:15:42.550 GMT [18116] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 12:15:42.555 GMT [18117] LOG:  database system was shut down at 2023-01-06 12:15:42 GMT
2023-01-06 12:15:42.560 GMT [18116] LOG:  database system is ready to accept connections
2023-01-06 12:15:43.057 GMT [18157] ERROR:  syntax error at or near "CREATE" at character 166
2023-01-06 12:15:43.057 GMT [18157] STATEMENT:  CREATE TABLE IF NOT EXISTS customer_account (
	    customer_id SERIAL PRIMARY KEY REFERENCES customer(id),
	    account_id SERIAL PRIMARY KEY REFERENCES account(id)
	)
	CREATE TABLE IF NOT EXISTS account (
	    id SERIAL PRIMARY KEY,
	    open_date DATE,
	    account_balance INT,
	    account_type TINYINT
	)
	CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-06 12:16:40.683 GMT [18116] LOG:  received fast shutdown request
2023-01-06 12:16:40.685 GMT [18116] LOG:  aborting any active transactions
2023-01-06 12:16:40.690 GMT [18116] LOG:  background worker "logical replication launcher" (PID 18123) exited with exit code 1
2023-01-06 12:16:40.690 GMT [18118] LOG:  shutting down
2023-01-06 12:16:40.725 GMT [18116] LOG:  database system is shut down
2023-01-06 12:16:42.879 GMT [18451] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 12:16:42.879 GMT [18451] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 12:16:42.880 GMT [18451] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 12:16:42.885 GMT [18457] LOG:  database system was shut down at 2023-01-06 12:16:42 GMT
2023-01-06 12:16:42.892 GMT [18451] LOG:  database system is ready to accept connections
2023-01-06 12:16:43.468 GMT [18485] ERROR:  multiple primary keys for table "customer_account" are not allowed at character 129
2023-01-06 12:16:43.468 GMT [18485] STATEMENT:  CREATE TABLE IF NOT EXISTS customer_account (
	    customer_id SERIAL PRIMARY KEY REFERENCES customer(id),
	    account_id SERIAL PRIMARY KEY REFERENCES account(id)
	);
2023-01-06 12:16:43.468 GMT [18485] ERROR:  type "tinyint" does not exist at character 127
2023-01-06 12:16:43.468 GMT [18485] STATEMENT:  CREATE TABLE IF NOT EXISTS account (
	    id SERIAL PRIMARY KEY,
	    open_date DATE,
	    account_balance INT,
	    account_type TINYINT
	);
2023-01-06 12:18:53.443 GMT [18451] LOG:  received fast shutdown request
2023-01-06 12:18:53.445 GMT [18451] LOG:  aborting any active transactions
2023-01-06 12:18:53.448 GMT [18451] LOG:  background worker "logical replication launcher" (PID 18463) exited with exit code 1
2023-01-06 12:18:53.451 GMT [18458] LOG:  shutting down
2023-01-06 12:18:53.483 GMT [18451] LOG:  database system is shut down
2023-01-06 12:18:55.264 GMT [18976] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 12:18:55.264 GMT [18976] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 12:18:55.265 GMT [18976] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 12:18:55.272 GMT [18981] LOG:  database system was shut down at 2023-01-06 12:18:54 GMT
2023-01-06 12:18:55.312 GMT [18976] LOG:  database system is ready to accept connections
2023-01-06 12:18:55.818 GMT [19017] ERROR:  multiple primary keys for table "customer_account" are not allowed at character 129
2023-01-06 12:18:55.818 GMT [19017] STATEMENT:  CREATE TABLE IF NOT EXISTS customer_account (
	    customer_id SERIAL PRIMARY KEY REFERENCES customer(id),
	    account_id SERIAL PRIMARY KEY REFERENCES account(id)
	);
2023-01-06 17:17:26.469 GMT [18976] LOG:  received fast shutdown request
2023-01-06 17:17:26.472 GMT [18976] LOG:  aborting any active transactions
2023-01-06 17:17:26.482 GMT [18976] LOG:  background worker "logical replication launcher" (PID 18990) exited with exit code 1
2023-01-06 17:17:26.483 GMT [18985] LOG:  shutting down
2023-01-06 17:17:26.520 GMT [18976] LOG:  database system is shut down
2023-01-06 17:17:35.900 GMT [68045] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 17:17:35.900 GMT [68045] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 17:17:35.903 GMT [68045] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 17:17:35.908 GMT [68046] LOG:  database system was shut down at 2023-01-06 17:17:35 GMT
2023-01-06 17:17:35.917 GMT [68045] LOG:  database system is ready to accept connections
2023-01-06 17:17:36.593 GMT [68074] ERROR:  syntax error at or near "." at character 153
2023-01-06 17:17:36.593 GMT [68074] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage INT,
	    overdraft_limit INT,
	    interest_rate NUMERIC(5,2).
	    debit_account_id INT REFERENCES debit_account(id)
	);
2023-01-06 17:17:36.594 GMT [68074] ERROR:  syntax error at or near "dest_account_id" at character 99
2023-01-06 17:17:36.594 GMT [68074] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT
	    dest_account_id INT,
	    amount INT,
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-06 17:17:36.610 GMT [68074] ERROR:  syntax error at or near "CREATE" at character 146
2023-01-06 17:17:36.610 GMT [68074] STATEMENT:  CREATE TABLE IF NOT EXISTS external_account (
	    account_id SERIAL PRIMARY KEY REFERENCES online_account(id),
	    external_account_number INT
	)
	CREATE TABLE IF NOT EXISTS authentication_log (
	    id SERIAL PRIMARY KEY,
	    log_description VARCHAR,
	    log_date DATE
	)
	CREATE TABLE IF NOT EXISTS management_log (
	    id SERIAL PRIMARY KEY,
	    log_description VARCHAR,
	    log_date DATE
	)
	CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-06 17:21:56.120 GMT [68045] LOG:  received fast shutdown request
2023-01-06 17:21:56.123 GMT [68045] LOG:  aborting any active transactions
2023-01-06 17:21:56.127 GMT [68045] LOG:  background worker "logical replication launcher" (PID 68052) exited with exit code 1
2023-01-06 17:21:56.131 GMT [68047] LOG:  shutting down
2023-01-06 17:21:56.173 GMT [68045] LOG:  database system is shut down
2023-01-06 17:21:58.772 GMT [68928] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 17:21:58.772 GMT [68928] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 17:21:58.773 GMT [68928] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 17:21:58.777 GMT [68930] LOG:  database system was shut down at 2023-01-06 17:21:58 GMT
2023-01-06 17:21:58.783 GMT [68928] LOG:  database system is ready to accept connections
2023-01-06 17:21:59.525 GMT [68955] ERROR:  syntax error at or near "dest_account_id" at character 99
2023-01-06 17:21:59.525 GMT [68955] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT
	    dest_account_id INT,
	    amount INT,
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-06 17:22:21.626 GMT [68928] LOG:  received fast shutdown request
2023-01-06 17:22:21.628 GMT [68928] LOG:  aborting any active transactions
2023-01-06 17:22:21.631 GMT [68928] LOG:  background worker "logical replication launcher" (PID 68936) exited with exit code 1
2023-01-06 17:22:21.635 GMT [68931] LOG:  shutting down
2023-01-06 17:22:21.674 GMT [68928] LOG:  database system is shut down
2023-01-06 17:22:23.745 GMT [69114] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 17:22:23.745 GMT [69114] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 17:22:23.749 GMT [69114] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 17:22:23.755 GMT [69115] LOG:  database system was shut down at 2023-01-06 17:22:23 GMT
2023-01-06 17:22:23.761 GMT [69114] LOG:  database system is ready to accept connections
2023-01-06 17:23:04.638 GMT [69114] LOG:  received fast shutdown request
2023-01-06 17:23:04.640 GMT [69114] LOG:  aborting any active transactions
2023-01-06 17:23:04.644 GMT [69114] LOG:  background worker "logical replication launcher" (PID 69121) exited with exit code 1
2023-01-06 17:23:04.646 GMT [69116] LOG:  shutting down
2023-01-06 17:23:04.686 GMT [69114] LOG:  database system is shut down
2023-01-06 17:23:06.413 GMT [69355] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-06 17:23:06.414 GMT [69355] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-06 17:23:06.415 GMT [69355] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-06 17:23:06.419 GMT [69356] LOG:  database system was shut down at 2023-01-06 17:23:06 GMT
2023-01-06 17:23:06.426 GMT [69355] LOG:  database system is ready to accept connections
2023-01-06 17:23:07.191 GMT [69381] ERROR:  syntax error at or near "CREATE" at character 51
2023-01-06 17:23:07.191 GMT [69381] STATEMENT:  CREATE ROLE manager WITH LOGIN PASSWORD 'manager' CREATE ROLE;
2023-01-06 17:23:25.479 GMT [69355] LOG:  received fast shutdown request
2023-01-06 17:23:25.482 GMT [69355] LOG:  aborting any active transactions
2023-01-06 17:23:25.488 GMT [69355] LOG:  background worker "logical replication launcher" (PID 69362) exited with exit code 1
2023-01-06 17:23:25.489 GMT [69357] LOG:  shutting down
2023-01-06 17:23:25.536 GMT [69355] LOG:  database system is shut down
2023-01-09 07:07:37.036 GMT [7448] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:07:37.039 GMT [7448] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:07:37.040 GMT [7448] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:07:37.043 GMT [7456] LOG:  database system was shut down at 2023-01-09 07:07:36 GMT
2023-01-09 07:07:37.048 GMT [7448] LOG:  database system is ready to accept connections
2023-01-09 07:07:37.689 GMT [7484] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:07:37.689 GMT [7484] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:07:37.690 GMT [7484] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:07:37.690 GMT [7484] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:07:37.694 GMT [7484] ERROR:  column "id" specified more than once
2023-01-09 07:07:37.694 GMT [7484] STATEMENT:  CREATE OR REPLACE VIEW view_personal_information AS
	SELECT * FROM customer
	LEFT JOIN view_online_account_details ON customer.id = view_online_account_details.customer_id;
2023-01-09 07:07:37.697 GMT [7484] ERROR:  column credit_account.credit_limit does not exist at character 109
2023-01-09 07:07:37.697 GMT [7484] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:11:09.336 GMT [7448] LOG:  received fast shutdown request
2023-01-09 07:11:09.337 GMT [7448] LOG:  aborting any active transactions
2023-01-09 07:11:09.341 GMT [7448] LOG:  background worker "logical replication launcher" (PID 7462) exited with exit code 1
2023-01-09 07:11:09.341 GMT [7457] LOG:  shutting down
2023-01-09 07:11:09.397 GMT [7448] LOG:  database system is shut down
2023-01-09 07:11:11.553 GMT [8251] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:11:11.554 GMT [8251] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:11:11.555 GMT [8251] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:11:11.561 GMT [8252] LOG:  database system was shut down at 2023-01-09 07:11:11 GMT
2023-01-09 07:11:11.567 GMT [8251] LOG:  database system is ready to accept connections
2023-01-09 07:11:12.289 GMT [8280] ERROR:  relation "user_login" does not exist at character 75
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_login AS
	SELECT id, account_id, username
	FROM user_login
	WHERE username = current_user;
2023-01-09 07:11:12.289 GMT [8280] ERROR:  relation "user_login" does not exist at character 92
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_login_secret AS
	SELECT id, account_id, username, password
	FROM user_login
	WHERE username = current_user;
2023-01-09 07:11:12.289 GMT [8280] ERROR:  relation "user_login_security_question" does not exist at character 151
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:11:12.289 GMT [8280] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:11:12.289 GMT [8280] ERROR:  relation "online_account" does not exist at character 171
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_online_account_details AS
	SELECT online_account.id, online_account.date_opened, online_account.sort_code, online_account.customer_id
	    FROM online_account
	INNER JOIN view_login ON online_account.id = view_login.id;
2023-01-09 07:11:12.289 GMT [8280] ERROR:  relation "customer" does not exist at character 170
2023-01-09 07:11:12.289 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_personal_information AS
	SELECT customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.phone_number FROM customer
	LEFT JOIN view_online_account_details ON customer.id = view_online_account_details.customer_id;
2023-01-09 07:11:12.290 GMT [8280] ERROR:  relation "loan" does not exist at character 112
2023-01-09 07:11:12.290 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN view_online_account_details ON loan.account_id = view_online_account_details.id;
2023-01-09 07:11:12.290 GMT [8280] ERROR:  relation "savings_account" does not exist at character 143
2023-01-09 07:11:12.290 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_savings_account AS
	SELECT savings_account.id, savings_account.current_balance, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN view_online_account_details ON savings_account.account_id = view_online_account_details.id;
2023-01-09 07:11:12.290 GMT [8280] ERROR:  relation "credit_account" does not exist at character 172
2023-01-09 07:11:12.290 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:11:12.290 GMT [8280] ERROR:  relation "debit_account" does not exist at character 136
2023-01-09 07:11:12.290 GMT [8280] STATEMENT:  CREATE OR REPLACE VIEW view_debit_accounts AS
	SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate
	FROM debit_account
	LEFT JOIN view_online_account_details ON debit_account.account_id = view_online_account_details.id;
2023-01-09 07:11:36.488 GMT [8251] LOG:  received fast shutdown request
2023-01-09 07:11:36.490 GMT [8251] LOG:  aborting any active transactions
2023-01-09 07:11:36.493 GMT [8251] LOG:  background worker "logical replication launcher" (PID 8258) exited with exit code 1
2023-01-09 07:11:36.497 GMT [8253] LOG:  shutting down
2023-01-09 07:11:36.553 GMT [8251] LOG:  database system is shut down
2023-01-09 07:11:38.506 GMT [8440] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:11:38.506 GMT [8440] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:11:38.509 GMT [8440] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:11:38.514 GMT [8441] LOG:  database system was shut down at 2023-01-09 07:11:38 GMT
2023-01-09 07:11:38.519 GMT [8440] LOG:  database system is ready to accept connections
2023-01-09 07:11:39.219 GMT [8469] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:11:39.219 GMT [8469] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:11:39.219 GMT [8469] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:11:39.219 GMT [8469] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:11:39.222 GMT [8469] ERROR:  column customer.address does not exist at character 125
2023-01-09 07:11:39.222 GMT [8469] STATEMENT:  CREATE OR REPLACE VIEW view_personal_information AS
	SELECT customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.phone_number FROM customer
	LEFT JOIN view_online_account_details ON customer.id = view_online_account_details.customer_id;
2023-01-09 07:11:39.227 GMT [8469] ERROR:  column credit_account.credit_limit does not exist at character 109
2023-01-09 07:11:39.227 GMT [8469] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:13:39.913 GMT [8440] LOG:  received fast shutdown request
2023-01-09 07:13:39.915 GMT [8440] LOG:  aborting any active transactions
2023-01-09 07:13:39.919 GMT [8440] LOG:  background worker "logical replication launcher" (PID 8447) exited with exit code 1
2023-01-09 07:13:39.919 GMT [8442] LOG:  shutting down
2023-01-09 07:13:39.953 GMT [8440] LOG:  database system is shut down
2023-01-09 07:13:41.762 GMT [8899] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:13:41.762 GMT [8899] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:13:41.764 GMT [8899] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:13:41.769 GMT [8900] LOG:  database system was shut down at 2023-01-09 07:13:41 GMT
2023-01-09 07:13:41.776 GMT [8899] LOG:  database system is ready to accept connections
2023-01-09 07:13:42.444 GMT [8942] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:13:42.444 GMT [8942] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:13:42.444 GMT [8942] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:13:42.444 GMT [8942] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:13:42.457 GMT [8942] ERROR:  column credit_account.credit_limit does not exist at character 109
2023-01-09 07:13:42.457 GMT [8942] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:14:19.139 GMT [8899] LOG:  received fast shutdown request
2023-01-09 07:14:19.141 GMT [8899] LOG:  aborting any active transactions
2023-01-09 07:14:19.147 GMT [8899] LOG:  background worker "logical replication launcher" (PID 8906) exited with exit code 1
2023-01-09 07:14:19.147 GMT [8901] LOG:  shutting down
2023-01-09 07:14:19.187 GMT [8899] LOG:  database system is shut down
2023-01-09 07:14:20.906 GMT [9155] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:14:20.907 GMT [9155] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:14:20.908 GMT [9155] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:14:20.914 GMT [9156] LOG:  database system was shut down at 2023-01-09 07:14:20 GMT
2023-01-09 07:14:20.921 GMT [9155] LOG:  database system is ready to accept connections
2023-01-09 07:14:21.637 GMT [9181] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:14:21.637 GMT [9181] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:14:21.637 GMT [9181] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:14:21.637 GMT [9181] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:17:06.364 GMT [9155] LOG:  received fast shutdown request
2023-01-09 07:17:06.367 GMT [9155] LOG:  aborting any active transactions
2023-01-09 07:17:06.369 GMT [9155] LOG:  background worker "logical replication launcher" (PID 9162) exited with exit code 1
2023-01-09 07:17:06.375 GMT [9157] LOG:  shutting down
2023-01-09 07:17:06.413 GMT [9155] LOG:  database system is shut down
2023-01-09 07:17:08.045 GMT [9745] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:17:08.045 GMT [9745] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:17:08.052 GMT [9745] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:17:08.057 GMT [9746] LOG:  database system was shut down at 2023-01-09 07:17:07 GMT
2023-01-09 07:17:08.062 GMT [9745] LOG:  database system is ready to accept connections
2023-01-09 07:17:08.700 GMT [9783] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:17:08.700 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:17:08.700 GMT [9783] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:17:08.700 GMT [9783] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:17:08.701 GMT [9783] ERROR:  relation "view_login" does not exist at character 197
2023-01-09 07:17:08.701 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_online_account_details AS
	SELECT online_account.id, online_account.date_opened, online_account.sort_code, online_account.customer_id
	    FROM online_account
	INNER JOIN view_login ON online_account.id = view_login.id;
2023-01-09 07:17:08.701 GMT [9783] ERROR:  relation "view_online_account_details" does not exist at character 95
2023-01-09 07:17:08.701 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_personal_information AS
	SELECT customer.* FROM customer
	LEFT JOIN view_online_account_details ON customer.id = view_online_account_details.customer_id;
2023-01-09 07:17:08.701 GMT [9783] ERROR:  relation "view_online_account_details" does not exist at character 127
2023-01-09 07:17:08.701 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN view_online_account_details ON loan.account_id = view_online_account_details.id;
2023-01-09 07:17:08.701 GMT [9783] ERROR:  relation "view_online_account_details" does not exist at character 169
2023-01-09 07:17:08.701 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_savings_account AS
	SELECT savings_account.id, savings_account.current_balance, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN view_online_account_details ON savings_account.account_id = view_online_account_details.id;
2023-01-09 07:17:08.701 GMT [9783] ERROR:  relation "view_online_account_details" does not exist at character 197
2023-01-09 07:17:08.701 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:17:08.702 GMT [9783] ERROR:  relation "view_online_account_details" does not exist at character 160
2023-01-09 07:17:08.702 GMT [9783] STATEMENT:  CREATE OR REPLACE VIEW view_debit_accounts AS
	SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate
	FROM debit_account
	LEFT JOIN view_online_account_details ON debit_account.account_id = view_online_account_details.id;
2023-01-09 07:18:03.780 GMT [9745] LOG:  received fast shutdown request
2023-01-09 07:18:03.782 GMT [9745] LOG:  aborting any active transactions
2023-01-09 07:18:03.786 GMT [9745] LOG:  background worker "logical replication launcher" (PID 9752) exited with exit code 1
2023-01-09 07:18:03.788 GMT [9747] LOG:  shutting down
2023-01-09 07:18:03.825 GMT [9745] LOG:  database system is shut down
2023-01-09 07:18:05.661 GMT [10041] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:18:05.661 GMT [10041] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:18:05.663 GMT [10041] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:18:05.667 GMT [10042] LOG:  database system was shut down at 2023-01-09 07:18:05 GMT
2023-01-09 07:18:05.675 GMT [10041] LOG:  database system is ready to accept connections
2023-01-09 07:18:06.310 GMT [10082] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:18:06.310 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:18:06.310 GMT [10082] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:18:06.310 GMT [10082] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:18:06.311 GMT [10082] ERROR:  relation "view_login" does not exist at character 197
2023-01-09 07:18:06.311 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_online_account_details AS
	SELECT online_account.id, online_account.date_opened, online_account.sort_code, online_account.customer_id
	    FROM online_account
	INNER JOIN view_login ON online_account.id = view_login.id;
2023-01-09 07:18:06.311 GMT [10082] ERROR:  relation "view_online_account_details" does not exist at character 95
2023-01-09 07:18:06.311 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_personal_information AS
	SELECT customer.* FROM customer
	LEFT JOIN view_online_account_details ON customer.id = view_online_account_details.customer_id;
2023-01-09 07:18:06.312 GMT [10082] ERROR:  relation "view_online_account_details" does not exist at character 127
2023-01-09 07:18:06.312 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN view_online_account_details ON loan.account_id = view_online_account_details.id;
2023-01-09 07:18:06.312 GMT [10082] ERROR:  relation "view_online_account_details" does not exist at character 169
2023-01-09 07:18:06.312 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_savings_account AS
	SELECT savings_account.id, savings_account.current_balance, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN view_online_account_details ON savings_account.account_id = view_online_account_details.id;
2023-01-09 07:18:06.312 GMT [10082] ERROR:  relation "view_online_account_details" does not exist at character 197
2023-01-09 07:18:06.312 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_credit_acounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN view_online_account_details ON credit_account.account_id = view_online_account_details.id;
2023-01-09 07:18:06.312 GMT [10082] ERROR:  relation "view_online_account_details" does not exist at character 160
2023-01-09 07:18:06.312 GMT [10082] STATEMENT:  CREATE OR REPLACE VIEW view_debit_accounts AS
	SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate
	FROM debit_account
	LEFT JOIN view_online_account_details ON debit_account.account_id = view_online_account_details.id;
2023-01-09 07:18:48.554 GMT [10041] LOG:  received fast shutdown request
2023-01-09 07:18:48.556 GMT [10041] LOG:  aborting any active transactions
2023-01-09 07:18:48.560 GMT [10041] LOG:  background worker "logical replication launcher" (PID 10048) exited with exit code 1
2023-01-09 07:18:48.563 GMT [10043] LOG:  shutting down
2023-01-09 07:18:48.596 GMT [10041] LOG:  database system is shut down
2023-01-09 07:18:50.286 GMT [10296] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:18:50.286 GMT [10296] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:18:50.288 GMT [10296] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:18:50.293 GMT [10297] LOG:  database system was shut down at 2023-01-09 07:18:50 GMT
2023-01-09 07:18:50.298 GMT [10296] LOG:  database system is ready to accept connections
2023-01-09 07:18:50.987 GMT [10336] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 105
2023-01-09 07:18:50.987 GMT [10336] STATEMENT:  CREATE OR REPLACE VIEW view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:18:50.988 GMT [10336] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:18:50.988 GMT [10336] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:45:38.623 GMT [10296] LOG:  received fast shutdown request
2023-01-09 07:45:38.625 GMT [10296] LOG:  aborting any active transactions
2023-01-09 07:45:38.630 GMT [10296] LOG:  background worker "logical replication launcher" (PID 10303) exited with exit code 1
2023-01-09 07:45:38.630 GMT [10298] LOG:  shutting down
2023-01-09 07:45:38.649 GMT [10296] LOG:  database system is shut down
2023-01-09 07:45:48.630 GMT [15383] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:45:48.630 GMT [15383] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:45:48.632 GMT [15383] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:45:48.638 GMT [15384] LOG:  database system was shut down at 2023-01-09 07:45:48 GMT
2023-01-09 07:45:48.645 GMT [15383] LOG:  database system is ready to accept connections
2023-01-09 07:45:49.366 GMT [15419] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 07:45:49.366 GMT [15419] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:45:49.366 GMT [15419] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:45:49.366 GMT [15419] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:45:49.380 GMT [15419] ERROR:  column savings_statement.account_id does not exist at character 334
2023-01-09 07:45:49.380 GMT [15419] STATEMENT:  CREATE OR REPLACE VIEW client.view_savings_account_statements AS
	SELECT savings_account_statement.id, savings_account_statement.starting_date, savings_account_statement.end_date, savings_account_statement.amount, savings_account_statement.account_id
	FROM view_savings_account
	LEFT JOIN savings_statement ON view_savings_account.id = savings_statement.account_id;
2023-01-09 07:45:49.380 GMT [15419] ERROR:  relation "view_savings_account_statements" does not exist at character 200
2023-01-09 07:45:49.380 GMT [15419] STATEMENT:  CREATE OR REPLACE VIEW client.view_savings_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.savings_statement_id
	FROM view_savings_account_statements
	LEFT JOIN transaction ON view_savings_account_statements.id = transaction.savings_statement_id;
2023-01-09 07:45:49.384 GMT [15419] ERROR:  syntax error at or near "ROLE" at character 38
2023-01-09 07:45:49.384 GMT [15419] STATEMENT:  CREATE OR REPLACE VIEW staff.
	CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-09 07:50:28.084 GMT [15383] LOG:  received fast shutdown request
2023-01-09 07:50:28.085 GMT [15383] LOG:  aborting any active transactions
2023-01-09 07:50:28.092 GMT [15383] LOG:  background worker "logical replication launcher" (PID 15390) exited with exit code 1
2023-01-09 07:50:28.093 GMT [15385] LOG:  shutting down
2023-01-09 07:50:28.134 GMT [15383] LOG:  database system is shut down
2023-01-09 07:50:30.044 GMT [16350] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:50:30.045 GMT [16350] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:50:30.046 GMT [16350] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:50:30.052 GMT [16351] LOG:  database system was shut down at 2023-01-09 07:50:29 GMT
2023-01-09 07:50:30.059 GMT [16350] LOG:  database system is ready to accept connections
2023-01-09 07:50:30.810 GMT [16379] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 07:50:30.810 GMT [16379] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:50:30.810 GMT [16379] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:50:30.810 GMT [16379] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:50:30.824 GMT [16379] ERROR:  missing FROM-clause entry for table "savings_account_statement" at character 73
2023-01-09 07:50:30.824 GMT [16379] STATEMENT:  CREATE OR REPLACE VIEW client.view_savings_account_statements AS
	SELECT savings_account_statement.id, savings_account_statement.starting_date, savings_account_statement.end_date, savings_account_statement.amount, savings_account_statement.account_id
	FROM view_savings_account
	LEFT JOIN savings_statement ON view_savings_account.id = savings_statement.account_id;
2023-01-09 07:50:30.825 GMT [16379] ERROR:  relation "view_savings_account_statements" does not exist at character 200
2023-01-09 07:50:30.825 GMT [16379] STATEMENT:  CREATE OR REPLACE VIEW client.view_savings_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.savings_statement_id
	FROM view_savings_account_statements
	LEFT JOIN transaction ON view_savings_account_statements.id = transaction.savings_statement_id;
2023-01-09 07:50:30.830 GMT [16379] ERROR:  syntax error at or near "ROLE" at character 38
2023-01-09 07:50:30.830 GMT [16379] STATEMENT:  CREATE OR REPLACE VIEW staff.
	CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-09 07:51:32.431 GMT [16350] LOG:  received fast shutdown request
2023-01-09 07:51:32.433 GMT [16350] LOG:  aborting any active transactions
2023-01-09 07:51:32.438 GMT [16350] LOG:  background worker "logical replication launcher" (PID 16357) exited with exit code 1
2023-01-09 07:51:32.439 GMT [16352] LOG:  shutting down
2023-01-09 07:51:32.482 GMT [16350] LOG:  database system is shut down
2023-01-09 07:51:34.443 GMT [16682] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:51:34.444 GMT [16682] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:51:34.446 GMT [16682] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:51:34.451 GMT [16683] LOG:  database system was shut down at 2023-01-09 07:51:34 GMT
2023-01-09 07:51:34.458 GMT [16682] LOG:  database system is ready to accept connections
2023-01-09 07:51:35.204 GMT [16708] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 07:51:35.204 GMT [16708] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:51:35.204 GMT [16708] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:51:35.204 GMT [16708] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 07:51:35.229 GMT [16708] ERROR:  syntax error at or near "ROLE" at character 38
2023-01-09 07:51:35.229 GMT [16708] STATEMENT:  CREATE OR REPLACE VIEW staff.
	CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-09 07:51:59.931 GMT [16682] LOG:  received fast shutdown request
2023-01-09 07:51:59.932 GMT [16682] LOG:  aborting any active transactions
2023-01-09 07:51:59.937 GMT [16682] LOG:  background worker "logical replication launcher" (PID 16689) exited with exit code 1
2023-01-09 07:51:59.938 GMT [16684] LOG:  shutting down
2023-01-09 07:51:59.978 GMT [16682] LOG:  database system is shut down
2023-01-09 07:52:01.902 GMT [16878] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 07:52:01.902 GMT [16878] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 07:52:01.904 GMT [16878] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 07:52:01.910 GMT [16879] LOG:  database system was shut down at 2023-01-09 07:52:01 GMT
2023-01-09 07:52:01.916 GMT [16878] LOG:  database system is ready to accept connections
2023-01-09 07:52:02.651 GMT [16904] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 07:52:02.651 GMT [16904] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 07:52:02.651 GMT [16904] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 07:52:02.651 GMT [16904] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:06:07.068 GMT [16878] LOG:  received fast shutdown request
2023-01-09 08:06:07.070 GMT [16878] LOG:  aborting any active transactions
2023-01-09 08:06:07.074 GMT [16878] LOG:  background worker "logical replication launcher" (PID 16885) exited with exit code 1
2023-01-09 08:06:07.074 GMT [16880] LOG:  shutting down
2023-01-09 08:06:07.090 GMT [16878] LOG:  database system is shut down
2023-01-09 08:06:09.032 GMT [19763] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:06:09.032 GMT [19763] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:06:09.058 GMT [19763] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:06:09.074 GMT [19764] LOG:  database system was shut down at 2023-01-09 08:06:08 GMT
2023-01-09 08:06:09.082 GMT [19763] LOG:  database system is ready to accept connections
2023-01-09 08:06:09.810 GMT [19797] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:06:09.810 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:06:09.810 GMT [19797] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:06:09.810 GMT [19797] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:06:09.840 GMT [19797] ERROR:  relation "view_credit_accounts" does not exist at character 164
2023-01-09 08:06:09.840 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_applications AS
	SELECT credit_account_application.application_status, credit_account_application.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_account_application ON view_credit_accounts.id = credit_account_application.loan_id;
2023-01-09 08:06:09.841 GMT [19797] ERROR:  relation "view_credit_accounts" does not exist at character 287
2023-01-09 08:06:09.841 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_statement ON view_credit_account.id = credit_statement.account_id;
2023-01-09 08:06:09.841 GMT [19797] ERROR:  relation "view_credit_account_statements" does not exist at character 204
2023-01-09 08:06:09.841 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_credit_account_statements
	RIGHT JOIN transaction ON view_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 08:06:09.843 GMT [19797] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:06:09.843 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:06:09.843 GMT [19797] ERROR:  relation "view_debit_account_statements" does not exist at character 200
2023-01-09 08:06:09.843 GMT [19797] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:07:22.943 GMT [19763] LOG:  received fast shutdown request
2023-01-09 08:07:22.945 GMT [19763] LOG:  aborting any active transactions
2023-01-09 08:07:22.947 GMT [19763] LOG:  background worker "logical replication launcher" (PID 19770) exited with exit code 1
2023-01-09 08:07:22.951 GMT [19765] LOG:  shutting down
2023-01-09 08:07:23.001 GMT [19763] LOG:  database system is shut down
2023-01-09 08:07:24.837 GMT [20149] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:07:24.838 GMT [20149] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:07:24.840 GMT [20149] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:07:24.845 GMT [20150] LOG:  database system was shut down at 2023-01-09 08:07:24 GMT
2023-01-09 08:07:24.852 GMT [20149] LOG:  database system is ready to accept connections
2023-01-09 08:07:25.611 GMT [20175] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:07:25.611 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:07:25.611 GMT [20175] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:07:25.611 GMT [20175] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:07:25.634 GMT [20175] ERROR:  column credit_account_application.loan_id does not exist at character 252
2023-01-09 08:07:25.634 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_applications AS
	SELECT credit_account_application.application_status, credit_account_application.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_account_application ON view_credit_accounts.id = credit_account_application.loan_id;
2023-01-09 08:07:25.634 GMT [20175] ERROR:  missing FROM-clause entry for table "view_credit_account" at character 339
2023-01-09 08:07:25.634 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_statement ON view_credit_account.id = credit_statement.account_id;
2023-01-09 08:07:25.635 GMT [20175] ERROR:  relation "view_credit_account_statements" does not exist at character 204
2023-01-09 08:07:25.635 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_credit_account_statements
	RIGHT JOIN transaction ON view_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 08:07:25.637 GMT [20175] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:07:25.637 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:07:25.637 GMT [20175] ERROR:  relation "view_debit_account_statements" does not exist at character 200
2023-01-09 08:07:25.637 GMT [20175] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:07:50.521 GMT [20303] ERROR:  cannot drop table customer because other objects depend on it
2023-01-09 08:07:50.521 GMT [20303] DETAIL:  constraint online_account_customer_id_fkey on table online_account depends on table customer
	view client.view_personal_information depends on table customer
2023-01-09 08:07:50.521 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.521 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS customer;
2023-01-09 08:07:50.523 GMT [20303] ERROR:  cannot drop table online_account because other objects depend on it
2023-01-09 08:07:50.523 GMT [20303] DETAIL:  constraint user_login_account_id_fkey on table user_login depends on table online_account
	constraint savings_account_account_id_fkey on table savings_account depends on table online_account
	constraint credit_account_account_id_fkey on table credit_account depends on table online_account
	constraint debit_account_account_id_fkey on table debit_account depends on table online_account
	constraint loan_account_id_fkey on table loan depends on table online_account
	constraint external_account_account_id_fkey on table external_account depends on table online_account
	view client.view_online_account_details depends on table online_account
	view client.view_personal_information depends on view client.view_online_account_details
	view client.view_loans depends on view client.view_online_account_details
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
	view client.view_savings_account depends on view client.view_online_account_details
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
	view client.view_credit_accounts depends on view client.view_online_account_details
	view client.view_debit_accounts depends on view client.view_online_account_details
2023-01-09 08:07:50.523 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.523 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS online_account;
2023-01-09 08:07:50.526 GMT [20303] ERROR:  cannot drop table user_login because other objects depend on it
2023-01-09 08:07:50.526 GMT [20303] DETAIL:  constraint user_login_security_question_login_id_fkey on table user_login_security_question depends on table user_login
	view client.view_login depends on table user_login
	view client.view_online_account_details depends on view client.view_login
	view client.view_personal_information depends on view client.view_online_account_details
	view client.view_loans depends on view client.view_online_account_details
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
	view client.view_savings_account depends on view client.view_online_account_details
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
	view client.view_credit_accounts depends on view client.view_online_account_details
	view client.view_debit_accounts depends on view client.view_online_account_details
	view client.view_login_secret depends on table user_login
2023-01-09 08:07:50.526 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.526 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS user_login;
2023-01-09 08:07:50.527 GMT [20303] ERROR:  cannot drop table user_login_security_question because other objects depend on it
2023-01-09 08:07:50.527 GMT [20303] DETAIL:  constraint security_question_answer_question_id_fkey on table security_question_answer depends on table user_login_security_question
2023-01-09 08:07:50.527 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.527 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS user_login_security_question;
2023-01-09 08:07:50.528 GMT [20303] ERROR:  cannot drop table security_question_option because other objects depend on it
2023-01-09 08:07:50.528 GMT [20303] DETAIL:  constraint user_login_security_question_question_choice_id_fkey on table user_login_security_question depends on table security_question_option
2023-01-09 08:07:50.528 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.528 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS security_question_option;
2023-01-09 08:07:50.531 GMT [20303] ERROR:  cannot drop table savings_account because other objects depend on it
2023-01-09 08:07:50.531 GMT [20303] DETAIL:  constraint savings_statement_account_id_fkey on table savings_statement depends on table savings_account
	view client.view_savings_account depends on table savings_account
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
2023-01-09 08:07:50.531 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.531 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS savings_account;
2023-01-09 08:07:50.532 GMT [20303] ERROR:  cannot drop table credit_account because other objects depend on it
2023-01-09 08:07:50.532 GMT [20303] DETAIL:  constraint credit_account_application_account_id_fkey on table credit_account_application depends on table credit_account
	constraint credit_statement_account_id_fkey on table credit_statement depends on table credit_account
	view client.view_credit_accounts depends on table credit_account
2023-01-09 08:07:50.532 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.532 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS credit_account;
2023-01-09 08:07:50.533 GMT [20303] ERROR:  cannot drop table debit_account because other objects depend on it
2023-01-09 08:07:50.533 GMT [20303] DETAIL:  constraint debit_statement_account_id_fkey on table debit_statement depends on table debit_account
	constraint debit_overdraft_account_id_fkey on table debit_overdraft depends on table debit_account
	view client.view_debit_accounts depends on table debit_account
2023-01-09 08:07:50.533 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.533 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS debit_account;
2023-01-09 08:07:50.534 GMT [20303] ERROR:  cannot drop table loan because other objects depend on it
2023-01-09 08:07:50.534 GMT [20303] DETAIL:  constraint loan_application_loan_id_fkey on table loan_application depends on table loan
	constraint loan_statement_loan_id_fkey on table loan_statement depends on table loan
	view client.view_loans depends on table loan
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
2023-01-09 08:07:50.534 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.534 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS loan;
2023-01-09 08:07:50.535 GMT [20303] ERROR:  cannot drop table savings_statement because other objects depend on it
2023-01-09 08:07:50.535 GMT [20303] DETAIL:  constraint transaction_savings_statement_id_fkey on table transaction depends on table savings_statement
	view client.view_savings_account_statements depends on table savings_statement
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
2023-01-09 08:07:50.535 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.535 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS savings_statement;
2023-01-09 08:07:50.538 GMT [20303] ERROR:  cannot drop table credit_statement because other objects depend on it
2023-01-09 08:07:50.538 GMT [20303] DETAIL:  constraint transaction_credit_statement_id_fkey on table transaction depends on table credit_statement
2023-01-09 08:07:50.538 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.538 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS credit_statement;
2023-01-09 08:07:50.539 GMT [20303] ERROR:  cannot drop table debit_statement because other objects depend on it
2023-01-09 08:07:50.539 GMT [20303] DETAIL:  constraint transaction_debit_statement_id_fkey on table transaction depends on table debit_statement
2023-01-09 08:07:50.539 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.539 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS debit_statement;
2023-01-09 08:07:50.545 GMT [20303] ERROR:  cannot drop table transaction because other objects depend on it
2023-01-09 08:07:50.545 GMT [20303] DETAIL:  view client.view_savings_account_statement depends on table transaction
2023-01-09 08:07:50.545 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.545 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS transaction;
2023-01-09 08:07:50.546 GMT [20303] ERROR:  cannot drop table loan_application because other objects depend on it
2023-01-09 08:07:50.546 GMT [20303] DETAIL:  view client.view_loan_applications depends on table loan_application
2023-01-09 08:07:50.546 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.546 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS loan_application;
2023-01-09 08:07:50.547 GMT [20303] ERROR:  cannot drop table loan_statement because other objects depend on it
2023-01-09 08:07:50.547 GMT [20303] DETAIL:  view client.view_loan_statements depends on table loan_statement
2023-01-09 08:07:50.547 GMT [20303] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:07:50.547 GMT [20303] STATEMENT:  DROP TABLE IF EXISTS loan_statement;
2023-01-09 08:07:50.604 GMT [20303] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:07:50.604 GMT [20303] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:07:50.604 GMT [20303] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:07:50.604 GMT [20303] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:07:50.626 GMT [20303] ERROR:  missing FROM-clause entry for table "view_credit_account" at character 339
2023-01-09 08:07:50.626 GMT [20303] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_statement ON view_credit_account.id = credit_statement.account_id;
2023-01-09 08:07:50.626 GMT [20303] ERROR:  relation "view_credit_account_statements" does not exist at character 204
2023-01-09 08:07:50.626 GMT [20303] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_credit_account_statements
	RIGHT JOIN transaction ON view_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 08:07:50.628 GMT [20303] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:07:50.628 GMT [20303] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:07:50.628 GMT [20303] ERROR:  relation "view_debit_account_statements" does not exist at character 200
2023-01-09 08:07:50.628 GMT [20303] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "manager" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "employee1" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE employee1 WITH LOGIN PASSWORD 'employee1';
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "employee2" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE employee2 WITH LOGIN PASSWORD 'employee2';
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "employee3" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE employee3 WITH LOGIN PASSWORD 'employee3';
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "employee4" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE employee4 WITH LOGIN PASSWORD 'employee4';
2023-01-09 08:07:50.629 GMT [20303] ERROR:  role "employee5" already exists
2023-01-09 08:07:50.629 GMT [20303] STATEMENT:  CREATE ROLE employee5 WITH LOGIN PASSWORD 'employee5';
2023-01-09 08:07:52.287 GMT [20149] LOG:  received fast shutdown request
2023-01-09 08:07:52.288 GMT [20149] LOG:  aborting any active transactions
2023-01-09 08:07:52.293 GMT [20149] LOG:  background worker "logical replication launcher" (PID 20156) exited with exit code 1
2023-01-09 08:07:52.295 GMT [20151] LOG:  shutting down
2023-01-09 08:07:52.341 GMT [20149] LOG:  database system is shut down
2023-01-09 08:07:54.212 GMT [20394] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:07:54.213 GMT [20394] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:07:54.214 GMT [20394] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:07:54.219 GMT [20395] LOG:  database system was shut down at 2023-01-09 08:07:53 GMT
2023-01-09 08:07:54.228 GMT [20394] LOG:  database system is ready to accept connections
2023-01-09 08:07:54.950 GMT [20420] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:07:54.950 GMT [20420] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:07:54.950 GMT [20420] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:07:54.950 GMT [20420] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:07:54.972 GMT [20420] ERROR:  missing FROM-clause entry for table "view_credit_account" at character 339
2023-01-09 08:07:54.972 GMT [20420] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM view_credit_accounts
	RIGHT JOIN credit_statement ON view_credit_account.id = credit_statement.account_id;
2023-01-09 08:07:54.972 GMT [20420] ERROR:  relation "view_credit_account_statements" does not exist at character 204
2023-01-09 08:07:54.972 GMT [20420] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_credit_account_statements
	RIGHT JOIN transaction ON view_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 08:07:54.977 GMT [20420] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:07:54.977 GMT [20420] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:07:54.977 GMT [20420] ERROR:  relation "view_debit_account_statements" does not exist at character 200
2023-01-09 08:07:54.977 GMT [20420] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:08:17.840 GMT [20394] LOG:  received fast shutdown request
2023-01-09 08:08:17.843 GMT [20394] LOG:  aborting any active transactions
2023-01-09 08:08:17.847 GMT [20394] LOG:  background worker "logical replication launcher" (PID 20401) exited with exit code 1
2023-01-09 08:08:17.847 GMT [20396] LOG:  shutting down
2023-01-09 08:08:17.889 GMT [20394] LOG:  database system is shut down
2023-01-09 08:08:20.977 GMT [20603] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:08:20.978 GMT [20603] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:08:20.979 GMT [20603] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:08:20.990 GMT [20604] LOG:  database system was shut down at 2023-01-09 08:08:20 GMT
2023-01-09 08:08:20.996 GMT [20603] LOG:  database system is ready to accept connections
2023-01-09 08:08:21.701 GMT [20629] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:08:21.701 GMT [20629] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:08:21.701 GMT [20629] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:08:21.701 GMT [20629] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:08:21.736 GMT [20629] ERROR:  column transaction.credit_account_id does not exist at character 169
2023-01-09 08:08:21.736 GMT [20629] STATEMENT:  CREATE OR REPLACE VIEW client.view_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_credit_account_statements
	RIGHT JOIN transaction ON view_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 08:08:21.739 GMT [20629] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:08:21.739 GMT [20629] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:08:21.739 GMT [20629] ERROR:  relation "view_debit_account_statements" does not exist at character 200
2023-01-09 08:08:21.739 GMT [20629] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_account_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:17:39.816 GMT [20603] LOG:  received fast shutdown request
2023-01-09 08:17:39.818 GMT [20603] LOG:  aborting any active transactions
2023-01-09 08:17:39.820 GMT [20603] LOG:  background worker "logical replication launcher" (PID 20610) exited with exit code 1
2023-01-09 08:17:39.825 GMT [20605] LOG:  shutting down
2023-01-09 08:17:39.842 GMT [20603] LOG:  database system is shut down
2023-01-09 08:17:41.742 GMT [22315] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:17:41.742 GMT [22315] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:17:41.743 GMT [22315] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:17:41.748 GMT [22316] LOG:  database system was shut down at 2023-01-09 08:17:41 GMT
2023-01-09 08:17:41.754 GMT [22315] LOG:  database system is ready to accept connections
2023-01-09 08:17:42.505 GMT [22341] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:17:42.505 GMT [22341] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:17:42.506 GMT [22341] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:17:42.506 GMT [22341] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:17:42.530 GMT [22341] ERROR:  column debit_statement.minimum_payment does not exist at character 172
2023-01-09 08:17:42.530 GMT [22341] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.minimum_payment, debit_statement.minimum_payment_due_date, debit_statement.account_id
	FROM view_debit_accounts
	RIGHT JOIN debit_statement ON view_debit_accounts.id = debit_statement.account_id;
2023-01-09 08:17:42.531 GMT [22341] ERROR:  relation "view_debit_account_statements" does not exist at character 202
2023-01-09 08:17:42.531 GMT [22341] STATEMENT:  CREATE OR REPLACE VIEW client.view_debit_account_status AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_statement_id
	FROM view_debit_account_statements
	RIGHT JOIN transaction ON view_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 08:18:13.466 GMT [22315] LOG:  received fast shutdown request
2023-01-09 08:18:13.468 GMT [22315] LOG:  aborting any active transactions
2023-01-09 08:18:13.475 GMT [22315] LOG:  background worker "logical replication launcher" (PID 22322) exited with exit code 1
2023-01-09 08:18:13.475 GMT [22317] LOG:  shutting down
2023-01-09 08:18:13.520 GMT [22315] LOG:  database system is shut down
2023-01-09 08:18:15.582 GMT [22551] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:18:15.582 GMT [22551] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:18:15.584 GMT [22551] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:18:15.589 GMT [22552] LOG:  database system was shut down at 2023-01-09 08:18:15 GMT
2023-01-09 08:18:15.596 GMT [22551] LOG:  database system is ready to accept connections
2023-01-09 08:18:16.322 GMT [22577] ERROR:  missing FROM-clause entry for table "security_question_answer" at character 112
2023-01-09 08:18:16.322 GMT [22577] STATEMENT:  CREATE OR REPLACE VIEW client.view_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id;
2023-01-09 08:18:16.325 GMT [22577] ERROR:  syntax error at or near "INNER" at character 1
2023-01-09 08:18:16.325 GMT [22577] STATEMENT:  INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id;
2023-01-09 08:23:41.357 GMT [22551] LOG:  received fast shutdown request
2023-01-09 08:23:41.359 GMT [22551] LOG:  aborting any active transactions
2023-01-09 08:23:41.363 GMT [22551] LOG:  background worker "logical replication launcher" (PID 22558) exited with exit code 1
2023-01-09 08:23:41.364 GMT [22553] LOG:  shutting down
2023-01-09 08:23:41.378 GMT [22551] LOG:  database system is shut down
2023-01-09 08:23:43.243 GMT [23617] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:23:43.243 GMT [23617] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:23:43.244 GMT [23617] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:23:43.251 GMT [23618] LOG:  database system was shut down at 2023-01-09 08:23:42 GMT
2023-01-09 08:23:43.258 GMT [23617] LOG:  database system is ready to accept connections
2023-01-09 08:27:57.901 GMT [23617] LOG:  received fast shutdown request
2023-01-09 08:27:57.902 GMT [23617] LOG:  aborting any active transactions
2023-01-09 08:27:57.907 GMT [23617] LOG:  background worker "logical replication launcher" (PID 23625) exited with exit code 1
2023-01-09 08:27:57.908 GMT [23620] LOG:  shutting down
2023-01-09 08:27:57.945 GMT [23617] LOG:  database system is shut down
2023-01-09 08:28:01.126 GMT [24503] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:28:01.127 GMT [24503] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:28:01.128 GMT [24503] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:28:01.135 GMT [24504] LOG:  database system was shut down at 2023-01-09 08:28:00 GMT
2023-01-09 08:28:01.139 GMT [24503] LOG:  database system is ready to accept connections
2023-01-09 08:36:05.681 GMT [24503] LOG:  received fast shutdown request
2023-01-09 08:36:05.682 GMT [24503] LOG:  aborting any active transactions
2023-01-09 08:36:05.687 GMT [24503] LOG:  background worker "logical replication launcher" (PID 24510) exited with exit code 1
2023-01-09 08:36:05.687 GMT [24505] LOG:  shutting down
2023-01-09 08:36:05.699 GMT [24503] LOG:  database system is shut down
2023-01-09 08:36:07.887 GMT [26062] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:36:07.888 GMT [26062] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:36:07.889 GMT [26062] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:36:07.900 GMT [26063] LOG:  database system was shut down at 2023-01-09 08:36:07 GMT
2023-01-09 08:36:07.907 GMT [26062] LOG:  database system is ready to accept connections
2023-01-09 08:36:08.566 GMT [26106] ERROR:  relation "client.view_dedit_accounts" does not exist at character 13
2023-01-09 08:36:08.566 GMT [26106] STATEMENT:  INSERT INTO client.view_dedit_accounts VALUES (3000, 0.05);
2023-01-09 08:36:23.509 GMT [26062] LOG:  received fast shutdown request
2023-01-09 08:36:23.511 GMT [26062] LOG:  aborting any active transactions
2023-01-09 08:36:23.514 GMT [26062] LOG:  background worker "logical replication launcher" (PID 26070) exited with exit code 1
2023-01-09 08:36:23.518 GMT [26064] LOG:  shutting down
2023-01-09 08:36:23.555 GMT [26062] LOG:  database system is shut down
2023-01-09 08:36:25.512 GMT [26248] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:36:25.512 GMT [26248] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:36:25.514 GMT [26248] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:36:25.519 GMT [26249] LOG:  database system was shut down at 2023-01-09 08:36:25 GMT
2023-01-09 08:36:25.524 GMT [26248] LOG:  database system is ready to accept connections
2023-01-09 08:36:26.275 GMT [26288] ERROR:  cannot insert into view "view_debit_accounts"
2023-01-09 08:36:26.275 GMT [26288] DETAIL:  Views that do not select from a single table or view are not automatically updatable.
2023-01-09 08:36:26.275 GMT [26288] HINT:  To enable inserting into the view, provide an INSTEAD OF INSERT trigger or an unconditional ON INSERT DO INSTEAD rule.
2023-01-09 08:36:26.275 GMT [26288] STATEMENT:  INSERT INTO client.view_debit_accounts VALUES (3000, 0.05);
2023-01-09 08:40:55.904 GMT [26248] LOG:  received fast shutdown request
2023-01-09 08:40:55.906 GMT [26248] LOG:  aborting any active transactions
2023-01-09 08:40:55.911 GMT [26248] LOG:  background worker "logical replication launcher" (PID 26255) exited with exit code 1
2023-01-09 08:40:55.912 GMT [26250] LOG:  shutting down
2023-01-09 08:40:55.951 GMT [26248] LOG:  database system is shut down
2023-01-09 08:40:57.623 GMT [27115] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:40:57.624 GMT [27115] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:40:57.626 GMT [27115] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:40:57.630 GMT [27116] LOG:  database system was shut down at 2023-01-09 08:40:57 GMT
2023-01-09 08:40:57.636 GMT [27115] LOG:  database system is ready to accept connections
2023-01-09 08:40:58.344 GMT [27153] ERROR:  column "alfie" does not exist at character 45
2023-01-09 08:40:58.344 GMT [27153] STATEMENT:  INSERT INTO client.view_login VALUES (1, 1, "alfie");
2023-01-09 08:41:29.247 GMT [27115] LOG:  received fast shutdown request
2023-01-09 08:41:29.249 GMT [27115] LOG:  aborting any active transactions
2023-01-09 08:41:29.252 GMT [27115] LOG:  background worker "logical replication launcher" (PID 27122) exited with exit code 1
2023-01-09 08:41:29.253 GMT [27117] LOG:  shutting down
2023-01-09 08:41:29.300 GMT [27115] LOG:  database system is shut down
2023-01-09 08:41:31.928 GMT [27329] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:41:31.928 GMT [27329] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:41:31.929 GMT [27329] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:41:31.936 GMT [27330] LOG:  database system was shut down at 2023-01-09 08:41:31 GMT
2023-01-09 08:41:31.945 GMT [27329] LOG:  database system is ready to accept connections
2023-01-09 08:41:32.688 GMT [27367] ERROR:  column "alfie" does not exist at character 42
2023-01-09 08:41:32.688 GMT [27367] STATEMENT:  INSERT INTO client.view_login VALUES (1, "alfie", "alfie");
2023-01-09 08:43:46.541 GMT [27329] LOG:  received fast shutdown request
2023-01-09 08:43:46.542 GMT [27329] LOG:  aborting any active transactions
2023-01-09 08:43:46.546 GMT [27329] LOG:  background worker "logical replication launcher" (PID 27336) exited with exit code 1
2023-01-09 08:43:46.546 GMT [27331] LOG:  shutting down
2023-01-09 08:43:46.584 GMT [27329] LOG:  database system is shut down
2023-01-09 08:43:48.633 GMT [27844] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:43:48.633 GMT [27844] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:43:48.635 GMT [27844] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:43:48.639 GMT [27846] LOG:  database system was shut down at 2023-01-09 08:43:48 GMT
2023-01-09 08:43:48.645 GMT [27844] LOG:  database system is ready to accept connections
2023-01-09 08:43:49.372 GMT [27891] ERROR:  syntax error at or near ")" at character 31
2023-01-09 08:43:49.372 GMT [27891] STATEMENT:  INSERT INTO client.view_login() VALUES (1, "alfie");
2023-01-09 08:43:58.608 GMT [27844] LOG:  received fast shutdown request
2023-01-09 08:43:58.609 GMT [27844] LOG:  aborting any active transactions
2023-01-09 08:43:58.613 GMT [27844] LOG:  background worker "logical replication launcher" (PID 27853) exited with exit code 1
2023-01-09 08:43:58.613 GMT [27848] LOG:  shutting down
2023-01-09 08:43:58.658 GMT [27844] LOG:  database system is shut down
2023-01-09 08:44:00.620 GMT [28018] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:44:00.620 GMT [28018] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:44:00.622 GMT [28018] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:44:00.626 GMT [28019] LOG:  database system was shut down at 2023-01-09 08:44:00 GMT
2023-01-09 08:44:00.631 GMT [28018] LOG:  database system is ready to accept connections
2023-01-09 08:44:01.356 GMT [28057] ERROR:  column "alfie" does not exist at character 42
2023-01-09 08:44:01.356 GMT [28057] STATEMENT:  INSERT INTO client.view_login VALUES (1, "alfie");
2023-01-09 08:44:38.569 GMT [28212] ERROR:  cannot drop table customer because other objects depend on it
2023-01-09 08:44:38.569 GMT [28212] DETAIL:  constraint online_account_customer_id_fkey on table online_account depends on table customer
	view client.view_personal_information depends on table customer
2023-01-09 08:44:38.569 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.569 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS customer;
2023-01-09 08:44:38.572 GMT [28212] ERROR:  cannot drop table online_account because other objects depend on it
2023-01-09 08:44:38.572 GMT [28212] DETAIL:  constraint user_login_account_id_fkey on table user_login depends on table online_account
	constraint savings_account_account_id_fkey on table savings_account depends on table online_account
	constraint credit_account_account_id_fkey on table credit_account depends on table online_account
	constraint debit_account_account_id_fkey on table debit_account depends on table online_account
	constraint loan_account_id_fkey on table loan depends on table online_account
	constraint external_account_account_id_fkey on table external_account depends on table online_account
	view client.view_online_account_details depends on table online_account
	view client.view_personal_information depends on view client.view_online_account_details
	view client.view_loans depends on view client.view_online_account_details
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
	view client.view_savings_account depends on view client.view_online_account_details
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
	view client.view_credit_accounts depends on view client.view_online_account_details
	view client.view_credit_account_applications depends on view client.view_credit_accounts
	view client.view_credit_account_statements depends on view client.view_credit_accounts
	view client.view_credit_account_statement depends on view client.view_credit_account_statements
	view client.view_debit_accounts depends on view client.view_online_account_details
	view client.view_debit_account_statements depends on view client.view_debit_accounts
	view client.view_debit_account_status depends on view client.view_debit_account_statements
2023-01-09 08:44:38.572 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.572 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS online_account;
2023-01-09 08:44:38.579 GMT [28212] ERROR:  cannot drop table user_login because other objects depend on it
2023-01-09 08:44:38.579 GMT [28212] DETAIL:  constraint user_login_security_question_login_id_fkey on table user_login_security_question depends on table user_login
	view client.view_login depends on table user_login
	view client.view_online_account_details depends on view client.view_login
	view client.view_personal_information depends on view client.view_online_account_details
	view client.view_loans depends on view client.view_online_account_details
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
	view client.view_savings_account depends on view client.view_online_account_details
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
	view client.view_credit_accounts depends on view client.view_online_account_details
	view client.view_credit_account_applications depends on view client.view_credit_accounts
	view client.view_credit_account_statements depends on view client.view_credit_accounts
	view client.view_credit_account_statement depends on view client.view_credit_account_statements
	view client.view_debit_accounts depends on view client.view_online_account_details
	view client.view_debit_account_statements depends on view client.view_debit_accounts
	view client.view_debit_account_status depends on view client.view_debit_account_statements
	view client.login depends on table user_login
	view client.view_login_secret depends on table user_login
2023-01-09 08:44:38.579 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.579 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS user_login;
2023-01-09 08:44:38.581 GMT [28212] ERROR:  cannot drop table user_login_security_question because other objects depend on it
2023-01-09 08:44:38.581 GMT [28212] DETAIL:  constraint security_question_answer_question_id_fkey on table security_question_answer depends on table user_login_security_question
	view client.view_security_questions depends on table user_login_security_question
2023-01-09 08:44:38.581 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.581 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS user_login_security_question;
2023-01-09 08:44:38.581 GMT [28212] ERROR:  cannot drop table security_question_option because other objects depend on it
2023-01-09 08:44:38.581 GMT [28212] DETAIL:  constraint user_login_security_question_question_choice_id_fkey on table user_login_security_question depends on table security_question_option
	view client.view_security_questions depends on table security_question_option
2023-01-09 08:44:38.581 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.581 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS security_question_option;
2023-01-09 08:44:38.582 GMT [28212] ERROR:  cannot drop table security_question_answer because other objects depend on it
2023-01-09 08:44:38.582 GMT [28212] DETAIL:  view client.view_security_questions depends on table security_question_answer
2023-01-09 08:44:38.582 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.582 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS security_question_answer;
2023-01-09 08:44:38.584 GMT [28212] ERROR:  cannot drop table savings_account because other objects depend on it
2023-01-09 08:44:38.584 GMT [28212] DETAIL:  constraint savings_statement_account_id_fkey on table savings_statement depends on table savings_account
	view client.view_savings_account depends on table savings_account
	view client.view_savings_account_statements depends on view client.view_savings_account
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
2023-01-09 08:44:38.584 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.584 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS savings_account;
2023-01-09 08:44:38.586 GMT [28212] ERROR:  cannot drop table credit_account because other objects depend on it
2023-01-09 08:44:38.586 GMT [28212] DETAIL:  constraint credit_account_application_account_id_fkey on table credit_account_application depends on table credit_account
	constraint credit_statement_account_id_fkey on table credit_statement depends on table credit_account
	view client.view_credit_accounts depends on table credit_account
	view client.view_credit_account_applications depends on view client.view_credit_accounts
	view client.view_credit_account_statements depends on view client.view_credit_accounts
	view client.view_credit_account_statement depends on view client.view_credit_account_statements
2023-01-09 08:44:38.586 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.586 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS credit_account;
2023-01-09 08:44:38.587 GMT [28212] ERROR:  cannot drop table debit_account because other objects depend on it
2023-01-09 08:44:38.587 GMT [28212] DETAIL:  constraint debit_statement_account_id_fkey on table debit_statement depends on table debit_account
	constraint debit_overdraft_account_id_fkey on table debit_overdraft depends on table debit_account
	view client.view_debit_accounts depends on table debit_account
	view client.view_debit_account_statements depends on view client.view_debit_accounts
	view client.view_debit_account_status depends on view client.view_debit_account_statements
2023-01-09 08:44:38.587 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.587 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS debit_account;
2023-01-09 08:44:38.588 GMT [28212] ERROR:  cannot drop table loan because other objects depend on it
2023-01-09 08:44:38.588 GMT [28212] DETAIL:  constraint loan_application_loan_id_fkey on table loan_application depends on table loan
	constraint loan_statement_loan_id_fkey on table loan_statement depends on table loan
	view client.view_loans depends on table loan
	view client.view_loan_applications depends on view client.view_loans
	view client.view_loan_statements depends on view client.view_loans
2023-01-09 08:44:38.588 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.588 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS loan;
2023-01-09 08:44:38.589 GMT [28212] ERROR:  cannot drop table savings_statement because other objects depend on it
2023-01-09 08:44:38.589 GMT [28212] DETAIL:  constraint transaction_savings_statement_id_fkey on table transaction depends on table savings_statement
	view client.view_savings_account_statements depends on table savings_statement
	view client.view_savings_account_statement depends on view client.view_savings_account_statements
2023-01-09 08:44:38.589 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.589 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS savings_statement;
2023-01-09 08:44:38.589 GMT [28212] ERROR:  cannot drop table credit_account_application because other objects depend on it
2023-01-09 08:44:38.589 GMT [28212] DETAIL:  view client.view_credit_account_applications depends on table credit_account_application
2023-01-09 08:44:38.589 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.589 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS credit_account_application;
2023-01-09 08:44:38.590 GMT [28212] ERROR:  cannot drop table credit_statement because other objects depend on it
2023-01-09 08:44:38.590 GMT [28212] DETAIL:  constraint transaction_credit_statement_id_fkey on table transaction depends on table credit_statement
	view client.view_credit_account_statements depends on table credit_statement
	view client.view_credit_account_statement depends on view client.view_credit_account_statements
2023-01-09 08:44:38.590 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.590 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS credit_statement;
2023-01-09 08:44:38.590 GMT [28212] ERROR:  cannot drop table debit_statement because other objects depend on it
2023-01-09 08:44:38.590 GMT [28212] DETAIL:  constraint transaction_debit_statement_id_fkey on table transaction depends on table debit_statement
	view client.view_debit_account_statements depends on table debit_statement
	view client.view_debit_account_status depends on view client.view_debit_account_statements
2023-01-09 08:44:38.590 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.590 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS debit_statement;
2023-01-09 08:44:38.597 GMT [28212] ERROR:  cannot drop table transaction because other objects depend on it
2023-01-09 08:44:38.597 GMT [28212] DETAIL:  view client.view_savings_account_statement depends on table transaction
	view client.view_credit_account_statement depends on table transaction
	view client.view_debit_account_status depends on table transaction
2023-01-09 08:44:38.597 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.597 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS transaction;
2023-01-09 08:44:38.598 GMT [28212] ERROR:  cannot drop table loan_application because other objects depend on it
2023-01-09 08:44:38.598 GMT [28212] DETAIL:  view client.view_loan_applications depends on table loan_application
2023-01-09 08:44:38.598 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.598 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS loan_application;
2023-01-09 08:44:38.599 GMT [28212] ERROR:  cannot drop table loan_statement because other objects depend on it
2023-01-09 08:44:38.599 GMT [28212] DETAIL:  view client.view_loan_statements depends on table loan_statement
2023-01-09 08:44:38.599 GMT [28212] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-09 08:44:38.599 GMT [28212] STATEMENT:  DROP TABLE IF EXISTS loan_statement;
2023-01-09 08:44:38.674 GMT [28212] ERROR:  role "manager" already exists
2023-01-09 08:44:38.674 GMT [28212] STATEMENT:  CREATE ROLE manager WITH LOGIN PASSWORD 'manager' CREATEROLE;
2023-01-09 08:44:38.674 GMT [28212] ERROR:  role "employee1" already exists
2023-01-09 08:44:38.674 GMT [28212] STATEMENT:  CREATE ROLE employee1 WITH LOGIN PASSWORD 'employee1' CREATEROLE;
2023-01-09 08:44:38.674 GMT [28212] ERROR:  role "employee2" already exists
2023-01-09 08:44:38.674 GMT [28212] STATEMENT:  CREATE ROLE employee2 WITH LOGIN PASSWORD 'employee2' CREATEROLE;
2023-01-09 08:44:38.675 GMT [28212] ERROR:  role "employee3" already exists
2023-01-09 08:44:38.675 GMT [28212] STATEMENT:  CREATE ROLE employee3 WITH LOGIN PASSWORD 'employee3' CREATEROLE;
2023-01-09 08:44:38.675 GMT [28212] ERROR:  role "employee4" already exists
2023-01-09 08:44:38.675 GMT [28212] STATEMENT:  CREATE ROLE employee4 WITH LOGIN PASSWORD 'employee4' CREATEROLE;
2023-01-09 08:44:38.675 GMT [28212] ERROR:  role "employee5" already exists
2023-01-09 08:44:38.675 GMT [28212] STATEMENT:  CREATE ROLE employee5 WITH LOGIN PASSWORD 'employee5' CREATEROLE;
2023-01-09 08:44:38.675 GMT [28212] ERROR:  column "alfie" does not exist at character 37
2023-01-09 08:44:38.675 GMT [28212] STATEMENT:  INSERT INTO client.login VALUES (1, "alfie");
2023-01-09 08:44:40.880 GMT [28018] LOG:  received fast shutdown request
2023-01-09 08:44:40.882 GMT [28018] LOG:  aborting any active transactions
2023-01-09 08:44:40.884 GMT [28018] LOG:  background worker "logical replication launcher" (PID 28025) exited with exit code 1
2023-01-09 08:44:40.886 GMT [28020] LOG:  shutting down
2023-01-09 08:44:40.928 GMT [28018] LOG:  database system is shut down
2023-01-09 08:44:43.892 GMT [28308] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:44:43.893 GMT [28308] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:44:43.894 GMT [28308] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:44:43.899 GMT [28309] LOG:  database system was shut down at 2023-01-09 08:44:43 GMT
2023-01-09 08:44:43.904 GMT [28308] LOG:  database system is ready to accept connections
2023-01-09 08:44:44.702 GMT [28349] ERROR:  column "alfie" does not exist at character 37
2023-01-09 08:44:44.702 GMT [28349] STATEMENT:  INSERT INTO client.login VALUES (1, "alfie");
2023-01-09 08:45:26.903 GMT [28308] LOG:  received fast shutdown request
2023-01-09 08:45:26.905 GMT [28308] LOG:  aborting any active transactions
2023-01-09 08:45:26.908 GMT [28308] LOG:  background worker "logical replication launcher" (PID 28315) exited with exit code 1
2023-01-09 08:45:26.909 GMT [28310] LOG:  shutting down
2023-01-09 08:45:26.948 GMT [28308] LOG:  database system is shut down
2023-01-09 08:45:28.808 GMT [28557] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:45:28.808 GMT [28557] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:45:28.810 GMT [28557] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:45:28.814 GMT [28561] LOG:  database system was shut down at 2023-01-09 08:45:28 GMT
2023-01-09 08:45:28.821 GMT [28557] LOG:  database system is ready to accept connections
2023-01-09 08:45:29.624 GMT [28603] ERROR:  column "alfie" does not exist at character 59
2023-01-09 08:45:29.624 GMT [28603] STATEMENT:  INSERT INTO client.login(account_id, username) VALUES (1, "alfie");
2023-01-09 08:46:33.633 GMT [28557] LOG:  received fast shutdown request
2023-01-09 08:46:33.634 GMT [28557] LOG:  aborting any active transactions
2023-01-09 08:46:33.636 GMT [28557] LOG:  background worker "logical replication launcher" (PID 28567) exited with exit code 1
2023-01-09 08:46:33.643 GMT [28562] LOG:  shutting down
2023-01-09 08:46:33.690 GMT [28557] LOG:  database system is shut down
2023-01-09 08:46:35.582 GMT [28900] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:46:35.582 GMT [28900] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:46:35.583 GMT [28900] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:46:35.588 GMT [28901] LOG:  database system was shut down at 2023-01-09 08:46:35 GMT
2023-01-09 08:46:35.596 GMT [28900] LOG:  database system is ready to accept connections
2023-01-09 08:46:36.424 GMT [28929] ERROR:  column "alfie" does not exist at character 60
2023-01-09 08:46:36.424 GMT [28929] STATEMENT:  INSERT INTO client.login (account_id, username) VALUES (1, "alfie");
2023-01-09 08:47:49.335 GMT [28900] LOG:  received fast shutdown request
2023-01-09 08:47:49.337 GMT [28900] LOG:  aborting any active transactions
2023-01-09 08:47:49.341 GMT [28900] LOG:  background worker "logical replication launcher" (PID 28907) exited with exit code 1
2023-01-09 08:47:49.343 GMT [28902] LOG:  shutting down
2023-01-09 08:47:49.376 GMT [28900] LOG:  database system is shut down
2023-01-09 08:47:51.163 GMT [29210] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:47:51.164 GMT [29210] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:47:51.165 GMT [29210] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:47:51.170 GMT [29211] LOG:  database system was shut down at 2023-01-09 08:47:50 GMT
2023-01-09 08:47:51.175 GMT [29210] LOG:  database system is ready to accept connections
2023-01-09 08:47:51.916 GMT [29249] ERROR:  insert or update on table "user_login" violates foreign key constraint "user_login_account_id_fkey"
2023-01-09 08:47:51.916 GMT [29249] DETAIL:  Key (account_id)=(1) is not present in table "online_account".
2023-01-09 08:47:51.916 GMT [29249] STATEMENT:  INSERT INTO client.login (account_id, username) VALUES (1, 'alfie');
2023-01-09 08:48:15.044 GMT [29210] LOG:  received fast shutdown request
2023-01-09 08:48:15.047 GMT [29210] LOG:  aborting any active transactions
2023-01-09 08:48:15.051 GMT [29210] LOG:  background worker "logical replication launcher" (PID 29217) exited with exit code 1
2023-01-09 08:48:15.052 GMT [29212] LOG:  shutting down
2023-01-09 08:48:15.096 GMT [29210] LOG:  database system is shut down
2023-01-09 08:48:16.963 GMT [29397] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 08:48:16.963 GMT [29397] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 08:48:16.964 GMT [29397] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 08:48:16.968 GMT [29398] LOG:  database system was shut down at 2023-01-09 08:48:16 GMT
2023-01-09 08:48:16.974 GMT [29397] LOG:  database system is ready to accept connections
2023-01-09 08:48:17.816 GMT [29433] ERROR:  invalid input syntax for type integer: "alfie" at character 37
2023-01-09 08:48:17.816 GMT [29433] STATEMENT:  INSERT INTO client.login VALUES (1, 'alfie');
2023-01-09 09:41:23.347 GMT [29397] LOG:  received fast shutdown request
2023-01-09 09:41:23.349 GMT [29397] LOG:  aborting any active transactions
2023-01-09 09:41:23.355 GMT [29397] LOG:  background worker "logical replication launcher" (PID 29404) exited with exit code 1
2023-01-09 09:41:23.356 GMT [29399] LOG:  shutting down
2023-01-09 09:41:23.369 GMT [29397] LOG:  database system is shut down
2023-01-09 09:41:37.206 GMT [38544] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 09:41:37.207 GMT [38544] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 09:41:37.209 GMT [38544] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 09:41:37.212 GMT [38545] LOG:  database system was shut down at 2023-01-09 09:41:36 GMT
2023-01-09 09:41:37.217 GMT [38544] LOG:  database system is ready to accept connections
2023-01-09 09:41:37.853 GMT [38580] ERROR:  relation "client_login" does not exist at character 206
2023-01-09 09:41:37.853 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_online_account_details AS
	SELECT online_account.id, online_account.date_opened, online_account.sort_code, online_account.customer_id
	    FROM online_account
	INNER JOIN client_login ON online_account.id = client_login.id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_online_account_details" does not exist at character 104
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_personal_information AS
	SELECT customer.* FROM customer
	LEFT JOIN client_online_account_details ON customer.id = client_online_account_details.customer_id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_online_account_details" does not exist at character 136
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN client_online_account_details ON loan.account_id = client_online_account_details.id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_loans" does not exist at character 133
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_applications AS
	SELECT loan_application.application_status, loan_application.loan_id
	FROM client_loans
	RIGHT JOIN loan_application ON client_loans.id = loan_application.loan_id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_loans" does not exist at character 145
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_statements AS
	SELECT loan_statement.starting_date, loan_statement.amount, loan_statement.loan_id
	FROM client_loans
	RIGHT JOIN loan_statement ON client_loans.id = loan_statement.loan_id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_online_account_details" does not exist at character 178
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account AS
	SELECT savings_account.id, savings_account.current_balance, savings_account.interest_rate
	FROM savings_account
	LEFT JOIN client_online_account_details ON savings_account.account_id = client_online_account_details.id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_savings_account" does not exist at character 218
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account_statements AS
	SELECT savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount, savings_statement.account_id
	FROM client_savings_account
	RIGHT JOIN savings_statement ON client_savings_account.id = savings_statement.account_id;
2023-01-09 09:41:37.858 GMT [38580] ERROR:  relation "client_savings_account_statements" does not exist at character 210
2023-01-09 09:41:37.858 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.savings_statement_id
	FROM client_savings_account_statements
	RIGHT JOIN transaction ON client_savings_account_statements.id = transaction.savings_statement_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_online_account_details" does not exist at character 207
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_accounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	LEFT JOIN client_online_account_details ON credit_account.account_id = client_online_account_details.id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_credit_accounts" does not exist at character 166
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_applications AS
	SELECT credit_account_application.application_status, credit_account_application.account_id
	FROM client_credit_accounts
	RIGHT JOIN credit_account_application ON client_credit_accounts.id = credit_account_application.account_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_credit_accounts" does not exist at character 289
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM client_credit_accounts
	RIGHT JOIN credit_statement ON client_credit_accounts.id = credit_statement.account_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_credit_account_statements" does not exist at character 208
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_statement_id
	FROM client_credit_account_statements
	RIGHT JOIN transaction ON client_credit_account_statements.id = transaction.credit_statement_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_online_account_details" does not exist at character 169
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_accounts AS
	SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate
	FROM debit_account
	LEFT JOIN client_online_account_details ON debit_account.account_id = client_online_account_details.id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_debit_accounts" does not exist at character 206
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.account_id
	FROM client_debit_accounts
	RIGHT JOIN debit_statement ON client_debit_accounts.id = debit_statement.account_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  relation "client_debit_account_statements" does not exist at character 207
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_statement_id
	FROM client_debit_account_statements
	RIGHT JOIN transaction ON client_debit_account_statements.id = transaction.debit_statement_id;
2023-01-09 09:41:37.859 GMT [38580] ERROR:  syntax error at or near "." at character 22
2023-01-09 09:41:37.859 GMT [38580] STATEMENT:  CREATE TRIGGER client.trg_client_security_questions ON client.client_security_questions
	INSTEAD OF INSERT
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question (question_choice_id, login_id)
	    SELECT i.question_choice_id, i.login_id
	    FROM inserted i
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	END;
	$$
	CREATE SCHEMA IF NOT EXISTS staff;
2023-01-09 09:43:00.392 GMT [38544] LOG:  received fast shutdown request
2023-01-09 09:43:00.393 GMT [38544] LOG:  aborting any active transactions
2023-01-09 09:43:00.396 GMT [38544] LOG:  background worker "logical replication launcher" (PID 38551) exited with exit code 1
2023-01-09 09:43:00.401 GMT [38546] LOG:  shutting down
2023-01-09 09:43:00.438 GMT [38544] LOG:  database system is shut down
2023-01-09 09:43:02.148 GMT [38878] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 09:43:02.149 GMT [38878] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 09:43:02.150 GMT [38878] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 09:43:02.154 GMT [38879] LOG:  database system was shut down at 2023-01-09 09:43:01 GMT
2023-01-09 09:43:02.158 GMT [38878] LOG:  database system is ready to accept connections
2023-01-09 09:43:02.921 GMT [38916] ERROR:  syntax error at or near "." at character 22
2023-01-09 09:43:02.921 GMT [38916] STATEMENT:  CREATE TRIGGER client.trg_client_security_questions ON client.client_security_questions
	INSTEAD OF INSERT
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question (question_choice_id, login_id)
	    SELECT i.question_choice_id, i.login_id
	    FROM inserted i
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	END;
	$$
	CREATE SCHEMA IF NOT EXISTS staff;
2023-01-09 09:43:45.930 GMT [38878] LOG:  received fast shutdown request
2023-01-09 09:43:45.932 GMT [38878] LOG:  aborting any active transactions
2023-01-09 09:43:45.935 GMT [38878] LOG:  background worker "logical replication launcher" (PID 38885) exited with exit code 1
2023-01-09 09:43:45.938 GMT [38880] LOG:  shutting down
2023-01-09 09:43:45.973 GMT [38878] LOG:  database system is shut down
2023-01-09 09:43:47.491 GMT [39131] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 09:43:47.492 GMT [39131] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 09:43:47.493 GMT [39131] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 09:43:47.499 GMT [39132] LOG:  database system was shut down at 2023-01-09 09:43:47 GMT
2023-01-09 09:43:47.505 GMT [39131] LOG:  database system is ready to accept connections
2023-01-09 09:43:48.184 GMT [39167] ERROR:  syntax error at or near "ON" at character 46
2023-01-09 09:43:48.184 GMT [39167] STATEMENT:  CREATE TRIGGER trg_client_security_questions ON client.client_security_questions
	INSTEAD OF INSERT
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question (question_choice_id, login_id)
	    SELECT i.question_choice_id, i.login_id
	    FROM inserted i
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	END;
	$$
	CREATE SCHEMA IF NOT EXISTS staff;
2023-01-09 10:05:02.271 GMT [39131] LOG:  received fast shutdown request
2023-01-09 10:05:02.274 GMT [39131] LOG:  aborting any active transactions
2023-01-09 10:05:02.278 GMT [39131] LOG:  background worker "logical replication launcher" (PID 39138) exited with exit code 1
2023-01-09 10:05:02.278 GMT [39133] LOG:  shutting down
2023-01-09 10:05:02.295 GMT [39131] LOG:  database system is shut down
2023-01-09 10:05:16.108 GMT [42774] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:05:16.108 GMT [42774] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:05:16.110 GMT [42774] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:05:16.114 GMT [42775] LOG:  database system was shut down at 2023-01-09 10:05:15 GMT
2023-01-09 10:05:16.119 GMT [42774] LOG:  database system is ready to accept connections
2023-01-09 10:05:16.768 GMT [42811] ERROR:  syntax error at or near "INTO" at character 131
2023-01-09 10:05:16.768 GMT [42811] CONTEXT:  invalid type name "INTO user_login_security_question (question_choice_id, login_id)
	    SELECT i.question_choice_id"
2023-01-09 10:05:16.768 GMT [42811] STATEMENT:  CREATE OR REPLACE FUNCTION trg_insert_client_security_questions() RETURNS trigger
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question (question_choice_id, login_id)
	    SELECT i.question_choice_id, i.login_id
	    FROM inserted i
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	END;
	$$
	LANGUAGE plpgsql;
2023-01-09 10:05:16.768 GMT [42811] ERROR:  function trg_insert_client_security_questions() does not exist
2023-01-09 10:05:16.768 GMT [42811] STATEMENT:  CREATE TRIGGER trg_insert_client_security_questions
	INSTEAD OF INSERT ON client.client_security_questions
	    FOR EACH ROW EXECUTE FUNCTION trg_insert_client_security_questions();
2023-01-09 10:11:04.602 GMT [42774] LOG:  received fast shutdown request
2023-01-09 10:11:04.604 GMT [42774] LOG:  aborting any active transactions
2023-01-09 10:11:04.606 GMT [42774] LOG:  background worker "logical replication launcher" (PID 42781) exited with exit code 1
2023-01-09 10:11:04.609 GMT [42776] LOG:  shutting down
2023-01-09 10:11:04.623 GMT [42774] LOG:  database system is shut down
2023-01-09 10:11:06.783 GMT [43874] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:11:06.784 GMT [43874] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:11:06.785 GMT [43874] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:11:06.789 GMT [43875] LOG:  database system was shut down at 2023-01-09 10:11:06 GMT
2023-01-09 10:11:06.794 GMT [43874] LOG:  database system is ready to accept connections
2023-01-09 10:11:07.445 GMT [43913] ERROR:  syntax error at or near "INTO" at character 131
2023-01-09 10:11:07.445 GMT [43913] CONTEXT:  invalid type name "INTO user_login_security_question (question_choice_id, login_id)
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id INTO prev_id"
2023-01-09 10:11:07.445 GMT [43913] STATEMENT:  CREATE OR REPLACE FUNCTION trg_insert_client_security_questions() RETURNS trigger
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question (question_choice_id, login_id)
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	END;
	$$
	LANGUAGE plpgsql;
2023-01-09 10:11:07.445 GMT [43913] ERROR:  function trg_insert_client_security_questions() does not exist
2023-01-09 10:11:07.445 GMT [43913] STATEMENT:  CREATE TRIGGER trg_insert_client_security_questions
	INSTEAD OF INSERT ON client.client_security_questions
	    FOR EACH ROW EXECUTE FUNCTION trg_insert_client_security_questions();
2023-01-09 10:16:56.384 GMT [43874] LOG:  received fast shutdown request
2023-01-09 10:16:56.388 GMT [43874] LOG:  aborting any active transactions
2023-01-09 10:16:56.393 GMT [43874] LOG:  background worker "logical replication launcher" (PID 43881) exited with exit code 1
2023-01-09 10:16:56.398 GMT [43876] LOG:  shutting down
2023-01-09 10:16:56.414 GMT [43874] LOG:  database system is shut down
2023-01-09 10:16:58.080 GMT [44976] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:16:58.080 GMT [44976] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:16:58.082 GMT [44976] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:16:58.086 GMT [44977] LOG:  database system was shut down at 2023-01-09 10:16:57 GMT
2023-01-09 10:16:58.092 GMT [44976] LOG:  database system is ready to accept connections
2023-01-09 10:16:58.726 GMT [45013] ERROR:  syntax error at or near "INTO" at character 131
2023-01-09 10:16:58.726 GMT [45013] CONTEXT:  invalid type name "INTO user_login_security_question
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id INTO prev_id"
2023-01-09 10:16:58.726 GMT [45013] STATEMENT:  CREATE OR REPLACE FUNCTION trg_insert_client_security_questions() RETURNS trigger
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	
	    RETURN NEW;
	END;
	$$
	LANGUAGE plpgsql;
2023-01-09 10:16:58.727 GMT [45013] ERROR:  function trg_insert_client_security_questions() does not exist
2023-01-09 10:16:58.727 GMT [45013] STATEMENT:  CREATE TRIGGER trg_insert_client_security_questions
	INSTEAD OF INSERT ON client.client_security_questions
	    FOR EACH ROW EXECUTE FUNCTION trg_insert_client_security_questions();
2023-01-09 10:17:22.243 GMT [44976] LOG:  received fast shutdown request
2023-01-09 10:17:22.245 GMT [44976] LOG:  aborting any active transactions
2023-01-09 10:17:22.250 GMT [44976] LOG:  background worker "logical replication launcher" (PID 44983) exited with exit code 1
2023-01-09 10:17:22.250 GMT [44978] LOG:  shutting down
2023-01-09 10:17:22.301 GMT [44976] LOG:  database system is shut down
2023-01-09 10:17:24.439 GMT [45165] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:17:24.440 GMT [45165] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:17:24.441 GMT [45165] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:17:24.445 GMT [45166] LOG:  database system was shut down at 2023-01-09 10:17:24 GMT
2023-01-09 10:17:24.451 GMT [45165] LOG:  database system is ready to accept connections
2023-01-09 10:17:25.093 GMT [45205] ERROR:  syntax error at or near "INTO" at character 131
2023-01-09 10:17:25.093 GMT [45205] CONTEXT:  invalid type name "INTO user_login_security_question
	    VALUES(0, 1)
	    RETURNING id INTO prev_id"
2023-01-09 10:17:25.093 GMT [45205] STATEMENT:  CREATE OR REPLACE FUNCTION trg_insert_client_security_questions() RETURNS trigger
	AS $$
	BEGIN
	    DECLARE prev_id INT;
	    INSERT INTO user_login_security_question
	    VALUES(0, 1)
	    RETURNING id INTO prev_id;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    SELECT i.question_answer, prev_id
	    FROM inserted i;
	
	    RETURN NEW;
	END;
	$$
	LANGUAGE plpgsql;
2023-01-09 10:17:25.096 GMT [45205] ERROR:  function trg_insert_client_security_questions() does not exist
2023-01-09 10:17:25.096 GMT [45205] STATEMENT:  CREATE TRIGGER trg_insert_client_security_questions
	INSTEAD OF INSERT ON client.client_security_questions
	    FOR EACH ROW EXECUTE FUNCTION trg_insert_client_security_questions();
2023-01-09 10:18:40.909 GMT [45165] LOG:  received fast shutdown request
2023-01-09 10:18:40.911 GMT [45165] LOG:  aborting any active transactions
2023-01-09 10:18:40.913 GMT [45165] LOG:  background worker "logical replication launcher" (PID 45172) exited with exit code 1
2023-01-09 10:18:40.916 GMT [45167] LOG:  shutting down
2023-01-09 10:18:40.959 GMT [45165] LOG:  database system is shut down
2023-01-09 10:18:42.698 GMT [45502] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:18:42.698 GMT [45502] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:18:42.700 GMT [45502] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:18:42.704 GMT [45503] LOG:  database system was shut down at 2023-01-09 10:18:42 GMT
2023-01-09 10:18:42.710 GMT [45502] LOG:  database system is ready to accept connections
2023-01-09 10:19:40.559 GMT [45502] LOG:  received fast shutdown request
2023-01-09 10:19:40.561 GMT [45502] LOG:  aborting any active transactions
2023-01-09 10:19:40.564 GMT [45502] LOG:  background worker "logical replication launcher" (PID 45509) exited with exit code 1
2023-01-09 10:19:40.568 GMT [45504] LOG:  shutting down
2023-01-09 10:19:40.603 GMT [45502] LOG:  database system is shut down
2023-01-09 10:19:42.429 GMT [45801] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:19:42.429 GMT [45801] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:19:42.431 GMT [45801] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:19:42.436 GMT [45802] LOG:  database system was shut down at 2023-01-09 10:19:42 GMT
2023-01-09 10:19:42.441 GMT [45801] LOG:  database system is ready to accept connections
2023-01-09 10:20:01.120 GMT [45801] LOG:  received fast shutdown request
2023-01-09 10:20:01.121 GMT [45801] LOG:  aborting any active transactions
2023-01-09 10:20:01.125 GMT [45801] LOG:  background worker "logical replication launcher" (PID 45808) exited with exit code 1
2023-01-09 10:20:01.126 GMT [45803] LOG:  shutting down
2023-01-09 10:20:01.160 GMT [45801] LOG:  database system is shut down
2023-01-09 10:20:02.983 GMT [45997] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:20:02.984 GMT [45997] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:20:02.985 GMT [45997] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:20:02.991 GMT [45998] LOG:  database system was shut down at 2023-01-09 10:20:02 GMT
2023-01-09 10:20:02.996 GMT [45997] LOG:  database system is ready to accept connections
2023-01-09 10:20:03.633 GMT [46036] ERROR:  syntax error at or near "INTO" at character 295
2023-01-09 10:20:03.633 GMT [46036] CONTEXT:  invalid type name "INTO security_question_answer (question_answer, question_id)
	    VALUES(NEW.question_answer, prev_id)"
2023-01-09 10:20:03.633 GMT [46036] STATEMENT:  CREATE OR REPLACE FUNCTION trg_insert_client_security_questions() RETURNS trigger
	AS $$
	BEGIN
	    -- DECLARE prev_id INT;
	    -- INSERT INTO user_login_security_question
	    -- VALUES(NEW.question_choice_id, NEW.login_id)
	    -- RETURNING id INTO prev_id;
	
	    DECLARE prev_id INT;
	
	    INSERT INTO security_question_answer (question_answer, question_id)
	    VALUES(NEW.question_answer, prev_id);
	
	    RETURN NEW;
	END;
	$$
	LANGUAGE plpgsql;
2023-01-09 10:20:03.635 GMT [46036] ERROR:  function trg_insert_client_security_questions() does not exist
2023-01-09 10:20:03.635 GMT [46036] STATEMENT:  CREATE TRIGGER trg_insert_client_security_questions
	INSTEAD OF INSERT ON client.client_security_questions
	    FOR EACH ROW EXECUTE FUNCTION trg_insert_client_security_questions();
2023-01-09 10:20:58.049 GMT [45997] LOG:  received fast shutdown request
2023-01-09 10:20:58.051 GMT [45997] LOG:  aborting any active transactions
2023-01-09 10:20:58.054 GMT [45997] LOG:  background worker "logical replication launcher" (PID 46004) exited with exit code 1
2023-01-09 10:20:58.059 GMT [45999] LOG:  shutting down
2023-01-09 10:20:58.095 GMT [45997] LOG:  database system is shut down
2023-01-09 10:20:59.790 GMT [46275] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:20:59.790 GMT [46275] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:20:59.797 GMT [46275] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:20:59.802 GMT [46276] LOG:  database system was shut down at 2023-01-09 10:20:59 GMT
2023-01-09 10:20:59.808 GMT [46275] LOG:  database system is ready to accept connections
2023-01-09 10:21:25.344 GMT [46275] LOG:  received fast shutdown request
2023-01-09 10:21:25.346 GMT [46275] LOG:  aborting any active transactions
2023-01-09 10:21:25.350 GMT [46275] LOG:  background worker "logical replication launcher" (PID 46282) exited with exit code 1
2023-01-09 10:21:25.353 GMT [46277] LOG:  shutting down
2023-01-09 10:21:25.390 GMT [46275] LOG:  database system is shut down
2023-01-09 10:21:27.128 GMT [46468] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:21:27.129 GMT [46468] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:21:27.130 GMT [46468] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:21:27.136 GMT [46472] LOG:  database system was shut down at 2023-01-09 10:21:26 GMT
2023-01-09 10:21:27.142 GMT [46468] LOG:  database system is ready to accept connections
2023-01-09 10:26:24.189 GMT [46468] LOG:  received fast shutdown request
2023-01-09 10:26:24.190 GMT [46468] LOG:  aborting any active transactions
2023-01-09 10:26:24.194 GMT [46468] LOG:  background worker "logical replication launcher" (PID 46478) exited with exit code 1
2023-01-09 10:26:24.194 GMT [46473] LOG:  shutting down
2023-01-09 10:26:24.231 GMT [46468] LOG:  database system is shut down
2023-01-09 10:26:26.064 GMT [47483] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:26:26.064 GMT [47483] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:26:26.066 GMT [47483] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:26:26.071 GMT [47484] LOG:  database system was shut down at 2023-01-09 10:26:25 GMT
2023-01-09 10:26:26.088 GMT [47483] LOG:  database system is ready to accept connections
2023-01-09 10:26:26.707 GMT [47523] ERROR:  column "question_choice_id" of relation "client_security_questions" does not exist at character 47
2023-01-09 10:26:26.707 GMT [47523] STATEMENT:  INSERT INTO client.client_security_questions (question_choice_id, login_id, question_answer)
	VALUES (1, 1, "Churchill");
2023-01-09 10:29:48.010 GMT [47483] LOG:  received fast shutdown request
2023-01-09 10:29:48.012 GMT [47483] LOG:  aborting any active transactions
2023-01-09 10:29:48.015 GMT [47483] LOG:  background worker "logical replication launcher" (PID 47490) exited with exit code 1
2023-01-09 10:29:48.018 GMT [47485] LOG:  shutting down
2023-01-09 10:29:48.056 GMT [47483] LOG:  database system is shut down
2023-01-09 10:29:49.586 GMT [48170] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:29:49.587 GMT [48170] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:29:49.588 GMT [48170] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:29:49.593 GMT [48171] LOG:  database system was shut down at 2023-01-09 10:29:49 GMT
2023-01-09 10:29:49.597 GMT [48170] LOG:  database system is ready to accept connections
2023-01-09 10:29:50.330 GMT [48207] ERROR:  column "question_choice_id" of relation "client_security_questions" does not exist at character 47
2023-01-09 10:29:50.330 GMT [48207] STATEMENT:  INSERT INTO client.client_security_questions (question_choice_id, login_id, question_answer)
	VALUES (1, 1, "Churchill");
2023-01-09 10:30:31.715 GMT [48170] LOG:  received fast shutdown request
2023-01-09 10:30:31.717 GMT [48170] LOG:  aborting any active transactions
2023-01-09 10:30:31.723 GMT [48170] LOG:  background worker "logical replication launcher" (PID 48177) exited with exit code 1
2023-01-09 10:30:31.723 GMT [48172] LOG:  shutting down
2023-01-09 10:30:31.761 GMT [48170] LOG:  database system is shut down
2023-01-09 10:30:33.427 GMT [48416] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:30:33.427 GMT [48416] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:30:33.429 GMT [48416] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:30:33.433 GMT [48417] LOG:  database system was shut down at 2023-01-09 10:30:33 GMT
2023-01-09 10:30:33.439 GMT [48416] LOG:  database system is ready to accept connections
2023-01-09 10:30:34.151 GMT [48457] ERROR:  column "question_choice_id" of relation "client_security_questions" does not exist at character 40
2023-01-09 10:30:34.151 GMT [48457] STATEMENT:  INSERT INTO client_security_questions (question_choice_id, login_id, question_answer)
	VALUES (1, 1, "Churchill");
2023-01-09 10:33:46.888 GMT [48416] LOG:  received fast shutdown request
2023-01-09 10:33:46.890 GMT [48416] LOG:  aborting any active transactions
2023-01-09 10:33:46.894 GMT [48416] LOG:  background worker "logical replication launcher" (PID 48423) exited with exit code 1
2023-01-09 10:33:46.894 GMT [48418] LOG:  shutting down
2023-01-09 10:33:46.932 GMT [48416] LOG:  database system is shut down
2023-01-09 10:33:48.651 GMT [49078] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:33:48.652 GMT [49078] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:33:48.653 GMT [49078] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:33:48.658 GMT [49079] LOG:  database system was shut down at 2023-01-09 10:33:48 GMT
2023-01-09 10:33:48.664 GMT [49078] LOG:  database system is ready to accept connections
2023-01-09 10:33:49.323 GMT [49122] ERROR:  column "Churchill" does not exist at character 53
2023-01-09 10:33:49.323 GMT [49122] STATEMENT:  INSERT INTO client_security_questions
	VALUES (1, 1, "Churchill");
2023-01-09 10:34:21.360 GMT [49078] LOG:  received fast shutdown request
2023-01-09 10:34:21.362 GMT [49078] LOG:  aborting any active transactions
2023-01-09 10:34:21.366 GMT [49078] LOG:  background worker "logical replication launcher" (PID 49087) exited with exit code 1
2023-01-09 10:34:21.366 GMT [49082] LOG:  shutting down
2023-01-09 10:34:21.410 GMT [49078] LOG:  database system is shut down
2023-01-09 10:34:23.141 GMT [49304] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:34:23.141 GMT [49304] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:34:23.143 GMT [49304] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:34:23.147 GMT [49305] LOG:  database system was shut down at 2023-01-09 10:34:22 GMT
2023-01-09 10:34:23.152 GMT [49304] LOG:  database system is ready to accept connections
2023-01-09 10:34:23.816 GMT [49343] ERROR:  record "new" has no field "question_choice_id"
2023-01-09 10:34:23.816 GMT [49343] CONTEXT:  SQL statement "INSERT INTO user_login_security_question
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id"
	PL/pgSQL function trg_insert_client_security_questions() line 4 at SQL statement
2023-01-09 10:34:23.816 GMT [49343] STATEMENT:  INSERT INTO client_security_questions
	VALUES (1, 1);
2023-01-09 10:35:13.710 GMT [49304] LOG:  received fast shutdown request
2023-01-09 10:35:13.712 GMT [49304] LOG:  aborting any active transactions
2023-01-09 10:35:13.716 GMT [49304] LOG:  background worker "logical replication launcher" (PID 49311) exited with exit code 1
2023-01-09 10:35:13.719 GMT [49306] LOG:  shutting down
2023-01-09 10:35:13.756 GMT [49304] LOG:  database system is shut down
2023-01-09 10:35:15.192 GMT [49566] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-09 10:35:15.193 GMT [49566] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-09 10:35:15.194 GMT [49566] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-09 10:35:15.198 GMT [49567] LOG:  database system was shut down at 2023-01-09 10:35:14 GMT
2023-01-09 10:35:15.206 GMT [49566] LOG:  database system is ready to accept connections
2023-01-09 10:35:15.840 GMT [49606] ERROR:  record "new" has no field "question_choice_id"
2023-01-09 10:35:15.840 GMT [49606] CONTEXT:  SQL statement "INSERT INTO user_login_security_question
	    VALUES(NEW.question_choice_id, NEW.login_id)
	    RETURNING id"
	PL/pgSQL function trg_insert_client_security_questions() line 4 at SQL statement
2023-01-09 10:35:15.840 GMT [49606] STATEMENT:  INSERT INTO client_security_questions
	VALUES (1, 'churchill');
2023-01-09 10:36:31.500 GMT [49566] LOG:  received smart shutdown request
2023-01-09 10:36:31.519 GMT [49566] LOG:  received SIGHUP, reloading configuration files
2023-01-09 10:36:31.519 GMT [49566] LOG:  background worker "logical replication launcher" (PID 49573) exited with exit code 1
2023-01-09 10:36:31.520 GMT [49568] LOG:  shutting down
2023-01-09 10:36:31.644 GMT [49566] LOG:  database system is shut down
2023-01-10 11:00:07.518 GMT [42654] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:00:07.520 GMT [42654] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:00:07.525 GMT [42654] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:00:07.530 GMT [42655] LOG:  database system was shut down at 2023-01-10 11:00:07 GMT
2023-01-10 11:00:07.537 GMT [42654] LOG:  database system is ready to accept connections
2023-01-10 11:00:08.380 GMT [42680] ERROR:  syntax error at or near "AS" at character 252
2023-01-10 11:00:08.380 GMT [42680] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURN INT
	AS $$
	DECLARE success INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
	        success = 1;
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT'
	        success = 0;
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:00:08.381 GMT [42680] ERROR:  syntax error at or near "AS" at character 124
2023-01-10 11:00:08.381 GMT [42680] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURN INT
	AS $$
	DECLARE customer_id INT;
	BEGIN
	    SELECT id INTO customer_id FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:00:08.381 GMT [42680] ERROR:  syntax error at or near "INT" at character 177
2023-01-10 11:00:08.381 GMT [42680] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT. question_choice_ids INT[], question_answers TEXT[])
	RETURN INT
	AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN'
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:12.061 GMT [42654] LOG:  received fast shutdown request
2023-01-10 11:02:12.063 GMT [42654] LOG:  aborting any active transactions
2023-01-10 11:02:12.068 GMT [42654] LOG:  background worker "logical replication launcher" (PID 42661) exited with exit code 1
2023-01-10 11:02:12.068 GMT [42656] LOG:  shutting down
2023-01-10 11:02:12.122 GMT [42654] LOG:  database system is shut down
2023-01-10 11:02:14.033 GMT [43232] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:02:14.034 GMT [43232] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:02:14.037 GMT [43232] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:02:14.044 GMT [43233] LOG:  database system was shut down at 2023-01-10 11:02:13 GMT
2023-01-10 11:02:14.057 GMT [43232] LOG:  database system is ready to accept connections
2023-01-10 11:02:14.959 GMT [43262] ERROR:  syntax error at or near "AS" at character 252
2023-01-10 11:02:14.959 GMT [43262] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURN INT AS $$
	DECLARE success INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
	        success = 1;
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT'
	        success = 0;
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:14.961 GMT [43262] ERROR:  syntax error at or near "AS" at character 124
2023-01-10 11:02:14.961 GMT [43262] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURN INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    SELECT id INTO customer_id FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:14.961 GMT [43262] ERROR:  syntax error at or near "INT" at character 177
2023-01-10 11:02:14.961 GMT [43262] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT. question_choice_ids INT[], question_answers TEXT[])
	RETURN INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN'
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:49.179 GMT [43232] LOG:  received fast shutdown request
2023-01-10 11:02:49.181 GMT [43232] LOG:  aborting any active transactions
2023-01-10 11:02:49.184 GMT [43232] LOG:  background worker "logical replication launcher" (PID 43239) exited with exit code 1
2023-01-10 11:02:49.188 GMT [43234] LOG:  shutting down
2023-01-10 11:02:49.239 GMT [43232] LOG:  database system is shut down
2023-01-10 11:02:51.287 GMT [43500] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:02:51.288 GMT [43500] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:02:51.289 GMT [43500] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:02:51.295 GMT [43501] LOG:  database system was shut down at 2023-01-10 11:02:50 GMT
2023-01-10 11:02:51.303 GMT [43500] LOG:  database system is ready to accept connections
2023-01-10 11:02:52.174 GMT [43529] ERROR:  syntax error at or near "," at character 355
2023-01-10 11:02:52.174 GMT [43529] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE success INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
	        success = 1;
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT'
	        success = 0;
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:52.175 GMT [43529] ERROR:  syntax error at or near "," at character 236
2023-01-10 11:02:52.175 GMT [43529] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    SELECT id INTO customer_id FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:02:52.175 GMT [43529] ERROR:  syntax error at or near "INT" at character 177
2023-01-10 11:02:52.175 GMT [43529] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT. question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN'
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:04:00.896 GMT [43500] LOG:  received fast shutdown request
2023-01-10 11:04:00.899 GMT [43500] LOG:  aborting any active transactions
2023-01-10 11:04:00.906 GMT [43500] LOG:  background worker "logical replication launcher" (PID 43507) exited with exit code 1
2023-01-10 11:04:00.907 GMT [43502] LOG:  shutting down
2023-01-10 11:04:00.956 GMT [43500] LOG:  database system is shut down
2023-01-10 11:04:03.899 GMT [43826] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:04:03.900 GMT [43826] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:04:03.901 GMT [43826] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:04:03.907 GMT [43827] LOG:  database system was shut down at 2023-01-10 11:04:03 GMT
2023-01-10 11:04:03.913 GMT [43826] LOG:  database system is ready to accept connections
2023-01-10 11:04:04.874 GMT [43855] ERROR:  syntax error at or near "," at character 355
2023-01-10 11:04:04.874 GMT [43855] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE success INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM customer WHERE first_name = first_name, last_name = last_name, email_address = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
	        success = 1;
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT'
	        success = 0;
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:04:04.876 GMT [43855] ERROR:  syntax error at or near "=" at character 1316
2023-01-10 11:04:04.876 GMT [43855] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN'
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:04:25.218 GMT [43826] LOG:  received fast shutdown request
2023-01-10 11:04:25.219 GMT [43826] LOG:  aborting any active transactions
2023-01-10 11:04:25.224 GMT [43826] LOG:  background worker "logical replication launcher" (PID 43833) exited with exit code 1
2023-01-10 11:04:25.227 GMT [43828] LOG:  shutting down
2023-01-10 11:04:25.278 GMT [43826] LOG:  database system is shut down
2023-01-10 11:04:26.998 GMT [44026] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:04:26.998 GMT [44026] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:04:26.999 GMT [44026] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:04:27.004 GMT [44027] LOG:  database system was shut down at 2023-01-10 11:04:26 GMT
2023-01-10 11:04:27.009 GMT [44026] LOG:  database system is ready to accept connections
2023-01-10 11:04:27.878 GMT [44052] ERROR:  syntax error at or near "success" at character 697
2023-01-10 11:04:27.878 GMT [44052] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE success INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM customer WHERE first_name = first_name AND last_name = last_name AND email_address = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
	        success = 1;
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT'
	        success = 0;
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:04:27.880 GMT [44052] ERROR:  syntax error at or near "=" at character 1316
2023-01-10 11:04:27.880 GMT [44052] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN'
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-10 11:05:02.904 GMT [44026] LOG:  received fast shutdown request
2023-01-10 11:05:02.905 GMT [44026] LOG:  aborting any active transactions
2023-01-10 11:05:02.910 GMT [44026] LOG:  background worker "logical replication launcher" (PID 44033) exited with exit code 1
2023-01-10 11:05:02.912 GMT [44028] LOG:  shutting down
2023-01-10 11:05:02.955 GMT [44026] LOG:  database system is shut down
2023-01-10 11:05:04.842 GMT [44266] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-10 11:05:04.842 GMT [44266] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-10 11:05:04.843 GMT [44266] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-10 11:05:04.846 GMT [44267] LOG:  database system was shut down at 2023-01-10 11:05:04 GMT
2023-01-10 11:05:04.856 GMT [44266] LOG:  database system is ready to accept connections
2023-01-10 11:05:05.856 GMT [44299] ERROR:  syntax error at or near "=" at character 1316
2023-01-10 11:05:05.856 GMT [44299] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-11 08:02:34.800 GMT [12950] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:02:34.806 GMT [12950] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:02:34.808 GMT [12950] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:02:34.813 GMT [12951] LOG:  database system was shut down at 2023-01-11 08:02:34 GMT
2023-01-11 08:02:34.818 GMT [12950] LOG:  database system is ready to accept connections
2023-01-11 08:02:35.670 GMT [12979] ERROR:  syntax error at or near "overdraft_limit" at character 112
2023-01-11 08:02:35.670 GMT [12979] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2)
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_id INT REFERENCES debit_account(id)
	);
2023-01-11 08:02:35.737 GMT [12979] ERROR:  column loan.loan_duration does not exist at character 81
2023-01-11 08:02:35.737 GMT [12979] STATEMENT:  CREATE OR REPLACE VIEW client.client_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN client_online_account_details ON loan.account_id = client_online_account_details.id;
2023-01-11 08:02:35.738 GMT [12979] ERROR:  relation "client_loans" does not exist at character 133
2023-01-11 08:02:35.738 GMT [12979] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_applications AS
	SELECT loan_application.application_status, loan_application.loan_id
	FROM client_loans
	RIGHT JOIN loan_application ON client_loans.id = loan_application.loan_id;
2023-01-11 08:02:35.738 GMT [12979] ERROR:  relation "client_loans" does not exist at character 145
2023-01-11 08:02:35.738 GMT [12979] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_statements AS
	SELECT loan_statement.starting_date, loan_statement.amount, loan_statement.loan_id
	FROM client_loans
	RIGHT JOIN loan_statement ON client_loans.id = loan_statement.loan_id;
2023-01-11 08:02:35.769 GMT [12979] ERROR:  syntax error at or near "=" at character 1316
2023-01-11 08:02:35.769 GMT [12979] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        CREATE ROLE 
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-11 08:02:35.771 GMT [12979] ERROR:  invalid input syntax for type integer: "John" at character 30
2023-01-11 08:02:35.771 GMT [12979] STATEMENT:  INSERT INTO customer
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
2023-01-11 08:02:35.772 GMT [12979] ERROR:  syntax error at or near "INSERT" at character 267
2023-01-11 08:02:35.772 GMT [12979] STATEMENT:  INSERT INTO online_account
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7)
	
	INSERT INTO user_login
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:02:35.772 GMT [12979] ERROR:  invalid input syntax for type integer: "What is your favourite colour?" at character 46
2023-01-11 08:02:35.772 GMT [12979] STATEMENT:  INSERT INTO security_question_option
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:02:35.774 GMT [12979] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:02:35.774 GMT [12979] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:02:35.774 GMT [12979] STATEMENT:  INSERT INTO user_login_security_question
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:02:35.774 GMT [12979] ERROR:  invalid input syntax for type integer: "Red" at character 46
2023-01-11 08:02:35.774 GMT [12979] STATEMENT:  INSERT INTO security_question_answer
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:02:35.782 GMT [12979] ERROR:  invalid input syntax for type integer: "2024-01-01" at character 26
2023-01-11 08:02:35.782 GMT [12979] STATEMENT:  INSERT INTO loan
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:03:37.680 GMT [12950] LOG:  received fast shutdown request
2023-01-11 08:03:37.682 GMT [12950] LOG:  aborting any active transactions
2023-01-11 08:03:37.686 GMT [12950] LOG:  background worker "logical replication launcher" (PID 12957) exited with exit code 1
2023-01-11 08:03:37.686 GMT [12952] LOG:  shutting down
2023-01-11 08:03:37.738 GMT [12950] LOG:  database system is shut down
2023-01-11 08:03:39.590 GMT [13250] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:03:39.590 GMT [13250] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:03:39.591 GMT [13250] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:03:39.595 GMT [13251] LOG:  database system was shut down at 2023-01-11 08:03:39 GMT
2023-01-11 08:03:39.600 GMT [13250] LOG:  database system is ready to accept connections
2023-01-11 08:03:40.282 GMT [13286] ERROR:  syntax error at or near "overdraft_limit" at character 112
2023-01-11 08:03:40.282 GMT [13286] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2)
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_id INT REFERENCES debit_account(id)
	);
2023-01-11 08:03:40.348 GMT [13286] ERROR:  column loan.loan_duration does not exist at character 81
2023-01-11 08:03:40.348 GMT [13286] STATEMENT:  CREATE OR REPLACE VIEW client.client_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_duration, loan.loan_type
	FROM loan
	LEFT JOIN client_online_account_details ON loan.account_id = client_online_account_details.id;
2023-01-11 08:03:40.349 GMT [13286] ERROR:  relation "client_loans" does not exist at character 133
2023-01-11 08:03:40.349 GMT [13286] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_applications AS
	SELECT loan_application.application_status, loan_application.loan_id
	FROM client_loans
	RIGHT JOIN loan_application ON client_loans.id = loan_application.loan_id;
2023-01-11 08:03:40.349 GMT [13286] ERROR:  relation "client_loans" does not exist at character 145
2023-01-11 08:03:40.349 GMT [13286] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_statements AS
	SELECT loan_statement.starting_date, loan_statement.amount, loan_statement.loan_id
	FROM client_loans
	RIGHT JOIN loan_statement ON client_loans.id = loan_statement.loan_id;
2023-01-11 08:03:40.385 GMT [13286] ERROR:  invalid input syntax for type integer: "John" at character 30
2023-01-11 08:03:40.385 GMT [13286] STATEMENT:  INSERT INTO customer
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
2023-01-11 08:03:40.385 GMT [13286] ERROR:  syntax error at or near "INSERT" at character 267
2023-01-11 08:03:40.385 GMT [13286] STATEMENT:  INSERT INTO online_account
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7)
	
	INSERT INTO user_login
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:03:40.385 GMT [13286] ERROR:  invalid input syntax for type integer: "What is your favourite colour?" at character 46
2023-01-11 08:03:40.385 GMT [13286] STATEMENT:  INSERT INTO security_question_option
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:03:40.387 GMT [13286] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:03:40.387 GMT [13286] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:03:40.387 GMT [13286] STATEMENT:  INSERT INTO user_login_security_question
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:03:40.388 GMT [13286] ERROR:  invalid input syntax for type integer: "Red" at character 46
2023-01-11 08:03:40.388 GMT [13286] STATEMENT:  INSERT INTO security_question_answer
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:03:40.396 GMT [13286] ERROR:  invalid input syntax for type integer: "2024-01-01" at character 26
2023-01-11 08:03:40.396 GMT [13286] STATEMENT:  INSERT INTO loan
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:04:40.789 GMT [13250] LOG:  received fast shutdown request
2023-01-11 08:04:40.790 GMT [13250] LOG:  aborting any active transactions
2023-01-11 08:04:40.795 GMT [13250] LOG:  background worker "logical replication launcher" (PID 13257) exited with exit code 1
2023-01-11 08:04:40.796 GMT [13252] LOG:  shutting down
2023-01-11 08:04:40.839 GMT [13250] LOG:  database system is shut down
2023-01-11 08:04:43.021 GMT [13646] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:04:43.022 GMT [13646] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:04:43.023 GMT [13646] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:04:43.027 GMT [13647] LOG:  database system was shut down at 2023-01-11 08:04:42 GMT
2023-01-11 08:04:43.032 GMT [13646] LOG:  database system is ready to accept connections
2023-01-11 08:04:43.863 GMT [13675] ERROR:  invalid input syntax for type integer: "John" at character 30
2023-01-11 08:04:43.863 GMT [13675] STATEMENT:  INSERT INTO customer
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
2023-01-11 08:04:43.863 GMT [13675] ERROR:  syntax error at or near "INSERT" at character 267
2023-01-11 08:04:43.863 GMT [13675] STATEMENT:  INSERT INTO online_account
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7)
	
	INSERT INTO user_login
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:04:43.864 GMT [13675] ERROR:  invalid input syntax for type integer: "What is your favourite colour?" at character 46
2023-01-11 08:04:43.864 GMT [13675] STATEMENT:  INSERT INTO security_question_option
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:04:43.864 GMT [13675] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:04:43.864 GMT [13675] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:04:43.864 GMT [13675] STATEMENT:  INSERT INTO user_login_security_question
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:04:43.865 GMT [13675] ERROR:  invalid input syntax for type integer: "Red" at character 46
2023-01-11 08:04:43.865 GMT [13675] STATEMENT:  INSERT INTO security_question_answer
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:04:43.870 GMT [13675] ERROR:  invalid input syntax for type integer: "2024-01-01" at character 26
2023-01-11 08:04:43.870 GMT [13675] STATEMENT:  INSERT INTO loan
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:06:13.277 GMT [13646] LOG:  received fast shutdown request
2023-01-11 08:06:13.279 GMT [13646] LOG:  aborting any active transactions
2023-01-11 08:06:13.283 GMT [13646] LOG:  background worker "logical replication launcher" (PID 13653) exited with exit code 1
2023-01-11 08:06:13.284 GMT [13648] LOG:  shutting down
2023-01-11 08:06:13.329 GMT [13646] LOG:  database system is shut down
2023-01-11 08:06:15.462 GMT [14044] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:06:15.463 GMT [14044] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:06:15.472 GMT [14044] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:06:15.476 GMT [14048] LOG:  database system was shut down at 2023-01-11 08:06:15 GMT
2023-01-11 08:06:15.482 GMT [14044] LOG:  database system is ready to accept connections
2023-01-11 08:06:16.211 GMT [14073] ERROR:  invalid input syntax for type integer: "John" at character 30
2023-01-11 08:06:16.211 GMT [14073] STATEMENT:  INSERT INTO customer
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
2023-01-11 08:06:16.212 GMT [14073] ERROR:  invalid input syntax for type integer: "2020-01-01" at character 36
2023-01-11 08:06:16.212 GMT [14073] STATEMENT:  INSERT INTO online_account
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7);
2023-01-11 08:06:16.212 GMT [14073] ERROR:  invalid input syntax for type integer: "johnsmith" at character 35
2023-01-11 08:06:16.212 GMT [14073] STATEMENT:  INSERT INTO user_login
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:06:16.212 GMT [14073] ERROR:  invalid input syntax for type integer: "What is your favourite colour?" at character 46
2023-01-11 08:06:16.212 GMT [14073] STATEMENT:  INSERT INTO security_question_option
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:06:16.215 GMT [14073] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:06:16.215 GMT [14073] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:06:16.215 GMT [14073] STATEMENT:  INSERT INTO user_login_security_question
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:06:16.216 GMT [14073] ERROR:  invalid input syntax for type integer: "Red" at character 46
2023-01-11 08:06:16.216 GMT [14073] STATEMENT:  INSERT INTO security_question_answer
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:06:16.223 GMT [14073] ERROR:  invalid input syntax for type integer: "2024-01-01" at character 26
2023-01-11 08:06:16.223 GMT [14073] STATEMENT:  INSERT INTO loan
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:08:05.434 GMT [14044] LOG:  received fast shutdown request
2023-01-11 08:08:05.436 GMT [14044] LOG:  aborting any active transactions
2023-01-11 08:08:05.440 GMT [14044] LOG:  background worker "logical replication launcher" (PID 14054) exited with exit code 1
2023-01-11 08:08:05.440 GMT [14049] LOG:  shutting down
2023-01-11 08:08:05.483 GMT [14044] LOG:  database system is shut down
2023-01-11 08:08:07.244 GMT [14460] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:08:07.244 GMT [14460] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:08:07.245 GMT [14460] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:08:07.250 GMT [14461] LOG:  database system was shut down at 2023-01-11 08:08:07 GMT
2023-01-11 08:08:07.257 GMT [14460] LOG:  database system is ready to accept connections
2023-01-11 08:08:08.059 GMT [14499] ERROR:  invalid input syntax for type integer: "2020-01-01" at character 36
2023-01-11 08:08:08.059 GMT [14499] STATEMENT:  INSERT INTO online_account
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7);
2023-01-11 08:08:08.059 GMT [14499] ERROR:  invalid input syntax for type integer: "johnsmith" at character 35
2023-01-11 08:08:08.059 GMT [14499] STATEMENT:  INSERT INTO user_login
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:08:08.060 GMT [14499] ERROR:  invalid input syntax for type integer: "What is your favourite colour?" at character 46
2023-01-11 08:08:08.060 GMT [14499] STATEMENT:  INSERT INTO security_question_option
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:08:08.063 GMT [14499] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:08:08.063 GMT [14499] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:08:08.063 GMT [14499] STATEMENT:  INSERT INTO user_login_security_question
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:08:08.064 GMT [14499] ERROR:  invalid input syntax for type integer: "Red" at character 46
2023-01-11 08:08:08.064 GMT [14499] STATEMENT:  INSERT INTO security_question_answer
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:08:08.068 GMT [14499] ERROR:  invalid input syntax for type integer: "2024-01-01" at character 26
2023-01-11 08:08:08.068 GMT [14499] STATEMENT:  INSERT INTO loan
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:09:12.635 GMT [14460] LOG:  received fast shutdown request
2023-01-11 08:09:12.637 GMT [14460] LOG:  aborting any active transactions
2023-01-11 08:09:12.643 GMT [14460] LOG:  background worker "logical replication launcher" (PID 14467) exited with exit code 1
2023-01-11 08:09:12.645 GMT [14462] LOG:  shutting down
2023-01-11 08:09:12.691 GMT [14460] LOG:  database system is shut down
2023-01-11 08:09:14.702 GMT [14831] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:09:14.702 GMT [14831] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:09:14.703 GMT [14831] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:09:14.708 GMT [14837] LOG:  database system was shut down at 2023-01-11 08:09:14 GMT
2023-01-11 08:09:14.713 GMT [14831] LOG:  database system is ready to accept connections
2023-01-11 08:09:15.451 GMT [14874] ERROR:  insert or update on table "online_account" violates foreign key constraint "online_account_customer_id_fkey"
2023-01-11 08:09:15.451 GMT [14874] DETAIL:  Key (customer_id)=(0) is not present in table "customer".
2023-01-11 08:09:15.451 GMT [14874] STATEMENT:  INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7);
2023-01-11 08:09:15.452 GMT [14874] ERROR:  insert or update on table "user_login" violates foreign key constraint "user_login_account_id_fkey"
2023-01-11 08:09:15.452 GMT [14874] DETAIL:  Key (account_id)=(0) is not present in table "online_account".
2023-01-11 08:09:15.452 GMT [14874] STATEMENT:  INSERT INTO user_login (account_id, username)
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:09:15.452 GMT [14874] ERROR:  column "question" of relation "security_question_option" does not exist at character 39
2023-01-11 08:09:15.452 GMT [14874] STATEMENT:  INSERT INTO security_question_option (question)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:09:15.453 GMT [14874] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:09:15.453 GMT [14874] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:09:15.453 GMT [14874] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:09:15.453 GMT [14874] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 08:09:15.453 GMT [14874] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:09:15.453 GMT [14874] ERROR:  column "balance" of relation "savings_account" does not exist at character 30
2023-01-11 08:09:15.453 GMT [14874] STATEMENT:  INSERT INTO savings_account (balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 0),
	(1000.00, 2.05, 1),
	(5000.00, 2.05, 2),
	(10000.00, 2.05, 3),
	(20000.00, 2.05, 4),
	(50000.00, 2.05, 5),
	(100000.00, 2.05, 6),
	(200000.00, 2.05, 7);
2023-01-11 08:09:15.454 GMT [14874] ERROR:  column "balance" of relation "credit_account" does not exist at character 29
2023-01-11 08:09:15.454 GMT [14874] STATEMENT:  INSERT INTO credit_account (balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 0),
	(100.00, 1000.00, 4.22, 1),
	(200.00, 5000.00, 4.22, 2),
	(300.00, 10000.00, 4.22, 3),
	(400.00, 20000.00, 4.22, 4),
	(500.00, 50000.00, 4.22, 5),
	(600.00, 100000.00, 4.22, 6),
	(700.00, 200000.00, 4.22, 7);
2023-01-11 08:09:15.454 GMT [14874] ERROR:  column "balance" of relation "debit_account" does not exist at character 28
2023-01-11 08:09:15.454 GMT [14874] STATEMENT:  INSERT INTO debit_account (balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 0),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 7);
2023-01-11 08:09:15.454 GMT [14874] ERROR:  column "interest_rate" of relation "loan" does not exist at character 32
2023-01-11 08:09:15.454 GMT [14874] STATEMENT:  INSERT INTO loan (loan_amount, interest_rate, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:09:58.575 GMT [14831] LOG:  received fast shutdown request
2023-01-11 08:09:58.576 GMT [14831] LOG:  aborting any active transactions
2023-01-11 08:09:58.583 GMT [14831] LOG:  background worker "logical replication launcher" (PID 14845) exited with exit code 1
2023-01-11 08:09:58.584 GMT [14840] LOG:  shutting down
2023-01-11 08:09:58.628 GMT [14831] LOG:  database system is shut down
2023-01-11 08:10:00.361 GMT [15092] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:10:00.361 GMT [15092] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:10:00.363 GMT [15092] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:10:00.368 GMT [15093] LOG:  database system was shut down at 2023-01-11 08:10:00 GMT
2023-01-11 08:10:00.373 GMT [15092] LOG:  database system is ready to accept connections
2023-01-11 08:10:01.103 GMT [15131] ERROR:  insert or update on table "online_account" violates foreign key constraint "online_account_customer_id_fkey"
2023-01-11 08:10:01.103 GMT [15131] DETAIL:  Key (customer_id)=(0) is not present in table "customer".
2023-01-11 08:10:01.103 GMT [15131] STATEMENT:  INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 0),
	('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7);
2023-01-11 08:10:01.104 GMT [15131] ERROR:  insert or update on table "user_login" violates foreign key constraint "user_login_account_id_fkey"
2023-01-11 08:10:01.104 GMT [15131] DETAIL:  Key (account_id)=(0) is not present in table "online_account".
2023-01-11 08:10:01.104 GMT [15131] STATEMENT:  INSERT INTO user_login (account_id, username)
	VALUES (0, 'johnsmith'),
	(1, 'janedoe'),
	(2, 'joebloggs'),
	(3, 'johnbloggs'),
	(4, 'janebloggs'),
	(5, 'joedoe'),
	(6, 'johndoe'),
	(7, 'joesmith'),
	(8, 'janesmith');
2023-01-11 08:10:01.105 GMT [15131] ERROR:  column "question" of relation "security_question_option" does not exist at character 39
2023-01-11 08:10:01.105 GMT [15131] STATEMENT:  INSERT INTO security_question_option (question)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:10:01.106 GMT [15131] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:10:01.106 GMT [15131] DETAIL:  Key (question_choice_id)=(0) is not present in table "security_question_option".
2023-01-11 08:10:01.106 GMT [15131] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (0, 0),
	(1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8);
2023-01-11 08:10:01.107 GMT [15131] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 08:10:01.107 GMT [15131] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	VALUES ('Red', 0),
	('Blue', 1),
	('Green', 2),
	('Yellow', 3),
	('Orange', 4),
	('Purple', 5),
	('Pink', 6),
	('Black', 7),
	('White', 8);
2023-01-11 08:10:01.107 GMT [15131] ERROR:  column "balance" of relation "savings_account" does not exist at character 30
2023-01-11 08:10:01.107 GMT [15131] STATEMENT:  INSERT INTO savings_account (balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 0),
	(1000.00, 2.05, 1),
	(5000.00, 2.05, 2),
	(10000.00, 2.05, 3),
	(20000.00, 2.05, 4),
	(50000.00, 2.05, 5),
	(100000.00, 2.05, 6),
	(200000.00, 2.05, 7);
2023-01-11 08:10:01.107 GMT [15131] ERROR:  column "balance" of relation "credit_account" does not exist at character 29
2023-01-11 08:10:01.107 GMT [15131] STATEMENT:  INSERT INTO credit_account (balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 0),
	(100.00, 1000.00, 4.22, 1),
	(200.00, 5000.00, 4.22, 2),
	(300.00, 10000.00, 4.22, 3),
	(400.00, 20000.00, 4.22, 4),
	(500.00, 50000.00, 4.22, 5),
	(600.00, 100000.00, 4.22, 6),
	(700.00, 200000.00, 4.22, 7);
2023-01-11 08:10:01.108 GMT [15131] ERROR:  column "balance" of relation "debit_account" does not exist at character 28
2023-01-11 08:10:01.108 GMT [15131] STATEMENT:  INSERT INTO debit_account (balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 0),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 7);
2023-01-11 08:10:01.108 GMT [15131] ERROR:  column "interest_rate" of relation "loan" does not exist at character 32
2023-01-11 08:10:01.108 GMT [15131] STATEMENT:  INSERT INTO loan (loan_amount, interest_rate, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 0),
	('2023-03-04', 300000, 'mortgage', 0),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:13:23.175 GMT [15092] LOG:  received fast shutdown request
2023-01-11 08:13:23.176 GMT [15092] LOG:  aborting any active transactions
2023-01-11 08:13:23.180 GMT [15092] LOG:  background worker "logical replication launcher" (PID 15099) exited with exit code 1
2023-01-11 08:13:23.180 GMT [15094] LOG:  shutting down
2023-01-11 08:13:23.222 GMT [15092] LOG:  database system is shut down
2023-01-11 08:13:25.029 GMT [15866] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:13:25.029 GMT [15866] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:13:25.031 GMT [15866] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:13:25.035 GMT [15867] LOG:  database system was shut down at 2023-01-11 08:13:24 GMT
2023-01-11 08:13:25.039 GMT [15866] LOG:  database system is ready to accept connections
2023-01-11 08:13:25.839 GMT [15904] ERROR:  insert or update on table "user_login" violates foreign key constraint "user_login_account_id_fkey"
2023-01-11 08:13:25.839 GMT [15904] DETAIL:  Key (account_id)=(9) is not present in table "online_account".
2023-01-11 08:13:25.839 GMT [15904] STATEMENT:  INSERT INTO user_login (account_id, username)
	VALUES (1, 'johnsmith'),
	(2, 'janedoe'),
	(3, 'joebloggs'),
	(4, 'johnbloggs'),
	(5, 'janebloggs'),
	(6, 'joedoe'),
	(7, 'johndoe'),
	(8, 'joesmith'),
	(9, 'janesmith');
2023-01-11 08:13:25.839 GMT [15904] ERROR:  column "question" of relation "security_question_option" does not exist at character 39
2023-01-11 08:13:25.839 GMT [15904] STATEMENT:  INSERT INTO security_question_option (question)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:13:25.840 GMT [15904] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:13:25.840 GMT [15904] DETAIL:  Key (question_choice_id)=(1) is not present in table "security_question_option".
2023-01-11 08:13:25.840 GMT [15904] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
2023-01-11 08:13:25.840 GMT [15904] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 08:13:25.840 GMT [15904] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-11 08:13:25.840 GMT [15904] ERROR:  column "balance" of relation "savings_account" does not exist at character 30
2023-01-11 08:13:25.840 GMT [15904] STATEMENT:  INSERT INTO savings_account (balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
2023-01-11 08:13:25.840 GMT [15904] ERROR:  column "balance" of relation "credit_account" does not exist at character 29
2023-01-11 08:13:25.840 GMT [15904] STATEMENT:  INSERT INTO credit_account (balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
2023-01-11 08:13:25.841 GMT [15904] ERROR:  column "balance" of relation "debit_account" does not exist at character 28
2023-01-11 08:13:25.841 GMT [15904] STATEMENT:  INSERT INTO debit_account (balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
2023-01-11 08:13:25.841 GMT [15904] ERROR:  column "interest_rate" of relation "loan" does not exist at character 32
2023-01-11 08:13:25.841 GMT [15904] STATEMENT:  INSERT INTO loan (loan_amount, interest_rate, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:14:21.002 GMT [15866] LOG:  received fast shutdown request
2023-01-11 08:14:21.004 GMT [15866] LOG:  aborting any active transactions
2023-01-11 08:14:21.009 GMT [15866] LOG:  background worker "logical replication launcher" (PID 15873) exited with exit code 1
2023-01-11 08:14:21.013 GMT [15868] LOG:  shutting down
2023-01-11 08:14:21.054 GMT [15866] LOG:  database system is shut down
2023-01-11 08:14:22.789 GMT [16181] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:14:22.790 GMT [16181] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:14:22.791 GMT [16181] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:14:22.796 GMT [16186] LOG:  database system was shut down at 2023-01-11 08:14:22 GMT
2023-01-11 08:14:22.805 GMT [16181] LOG:  database system is ready to accept connections
2023-01-11 08:14:23.533 GMT [16222] ERROR:  column "question" of relation "security_question_option" does not exist at character 39
2023-01-11 08:14:23.533 GMT [16222] STATEMENT:  INSERT INTO security_question_option (question)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-11 08:14:23.534 GMT [16222] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-11 08:14:23.534 GMT [16222] DETAIL:  Key (question_choice_id)=(1) is not present in table "security_question_option".
2023-01-11 08:14:23.534 GMT [16222] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
2023-01-11 08:14:23.534 GMT [16222] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 08:14:23.534 GMT [16222] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-11 08:14:23.535 GMT [16222] ERROR:  column "balance" of relation "savings_account" does not exist at character 30
2023-01-11 08:14:23.535 GMT [16222] STATEMENT:  INSERT INTO savings_account (balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
2023-01-11 08:14:23.535 GMT [16222] ERROR:  column "balance" of relation "credit_account" does not exist at character 29
2023-01-11 08:14:23.535 GMT [16222] STATEMENT:  INSERT INTO credit_account (balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
2023-01-11 08:14:23.535 GMT [16222] ERROR:  column "balance" of relation "debit_account" does not exist at character 28
2023-01-11 08:14:23.535 GMT [16222] STATEMENT:  INSERT INTO debit_account (balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
2023-01-11 08:14:23.535 GMT [16222] ERROR:  column "interest_rate" of relation "loan" does not exist at character 32
2023-01-11 08:14:23.535 GMT [16222] STATEMENT:  INSERT INTO loan (loan_amount, interest_rate, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:14:54.421 GMT [16181] LOG:  received fast shutdown request
2023-01-11 08:14:54.423 GMT [16181] LOG:  aborting any active transactions
2023-01-11 08:14:54.425 GMT [16181] LOG:  background worker "logical replication launcher" (PID 16194) exited with exit code 1
2023-01-11 08:14:54.428 GMT [16189] LOG:  shutting down
2023-01-11 08:14:54.472 GMT [16181] LOG:  database system is shut down
2023-01-11 08:14:56.451 GMT [16404] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:14:56.451 GMT [16404] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:14:56.453 GMT [16404] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:14:56.458 GMT [16413] LOG:  database system was shut down at 2023-01-11 08:14:56 GMT
2023-01-11 08:14:56.464 GMT [16404] LOG:  database system is ready to accept connections
2023-01-11 08:14:57.206 GMT [16442] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 08:14:57.206 GMT [16442] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-11 08:14:57.206 GMT [16442] ERROR:  column "balance" of relation "savings_account" does not exist at character 30
2023-01-11 08:14:57.206 GMT [16442] STATEMENT:  INSERT INTO savings_account (balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
2023-01-11 08:14:57.206 GMT [16442] ERROR:  column "balance" of relation "credit_account" does not exist at character 29
2023-01-11 08:14:57.206 GMT [16442] STATEMENT:  INSERT INTO credit_account (balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
2023-01-11 08:14:57.207 GMT [16442] ERROR:  column "balance" of relation "debit_account" does not exist at character 28
2023-01-11 08:14:57.207 GMT [16442] STATEMENT:  INSERT INTO debit_account (balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
2023-01-11 08:14:57.207 GMT [16442] ERROR:  column "interest_rate" of relation "loan" does not exist at character 32
2023-01-11 08:14:57.207 GMT [16442] STATEMENT:  INSERT INTO loan (loan_amount, interest_rate, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:16:42.452 GMT [16404] LOG:  received fast shutdown request
2023-01-11 08:16:42.453 GMT [16404] LOG:  aborting any active transactions
2023-01-11 08:16:42.459 GMT [16404] LOG:  background worker "logical replication launcher" (PID 16420) exited with exit code 1
2023-01-11 08:16:42.459 GMT [16415] LOG:  shutting down
2023-01-11 08:16:42.498 GMT [16404] LOG:  database system is shut down
2023-01-11 08:16:44.212 GMT [16860] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:16:44.212 GMT [16860] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:16:44.213 GMT [16860] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:16:44.218 GMT [16861] LOG:  database system was shut down at 2023-01-11 08:16:43 GMT
2023-01-11 08:16:44.224 GMT [16860] LOG:  database system is ready to accept connections
2023-01-11 08:16:44.931 GMT [16903] ERROR:  column "online_account_id" of relation "savings_account" does not exist at character 62
2023-01-11 08:16:44.931 GMT [16903] STATEMENT:  INSERT INTO savings_account (current_balance, interest_rate, online_account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
2023-01-11 08:16:44.932 GMT [16903] ERROR:  column "online_account_id" of relation "credit_account" does not exist at character 79
2023-01-11 08:16:44.932 GMT [16903] STATEMENT:  INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, online_account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
2023-01-11 08:16:44.932 GMT [16903] ERROR:  column "overdraft_limit" of relation "debit_account" does not exist at character 45
2023-01-11 08:16:44.932 GMT [16903] STATEMENT:  INSERT INTO debit_account (current_balance, overdraft_limit, interest_rate, online_account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
2023-01-11 08:16:44.932 GMT [16903] ERROR:  column "online_account_id" of relation "loan" does not exist at character 58
2023-01-11 08:16:44.932 GMT [16903] STATEMENT:  INSERT INTO loan (loan_end_date, loan_amount, loan_type, online_account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
2023-01-11 08:17:20.258 GMT [16860] LOG:  received fast shutdown request
2023-01-11 08:17:20.259 GMT [16860] LOG:  aborting any active transactions
2023-01-11 08:17:20.263 GMT [16860] LOG:  background worker "logical replication launcher" (PID 16867) exited with exit code 1
2023-01-11 08:17:20.264 GMT [16862] LOG:  shutting down
2023-01-11 08:17:20.313 GMT [16860] LOG:  database system is shut down
2023-01-11 08:17:23.592 GMT [17157] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:17:23.592 GMT [17157] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:17:23.593 GMT [17157] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:17:23.599 GMT [17158] LOG:  database system was shut down at 2023-01-11 08:17:23 GMT
2023-01-11 08:17:23.604 GMT [17157] LOG:  database system is ready to accept connections
2023-01-11 08:17:24.349 GMT [17198] ERROR:  column "overdraft_limit" of relation "debit_account" does not exist at character 45
2023-01-11 08:17:24.349 GMT [17198] STATEMENT:  INSERT INTO debit_account (current_balance, overdraft_limit, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
2023-01-11 08:17:42.497 GMT [17157] LOG:  received fast shutdown request
2023-01-11 08:17:42.499 GMT [17157] LOG:  aborting any active transactions
2023-01-11 08:17:42.503 GMT [17157] LOG:  background worker "logical replication launcher" (PID 17164) exited with exit code 1
2023-01-11 08:17:42.504 GMT [17159] LOG:  shutting down
2023-01-11 08:17:42.546 GMT [17157] LOG:  database system is shut down
2023-01-11 08:17:44.084 GMT [17347] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:17:44.084 GMT [17347] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:17:44.085 GMT [17347] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:17:44.090 GMT [17348] LOG:  database system was shut down at 2023-01-11 08:17:43 GMT
2023-01-11 08:17:44.095 GMT [17347] LOG:  database system is ready to accept connections
2023-01-11 08:18:48.762 GMT [17347] LOG:  received fast shutdown request
2023-01-11 08:18:48.763 GMT [17347] LOG:  aborting any active transactions
2023-01-11 08:18:48.769 GMT [17347] LOG:  background worker "logical replication launcher" (PID 17354) exited with exit code 1
2023-01-11 08:18:48.769 GMT [17349] LOG:  shutting down
2023-01-11 08:18:48.812 GMT [17347] LOG:  database system is shut down
2023-01-11 08:18:50.766 GMT [17711] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:18:50.766 GMT [17711] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:18:50.767 GMT [17711] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:18:50.772 GMT [17712] LOG:  database system was shut down at 2023-01-11 08:18:50 GMT
2023-01-11 08:18:50.779 GMT [17711] LOG:  database system is ready to accept connections
2023-01-11 08:19:37.665 GMT [17711] LOG:  received fast shutdown request
2023-01-11 08:19:37.667 GMT [17711] LOG:  aborting any active transactions
2023-01-11 08:19:37.672 GMT [17711] LOG:  background worker "logical replication launcher" (PID 17719) exited with exit code 1
2023-01-11 08:19:37.672 GMT [17713] LOG:  shutting down
2023-01-11 08:19:37.715 GMT [17711] LOG:  database system is shut down
2023-01-11 08:19:39.646 GMT [17997] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:19:39.646 GMT [17997] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:19:39.648 GMT [17997] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:19:39.652 GMT [17998] LOG:  database system was shut down at 2023-01-11 08:19:39 GMT
2023-01-11 08:19:39.658 GMT [17997] LOG:  database system is ready to accept connections
2023-01-11 08:19:46.424 GMT [17997] LOG:  received fast shutdown request
2023-01-11 08:19:46.425 GMT [17997] LOG:  aborting any active transactions
2023-01-11 08:19:46.429 GMT [17997] LOG:  background worker "logical replication launcher" (PID 18004) exited with exit code 1
2023-01-11 08:19:46.429 GMT [17999] LOG:  shutting down
2023-01-11 08:19:46.474 GMT [17997] LOG:  database system is shut down
2023-01-11 08:19:48.173 GMT [18158] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:19:48.174 GMT [18158] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:19:48.176 GMT [18158] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:19:48.181 GMT [18159] LOG:  database system was shut down at 2023-01-11 08:19:47 GMT
2023-01-11 08:19:48.187 GMT [18158] LOG:  database system is ready to accept connections
2023-01-11 08:20:35.481 GMT [18158] LOG:  received fast shutdown request
2023-01-11 08:20:35.483 GMT [18158] LOG:  aborting any active transactions
2023-01-11 08:20:35.488 GMT [18158] LOG:  background worker "logical replication launcher" (PID 18165) exited with exit code 1
2023-01-11 08:20:35.489 GMT [18160] LOG:  shutting down
2023-01-11 08:20:35.536 GMT [18158] LOG:  database system is shut down
2023-01-11 08:20:37.170 GMT [18431] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:20:37.170 GMT [18431] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:20:37.171 GMT [18431] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:20:37.176 GMT [18432] LOG:  database system was shut down at 2023-01-11 08:20:36 GMT
2023-01-11 08:20:37.181 GMT [18431] LOG:  database system is ready to accept connections
2023-01-11 08:21:06.782 GMT [18431] LOG:  received fast shutdown request
2023-01-11 08:21:06.783 GMT [18431] LOG:  aborting any active transactions
2023-01-11 08:21:06.788 GMT [18431] LOG:  background worker "logical replication launcher" (PID 18438) exited with exit code 1
2023-01-11 08:21:06.788 GMT [18433] LOG:  shutting down
2023-01-11 08:21:06.835 GMT [18431] LOG:  database system is shut down
2023-01-11 08:21:08.478 GMT [18637] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:21:08.478 GMT [18637] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:21:08.479 GMT [18637] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:21:08.484 GMT [18638] LOG:  database system was shut down at 2023-01-11 08:21:08 GMT
2023-01-11 08:21:08.488 GMT [18637] LOG:  database system is ready to accept connections
2023-01-11 08:21:58.267 GMT [18637] LOG:  received fast shutdown request
2023-01-11 08:21:58.270 GMT [18637] LOG:  aborting any active transactions
2023-01-11 08:21:58.274 GMT [18637] LOG:  background worker "logical replication launcher" (PID 18644) exited with exit code 1
2023-01-11 08:21:58.274 GMT [18639] LOG:  shutting down
2023-01-11 08:21:58.320 GMT [18637] LOG:  database system is shut down
2023-01-11 08:21:59.943 GMT [18911] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:21:59.943 GMT [18911] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:21:59.945 GMT [18911] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:21:59.949 GMT [18912] LOG:  database system was shut down at 2023-01-11 08:21:59 GMT
2023-01-11 08:21:59.955 GMT [18911] LOG:  database system is ready to accept connections
2023-01-11 08:22:52.944 GMT [18911] LOG:  received fast shutdown request
2023-01-11 08:22:52.946 GMT [18911] LOG:  aborting any active transactions
2023-01-11 08:22:52.950 GMT [18911] LOG:  background worker "logical replication launcher" (PID 18918) exited with exit code 1
2023-01-11 08:22:52.953 GMT [18913] LOG:  shutting down
2023-01-11 08:22:53.000 GMT [18911] LOG:  database system is shut down
2023-01-11 08:22:54.680 GMT [19185] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:22:54.680 GMT [19185] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:22:54.682 GMT [19185] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:22:54.686 GMT [19186] LOG:  database system was shut down at 2023-01-11 08:22:54 GMT
2023-01-11 08:22:54.691 GMT [19185] LOG:  database system is ready to accept connections
2023-01-11 08:23:09.129 GMT [19185] LOG:  received fast shutdown request
2023-01-11 08:23:09.130 GMT [19185] LOG:  aborting any active transactions
2023-01-11 08:23:09.133 GMT [19185] LOG:  background worker "logical replication launcher" (PID 19192) exited with exit code 1
2023-01-11 08:23:09.135 GMT [19187] LOG:  shutting down
2023-01-11 08:23:09.180 GMT [19185] LOG:  database system is shut down
2023-01-11 08:23:10.906 GMT [19364] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:23:10.906 GMT [19364] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:23:10.908 GMT [19364] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:23:10.912 GMT [19365] LOG:  database system was shut down at 2023-01-11 08:23:10 GMT
2023-01-11 08:23:10.918 GMT [19364] LOG:  database system is ready to accept connections
2023-01-11 08:28:10.556 GMT [19364] LOG:  received fast shutdown request
2023-01-11 08:28:10.557 GMT [19364] LOG:  aborting any active transactions
2023-01-11 08:28:10.562 GMT [19364] LOG:  background worker "logical replication launcher" (PID 19371) exited with exit code 1
2023-01-11 08:28:10.563 GMT [19366] LOG:  shutting down
2023-01-11 08:28:10.605 GMT [19364] LOG:  database system is shut down
2023-01-11 08:28:12.127 GMT [20351] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:28:12.127 GMT [20351] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:28:12.129 GMT [20351] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:28:12.137 GMT [20352] LOG:  database system was shut down at 2023-01-11 08:28:11 GMT
2023-01-11 08:28:12.145 GMT [20351] LOG:  database system is ready to accept connections
2023-01-11 08:29:31.346 GMT [20351] LOG:  received fast shutdown request
2023-01-11 08:29:31.348 GMT [20351] LOG:  aborting any active transactions
2023-01-11 08:29:31.353 GMT [20351] LOG:  background worker "logical replication launcher" (PID 20358) exited with exit code 1
2023-01-11 08:29:31.353 GMT [20353] LOG:  shutting down
2023-01-11 08:29:31.402 GMT [20351] LOG:  database system is shut down
2023-01-11 08:29:33.105 GMT [20763] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:29:33.105 GMT [20763] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:29:33.107 GMT [20763] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:29:33.115 GMT [20764] LOG:  database system was shut down at 2023-01-11 08:29:32 GMT
2023-01-11 08:29:33.121 GMT [20763] LOG:  database system is ready to accept connections
2023-01-11 08:30:02.216 GMT [20763] LOG:  received fast shutdown request
2023-01-11 08:30:02.217 GMT [20763] LOG:  aborting any active transactions
2023-01-11 08:30:02.222 GMT [20763] LOG:  background worker "logical replication launcher" (PID 20770) exited with exit code 1
2023-01-11 08:30:02.222 GMT [20765] LOG:  shutting down
2023-01-11 08:30:02.264 GMT [20763] LOG:  database system is shut down
2023-01-11 08:30:04.175 GMT [20975] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:30:04.175 GMT [20975] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:30:04.176 GMT [20975] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:30:04.182 GMT [20977] LOG:  database system was shut down at 2023-01-11 08:30:03 GMT
2023-01-11 08:30:04.187 GMT [20975] LOG:  database system is ready to accept connections
2023-01-11 08:30:16.440 GMT [20975] LOG:  received fast shutdown request
2023-01-11 08:30:16.442 GMT [20975] LOG:  aborting any active transactions
2023-01-11 08:30:16.447 GMT [20975] LOG:  background worker "logical replication launcher" (PID 20985) exited with exit code 1
2023-01-11 08:30:16.450 GMT [20979] LOG:  shutting down
2023-01-11 08:30:16.495 GMT [20975] LOG:  database system is shut down
2023-01-11 08:30:18.133 GMT [21183] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:30:18.133 GMT [21183] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:30:18.136 GMT [21183] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:30:18.140 GMT [21184] LOG:  database system was shut down at 2023-01-11 08:30:17 GMT
2023-01-11 08:30:18.144 GMT [21183] LOG:  database system is ready to accept connections
2023-01-11 08:30:57.835 GMT [21183] LOG:  received fast shutdown request
2023-01-11 08:30:57.839 GMT [21183] LOG:  aborting any active transactions
2023-01-11 08:30:57.847 GMT [21183] LOG:  background worker "logical replication launcher" (PID 21190) exited with exit code 1
2023-01-11 08:30:57.847 GMT [21185] LOG:  shutting down
2023-01-11 08:30:57.904 GMT [21183] LOG:  database system is shut down
2023-01-11 08:30:59.617 GMT [21439] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:30:59.617 GMT [21439] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:30:59.619 GMT [21439] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:30:59.623 GMT [21441] LOG:  database system was shut down at 2023-01-11 08:30:59 GMT
2023-01-11 08:30:59.628 GMT [21439] LOG:  database system is ready to accept connections
2023-01-11 08:33:06.795 GMT [21439] LOG:  received fast shutdown request
2023-01-11 08:33:06.796 GMT [21439] LOG:  aborting any active transactions
2023-01-11 08:33:06.799 GMT [21439] LOG:  background worker "logical replication launcher" (PID 21448) exited with exit code 1
2023-01-11 08:33:06.803 GMT [21443] LOG:  shutting down
2023-01-11 08:33:06.846 GMT [21439] LOG:  database system is shut down
2023-01-11 08:33:08.411 GMT [21955] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:33:08.411 GMT [21955] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:33:08.413 GMT [21955] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:33:08.417 GMT [21956] LOG:  database system was shut down at 2023-01-11 08:33:08 GMT
2023-01-11 08:33:08.424 GMT [21955] LOG:  database system is ready to accept connections
2023-01-11 08:33:22.181 GMT [21955] LOG:  received fast shutdown request
2023-01-11 08:33:22.183 GMT [21955] LOG:  aborting any active transactions
2023-01-11 08:33:22.186 GMT [21955] LOG:  background worker "logical replication launcher" (PID 21962) exited with exit code 1
2023-01-11 08:33:22.189 GMT [21957] LOG:  shutting down
2023-01-11 08:33:22.249 GMT [21955] LOG:  database system is shut down
2023-01-11 08:33:23.897 GMT [22119] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:33:23.897 GMT [22119] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:33:23.898 GMT [22119] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:33:23.903 GMT [22126] LOG:  database system was shut down at 2023-01-11 08:33:23 GMT
2023-01-11 08:33:23.908 GMT [22119] LOG:  database system is ready to accept connections
2023-01-11 08:37:30.911 GMT [22119] LOG:  received fast shutdown request
2023-01-11 08:37:30.913 GMT [22119] LOG:  aborting any active transactions
2023-01-11 08:37:30.919 GMT [22119] LOG:  background worker "logical replication launcher" (PID 22134) exited with exit code 1
2023-01-11 08:37:30.919 GMT [22129] LOG:  shutting down
2023-01-11 08:37:30.961 GMT [22119] LOG:  database system is shut down
2023-01-11 08:37:32.714 GMT [23036] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:37:32.714 GMT [23036] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:37:32.718 GMT [23036] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:37:32.724 GMT [23037] LOG:  database system was shut down at 2023-01-11 08:37:32 GMT
2023-01-11 08:37:32.739 GMT [23036] LOG:  database system is ready to accept connections
2023-01-11 08:37:45.079 GMT [23036] LOG:  received fast shutdown request
2023-01-11 08:37:45.080 GMT [23036] LOG:  aborting any active transactions
2023-01-11 08:37:45.084 GMT [23036] LOG:  background worker "logical replication launcher" (PID 23044) exited with exit code 1
2023-01-11 08:37:45.084 GMT [23038] LOG:  shutting down
2023-01-11 08:37:45.124 GMT [23036] LOG:  database system is shut down
2023-01-11 08:37:46.787 GMT [23213] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:37:46.788 GMT [23213] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:37:46.789 GMT [23213] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:37:46.793 GMT [23214] LOG:  database system was shut down at 2023-01-11 08:37:46 GMT
2023-01-11 08:37:46.799 GMT [23213] LOG:  database system is ready to accept connections
2023-01-11 08:40:53.292 GMT [23213] LOG:  received fast shutdown request
2023-01-11 08:40:53.293 GMT [23213] LOG:  aborting any active transactions
2023-01-11 08:40:53.298 GMT [23213] LOG:  background worker "logical replication launcher" (PID 23220) exited with exit code 1
2023-01-11 08:40:53.299 GMT [23215] LOG:  shutting down
2023-01-11 08:40:53.357 GMT [23213] LOG:  database system is shut down
2023-01-11 08:40:55.202 GMT [23901] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:40:55.202 GMT [23901] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:40:55.203 GMT [23901] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:40:55.207 GMT [23902] LOG:  database system was shut down at 2023-01-11 08:40:54 GMT
2023-01-11 08:40:55.217 GMT [23901] LOG:  database system is ready to accept connections
2023-01-11 08:40:55.990 GMT [23947] ERROR:  unrecognized privilege type "priveleges"
2023-01-11 08:40:55.990 GMT [23947] STATEMENT:  REVOKE priveleges ON ALL TABLES IN SCHEMA public FROM postgres;
2023-01-11 08:41:13.482 GMT [23901] LOG:  received fast shutdown request
2023-01-11 08:41:13.483 GMT [23901] LOG:  aborting any active transactions
2023-01-11 08:41:13.489 GMT [23901] LOG:  background worker "logical replication launcher" (PID 23908) exited with exit code 1
2023-01-11 08:41:13.489 GMT [23903] LOG:  shutting down
2023-01-11 08:41:13.540 GMT [23901] LOG:  database system is shut down
2023-01-11 08:41:15.291 GMT [24095] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:41:15.291 GMT [24095] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:41:15.293 GMT [24095] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:41:15.298 GMT [24096] LOG:  database system was shut down at 2023-01-11 08:41:15 GMT
2023-01-11 08:41:15.303 GMT [24095] LOG:  database system is ready to accept connections
2023-01-11 08:41:16.031 GMT [24139] ERROR:  unrecognized privilege type "privilege"
2023-01-11 08:41:16.031 GMT [24139] STATEMENT:  REVOKE privilege ON ALL TABLES IN SCHEMA public FROM postgres;
2023-01-11 08:41:43.244 GMT [24095] LOG:  received fast shutdown request
2023-01-11 08:41:43.246 GMT [24095] LOG:  aborting any active transactions
2023-01-11 08:41:43.251 GMT [24095] LOG:  background worker "logical replication launcher" (PID 24102) exited with exit code 1
2023-01-11 08:41:43.253 GMT [24097] LOG:  shutting down
2023-01-11 08:41:43.305 GMT [24095] LOG:  database system is shut down
2023-01-11 08:41:45.075 GMT [24308] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:41:45.076 GMT [24308] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:41:45.077 GMT [24308] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:41:45.083 GMT [24309] LOG:  database system was shut down at 2023-01-11 08:41:44 GMT
2023-01-11 08:41:45.093 GMT [24308] LOG:  database system is ready to accept connections
2023-01-11 08:42:01.784 GMT [24308] LOG:  received fast shutdown request
2023-01-11 08:42:01.786 GMT [24308] LOG:  aborting any active transactions
2023-01-11 08:42:01.790 GMT [24308] LOG:  background worker "logical replication launcher" (PID 24315) exited with exit code 1
2023-01-11 08:42:01.793 GMT [24310] LOG:  shutting down
2023-01-11 08:42:01.854 GMT [24308] LOG:  database system is shut down
2023-01-11 08:42:03.466 GMT [24520] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:42:03.466 GMT [24520] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:42:03.467 GMT [24520] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:42:03.472 GMT [24521] LOG:  database system was shut down at 2023-01-11 08:42:03 GMT
2023-01-11 08:42:03.479 GMT [24520] LOG:  database system is ready to accept connections
2023-01-11 08:44:25.615 GMT [24520] LOG:  received fast shutdown request
2023-01-11 08:44:25.617 GMT [24520] LOG:  aborting any active transactions
2023-01-11 08:44:25.623 GMT [24520] LOG:  background worker "logical replication launcher" (PID 24527) exited with exit code 1
2023-01-11 08:44:25.625 GMT [24522] LOG:  shutting down
2023-01-11 08:44:25.669 GMT [24520] LOG:  database system is shut down
2023-01-11 08:44:27.676 GMT [25075] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:44:27.676 GMT [25075] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:44:27.677 GMT [25075] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:44:27.682 GMT [25080] LOG:  database system was shut down at 2023-01-11 08:44:27 GMT
2023-01-11 08:44:27.688 GMT [25075] LOG:  database system is ready to accept connections
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for schema client at character 15
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * FROM client.view_login;
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for schema client at character 15
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * from client.client_security_questions;
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for schema client at character 15
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * FROM client.client_online_account_details;
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for schema client at character 15
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * FROM client.client_personal_information;
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for schema client at character 15
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * FROM client.client_loans;
2023-01-11 08:44:28.483 GMT [25113] ERROR:  permission denied for table customer
2023-01-11 08:44:28.483 GMT [25113] STATEMENT:  SELECT * FROM customer;
2023-01-11 08:44:58.789 GMT [25075] LOG:  received fast shutdown request
2023-01-11 08:44:58.791 GMT [25075] LOG:  aborting any active transactions
2023-01-11 08:44:58.796 GMT [25075] LOG:  background worker "logical replication launcher" (PID 25086) exited with exit code 1
2023-01-11 08:44:58.796 GMT [25081] LOG:  shutting down
2023-01-11 08:44:58.844 GMT [25075] LOG:  database system is shut down
2023-01-11 08:45:01.173 GMT [25330] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:45:01.173 GMT [25330] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:45:01.175 GMT [25330] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:45:01.180 GMT [25338] LOG:  database system was shut down at 2023-01-11 08:45:00 GMT
2023-01-11 08:45:01.187 GMT [25330] LOG:  database system is ready to accept connections
2023-01-11 08:45:01.988 GMT [25366] ERROR:  permission denied for schema client at character 15
2023-01-11 08:45:01.988 GMT [25366] STATEMENT:  SELECT * FROM client.view_login;
2023-01-11 08:45:01.988 GMT [25366] ERROR:  permission denied for schema client at character 15
2023-01-11 08:45:01.988 GMT [25366] STATEMENT:  SELECT * from client.client_security_questions;
2023-01-11 08:45:01.988 GMT [25366] ERROR:  permission denied for schema client at character 15
2023-01-11 08:45:01.988 GMT [25366] STATEMENT:  SELECT * FROM client.client_online_account_details;
2023-01-11 08:45:01.989 GMT [25366] ERROR:  permission denied for schema client at character 15
2023-01-11 08:45:01.989 GMT [25366] STATEMENT:  SELECT * FROM client.client_personal_information;
2023-01-11 08:45:01.989 GMT [25366] ERROR:  permission denied for schema client at character 15
2023-01-11 08:45:01.989 GMT [25366] STATEMENT:  SELECT * FROM client.client_loans;
2023-01-11 08:45:01.989 GMT [25366] ERROR:  permission denied for table customer
2023-01-11 08:45:01.989 GMT [25366] STATEMENT:  SELECT * FROM customer;
2023-01-11 08:47:01.754 GMT [25330] LOG:  received fast shutdown request
2023-01-11 08:47:01.756 GMT [25330] LOG:  aborting any active transactions
2023-01-11 08:47:01.763 GMT [25330] LOG:  background worker "logical replication launcher" (PID 25344) exited with exit code 1
2023-01-11 08:47:01.763 GMT [25339] LOG:  shutting down
2023-01-11 08:47:01.812 GMT [25330] LOG:  database system is shut down
2023-01-11 08:47:03.369 GMT [25795] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 08:47:03.369 GMT [25795] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 08:47:03.370 GMT [25795] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 08:47:03.375 GMT [25796] LOG:  database system was shut down at 2023-01-11 08:47:03 GMT
2023-01-11 08:47:03.380 GMT [25795] LOG:  database system is ready to accept connections
2023-01-11 08:47:04.240 GMT [25836] ERROR:  permission denied for table customer
2023-01-11 08:47:04.240 GMT [25836] STATEMENT:  SELECT * FROM customer;
2023-01-11 09:33:09.487 GMT [25795] LOG:  received fast shutdown request
2023-01-11 09:33:09.489 GMT [25795] LOG:  aborting any active transactions
2023-01-11 09:33:09.495 GMT [25795] LOG:  background worker "logical replication launcher" (PID 25802) exited with exit code 1
2023-01-11 09:33:09.496 GMT [25797] LOG:  shutting down
2023-01-11 09:33:09.514 GMT [25795] LOG:  database system is shut down
2023-01-11 09:33:18.920 GMT [34126] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 09:33:18.920 GMT [34126] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 09:33:18.923 GMT [34126] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 09:33:18.929 GMT [34127] LOG:  database system was shut down at 2023-01-11 09:33:18 GMT
2023-01-11 09:33:18.934 GMT [34126] LOG:  database system is ready to accept connections
2023-01-11 09:33:19.796 GMT [34155] ERROR:  syntax error at or near "format" at character 1625
2023-01-11 09:33:19.796 GMT [34155] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
	DECLARE customer_id INT;
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	        success = 1;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        success = 0;
	
	
	    EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
	    EXECUTE format(
	        'SET ROLE %I', username
	    );
	    EXECUTE format(
	        'GRANT USAGE ON SCHEMA client TO %I', username
	    )
	    EXECUTE format(
	        'GRANT ALL ON ALL TABLES IN SCHEMA client TO %I', username
	    );
	    EXECUTE format(
	        'REVOKE ALL ON ALL TABLES IN SCHEMA public TO %I', username
	    );
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-11 09:33:19.843 GMT [34155] ERROR:  permission denied for table customer
2023-01-11 09:33:19.843 GMT [34155] STATEMENT:  SELECT * FROM customer;
2023-01-11 09:33:41.455 GMT [34126] LOG:  received fast shutdown request
2023-01-11 09:33:41.456 GMT [34126] LOG:  aborting any active transactions
2023-01-11 09:33:41.464 GMT [34126] LOG:  background worker "logical replication launcher" (PID 34133) exited with exit code 1
2023-01-11 09:33:41.464 GMT [34128] LOG:  shutting down
2023-01-11 09:33:41.522 GMT [34126] LOG:  database system is shut down
2023-01-11 09:33:43.395 GMT [34310] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 09:33:43.395 GMT [34310] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 09:33:43.397 GMT [34310] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 09:33:43.401 GMT [34314] LOG:  database system was shut down at 2023-01-11 09:33:43 GMT
2023-01-11 09:33:43.408 GMT [34310] LOG:  database system is ready to accept connections
2023-01-11 09:33:44.319 GMT [34353] ERROR:  permission denied for table customer
2023-01-11 09:33:44.319 GMT [34353] STATEMENT:  SELECT * FROM customer;
2023-01-11 10:02:39.205 GMT [39544] ERROR:  role "l1" already exists
2023-01-11 10:02:39.205 GMT [39544] STATEMENT:  CREATE ROLE l1 WITH CREATEDB CREATEROLE SUPERUSER;
2023-01-11 10:02:39.206 GMT [39544] ERROR:  role "l2" already exists
2023-01-11 10:02:39.206 GMT [39544] STATEMENT:  CREATE ROLE l2 WITH CREATEROLE;
2023-01-11 10:02:39.206 GMT [39544] ERROR:  role "l3" already exists
2023-01-11 10:02:39.206 GMT [39544] STATEMENT:  CREATE ROLE l3 WITH CREATEROLE;
2023-01-11 10:02:39.206 GMT [39544] ERROR:  role "l4" already exists
2023-01-11 10:02:39.206 GMT [39544] STATEMENT:  CREATE ROLE l4;
2023-01-11 10:02:39.207 GMT [39544] ERROR:  role "l5" already exists
2023-01-11 10:02:39.207 GMT [39544] STATEMENT:  CREATE ROLE l5;
2023-01-11 10:02:39.208 GMT [39544] ERROR:  role "manager" already exists
2023-01-11 10:02:39.208 GMT [39544] STATEMENT:  CREATE ROLE manager WITH LOGIN PASSWORD 'manager';
2023-01-11 10:02:39.208 GMT [39544] ERROR:  role "employee1" already exists
2023-01-11 10:02:39.208 GMT [39544] STATEMENT:  CREATE ROLE employee1 WITH LOGIN PASSWORD 'employee1';
2023-01-11 10:02:39.209 GMT [39544] ERROR:  role "employee2" already exists
2023-01-11 10:02:39.209 GMT [39544] STATEMENT:  CREATE ROLE employee2 WITH LOGIN PASSWORD 'employee2';
2023-01-11 10:02:39.209 GMT [39544] ERROR:  role "employee3" already exists
2023-01-11 10:02:39.209 GMT [39544] STATEMENT:  CREATE ROLE employee3 WITH LOGIN PASSWORD 'employee3';
2023-01-11 10:02:39.209 GMT [39544] ERROR:  role "employee4" already exists
2023-01-11 10:02:39.209 GMT [39544] STATEMENT:  CREATE ROLE employee4 WITH LOGIN PASSWORD 'employee4';
2023-01-11 10:02:39.209 GMT [39544] ERROR:  role "employee5" already exists
2023-01-11 10:02:39.209 GMT [39544] STATEMENT:  CREATE ROLE employee5 WITH LOGIN PASSWORD 'employee5';
2023-01-11 10:02:39.209 GMT [39544] ERROR:  role "unauthenticated" already exists
2023-01-11 10:02:39.209 GMT [39544] STATEMENT:  CREATE ROLE unauthenticated WITH LOGIN PASSWORD 'unauthenticated';
2023-01-11 10:02:39.215 GMT [39544] ERROR:  cannot drop table customer because other objects depend on it
2023-01-11 10:02:39.215 GMT [39544] DETAIL:  constraint online_account_customer_id_fkey on table online_account depends on table customer
	view client.client_personal_information depends on table customer
	view unauthenticated.unauthenticated_personal_information depends on table customer
	view unauthenticated.unauthenticated_customer depends on table customer
2023-01-11 10:02:39.215 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.215 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS customer;
2023-01-11 10:02:39.217 GMT [39544] ERROR:  cannot drop table online_account because other objects depend on it
2023-01-11 10:02:39.217 GMT [39544] DETAIL:  constraint user_login_account_id_fkey on table user_login depends on table online_account
	constraint savings_account_account_id_fkey on table savings_account depends on table online_account
	constraint credit_account_account_id_fkey on table credit_account depends on table online_account
	constraint debit_account_account_id_fkey on table debit_account depends on table online_account
	constraint loan_account_id_fkey on table loan depends on table online_account
	constraint external_account_account_id_fkey on table external_account depends on table online_account
	view client.client_online_account_details depends on table online_account
	view client.client_personal_information depends on view client.client_online_account_details
	view client.client_loans depends on view client.client_online_account_details
	view client.client_loan_applications depends on view client.client_loans
	view client.client_loan_statements depends on view client.client_loans
	view client.client_savings_account depends on view client.client_online_account_details
	view client.client_savings_account_statements depends on view client.client_savings_account
	view client.client_savings_account_statement depends on view client.client_savings_account_statements
	view client.client_credit_accounts depends on view client.client_online_account_details
	view client.client_credit_account_applications depends on view client.client_credit_accounts
	view client.client_credit_account_statements depends on view client.client_credit_accounts
	view client.client_credit_account_statement depends on view client.client_credit_account_statements
	view client.client_debit_accounts depends on view client.client_online_account_details
	view client.client_debit_account_statements depends on view client.client_debit_accounts
	view client.client_debit_account_statement depends on view client.client_debit_account_statements
2023-01-11 10:02:39.217 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.217 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS online_account;
2023-01-11 10:02:39.218 GMT [39544] ERROR:  cannot drop table user_login because other objects depend on it
2023-01-11 10:02:39.218 GMT [39544] DETAIL:  constraint user_login_security_question_login_id_fkey on table user_login_security_question depends on table user_login
	view client.view_login depends on table user_login
	view client.client_security_questions depends on view client.view_login
	view client.client_online_account_details depends on view client.view_login
	view client.client_personal_information depends on view client.client_online_account_details
	view client.client_loans depends on view client.client_online_account_details
	view client.client_loan_applications depends on view client.client_loans
	view client.client_loan_statements depends on view client.client_loans
	view client.client_savings_account depends on view client.client_online_account_details
	view client.client_savings_account_statements depends on view client.client_savings_account
	view client.client_savings_account_statement depends on view client.client_savings_account_statements
	view client.client_credit_accounts depends on view client.client_online_account_details
	view client.client_credit_account_applications depends on view client.client_credit_accounts
	view client.client_credit_account_statements depends on view client.client_credit_accounts
	view client.client_credit_account_statement depends on view client.client_credit_account_statements
	view client.client_debit_accounts depends on view client.client_online_account_details
	view client.client_debit_account_statements depends on view client.client_debit_accounts
	view client.client_debit_account_statement depends on view client.client_debit_account_statements
	view unauthenticated.unauthenticated_login depends on table user_login
2023-01-11 10:02:39.218 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.218 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS user_login;
2023-01-11 10:02:39.219 GMT [39544] ERROR:  cannot drop table user_login_security_question because other objects depend on it
2023-01-11 10:02:39.219 GMT [39544] DETAIL:  constraint security_question_answer_question_id_fkey on table security_question_answer depends on table user_login_security_question
	view client.client_security_questions depends on table user_login_security_question
2023-01-11 10:02:39.219 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.219 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS user_login_security_question;
2023-01-11 10:02:39.219 GMT [39544] ERROR:  cannot drop table security_question_option because other objects depend on it
2023-01-11 10:02:39.219 GMT [39544] DETAIL:  constraint user_login_security_question_question_choice_id_fkey on table user_login_security_question depends on table security_question_option
	view client.client_security_questions depends on table security_question_option
2023-01-11 10:02:39.219 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.219 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS security_question_option;
2023-01-11 10:02:39.220 GMT [39544] ERROR:  cannot drop table security_question_answer because other objects depend on it
2023-01-11 10:02:39.220 GMT [39544] DETAIL:  view client.client_security_questions depends on table security_question_answer
2023-01-11 10:02:39.220 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.220 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS security_question_answer;
2023-01-11 10:02:39.221 GMT [39544] ERROR:  cannot drop table savings_account because other objects depend on it
2023-01-11 10:02:39.221 GMT [39544] DETAIL:  constraint savings_statement_account_id_fkey on table savings_statement depends on table savings_account
	view client.client_savings_account depends on table savings_account
	view client.client_savings_account_statements depends on view client.client_savings_account
	view client.client_savings_account_statement depends on view client.client_savings_account_statements
2023-01-11 10:02:39.221 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.221 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS savings_account;
2023-01-11 10:02:39.222 GMT [39544] ERROR:  cannot drop table credit_account because other objects depend on it
2023-01-11 10:02:39.222 GMT [39544] DETAIL:  constraint credit_account_application_account_id_fkey on table credit_account_application depends on table credit_account
	constraint credit_statement_account_id_fkey on table credit_statement depends on table credit_account
	view client.client_credit_accounts depends on table credit_account
	view client.client_credit_account_applications depends on view client.client_credit_accounts
	view client.client_credit_account_statements depends on view client.client_credit_accounts
	view client.client_credit_account_statement depends on view client.client_credit_account_statements
2023-01-11 10:02:39.222 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.222 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS credit_account;
2023-01-11 10:02:39.222 GMT [39544] ERROR:  cannot drop table debit_account because other objects depend on it
2023-01-11 10:02:39.222 GMT [39544] DETAIL:  constraint debit_statement_account_id_fkey on table debit_statement depends on table debit_account
	constraint debit_overdraft_account_id_fkey on table debit_overdraft depends on table debit_account
	view client.client_debit_accounts depends on table debit_account
	view client.client_debit_account_statements depends on view client.client_debit_accounts
	view client.client_debit_account_statement depends on view client.client_debit_account_statements
2023-01-11 10:02:39.222 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.222 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS debit_account;
2023-01-11 10:02:39.223 GMT [39544] ERROR:  cannot drop table loan because other objects depend on it
2023-01-11 10:02:39.223 GMT [39544] DETAIL:  constraint loan_application_loan_id_fkey on table loan_application depends on table loan
	constraint loan_statement_loan_id_fkey on table loan_statement depends on table loan
	view client.client_loans depends on table loan
	view client.client_loan_applications depends on view client.client_loans
	view client.client_loan_statements depends on view client.client_loans
2023-01-11 10:02:39.223 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.223 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS loan;
2023-01-11 10:02:39.224 GMT [39544] ERROR:  cannot drop table savings_statement because other objects depend on it
2023-01-11 10:02:39.224 GMT [39544] DETAIL:  constraint transaction_savings_statement_id_fkey on table transaction depends on table savings_statement
	view client.client_savings_account_statements depends on table savings_statement
	view client.client_savings_account_statement depends on view client.client_savings_account_statements
2023-01-11 10:02:39.224 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.224 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS savings_statement;
2023-01-11 10:02:39.224 GMT [39544] ERROR:  cannot drop table credit_account_application because other objects depend on it
2023-01-11 10:02:39.224 GMT [39544] DETAIL:  view client.client_credit_account_applications depends on table credit_account_application
2023-01-11 10:02:39.224 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.224 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS credit_account_application;
2023-01-11 10:02:39.225 GMT [39544] ERROR:  cannot drop table credit_statement because other objects depend on it
2023-01-11 10:02:39.225 GMT [39544] DETAIL:  constraint transaction_credit_statement_id_fkey on table transaction depends on table credit_statement
	view client.client_credit_account_statements depends on table credit_statement
	view client.client_credit_account_statement depends on view client.client_credit_account_statements
2023-01-11 10:02:39.225 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.225 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS credit_statement;
2023-01-11 10:02:39.225 GMT [39544] ERROR:  cannot drop table debit_statement because other objects depend on it
2023-01-11 10:02:39.225 GMT [39544] DETAIL:  constraint transaction_debit_statement_id_fkey on table transaction depends on table debit_statement
	view client.client_debit_account_statements depends on table debit_statement
	view client.client_debit_account_statement depends on view client.client_debit_account_statements
2023-01-11 10:02:39.225 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.225 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS debit_statement;
2023-01-11 10:02:39.231 GMT [39544] ERROR:  cannot drop table transaction because other objects depend on it
2023-01-11 10:02:39.231 GMT [39544] DETAIL:  view client.client_savings_account_statement depends on table transaction
	view client.client_credit_account_statement depends on table transaction
	view client.client_debit_account_statement depends on table transaction
2023-01-11 10:02:39.231 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.231 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS transaction;
2023-01-11 10:02:39.233 GMT [39544] ERROR:  cannot drop table loan_application because other objects depend on it
2023-01-11 10:02:39.233 GMT [39544] DETAIL:  view client.client_loan_applications depends on table loan_application
2023-01-11 10:02:39.233 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.233 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS loan_application;
2023-01-11 10:02:39.234 GMT [39544] ERROR:  cannot drop table loan_statement because other objects depend on it
2023-01-11 10:02:39.234 GMT [39544] DETAIL:  view client.client_loan_statements depends on table loan_statement
2023-01-11 10:02:39.234 GMT [39544] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2023-01-11 10:02:39.234 GMT [39544] STATEMENT:  DROP TABLE IF EXISTS loan_statement;
2023-01-11 10:02:39.323 GMT [39544] ERROR:  syntax error at or near "DECLARE" at character 685
2023-01-11 10:02:39.323 GMT [39544] STATEMENT:  CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	
	    EXECUTE format('DROP USER %I', (SELECT username FROM client.view_login));
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    DELETE FROM user_login WHERE id = (SELECT id FROM client.view_login);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    DELETE FROM client_online_account_details WHERE id = (SELECT id FROM client.view_login);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    RETURN passed;
	
	    SET ROLE unauthenticated;
	
	END;
	
	CREATE OR REPLACE FUNCTION client.open_debit_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 10:02:39.323 GMT [39544] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-11 10:02:39.323 GMT [39544] STATEMENT:  BEGIN
	    INSERT INTO debit_account (account_id, current_balance, interest_rate) VALUES ((SELECT id FROM client.view_login), 0, 0.01);
2023-01-11 10:02:39.323 GMT [39544] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 10:02:39.323 GMT [39544] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 10:02:39.323 GMT [39544] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 10:02:39.323 GMT [39544] STATEMENT:  RETURN passed;
2023-01-11 10:02:39.323 GMT [39544] WARNING:  there is no transaction in progress
2023-01-11 10:02:39.360 GMT [39544] ERROR:  role "johnsmith" already exists
2023-01-11 10:02:39.360 GMT [39544] STATEMENT:  CREATE ROLE johnsmith WITH LOGIN PASSWORD '123456';
2023-01-11 10:02:39.366 GMT [39544] ERROR:  permission denied for table customer
2023-01-11 10:02:39.366 GMT [39544] STATEMENT:  SELECT * FROM customer;
2023-01-11 10:28:51.798 GMT [34310] LOG:  received smart shutdown request
2023-01-11 10:28:51.811 GMT [34310] LOG:  background worker "logical replication launcher" (PID 34321) exited with exit code 1
2023-01-11 10:28:51.813 GMT [34316] LOG:  shutting down
2023-01-11 10:28:51.817 GMT [34310] LOG:  received SIGHUP, reloading configuration files
2023-01-11 10:28:51.832 GMT [34310] LOG:  database system is shut down
2023-01-11 12:29:03.628 GMT [13347] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:29:03.630 GMT [13347] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:29:03.631 GMT [13347] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:29:03.638 GMT [13348] LOG:  database system was shut down at 2023-01-11 12:29:03 GMT
2023-01-11 12:29:03.646 GMT [13347] LOG:  database system is ready to accept connections
2023-01-11 12:29:04.994 GMT [13384] ERROR:  syntax error at or near "CREATE" at character 94
2023-01-11 12:29:04.994 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.view_login AS
	SELECT id, account_id, username
	FROM user_login
	
	CREATE OR REPLACE VIEW client.client_security_questions AS
	SELECT security_question_option.question_description, security_question_answer.question_answer
	FROM user_login_security_question
	INNER JOIN security_question_option ON user_login_security_question.question_choice_id = security_question_option.id
	INNER JOIN security_question_answer ON user_login_security_question.id = security_question_answer.question_id
	INNER JOIN view_login ON user_login_security_question.login_id = view_login.id;
2023-01-11 12:29:04.994 GMT [13384] ERROR:  relation "view_login" does not exist at character 206
2023-01-11 12:29:04.994 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_online_account_details AS
	SELECT online_account.id, online_account.date_opened, online_account.sort_code, online_account.customer_id
	    FROM online_account
	INNER JOIN view_login ON online_account.id = view_login.id;
2023-01-11 12:29:04.995 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 105
2023-01-11 12:29:04.995 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_personal_information AS
	SELECT customer.* FROM customer
	INNER JOIN client_online_account_details ON customer.id = client_online_account_details.customer_id;
2023-01-11 12:29:04.997 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 137
2023-01-11 12:29:04.997 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_loans AS
	SELECT loan.id, loan.loan_amount, loan.loan_end_date, loan.loan_type
	FROM loan
	INNER JOIN client_online_account_details ON loan.account_id = client_online_account_details.id;
2023-01-11 12:29:04.997 GMT [13384] ERROR:  relation "client_loans" does not exist at character 133
2023-01-11 12:29:04.997 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_applications AS
	SELECT loan_application.application_status, loan_application.loan_id
	FROM client_loans
	INNER JOIN loan_application ON client_loans.id = loan_application.loan_id;
2023-01-11 12:29:04.998 GMT [13384] ERROR:  relation "client_loans" does not exist at character 145
2023-01-11 12:29:04.998 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_loan_statements AS
	SELECT loan_statement.starting_date, loan_statement.amount, loan_statement.loan_id
	FROM client_loans
	INNER JOIN loan_statement ON client_loans.id = loan_statement.loan_id;
2023-01-11 12:29:04.998 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 179
2023-01-11 12:29:04.998 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account AS
	SELECT savings_account.id, savings_account.current_balance, savings_account.interest_rate
	FROM savings_account
	INNER JOIN client_online_account_details ON savings_account.account_id = client_online_account_details.id;
2023-01-11 12:29:04.998 GMT [13384] ERROR:  relation "client_savings_account" does not exist at character 218
2023-01-11 12:29:04.998 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account_statements AS
	SELECT savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount, savings_statement.account_id
	FROM client_savings_account
	INNER JOIN savings_statement ON client_savings_account.id = savings_statement.account_id;
2023-01-11 12:29:04.999 GMT [13384] ERROR:  relation "client_savings_account_statements" does not exist at character 210
2023-01-11 12:29:04.999 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_savings_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.savings_statement_id
	FROM client_savings_account_statements
	INNER JOIN transaction ON client_savings_account_statements.id = transaction.savings_statement_id;
2023-01-11 12:29:04.999 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 208
2023-01-11 12:29:04.999 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_accounts AS
	SELECT credit_account.id, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	FROM credit_account
	INNER JOIN client_online_account_details ON credit_account.account_id = client_online_account_details.id;
2023-01-11 12:29:04.999 GMT [13384] ERROR:  relation "client_credit_accounts" does not exist at character 166
2023-01-11 12:29:04.999 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_applications AS
	SELECT credit_account_application.application_status, credit_account_application.account_id
	FROM client_credit_accounts
	INNER JOIN credit_account_application ON client_credit_accounts.id = credit_account_application.account_id;
2023-01-11 12:29:05.000 GMT [13384] ERROR:  relation "client_credit_accounts" does not exist at character 289
2023-01-11 12:29:05.000 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_statements AS
	SELECT credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date, credit_statement.account_id
	FROM client_credit_accounts
	INNER JOIN credit_statement ON client_credit_accounts.id = credit_statement.account_id;
2023-01-11 12:29:05.000 GMT [13384] ERROR:  relation "client_credit_account_statements" does not exist at character 208
2023-01-11 12:29:05.000 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_credit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_statement_id
	FROM client_credit_account_statements
	INNER JOIN transaction ON client_credit_account_statements.id = transaction.credit_statement_id;
2023-01-11 12:29:05.000 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 170
2023-01-11 12:29:05.000 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_accounts AS
	SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate
	FROM debit_account
	INNER JOIN client_online_account_details ON debit_account.account_id = client_online_account_details.id;
2023-01-11 12:29:05.002 GMT [13384] ERROR:  relation "client_debit_accounts" does not exist at character 206
2023-01-11 12:29:05.002 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_account_statements AS
	SELECT debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount, debit_statement.account_id
	FROM client_debit_accounts
	INNER JOIN debit_statement ON client_debit_accounts.id = debit_statement.account_id;
2023-01-11 12:29:05.004 GMT [13384] ERROR:  relation "client_debit_account_statements" does not exist at character 207
2023-01-11 12:29:05.004 GMT [13384] STATEMENT:  CREATE OR REPLACE VIEW client.client_debit_account_statement AS
	SELECT transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date, transaction.credit_statement_id
	FROM client_debit_account_statements
	INNER JOIN transaction ON client_debit_account_statements.id = transaction.debit_statement_id;
2023-01-11 12:29:05.004 GMT [13384] ERROR:  syntax error at or near "DECLARE" at character 727
2023-01-11 12:29:05.004 GMT [13384] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_customer_id(username TEXT, password TEXT)
	RETURNS INTEGER AS $$
	DECLARE customer_id INTEGER;
	BEGIN
	    SELECT online_account_details.customer_id FROM client_online_account_details AS online_account_details
	    INNER JOIN client.view_login ON online_account_details.id = client.view_login.id
	    WHERE client.view_login.username = username AND hashtext(client.view_login.password) = password;
	END;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:29:05.004 GMT [13384] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-11 12:29:05.004 GMT [13384] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT * FROM get_customer_id(username, password));
2023-01-11 12:29:05.004 GMT [13384] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:29:05.004 GMT [13384] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:29:05.005 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.005 GMT [13384] STATEMENT:  RETURN passed;
2023-01-11 12:29:05.005 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.005 GMT [13384] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_login_information(username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-11 12:29:05.005 GMT [13384] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_login_information(username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:29:05.005 GMT [13384] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-11 12:29:05.005 GMT [13384] STATEMENT:  BEGIN
	    UPDATE user_login SET username = username
	    WHERE id = (SELECT id FROM client.view_login);
2023-01-11 12:29:05.005 GMT [13384] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:29:05.005 GMT [13384] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:29:05.006 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.006 GMT [13384] STATEMENT:  EXECUTE format('ALTER USER %I WITH PASSWORD %L', username, password);
2023-01-11 12:29:05.007 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.007 GMT [13384] STATEMENT:  RETURN passed;
2023-01-11 12:29:05.007 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.007 GMT [13384] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$" at character 1
2023-01-11 12:29:05.007 GMT [13384] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:29:05.007 GMT [13384] ERROR:  syntax error at or near "EXECUTE" at character 11
2023-01-11 12:29:05.007 GMT [13384] STATEMENT:  BEGIN
	    EXECUTE format('DROP USER %I', (SELECT username FROM client.view_login));
2023-01-11 12:29:05.007 GMT [13384] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:29:05.007 GMT [13384] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:29:05.007 GMT [13384] ERROR:  relation "client.view_login" does not exist at character 51
2023-01-11 12:29:05.007 GMT [13384] STATEMENT:  DELETE FROM user_login WHERE id = (SELECT id FROM client.view_login);
2023-01-11 12:29:05.008 GMT [13384] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:29:05.008 GMT [13384] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:29:05.009 GMT [13384] ERROR:  relation "client_online_account_details" does not exist at character 13
2023-01-11 12:29:05.009 GMT [13384] STATEMENT:  DELETE FROM client_online_account_details WHERE id = (SELECT id FROM client.view_login);
2023-01-11 12:29:05.009 GMT [13384] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:29:05.009 GMT [13384] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:29:05.009 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.009 GMT [13384] STATEMENT:  RETURN passed;
2023-01-11 12:29:05.011 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.011 GMT [13384] ERROR:  syntax error at or near "DECLARE" at character 1185
2023-01-11 12:29:05.011 GMT [13384] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO debit_account (account_id, current_balance, interest_rate) VALUES ((SELECT id FROM client.view_login), 0, 0.01);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, hashtext(first_name) AS first_name, hashtext(last_name) AS last_name, hashtext(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_customer AS
	SELECT * FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT hashtext(username) AS username FROM user_login;
	
	
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE success INT;
2023-01-11 12:29:05.011 GMT [13384] ERROR:  syntax error at or near "IF" at character 11
2023-01-11 12:29:05.011 GMT [13384] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated_personal_information WHERE hashtext(first_name) = first_name AND hashtext(last_name) = last_name AND hashtext(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  success = 1;
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  success = 0;
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "IF" at character 5
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  END IF;
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  RETURN success;
2023-01-11 12:29:05.012 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.012 GMT [13384] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows a user to fetch their respective customer id
	CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURNS INT AS $$" at character 1
2023-01-11 12:29:05.012 GMT [13384] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows a user to fetch their respective customer id
	CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-11 12:29:05.013 GMT [13384] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-11 12:29:05.013 GMT [13384] STATEMENT:  BEGIN
	    SELECT id INTO customer_id FROM customer WHERE first_name = first_name AND last_name = last_name AND email_address = email_address;
2023-01-11 12:29:05.013 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.013 GMT [13384] STATEMENT:  RETURN customer_id;
2023-01-11 12:29:05.013 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.013 GMT [13384] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-11 12:29:05.013 GMT [13384] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
2023-01-11 12:29:05.013 GMT [13384] ERROR:  syntax error at or near "INT" at character 21
2023-01-11 12:29:05.013 GMT [13384] STATEMENT:  DECLARE customer_id INT;
2023-01-11 12:29:05.013 GMT [13384] ERROR:  syntax error at or near "INT" at character 20
2023-01-11 12:29:05.013 GMT [13384] STATEMENT:  DECLARE account_id INT;
2023-01-11 12:29:05.014 GMT [13384] ERROR:  syntax error at or near "INT" at character 27
2023-01-11 12:29:05.014 GMT [13384] STATEMENT:  DECLARE online_account_id INT;
2023-01-11 12:29:05.014 GMT [13384] ERROR:  syntax error at or near "INT" at character 28
2023-01-11 12:29:05.014 GMT [13384] STATEMENT:  DECLARE question_choice_id INT;
2023-01-11 12:29:05.015 GMT [13384] ERROR:  syntax error at or near "IF" at character 11
2023-01-11 12:29:05.015 GMT [13384] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
2023-01-11 12:29:05.015 GMT [13384] ERROR:  syntax error at or near "INTO" at character 191
2023-01-11 12:29:05.015 GMT [13384] STATEMENT:  INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-11 12:29:05.016 GMT [13384] ERROR:  syntax error at or near "INTO" at character 106
2023-01-11 12:29:05.016 GMT [13384] STATEMENT:  INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
2023-01-11 12:29:05.016 GMT [13384] ERROR:  syntax error at or near "FOR" at character 1
2023-01-11 12:29:05.016 GMT [13384] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-11 12:29:05.017 GMT [13384] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 12:29:05.017 GMT [13384] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-11 12:29:05.018 GMT [13384] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-11 12:29:05.018 GMT [13384] STATEMENT:  END LOOP;
2023-01-11 12:29:05.018 GMT [13384] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:29:05.018 GMT [13384] STATEMENT:  success = 1;
2023-01-11 12:29:05.018 GMT [13384] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-11 12:29:05.018 GMT [13384] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-11 12:29:05.019 GMT [13384] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:29:05.019 GMT [13384] STATEMENT:  success = 0;
2023-01-11 12:29:05.019 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.019 GMT [13384] STATEMENT:  EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
2023-01-11 12:29:05.019 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.019 GMT [13384] STATEMENT:  EXECUTE format(
	        'SET ROLE %I', username
	    );
2023-01-11 12:29:05.019 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.019 GMT [13384] STATEMENT:  EXECUTE format(
	        'GRANT USAGE ON SCHEMA client TO %I', username
	    );
2023-01-11 12:29:05.020 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.020 GMT [13384] STATEMENT:  EXECUTE format(
	        'GRANT ALL ON ALL TABLES IN SCHEMA client TO %I', username
	    );
2023-01-11 12:29:05.020 GMT [13384] ERROR:  prepared statement "format" does not exist
2023-01-11 12:29:05.020 GMT [13384] STATEMENT:  EXECUTE format(
	        'REVOKE ALL ON ALL TABLES IN SCHEMA public TO %I', username
	    );
2023-01-11 12:29:05.020 GMT [13384] ERROR:  syntax error at or near "IF" at character 5
2023-01-11 12:29:05.020 GMT [13384] STATEMENT:  END IF;
2023-01-11 12:29:05.020 GMT [13384] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:29:05.020 GMT [13384] STATEMENT:  RETURN success;
2023-01-11 12:29:05.020 GMT [13384] WARNING:  there is no transaction in progress
2023-01-11 12:29:05.021 GMT [13384] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7),
	('2020-01-01', '123456', 8),
	('2020-01-01', '123456', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username)
	VALUES (1, 'johnsmith'),
	(2, 'janedoe'),
	(3, 'joebloggs'),
	(4, 'johnbloggs'),
	(5, 'janebloggs'),
	(6, 'joedoe'),
	(7, 'johndoe'),
	(8, 'joesmith'),
	(9, 'janesmith');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	-- sample data for savings account
	INSERT INTO savings_account (current_balance, interest_rate, account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
	
	-- sample data for credit account
	INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
	
	-- sample data for debit account
	INSERT INTO debit_account (current_balance, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
	
	-- sample data for loan
	INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
	
	CREATE SCHEMA IF NOT EXISTS staff;
	
	SET search_path TO public, staff;" at character 1
2023-01-11 12:29:05.021 GMT [13384] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7),
	('2020-01-01', '123456', 8),
	('2020-01-01', '123456', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username)
	VALUES (1, 'johnsmith'),
	(2, 'janedoe'),
	(3, 'joebloggs'),
	(4, 'johnbloggs'),
	(5, 'janebloggs'),
	(6, 'joedoe'),
	(7, 'johndoe'),
	(8, 'joesmith'),
	(9, 'janesmith');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	-- sample data for savings account
	INSERT INTO savings_account (current_balance, interest_rate, account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
	
	-- sample data for credit account
	INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
	
	-- sample data for debit account
	INSERT INTO debit_account (current_balance, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
	
	-- sample data for loan
	INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
	
	CREATE SCHEMA IF NOT EXISTS staff;
	
	SET search_path TO public, staff;
2023-01-11 12:30:19.053 GMT [13347] LOG:  received fast shutdown request
2023-01-11 12:30:19.054 GMT [13347] LOG:  aborting any active transactions
2023-01-11 12:30:19.062 GMT [13347] LOG:  background worker "logical replication launcher" (PID 13354) exited with exit code 1
2023-01-11 12:30:19.062 GMT [13349] LOG:  shutting down
2023-01-11 12:30:19.111 GMT [13347] LOG:  database system is shut down
2023-01-11 12:30:21.935 GMT [13717] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:30:21.935 GMT [13717] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:30:21.937 GMT [13717] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:30:21.942 GMT [13718] LOG:  database system was shut down at 2023-01-11 12:30:21 GMT
2023-01-11 12:30:21.948 GMT [13717] LOG:  database system is ready to accept connections
2023-01-11 12:30:22.927 GMT [13743] ERROR:  syntax error at or near "DECLARE" at character 727
2023-01-11 12:30:22.927 GMT [13743] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_customer_id(username TEXT, password TEXT)
	RETURNS INTEGER AS $$
	DECLARE customer_id INTEGER;
	BEGIN
	    SELECT online_account_details.customer_id FROM client_online_account_details AS online_account_details
	    INNER JOIN client.view_login ON online_account_details.id = client.view_login.id
	    WHERE client.view_login.username = username AND hashtext(client.view_login.password) = password;
	END;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:30:22.927 GMT [13743] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-11 12:30:22.927 GMT [13743] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT * FROM get_customer_id(username, password));
2023-01-11 12:30:22.928 GMT [13743] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:22.928 GMT [13743] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:22.928 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.928 GMT [13743] STATEMENT:  RETURN passed;
2023-01-11 12:30:22.928 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.928 GMT [13743] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_login_information(username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-11 12:30:22.928 GMT [13743] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_login_information(username TEXT, password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:30:22.928 GMT [13743] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-11 12:30:22.928 GMT [13743] STATEMENT:  BEGIN
	    UPDATE user_login SET username = username
	    WHERE id = (SELECT id FROM client.view_login);
2023-01-11 12:30:22.928 GMT [13743] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:22.928 GMT [13743] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:22.929 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.929 GMT [13743] STATEMENT:  EXECUTE format('ALTER USER %I WITH PASSWORD %L', username, password);
2023-01-11 12:30:22.929 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.929 GMT [13743] STATEMENT:  RETURN passed;
2023-01-11 12:30:22.929 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.929 GMT [13743] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$" at character 1
2023-01-11 12:30:22.929 GMT [13743] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:30:22.929 GMT [13743] ERROR:  syntax error at or near "EXECUTE" at character 11
2023-01-11 12:30:22.929 GMT [13743] STATEMENT:  BEGIN
	    EXECUTE format('DROP USER %I', (SELECT username FROM client.view_login));
2023-01-11 12:30:22.929 GMT [13743] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:22.929 GMT [13743] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:22.930 GMT [13743] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:22.930 GMT [13743] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:22.933 GMT [13743] ERROR:  cannot delete from view "client_online_account_details"
2023-01-11 12:30:22.933 GMT [13743] DETAIL:  Views that do not select from a single table or view are not automatically updatable.
2023-01-11 12:30:22.933 GMT [13743] HINT:  To enable deleting from the view, provide an INSTEAD OF DELETE trigger or an unconditional ON DELETE DO INSTEAD rule.
2023-01-11 12:30:22.933 GMT [13743] STATEMENT:  DELETE FROM client_online_account_details WHERE id = (SELECT id FROM client.view_login);
2023-01-11 12:30:22.933 GMT [13743] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:22.933 GMT [13743] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:22.933 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.933 GMT [13743] STATEMENT:  RETURN passed;
2023-01-11 12:30:22.933 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.934 GMT [13743] ERROR:  syntax error at or near "DECLARE" at character 1185
2023-01-11 12:30:22.934 GMT [13743] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO debit_account (account_id, current_balance, interest_rate) VALUES ((SELECT id FROM client.view_login), 0, 0.01);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, hashtext(first_name) AS first_name, hashtext(last_name) AS last_name, hashtext(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_customer AS
	SELECT * FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT hashtext(username) AS username FROM user_login;
	
	
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE success INT;
2023-01-11 12:30:22.934 GMT [13743] ERROR:  syntax error at or near "IF" at character 11
2023-01-11 12:30:22.934 GMT [13743] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated_personal_information WHERE hashtext(first_name) = first_name AND hashtext(last_name) = last_name AND hashtext(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode);
2023-01-11 12:30:22.935 GMT [13743] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:30:22.935 GMT [13743] STATEMENT:  success = 1;
2023-01-11 12:30:22.935 GMT [13743] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-11 12:30:22.935 GMT [13743] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-11 12:30:22.935 GMT [13743] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:30:22.935 GMT [13743] STATEMENT:  success = 0;
2023-01-11 12:30:22.935 GMT [13743] ERROR:  syntax error at or near "IF" at character 5
2023-01-11 12:30:22.935 GMT [13743] STATEMENT:  END IF;
2023-01-11 12:30:22.936 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.936 GMT [13743] STATEMENT:  RETURN success;
2023-01-11 12:30:22.936 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.937 GMT [13743] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows a user to fetch their respective customer id
	CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURNS INT AS $$" at character 1
2023-01-11 12:30:22.937 GMT [13743] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows a user to fetch their respective customer id
	CREATE OR REPLACE FUNCTION unauthenticated.get_customer_id(first_name TEXT, last_name TEXT, email_address TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-11 12:30:22.937 GMT [13743] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-11 12:30:22.937 GMT [13743] STATEMENT:  BEGIN
	    SELECT id INTO customer_id FROM customer WHERE first_name = first_name AND last_name = last_name AND email_address = email_address;
2023-01-11 12:30:22.937 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.937 GMT [13743] STATEMENT:  RETURN customer_id;
2023-01-11 12:30:22.937 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.938 GMT [13743] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-11 12:30:22.938 GMT [13743] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(username TEXT, password TEXT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE success INT;
2023-01-11 12:30:22.938 GMT [13743] ERROR:  syntax error at or near "INT" at character 21
2023-01-11 12:30:22.938 GMT [13743] STATEMENT:  DECLARE customer_id INT;
2023-01-11 12:30:22.938 GMT [13743] ERROR:  syntax error at or near "INT" at character 20
2023-01-11 12:30:22.938 GMT [13743] STATEMENT:  DECLARE account_id INT;
2023-01-11 12:30:22.938 GMT [13743] ERROR:  syntax error at or near "INT" at character 27
2023-01-11 12:30:22.938 GMT [13743] STATEMENT:  DECLARE online_account_id INT;
2023-01-11 12:30:22.939 GMT [13743] ERROR:  syntax error at or near "INT" at character 28
2023-01-11 12:30:22.939 GMT [13743] STATEMENT:  DECLARE question_choice_id INT;
2023-01-11 12:30:22.939 GMT [13743] ERROR:  syntax error at or near "IF" at character 11
2023-01-11 12:30:22.939 GMT [13743] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        customer_id = unauthenticated.get_customer_id(first_name, last_name, email_address);
2023-01-11 12:30:22.939 GMT [13743] ERROR:  syntax error at or near "INTO" at character 191
2023-01-11 12:30:22.939 GMT [13743] STATEMENT:  INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-11 12:30:22.940 GMT [13743] ERROR:  syntax error at or near "INTO" at character 106
2023-01-11 12:30:22.940 GMT [13743] STATEMENT:  INSERT INTO user_login (account_id, username)
	        VALUES (account_id, username)
	        RETURNING id INTO online_account_id;
2023-01-11 12:30:22.940 GMT [13743] ERROR:  syntax error at or near "FOR" at character 1
2023-01-11 12:30:22.940 GMT [13743] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-11 12:30:22.940 GMT [13743] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-11 12:30:22.940 GMT [13743] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-11 12:30:22.941 GMT [13743] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  END LOOP;
2023-01-11 12:30:22.941 GMT [13743] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  success = 1;
2023-01-11 12:30:22.941 GMT [13743] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-11 12:30:22.941 GMT [13743] ERROR:  syntax error at or near "success" at character 1
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  success = 0;
2023-01-11 12:30:22.941 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  EXECUTE format(
	        'CREATE ROLE %I WITH LOGIN PASSWORD %L', username, password
	    );
2023-01-11 12:30:22.941 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.941 GMT [13743] STATEMENT:  EXECUTE format(
	        'SET ROLE %I', username
	    );
2023-01-11 12:30:22.942 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  EXECUTE format(
	        'GRANT USAGE ON SCHEMA client TO %I', username
	    );
2023-01-11 12:30:22.942 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  EXECUTE format(
	        'GRANT ALL ON ALL TABLES IN SCHEMA client TO %I', username
	    );
2023-01-11 12:30:22.942 GMT [13743] ERROR:  prepared statement "format" does not exist
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  EXECUTE format(
	        'REVOKE ALL ON ALL TABLES IN SCHEMA public TO %I', username
	    );
2023-01-11 12:30:22.942 GMT [13743] ERROR:  syntax error at or near "IF" at character 5
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  END IF;
2023-01-11 12:30:22.942 GMT [13743] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  RETURN success;
2023-01-11 12:30:22.942 GMT [13743] WARNING:  there is no transaction in progress
2023-01-11 12:30:22.942 GMT [13743] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7),
	('2020-01-01', '123456', 8),
	('2020-01-01', '123456', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username)
	VALUES (1, 'johnsmith'),
	(2, 'janedoe'),
	(3, 'joebloggs'),
	(4, 'johnbloggs'),
	(5, 'janebloggs'),
	(6, 'joedoe'),
	(7, 'johndoe'),
	(8, 'joesmith'),
	(9, 'janesmith');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	-- sample data for savings account
	INSERT INTO savings_account (current_balance, interest_rate, account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
	
	-- sample data for credit account
	INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
	
	-- sample data for debit account
	INSERT INTO debit_account (current_balance, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
	
	-- sample data for loan
	INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
	
	CREATE SCHEMA IF NOT EXISTS staff;
	
	SET search_path TO public, staff;" at character 1
2023-01-11 12:30:22.942 GMT [13743] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '123456', 2),
	('2018-01-01', '123456', 3),
	('2017-01-01', '123456', 4),
	('2016-01-01', '123456', 5),
	('2017-02-03', '123456', 6),
	('2018-02-04', '123456', 7),
	('2020-01-01', '123456', 8),
	('2020-01-01', '123456', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username)
	VALUES (1, 'johnsmith'),
	(2, 'janedoe'),
	(3, 'joebloggs'),
	(4, 'johnbloggs'),
	(5, 'janebloggs'),
	(6, 'joedoe'),
	(7, 'johndoe'),
	(8, 'joesmith'),
	(9, 'janesmith');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	-- sample data for savings account
	INSERT INTO savings_account (current_balance, interest_rate, account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
	
	-- sample data for credit account
	INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
	
	-- sample data for debit account
	INSERT INTO debit_account (current_balance, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
	
	-- sample data for loan
	INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	VALUES ('2024-01-01', 10000, 'vehicle', 8),
	('2023-03-04', 300000, 'mortgage', 8),
	('2035-03-03', 400000, 'mortgage', 1),
	('2025-04-05', 25000, 'vehicle', 1),
	('2026-05-05', 34000, 'vehicle', 1),
	('2023-06-07', 500000, 'mortgage', 2),
	('2026-04-04', 60000, 'vehicle', 2),
	('2024-03-03', 70000, 'vehicle', 2),
	('2023-02-02', 800000, 'mortgage', 3),
	('2022-01-01', 90000, 'vehicle', 3),
	('2021-01-01', 100000, 'vehicle', 3),
	('2020-01-01', 110000, 'mortgage', 4),
	('2020-01-01', 12000, 'vehicle', 4),
	('2020-01-01', 13000, 'vehicle', 4),
	('2020-01-01', 140000, 'mortgage', 5),
	('2020-01-01', 15000, 'vehicle', 5),
	('2020-01-01', 16000, 'vehicle', 5),
	('2020-01-01', 170000, 'mortgage', 6),
	('2020-01-01', 18000, 'vehicle', 6),
	('2020-01-01', 19000, 'vehicle', 6),
	('2020-01-01', 200000, 'mortgage', 7),
	('2020-01-01', 21000, 'vehicle', 7),
	('2020-01-01', 22000, 'vehicle', 7);
	
	CREATE SCHEMA IF NOT EXISTS staff;
	
	SET search_path TO public, staff;
2023-01-11 12:30:50.089 GMT [13717] LOG:  received fast shutdown request
2023-01-11 12:30:50.091 GMT [13717] LOG:  aborting any active transactions
2023-01-11 12:30:50.096 GMT [13717] LOG:  background worker "logical replication launcher" (PID 13724) exited with exit code 1
2023-01-11 12:30:50.097 GMT [13719] LOG:  shutting down
2023-01-11 12:30:50.148 GMT [13717] LOG:  database system is shut down
2023-01-11 12:30:53.711 GMT [13939] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:30:53.712 GMT [13939] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:30:53.713 GMT [13939] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:30:53.726 GMT [13940] LOG:  database system was shut down at 2023-01-11 12:30:53 GMT
2023-01-11 12:30:53.734 GMT [13939] LOG:  database system is ready to accept connections
2023-01-11 12:30:54.684 GMT [13968] ERROR:  syntax error at or near "DECLARE" at character 685
2023-01-11 12:30:54.684 GMT [13968] STATEMENT:  CREATE OR REPLACE FUNCTION client.close_online_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	
	    EXECUTE format('DROP USER %I', (SELECT username FROM client.view_login));
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    DELETE FROM user_login WHERE id = (SELECT id FROM client.view_login);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    DELETE FROM client_online_account_details WHERE id = (SELECT id FROM client.view_login);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	
	    RETURN passed;
	
	    SET ROLE unauthenticated;
	
	END;
	
	CREATE OR REPLACE FUNCTION client.open_debit_account()
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-11 12:30:54.685 GMT [13968] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-11 12:30:54.685 GMT [13968] STATEMENT:  BEGIN
	    INSERT INTO debit_account (account_id, current_balance, interest_rate) VALUES ((SELECT id FROM client.view_login), 0, 0.01);
2023-01-11 12:30:54.686 GMT [13968] ERROR:  syntax error at or near "passed" at character 1
2023-01-11 12:30:54.686 GMT [13968] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-11 12:30:54.687 GMT [13968] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-11 12:30:54.687 GMT [13968] STATEMENT:  RETURN passed;
2023-01-11 12:30:54.687 GMT [13968] WARNING:  there is no transaction in progress
2023-01-11 12:33:21.053 GMT [13939] LOG:  received fast shutdown request
2023-01-11 12:33:21.054 GMT [13939] LOG:  aborting any active transactions
2023-01-11 12:33:21.059 GMT [13939] LOG:  background worker "logical replication launcher" (PID 13946) exited with exit code 1
2023-01-11 12:33:21.060 GMT [13941] LOG:  shutting down
2023-01-11 12:33:21.117 GMT [13939] LOG:  database system is shut down
2023-01-11 12:33:23.466 GMT [14533] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:33:23.466 GMT [14533] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:33:23.468 GMT [14533] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:33:23.473 GMT [14534] LOG:  database system was shut down at 2023-01-11 12:33:23 GMT
2023-01-11 12:33:23.479 GMT [14533] LOG:  database system is ready to accept connections
2023-01-11 12:37:18.427 GMT [14533] LOG:  received fast shutdown request
2023-01-11 12:37:18.431 GMT [14533] LOG:  aborting any active transactions
2023-01-11 12:37:18.437 GMT [14533] LOG:  background worker "logical replication launcher" (PID 14540) exited with exit code 1
2023-01-11 12:37:18.438 GMT [14535] LOG:  shutting down
2023-01-11 12:37:18.497 GMT [14533] LOG:  database system is shut down
2023-01-11 12:37:20.839 GMT [15415] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:37:20.839 GMT [15415] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:37:20.840 GMT [15415] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:37:20.845 GMT [15416] LOG:  database system was shut down at 2023-01-11 12:37:20 GMT
2023-01-11 12:37:20.851 GMT [15415] LOG:  database system is ready to accept connections
2023-01-11 12:38:21.578 GMT [15415] LOG:  received fast shutdown request
2023-01-11 12:38:21.582 GMT [15415] LOG:  aborting any active transactions
2023-01-11 12:38:21.587 GMT [15415] LOG:  background worker "logical replication launcher" (PID 15422) exited with exit code 1
2023-01-11 12:38:21.589 GMT [15417] LOG:  shutting down
2023-01-11 12:38:21.641 GMT [15415] LOG:  database system is shut down
2023-01-11 12:38:22.872 GMT [15799] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:38:22.872 GMT [15799] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:38:22.874 GMT [15799] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:38:22.879 GMT [15800] LOG:  database system was shut down at 2023-01-11 12:38:22 GMT
2023-01-11 12:38:22.885 GMT [15799] LOG:  database system is ready to accept connections
2023-01-11 12:38:48.346 GMT [15799] LOG:  received fast shutdown request
2023-01-11 12:38:48.348 GMT [15799] LOG:  aborting any active transactions
2023-01-11 12:38:48.353 GMT [15799] LOG:  background worker "logical replication launcher" (PID 15806) exited with exit code 1
2023-01-11 12:38:48.353 GMT [15801] LOG:  shutting down
2023-01-11 12:38:48.408 GMT [15799] LOG:  database system is shut down
2023-01-11 12:38:49.725 GMT [15985] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:38:49.726 GMT [15985] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:38:49.728 GMT [15985] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:38:49.733 GMT [15986] LOG:  database system was shut down at 2023-01-11 12:38:49 GMT
2023-01-11 12:38:49.739 GMT [15985] LOG:  database system is ready to accept connections
2023-01-11 12:39:51.943 GMT [15985] LOG:  received fast shutdown request
2023-01-11 12:39:51.945 GMT [15985] LOG:  aborting any active transactions
2023-01-11 12:39:51.950 GMT [15985] LOG:  background worker "logical replication launcher" (PID 15992) exited with exit code 1
2023-01-11 12:39:51.953 GMT [15987] LOG:  shutting down
2023-01-11 12:39:52.007 GMT [15985] LOG:  database system is shut down
2023-01-11 12:39:53.325 GMT [16295] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:39:53.326 GMT [16295] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:39:53.327 GMT [16295] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:39:53.332 GMT [16296] LOG:  database system was shut down at 2023-01-11 12:39:53 GMT
2023-01-11 12:39:53.342 GMT [16295] LOG:  database system is ready to accept connections
2023-01-11 12:39:54.213 GMT [16328] ERROR:  column reference "username" is ambiguous at character 235
2023-01-11 12:39:54.213 GMT [16328] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-11 12:39:54.213 GMT [16328] QUERY:  SELECT online_account_details.customer_id FROM client.client_online_account_details AS online_account_details
	    INNER JOIN client.view_login ON online_account_details.id = client.view_login.id
	    WHERE client.view_login.username = username AND md5(client.view_login.password) = password
2023-01-11 12:39:54.213 GMT [16328] CONTEXT:  PL/pgSQL function client.get_customer_id(text,text) line 4 at SQL statement
2023-01-11 12:39:54.213 GMT [16328] STATEMENT:  SELECT * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:41:14.422 GMT [16295] LOG:  received fast shutdown request
2023-01-11 12:41:14.424 GMT [16295] LOG:  aborting any active transactions
2023-01-11 12:41:14.427 GMT [16295] LOG:  background worker "logical replication launcher" (PID 16302) exited with exit code 1
2023-01-11 12:41:14.430 GMT [16297] LOG:  shutting down
2023-01-11 12:41:14.483 GMT [16295] LOG:  database system is shut down
2023-01-11 12:41:15.783 GMT [16669] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:41:15.784 GMT [16669] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:41:15.786 GMT [16669] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:41:15.790 GMT [16670] LOG:  database system was shut down at 2023-01-11 12:41:15 GMT
2023-01-11 12:41:15.797 GMT [16669] LOG:  database system is ready to accept connections
2023-01-11 12:41:16.745 GMT [16705] ERROR:  column "password" does not exist at character 245
2023-01-11 12:41:16.745 GMT [16705] QUERY:  SELECT online_account_details.customer_id FROM client.client_online_account_details AS online_account_details
	    INNER JOIN client.view_login ON online_account_details.id = client.view_login.id
	    WHERE client.view_login.username = uname AND password = passwd
2023-01-11 12:41:16.745 GMT [16705] CONTEXT:  PL/pgSQL function client.get_customer_id(text,text) line 4 at SQL statement
2023-01-11 12:41:16.745 GMT [16705] STATEMENT:  SELECT * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:41:36.428 GMT [16669] LOG:  received fast shutdown request
2023-01-11 12:41:36.429 GMT [16669] LOG:  aborting any active transactions
2023-01-11 12:41:36.432 GMT [16669] LOG:  background worker "logical replication launcher" (PID 16676) exited with exit code 1
2023-01-11 12:41:36.436 GMT [16671] LOG:  shutting down
2023-01-11 12:41:36.496 GMT [16669] LOG:  database system is shut down
2023-01-11 12:41:37.718 GMT [16839] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:41:37.718 GMT [16839] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:41:37.720 GMT [16839] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:41:37.725 GMT [16840] LOG:  database system was shut down at 2023-01-11 12:41:37 GMT
2023-01-11 12:41:37.731 GMT [16839] LOG:  database system is ready to accept connections
2023-01-11 12:41:38.657 GMT [16869] ERROR:  column view_login.password does not exist at character 245
2023-01-11 12:41:38.657 GMT [16869] QUERY:  SELECT online_account_details.customer_id FROM client.client_online_account_details AS online_account_details
	    INNER JOIN client.view_login ON online_account_details.id = client.view_login.id
	    WHERE client.view_login.username = uname AND client.view_login.password = passwd
2023-01-11 12:41:38.657 GMT [16869] CONTEXT:  PL/pgSQL function client.get_customer_id(text,text) line 4 at SQL statement
2023-01-11 12:41:38.657 GMT [16869] STATEMENT:  SELECT * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:42:03.852 GMT [16839] LOG:  received fast shutdown request
2023-01-11 12:42:03.855 GMT [16839] LOG:  aborting any active transactions
2023-01-11 12:42:03.860 GMT [16839] LOG:  background worker "logical replication launcher" (PID 16846) exited with exit code 1
2023-01-11 12:42:03.861 GMT [16841] LOG:  shutting down
2023-01-11 12:42:03.919 GMT [16839] LOG:  database system is shut down
2023-01-11 12:42:05.235 GMT [17024] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:42:05.235 GMT [17024] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:42:05.237 GMT [17024] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:42:05.242 GMT [17025] LOG:  database system was shut down at 2023-01-11 12:42:04 GMT
2023-01-11 12:42:05.249 GMT [17024] LOG:  database system is ready to accept connections
2023-01-11 12:42:06.173 GMT [17063] ERROR:  query has no destination for result data
2023-01-11 12:42:06.173 GMT [17063] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-11 12:42:06.173 GMT [17063] CONTEXT:  PL/pgSQL function client.get_customer_id(text,text) line 4 at SQL statement
2023-01-11 12:42:06.173 GMT [17063] STATEMENT:  SELECT * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:43:20.110 GMT [17024] LOG:  received fast shutdown request
2023-01-11 12:43:20.112 GMT [17024] LOG:  aborting any active transactions
2023-01-11 12:43:20.117 GMT [17024] LOG:  background worker "logical replication launcher" (PID 17031) exited with exit code 1
2023-01-11 12:43:20.117 GMT [17026] LOG:  shutting down
2023-01-11 12:43:20.170 GMT [17024] LOG:  database system is shut down
2023-01-11 12:43:25.066 GMT [17368] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:43:25.067 GMT [17368] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:43:25.068 GMT [17368] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:43:25.072 GMT [17369] LOG:  database system was shut down at 2023-01-11 12:43:24 GMT
2023-01-11 12:43:25.078 GMT [17368] LOG:  database system is ready to accept connections
2023-01-11 12:43:25.974 GMT [17397] ERROR:  syntax error at or near "PERFORM" at character 1
2023-01-11 12:43:25.974 GMT [17397] STATEMENT:  PERFORM * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:43:41.927 GMT [17368] LOG:  received fast shutdown request
2023-01-11 12:43:41.929 GMT [17368] LOG:  aborting any active transactions
2023-01-11 12:43:41.932 GMT [17368] LOG:  background worker "logical replication launcher" (PID 17375) exited with exit code 1
2023-01-11 12:43:41.936 GMT [17370] LOG:  shutting down
2023-01-11 12:43:41.989 GMT [17368] LOG:  database system is shut down
2023-01-11 12:43:43.914 GMT [17566] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:43:43.914 GMT [17566] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:43:43.916 GMT [17566] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:43:43.921 GMT [17573] LOG:  database system was shut down at 2023-01-11 12:43:43 GMT
2023-01-11 12:43:43.927 GMT [17566] LOG:  database system is ready to accept connections
2023-01-11 12:43:44.838 GMT [17600] ERROR:  query has no destination for result data
2023-01-11 12:43:44.838 GMT [17600] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-11 12:43:44.838 GMT [17600] CONTEXT:  PL/pgSQL function client.get_customer_id(text,text) line 4 at SQL statement
2023-01-11 12:43:44.838 GMT [17600] STATEMENT:  SELECT * FROM client.get_customer_id('johnsmith', 'b29af57c2b3bba21e9df0cece40952c6');
2023-01-11 12:44:42.456 GMT [17566] LOG:  received fast shutdown request
2023-01-11 12:44:42.458 GMT [17566] LOG:  aborting any active transactions
2023-01-11 12:44:42.462 GMT [17566] LOG:  background worker "logical replication launcher" (PID 17581) exited with exit code 1
2023-01-11 12:44:42.463 GMT [17576] LOG:  shutting down
2023-01-11 12:44:42.525 GMT [17566] LOG:  database system is shut down
2023-01-11 12:44:43.843 GMT [17846] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-11 12:44:43.843 GMT [17846] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-11 12:44:43.846 GMT [17846] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-11 12:44:43.851 GMT [17847] LOG:  database system was shut down at 2023-01-11 12:44:43 GMT
2023-01-11 12:44:43.857 GMT [17846] LOG:  database system is ready to accept connections
2023-01-12 08:57:02.340 GMT [17846] LOG:  received fast shutdown request
2023-01-12 08:57:02.351 GMT [17846] LOG:  aborting any active transactions
2023-01-12 08:57:02.394 GMT [17846] LOG:  background worker "logical replication launcher" (PID 17853) exited with exit code 1
2023-01-12 08:57:02.398 GMT [17848] LOG:  shutting down
2023-01-12 08:57:02.549 GMT [17846] LOG:  database system is shut down
2023-01-12 08:57:08.404 GMT [45638] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 08:57:08.404 GMT [45638] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 08:57:08.406 GMT [45638] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 08:57:08.410 GMT [45639] LOG:  database system was shut down at 2023-01-12 08:57:08 GMT
2023-01-12 08:57:08.420 GMT [45638] LOG:  database system is ready to accept connections
2023-01-12 08:57:09.152 GMT [45667] ERROR:  syntax error at or near "INSERT" at character 248
2023-01-12 08:57:09.152 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier
	
	    INSERT INTO management_log (account_id, action, date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:57:09.156 GMT [45667] ERROR:  syntax error at or near "DECLARE" at character 811
2023-01-12 08:57:09.156 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	BEGIN
	    INSERT INTO savings_account (account_id, current_balance, interest_rate) VALUES (account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-12 08:57:09.156 GMT [45667] ERROR:  syntax error at or near "INT" at character 17
2023-01-12 08:57:09.156 GMT [45667] STATEMENT:  DECLARE loan_id INT;
2023-01-12 08:57:09.156 GMT [45667] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-12 08:57:09.156 GMT [45667] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-12 08:57:09.157 GMT [45667] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-12 08:57:09.157 GMT [45667] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-12 08:57:09.157 GMT [45667] ERROR:  column "loan_id" does not exist at character 68
2023-01-12 08:57:09.157 GMT [45667] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-12 08:57:09.157 GMT [45667] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-12 08:57:09.157 GMT [45667] ERROR:  column "action" of relation "management_log" does not exist at character 41
2023-01-12 08:57:09.157 GMT [45667] STATEMENT:  INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-12 08:57:09.158 GMT [45667] ERROR:  syntax error at or near "passed" at character 1
2023-01-12 08:57:09.158 GMT [45667] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-12 08:57:09.158 GMT [45667] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-12 08:57:09.158 GMT [45667] STATEMENT:  RETURN passed;
2023-01-12 08:57:09.159 GMT [45667] WARNING:  there is no transaction in progress
2023-01-12 08:57:09.160 GMT [45667] ERROR:  syntax error at or near ")" at character 205
2023-01-12 08:57:09.160 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	        FROM debit_account
	        INNER JOIN debit_overdraft ON debit_account.id = debit_overdraft.account_id
	        WHERE debit_account.account_id = account_id;
	    SELECT client.
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:57:09.160 GMT [45667] ERROR:  syntax error at or near "CREATE" at character 58
2023-01-12 08:57:09.160 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_accounts()
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
2023-01-12 08:57:09.161 GMT [45667] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:57:09.161 GMT [45667] STATEMENT:  CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
2023-01-12 08:57:09.162 GMT [45667] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:57:09.162 GMT [45667] STATEMENT:  CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
2023-01-12 08:57:09.162 GMT [45667] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:57:09.162 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:57:09.163 GMT [45667] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:57:09.163 GMT [45667] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:58:34.257 GMT [45638] LOG:  received fast shutdown request
2023-01-12 08:58:34.259 GMT [45638] LOG:  aborting any active transactions
2023-01-12 08:58:34.264 GMT [45638] LOG:  background worker "logical replication launcher" (PID 45645) exited with exit code 1
2023-01-12 08:58:34.264 GMT [45640] LOG:  shutting down
2023-01-12 08:58:34.306 GMT [45638] LOG:  database system is shut down
2023-01-12 08:58:35.375 GMT [46031] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 08:58:35.376 GMT [46031] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 08:58:35.377 GMT [46031] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 08:58:35.382 GMT [46032] LOG:  database system was shut down at 2023-01-12 08:58:35 GMT
2023-01-12 08:58:35.387 GMT [46031] LOG:  database system is ready to accept connections
2023-01-12 08:58:36.110 GMT [46060] ERROR:  syntax error at or near ")" at character 205
2023-01-12 08:58:36.110 GMT [46060] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT debit_account.id, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	        FROM debit_account
	        INNER JOIN debit_overdraft ON debit_account.id = debit_overdraft.account_id
	        WHERE debit_account.account_id = account_id;
	    SELECT client.
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:58:36.111 GMT [46060] ERROR:  syntax error at or near "CREATE" at character 58
2023-01-12 08:58:36.111 GMT [46060] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_accounts()
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
2023-01-12 08:58:36.113 GMT [46060] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:58:36.113 GMT [46060] STATEMENT:  CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
2023-01-12 08:58:36.114 GMT [46060] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:58:36.114 GMT [46060] STATEMENT:  CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
2023-01-12 08:58:36.114 GMT [46060] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:58:36.114 GMT [46060] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 08:58:36.115 GMT [46060] ERROR:  schema "unauthenticated" does not exist
2023-01-12 08:58:36.115 GMT [46060] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
2023-01-12 10:06:08.629 GMT [46031] LOG:  received SIGHUP, reloading configuration files
2023-01-12 10:06:08.662 GMT [46031] LOG:  received smart shutdown request
2023-01-12 10:06:08.759 GMT [46031] LOG:  background worker "logical replication launcher" (PID 46038) exited with exit code 1
2023-01-12 10:06:08.760 GMT [46033] LOG:  shutting down
2023-01-12 10:06:08.836 GMT [46031] LOG:  database system is shut down
2023-01-12 18:20:53.832 GMT [15045] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:20:53.832 GMT [15045] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:20:53.834 GMT [15045] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:20:53.837 GMT [15046] LOG:  database system was shut down at 2023-01-12 18:20:53 GMT
2023-01-12 18:20:53.845 GMT [15045] LOG:  database system is ready to accept connections
2023-01-12 18:20:54.470 GMT [15087] ERROR:  schema "client" does not exist
2023-01-12 18:20:54.470 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS savings_account (
	    current_balance NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2)
	) INHERITS (client.account);
2023-01-12 18:20:54.470 GMT [15087] ERROR:  schema "client" does not exist
2023-01-12 18:20:54.470 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account (
	    outstanding_balance NUMERIC(15, 2),
	    credit_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2)
	) INHERITS (client.account);
2023-01-12 18:20:54.470 GMT [15087] ERROR:  schema "client" does not exist
2023-01-12 18:20:54.470 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_account (
	    current_balance NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2)
	) INHERITS (client.account);
2023-01-12 18:20:54.479 GMT [15087] ERROR:  relation "savings_account" does not exist
2023-01-12 18:20:54.479 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS savings_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES savings_account(account_number)
	);
2023-01-12 18:20:54.484 GMT [15087] ERROR:  relation "credit_account" does not exist
2023-01-12 18:20:54.484 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:20:54.486 GMT [15087] ERROR:  relation "credit_account" does not exist
2023-01-12 18:20:54.486 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:20:54.489 GMT [15087] ERROR:  relation "debit_account" does not exist
2023-01-12 18:20:54.489 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:20:54.492 GMT [15087] ERROR:  relation "debit_account" does not exist
2023-01-12 18:20:54.492 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2),
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:20:54.498 GMT [15087] ERROR:  relation "savings_statement" does not exist
2023-01-12 18:20:54.498 GMT [15087] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:21:25.261 GMT [15045] LOG:  received fast shutdown request
2023-01-12 18:21:25.262 GMT [15045] LOG:  aborting any active transactions
2023-01-12 18:21:25.267 GMT [15045] LOG:  background worker "logical replication launcher" (PID 15052) exited with exit code 1
2023-01-12 18:21:25.270 GMT [15047] LOG:  shutting down
2023-01-12 18:21:25.309 GMT [15045] LOG:  database system is shut down
2023-01-12 18:21:26.427 GMT [15255] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:21:26.428 GMT [15255] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:21:26.431 GMT [15255] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:21:26.438 GMT [15256] LOG:  database system was shut down at 2023-01-12 18:21:26 GMT
2023-01-12 18:21:26.446 GMT [15255] LOG:  database system is ready to accept connections
2023-01-12 18:21:27.100 GMT [15284] ERROR:  there is no unique constraint matching given keys for referenced table "savings_account"
2023-01-12 18:21:27.100 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS savings_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES savings_account(account_number)
	);
2023-01-12 18:21:27.109 GMT [15284] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:21:27.109 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:21:27.113 GMT [15284] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:21:27.113 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:21:27.120 GMT [15284] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:21:27.120 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:21:27.123 GMT [15284] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:21:27.123 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2),
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:21:27.127 GMT [15284] ERROR:  relation "savings_statement" does not exist
2023-01-12 18:21:27.127 GMT [15284] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:28:57.894 GMT [15255] LOG:  received fast shutdown request
2023-01-12 18:28:57.895 GMT [15255] LOG:  aborting any active transactions
2023-01-12 18:28:57.900 GMT [15255] LOG:  background worker "logical replication launcher" (PID 15262) exited with exit code 1
2023-01-12 18:28:57.901 GMT [15257] LOG:  shutting down
2023-01-12 18:28:57.916 GMT [15255] LOG:  database system is shut down
2023-01-12 18:28:59.323 GMT [16652] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:28:59.323 GMT [16652] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:28:59.325 GMT [16652] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:28:59.331 GMT [16653] LOG:  database system was shut down at 2023-01-12 18:28:59 GMT
2023-01-12 18:28:59.339 GMT [16652] LOG:  database system is ready to accept connections
2023-01-12 18:29:00.015 GMT [16684] ERROR:  column "savings_account_number" referenced in foreign key constraint does not exist
2023-01-12 18:29:00.015 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS savings_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES savings_account(savings_account_number)
	);
2023-01-12 18:29:00.022 GMT [16684] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:29:00.022 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:29:00.025 GMT [16684] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:29:00.025 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:29:00.029 GMT [16684] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:29:00.029 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:29:00.032 GMT [16684] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:29:00.032 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2),
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:29:00.037 GMT [16684] ERROR:  relation "savings_statement" does not exist
2023-01-12 18:29:00.037 GMT [16684] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:33:26.875 GMT [16652] LOG:  received fast shutdown request
2023-01-12 18:33:26.877 GMT [16652] LOG:  aborting any active transactions
2023-01-12 18:33:26.883 GMT [16652] LOG:  background worker "logical replication launcher" (PID 16659) exited with exit code 1
2023-01-12 18:33:26.885 GMT [16654] LOG:  shutting down
2023-01-12 18:33:26.925 GMT [16652] LOG:  database system is shut down
2023-01-12 18:33:28.126 GMT [17473] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:33:28.127 GMT [17473] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:33:28.128 GMT [17473] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:33:28.133 GMT [17474] LOG:  database system was shut down at 2023-01-12 18:33:27 GMT
2023-01-12 18:33:28.138 GMT [17473] LOG:  database system is ready to accept connections
2023-01-12 18:33:28.788 GMT [17499] ERROR:  column "savings_account_number" referenced in foreign key constraint does not exist
2023-01-12 18:33:28.788 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS savings_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES savings_account(savings_account_number)
	);
2023-01-12 18:33:28.794 GMT [17499] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:33:28.794 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:33:28.801 GMT [17499] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:33:28.801 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:33:28.805 GMT [17499] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:33:28.805 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:33:28.809 GMT [17499] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:33:28.809 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2),
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:33:28.814 GMT [17499] ERROR:  relation "savings_statement" does not exist
2023-01-12 18:33:28.814 GMT [17499] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:33:46.093 GMT [17473] LOG:  received fast shutdown request
2023-01-12 18:33:46.096 GMT [17473] LOG:  aborting any active transactions
2023-01-12 18:33:46.101 GMT [17473] LOG:  background worker "logical replication launcher" (PID 17480) exited with exit code 1
2023-01-12 18:33:46.101 GMT [17475] LOG:  shutting down
2023-01-12 18:33:46.147 GMT [17473] LOG:  database system is shut down
2023-01-12 18:33:47.204 GMT [17633] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:33:47.204 GMT [17633] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:33:47.206 GMT [17633] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:33:47.210 GMT [17634] LOG:  database system was shut down at 2023-01-12 18:33:46 GMT
2023-01-12 18:33:47.216 GMT [17633] LOG:  database system is ready to accept connections
2023-01-12 18:33:47.842 GMT [17659] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:33:47.842 GMT [17659] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:33:47.845 GMT [17659] ERROR:  there is no unique constraint matching given keys for referenced table "credit_account"
2023-01-12 18:33:47.845 GMT [17659] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:33:47.849 GMT [17659] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:33:47.849 GMT [17659] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:33:47.854 GMT [17659] ERROR:  there is no unique constraint matching given keys for referenced table "debit_account"
2023-01-12 18:33:47.854 GMT [17659] STATEMENT:  CREATE TABLE IF NOT EXISTS debit_overdraft (
	    id SERIAL PRIMARY KEY,
	    overdraft_usage NUMERIC(15, 2),
	    overdraft_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2),
	    account_number INT REFERENCES debit_account(account_number)
	);
2023-01-12 18:33:47.857 GMT [17659] ERROR:  relation "credit_statement" does not exist
2023-01-12 18:33:47.857 GMT [17659] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:34:15.858 GMT [17633] LOG:  received fast shutdown request
2023-01-12 18:34:15.861 GMT [17633] LOG:  aborting any active transactions
2023-01-12 18:34:15.864 GMT [17633] LOG:  background worker "logical replication launcher" (PID 17640) exited with exit code 1
2023-01-12 18:34:15.867 GMT [17635] LOG:  shutting down
2023-01-12 18:34:15.909 GMT [17633] LOG:  database system is shut down
2023-01-12 18:34:17.033 GMT [17834] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:34:17.034 GMT [17834] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:34:17.035 GMT [17834] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:34:17.040 GMT [17835] LOG:  database system was shut down at 2023-01-12 18:34:16 GMT
2023-01-12 18:34:17.046 GMT [17834] LOG:  database system is ready to accept connections
2023-01-12 18:34:17.663 GMT [17860] ERROR:  syntax error at or near "(" at character 165
2023-01-12 18:34:17.663 GMT [17860] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account (
	    outstanding_balance NUMERIC(15, 2),
	    credit_limit NUMERIC(15, 2),
	    interest_rate NUMERIC(5,2)
	    PRIMARY KEY (account_number)
	) INHERITS (account);
2023-01-12 18:34:17.688 GMT [17860] ERROR:  relation "credit_account" does not exist
2023-01-12 18:34:17.688 GMT [17860] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_account_application (
	    id SERIAL PRIMARY KEY,
	    application_status VARCHAR,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:34:17.692 GMT [17860] ERROR:  relation "credit_account" does not exist
2023-01-12 18:34:17.692 GMT [17860] STATEMENT:  CREATE TABLE IF NOT EXISTS credit_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    end_date DATE,
	    amount INT,
	    minimum_payment INT,
	    minimum_payment_due_date DATE,
	    account_number INT REFERENCES credit_account(account_number)
	);
2023-01-12 18:34:17.707 GMT [17860] ERROR:  relation "credit_statement" does not exist
2023-01-12 18:34:17.707 GMT [17860] STATEMENT:  CREATE TABLE IF NOT EXISTS transaction (
	    id SERIAL PRIMARY KEY,
	    origin_account_id INT,
	    dest_account_id INT,
	    amount NUMERIC(15, 2),
	    date DATE,
	    savings_statement_id INT REFERENCES savings_statement(id),
	    credit_statement_id INT REFERENCES credit_statement(id),
	    debit_statement_id INT REFERENCES debit_statement(id)
	);
2023-01-12 18:35:34.055 GMT [17834] LOG:  received fast shutdown request
2023-01-12 18:35:34.057 GMT [17834] LOG:  aborting any active transactions
2023-01-12 18:35:34.061 GMT [17834] LOG:  background worker "logical replication launcher" (PID 17841) exited with exit code 1
2023-01-12 18:35:34.061 GMT [17836] LOG:  shutting down
2023-01-12 18:35:34.103 GMT [17834] LOG:  database system is shut down
2023-01-12 18:35:35.239 GMT [18151] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:35:35.239 GMT [18151] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:35:35.240 GMT [18151] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:35:35.251 GMT [18155] LOG:  database system was shut down at 2023-01-12 18:35:35 GMT
2023-01-12 18:35:35.257 GMT [18151] LOG:  database system is ready to accept connections
2023-01-12 18:36:32.280 GMT [18151] LOG:  received fast shutdown request
2023-01-12 18:36:32.281 GMT [18151] LOG:  aborting any active transactions
2023-01-12 18:36:32.287 GMT [18151] LOG:  background worker "logical replication launcher" (PID 18161) exited with exit code 1
2023-01-12 18:36:32.287 GMT [18156] LOG:  shutting down
2023-01-12 18:36:32.322 GMT [18151] LOG:  database system is shut down
2023-01-12 18:36:33.392 GMT [18463] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:36:33.392 GMT [18463] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:36:33.394 GMT [18463] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:36:33.397 GMT [18464] LOG:  database system was shut down at 2023-01-12 18:36:33 GMT
2023-01-12 18:36:33.401 GMT [18463] LOG:  database system is ready to accept connections
2023-01-12 18:36:55.656 GMT [18463] LOG:  received fast shutdown request
2023-01-12 18:36:55.657 GMT [18463] LOG:  aborting any active transactions
2023-01-12 18:36:55.662 GMT [18463] LOG:  background worker "logical replication launcher" (PID 18470) exited with exit code 1
2023-01-12 18:36:55.663 GMT [18465] LOG:  shutting down
2023-01-12 18:36:55.701 GMT [18463] LOG:  database system is shut down
2023-01-12 18:36:56.767 GMT [18634] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:36:56.767 GMT [18634] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:36:56.768 GMT [18634] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:36:56.773 GMT [18635] LOG:  database system was shut down at 2023-01-12 18:36:56 GMT
2023-01-12 18:36:56.778 GMT [18634] LOG:  database system is ready to accept connections
2023-01-12 18:42:08.442 GMT [18634] LOG:  received fast shutdown request
2023-01-12 18:42:08.445 GMT [18634] LOG:  aborting any active transactions
2023-01-12 18:42:08.453 GMT [18634] LOG:  background worker "logical replication launcher" (PID 18641) exited with exit code 1
2023-01-12 18:42:08.473 GMT [18636] LOG:  shutting down
2023-01-12 18:42:08.483 GMT [18634] LOG:  database system is shut down
2023-01-12 18:42:09.662 GMT [19597] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:42:09.663 GMT [19597] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:42:09.664 GMT [19597] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:42:09.668 GMT [19598] LOG:  database system was shut down at 2023-01-12 18:42:09 GMT
2023-01-12 18:42:09.673 GMT [19597] LOG:  database system is ready to accept connections
2023-01-12 18:42:39.151 GMT [19597] LOG:  received fast shutdown request
2023-01-12 18:42:39.152 GMT [19597] LOG:  aborting any active transactions
2023-01-12 18:42:39.154 GMT [19597] LOG:  background worker "logical replication launcher" (PID 19604) exited with exit code 1
2023-01-12 18:42:39.158 GMT [19599] LOG:  shutting down
2023-01-12 18:42:39.194 GMT [19597] LOG:  database system is shut down
2023-01-12 18:42:40.292 GMT [19793] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:42:40.292 GMT [19793] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:42:40.294 GMT [19793] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:42:40.299 GMT [19794] LOG:  database system was shut down at 2023-01-12 18:42:40 GMT
2023-01-12 18:42:40.305 GMT [19793] LOG:  database system is ready to accept connections
2023-01-12 18:43:40.355 GMT [19793] LOG:  received fast shutdown request
2023-01-12 18:43:40.356 GMT [19793] LOG:  aborting any active transactions
2023-01-12 18:43:40.361 GMT [19793] LOG:  background worker "logical replication launcher" (PID 19800) exited with exit code 1
2023-01-12 18:43:40.361 GMT [19795] LOG:  shutting down
2023-01-12 18:43:40.398 GMT [19793] LOG:  database system is shut down
2023-01-12 18:43:41.524 GMT [20101] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 18:43:41.525 GMT [20101] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 18:43:41.526 GMT [20101] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 18:43:41.531 GMT [20102] LOG:  database system was shut down at 2023-01-12 18:43:41 GMT
2023-01-12 18:43:41.537 GMT [20101] LOG:  database system is ready to accept connections
2023-01-12 20:31:24.645 GMT [20101] LOG:  received fast shutdown request
2023-01-12 20:31:24.647 GMT [20101] LOG:  aborting any active transactions
2023-01-12 20:31:24.651 GMT [20101] LOG:  background worker "logical replication launcher" (PID 20108) exited with exit code 1
2023-01-12 20:31:24.656 GMT [20103] LOG:  shutting down
2023-01-12 20:31:24.671 GMT [20101] LOG:  database system is shut down
2023-01-12 20:31:28.964 GMT [37044] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-12 20:31:28.964 GMT [37044] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-12 20:31:28.966 GMT [37044] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-12 20:31:28.970 GMT [37045] LOG:  database system was shut down at 2023-01-12 20:31:28 GMT
2023-01-12 20:31:28.977 GMT [37044] LOG:  database system is ready to accept connections
2023-01-12 20:31:29.724 GMT [37073] ERROR:  new row for relation "savings_account" violates check constraint "account_number_8_digits"
2023-01-12 20:31:29.724 GMT [37073] DETAIL:  Failing row contains (1, null, 1000.00, 0.50).
2023-01-12 20:31:29.724 GMT [37073] STATEMENT:  INSERT INTO savings_account (account_number, current_balance, interest_rate) VALUES (1, 1000, 0.5);
2023-01-13 07:55:22.982 GMT [37044] LOG:  received fast shutdown request
2023-01-13 07:55:22.989 GMT [37044] LOG:  aborting any active transactions
2023-01-13 07:55:23.007 GMT [37044] LOG:  background worker "logical replication launcher" (PID 37051) exited with exit code 1
2023-01-13 07:55:23.010 GMT [37046] LOG:  shutting down
2023-01-13 07:55:23.082 GMT [37044] LOG:  database system is shut down
2023-01-13 07:55:42.473 GMT [60160] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 07:55:42.474 GMT [60160] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 07:55:42.476 GMT [60160] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 07:55:42.481 GMT [60161] LOG:  database system was shut down at 2023-01-13 07:55:42 GMT
2023-01-13 07:55:42.489 GMT [60160] LOG:  database system is ready to accept connections
2023-01-13 07:55:43.465 GMT [60186] ERROR:  syntax error at or near "DECLARE" at character 4670
2023-01-13 07:55:43.465 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:55:43.468 GMT [60186] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:55:43.468 GMT [60186] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_id);
2023-01-13 07:55:43.471 GMT [60186] ERROR:  column "action" of relation "management_log" does not exist at character 41
2023-01-13 07:55:43.471 GMT [60186] STATEMENT:  INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Updated personal information', CURRENT_DATE);
2023-01-13 07:55:43.473 GMT [60186] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:55:43.473 GMT [60186] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:55:43.474 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.474 GMT [60186] STATEMENT:  RETURN passed;
2023-01-13 07:55:43.475 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.478 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 07:55:43.478 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:55:43.481 GMT [60186] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:55:43.481 GMT [60186] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 07:55:43.482 GMT [60186] ERROR:  column "action" of relation "management_log" does not exist at character 41
2023-01-13 07:55:43.482 GMT [60186] STATEMENT:  INSERT INTO management_log (account_id, action, date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 07:55:43.483 GMT [60186] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:55:43.483 GMT [60186] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:55:43.483 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.483 GMT [60186] STATEMENT:  RETURN passed;
2023-01-13 07:55:43.484 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.484 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 07:55:43.484 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:55:43.484 GMT [60186] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:55:43.484 GMT [60186] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 07:55:43.484 GMT [60186] ERROR:  column "action" of relation "management_log" does not exist at character 41
2023-01-13 07:55:43.484 GMT [60186] STATEMENT:  INSERT INTO management_log (account_id, action, date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 07:55:43.485 GMT [60186] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:55:43.485 GMT [60186] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:55:43.485 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.485 GMT [60186] STATEMENT:  RETURN passed;
2023-01-13 07:55:43.485 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.486 GMT [60186] ERROR:  schema "client" does not exist
2023-01-13 07:55:43.486 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:55:43.486 GMT [60186] ERROR:  schema "client" does not exist
2023-01-13 07:55:43.486 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 07:55:43.487 GMT [60186] ERROR:  schema "client" does not exist
2023-01-13 07:55:43.487 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:55:43.488 GMT [60186] ERROR:  schema "client" does not exist
2023-01-13 07:55:43.488 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:55:43.488 GMT [60186] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 07:55:43.488 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 07:55:43.489 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 07:55:43.489 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 07:55:43.489 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.489 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 07:55:43.490 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.490 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 07:55:43.490 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 07:55:43.490 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.490 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 07:55:43.490 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.490 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 07:55:43.490 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 07:55:43.491 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.491 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 07:55:43.491 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.492 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 07:55:43.492 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 07:55:43.492 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.492 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 07:55:43.492 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.492 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:55:43.492 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 07:55:43.492 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.492 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 07:55:43.493 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.493 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:55:43.493 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 07:55:43.493 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.493 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 07:55:43.493 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.494 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:55:43.494 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 07:55:43.494 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.494 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 07:55:43.495 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.495 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:55:43.495 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 07:55:43.495 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.495 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 07:55:43.496 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.497 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:55:43.497 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 07:55:43.498 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.498 GMT [60186] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 07:55:43.499 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.500 GMT [60186] ERROR:  syntax error at or near "DECLARE" at character 1777
2023-01-13 07:55:43.500 GMT [60186] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, action, date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 07:55:43.500 GMT [60186] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 07:55:43.500 GMT [60186] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 07:55:43.507 GMT [60186] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 07:55:43.507 GMT [60186] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 07:55:43.508 GMT [60186] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 07:55:43.508 GMT [60186] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 07:55:43.508 GMT [60186] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 07:55:43.508 GMT [60186] STATEMENT:  END IF;
2023-01-13 07:55:43.509 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.509 GMT [60186] STATEMENT:  RETURN customer_id;
2023-01-13 07:55:43.509 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.509 GMT [60186] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 07:55:43.509 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 07:55:43.510 GMT [60186] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 07:55:43.510 GMT [60186] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 07:55:43.511 GMT [60186] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 07:55:43.511 GMT [60186] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 07:55:43.511 GMT [60186] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 07:55:43.511 GMT [60186] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 07:55:43.512 GMT [60186] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 07:55:43.512 GMT [60186] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 07:55:43.512 GMT [60186] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 07:55:43.512 GMT [60186] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 07:55:43.513 GMT [60186] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 07:55:43.513 GMT [60186] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 07:55:43.513 GMT [60186] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 07:55:43.513 GMT [60186] STATEMENT:  END LOOP;
2023-01-13 07:55:43.513 GMT [60186] ERROR:  column "account_id" does not exist at character 117
2023-01-13 07:55:43.513 GMT [60186] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 07:55:43.513 GMT [60186] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 07:55:43.514 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.514 GMT [60186] STATEMENT:  RETURN account_id;
2023-01-13 07:55:43.514 GMT [60186] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 07:55:43.514 GMT [60186] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 07:55:43.514 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.514 GMT [60186] STATEMENT:  RETURN NULL;
2023-01-13 07:55:43.514 GMT [60186] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 07:55:43.514 GMT [60186] STATEMENT:  END IF;
2023-01-13 07:55:43.515 GMT [60186] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:55:43.515 GMT [60186] STATEMENT:  RETURN success;
2023-01-13 07:55:43.515 GMT [60186] WARNING:  there is no transaction in progress
2023-01-13 07:55:43.515 GMT [60186] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 07:55:43.515 GMT [60186] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 07:59:31.099 GMT [60160] LOG:  received fast shutdown request
2023-01-13 07:59:31.101 GMT [60160] LOG:  aborting any active transactions
2023-01-13 07:59:31.110 GMT [60160] LOG:  background worker "logical replication launcher" (PID 60167) exited with exit code 1
2023-01-13 07:59:31.112 GMT [60162] LOG:  shutting down
2023-01-13 07:59:31.177 GMT [60160] LOG:  database system is shut down
2023-01-13 07:59:35.786 GMT [61006] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 07:59:35.786 GMT [61006] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 07:59:35.788 GMT [61006] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 07:59:35.795 GMT [61007] LOG:  database system was shut down at 2023-01-13 07:59:35 GMT
2023-01-13 07:59:35.802 GMT [61006] LOG:  database system is ready to accept connections
2023-01-13 07:59:36.685 GMT [61032] ERROR:  syntax error at or near "DECLARE" at character 4778
2023-01-13 07:59:36.685 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, translog_description.origin_account_id, translog_description.dest_account_id, translog_description.amount, translog_description.date
	    FROM debit_accounts_statements
	    INNER JOIN translog_description ON debit_accounts_statements.id = translog_description.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, translog_description.origin_account_id, translog_description.dest_account_id, translog_description.amount, translog_description.date
	    FROM credit_accounts_statements
	    INNER JOIN translog_description ON credit_accounts_statements.id = translog_description.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:59:36.685 GMT [61032] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:59:36.685 GMT [61032] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_id);
2023-01-13 07:59:36.686 GMT [61032] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 07:59:36.686 GMT [61032] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Updated personal information', CURRENT_DATE);
2023-01-13 07:59:36.686 GMT [61032] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:59:36.686 GMT [61032] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:59:36.686 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.686 GMT [61032] STATEMENT:  RETURN passed;
2023-01-13 07:59:36.686 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  RETURN passed;
2023-01-13 07:59:36.687 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 07:59:36.687 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.687 GMT [61032] STATEMENT:  RETURN passed;
2023-01-13 07:59:36.688 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.688 GMT [61032] ERROR:  schema "client" does not exist
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:59:36.688 GMT [61032] ERROR:  schema "client" does not exist
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 07:59:36.688 GMT [61032] ERROR:  schema "client" does not exist
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:59:36.688 GMT [61032] ERROR:  schema "client" does not exist
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 07:59:36.688 GMT [61032] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 07:59:36.688 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 07:59:36.688 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 07:59:36.688 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.688 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 07:59:36.688 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.688 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 07:59:36.688 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 07:59:36.689 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 07:59:36.689 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 07:59:36.689 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 07:59:36.689 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.689 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 07:59:36.690 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.690 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:59:36.690 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 07:59:36.690 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.690 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 07:59:36.690 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.691 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:59:36.691 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 07:59:36.691 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.691 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 07:59:36.691 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.691 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 07:59:36.691 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 07:59:36.691 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.691 GMT [61032] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 07:59:36.692 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.692 GMT [61032] ERROR:  syntax error at or near "DECLARE" at character 1786
2023-01-13 07:59:36.692 GMT [61032] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 07:59:36.692 GMT [61032] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 07:59:36.692 GMT [61032] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 07:59:36.694 GMT [61032] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 07:59:36.694 GMT [61032] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 07:59:36.694 GMT [61032] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 07:59:36.694 GMT [61032] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 07:59:36.694 GMT [61032] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 07:59:36.694 GMT [61032] STATEMENT:  END IF;
2023-01-13 07:59:36.694 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.694 GMT [61032] STATEMENT:  RETURN customer_id;
2023-01-13 07:59:36.695 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 07:59:36.695 GMT [61032] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 07:59:36.695 GMT [61032] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 07:59:36.696 GMT [61032] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 07:59:36.696 GMT [61032] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 07:59:36.696 GMT [61032] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 07:59:36.696 GMT [61032] STATEMENT:  END LOOP;
2023-01-13 07:59:36.696 GMT [61032] ERROR:  column "account_id" does not exist at character 117
2023-01-13 07:59:36.696 GMT [61032] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 07:59:36.696 GMT [61032] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 07:59:36.697 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.697 GMT [61032] STATEMENT:  RETURN account_id;
2023-01-13 07:59:36.697 GMT [61032] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 07:59:36.697 GMT [61032] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 07:59:36.697 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.697 GMT [61032] STATEMENT:  RETURN NULL;
2023-01-13 07:59:36.698 GMT [61032] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 07:59:36.698 GMT [61032] STATEMENT:  END IF;
2023-01-13 07:59:36.698 GMT [61032] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 07:59:36.698 GMT [61032] STATEMENT:  RETURN success;
2023-01-13 07:59:36.699 GMT [61032] WARNING:  there is no transaction in progress
2023-01-13 07:59:36.700 GMT [61032] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 07:59:36.700 GMT [61032] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:01:14.903 GMT [61006] LOG:  received fast shutdown request
2023-01-13 08:01:14.906 GMT [61006] LOG:  aborting any active transactions
2023-01-13 08:01:14.913 GMT [61006] LOG:  background worker "logical replication launcher" (PID 61013) exited with exit code 1
2023-01-13 08:01:14.914 GMT [61008] LOG:  shutting down
2023-01-13 08:01:14.960 GMT [61006] LOG:  database system is shut down
2023-01-13 08:01:16.389 GMT [61415] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:01:16.390 GMT [61415] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:01:16.392 GMT [61415] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:01:16.397 GMT [61416] LOG:  database system was shut down at 2023-01-13 08:01:16 GMT
2023-01-13 08:01:16.403 GMT [61415] LOG:  database system is ready to accept connections
2023-01-13 08:01:17.302 GMT [61451] ERROR:  syntax error at or near "DECLARE" at character 4670
2023-01-13 08:01:17.302 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:01:17.303 GMT [61451] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:01:17.303 GMT [61451] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_id);
2023-01-13 08:01:17.304 GMT [61451] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 08:01:17.304 GMT [61451] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Updated personal information', CURRENT_DATE);
2023-01-13 08:01:17.306 GMT [61451] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:01:17.306 GMT [61451] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:01:17.307 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.307 GMT [61451] STATEMENT:  RETURN passed;
2023-01-13 08:01:17.310 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.314 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:01:17.314 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:01:17.315 GMT [61451] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:01:17.315 GMT [61451] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:01:17.315 GMT [61451] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 08:01:17.315 GMT [61451] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:01:17.316 GMT [61451] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:01:17.316 GMT [61451] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:01:17.316 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.316 GMT [61451] STATEMENT:  RETURN passed;
2023-01-13 08:01:17.317 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.317 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:01:17.317 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:01:17.317 GMT [61451] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:01:17.317 GMT [61451] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:01:17.318 GMT [61451] ERROR:  column "date" of relation "management_log" does not exist at character 58
2023-01-13 08:01:17.318 GMT [61451] STATEMENT:  INSERT INTO management_log (account_id, log_description, date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:01:17.319 GMT [61451] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:01:17.319 GMT [61451] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:01:17.320 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.320 GMT [61451] STATEMENT:  RETURN passed;
2023-01-13 08:01:17.320 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.321 GMT [61451] ERROR:  schema "client" does not exist
2023-01-13 08:01:17.321 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:01:17.322 GMT [61451] ERROR:  schema "client" does not exist
2023-01-13 08:01:17.322 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:01:17.322 GMT [61451] ERROR:  schema "client" does not exist
2023-01-13 08:01:17.322 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:01:17.323 GMT [61451] ERROR:  schema "client" does not exist
2023-01-13 08:01:17.323 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:01:17.323 GMT [61451] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:01:17.323 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:01:17.323 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:01:17.323 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:01:17.324 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.324 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:01:17.324 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.325 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:01:17.325 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:01:17.325 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.325 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:01:17.326 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.326 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:01:17.326 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:01:17.327 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.327 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:01:17.327 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.327 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:01:17.327 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:01:17.327 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.327 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:01:17.328 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.328 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:01:17.328 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:01:17.328 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.328 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:01:17.328 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.329 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:01:17.329 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:01:17.329 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.329 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:01:17.329 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.329 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:01:17.329 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:01:17.329 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.329 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:01:17.330 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.330 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:01:17.330 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:01:17.331 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.331 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:01:17.331 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.331 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:01:17.331 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:01:17.331 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.331 GMT [61451] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:01:17.331 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.332 GMT [61451] ERROR:  syntax error at or near "DECLARE" at character 1786
2023-01-13 08:01:17.332 GMT [61451] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:01:17.332 GMT [61451] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:01:17.332 GMT [61451] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:01:17.333 GMT [61451] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:01:17.333 GMT [61451] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:01:17.334 GMT [61451] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:01:17.334 GMT [61451] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:01:17.334 GMT [61451] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:01:17.334 GMT [61451] STATEMENT:  END IF;
2023-01-13 08:01:17.334 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.334 GMT [61451] STATEMENT:  RETURN customer_id;
2023-01-13 08:01:17.334 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.334 GMT [61451] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:01:17.334 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:01:17.334 GMT [61451] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:01:17.334 GMT [61451] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:01:17.335 GMT [61451] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:01:17.335 GMT [61451] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:01:17.335 GMT [61451] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:01:17.335 GMT [61451] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:01:17.335 GMT [61451] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:01:17.335 GMT [61451] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:01:17.335 GMT [61451] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:01:17.335 GMT [61451] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:01:17.335 GMT [61451] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:01:17.335 GMT [61451] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:01:17.336 GMT [61451] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:01:17.336 GMT [61451] STATEMENT:  END LOOP;
2023-01-13 08:01:17.336 GMT [61451] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:01:17.336 GMT [61451] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:01:17.336 GMT [61451] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:01:17.336 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.336 GMT [61451] STATEMENT:  RETURN account_id;
2023-01-13 08:01:17.336 GMT [61451] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:01:17.336 GMT [61451] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:01:17.337 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.337 GMT [61451] STATEMENT:  RETURN NULL;
2023-01-13 08:01:17.338 GMT [61451] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:01:17.338 GMT [61451] STATEMENT:  END IF;
2023-01-13 08:01:17.338 GMT [61451] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:01:17.338 GMT [61451] STATEMENT:  RETURN success;
2023-01-13 08:01:17.338 GMT [61451] WARNING:  there is no transaction in progress
2023-01-13 08:01:17.339 GMT [61451] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:01:17.339 GMT [61451] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:02:53.163 GMT [61415] LOG:  received fast shutdown request
2023-01-13 08:02:53.165 GMT [61415] LOG:  aborting any active transactions
2023-01-13 08:02:53.169 GMT [61415] LOG:  background worker "logical replication launcher" (PID 61422) exited with exit code 1
2023-01-13 08:02:53.173 GMT [61417] LOG:  shutting down
2023-01-13 08:02:53.223 GMT [61415] LOG:  database system is shut down
2023-01-13 08:02:54.849 GMT [61827] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:02:54.849 GMT [61827] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:02:54.851 GMT [61827] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:02:54.858 GMT [61828] LOG:  database system was shut down at 2023-01-13 08:02:54 GMT
2023-01-13 08:02:54.863 GMT [61827] LOG:  database system is ready to accept connections
2023-01-13 08:02:55.735 GMT [61866] ERROR:  syntax error at or near "DECLARE" at character 4670
2023-01-13 08:02:55.735 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:02:55.735 GMT [61866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:02:55.735 GMT [61866] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_id);
2023-01-13 08:02:55.736 GMT [61866] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:02:55.736 GMT [61866] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:02:55.736 GMT [61866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Updated personal information', CURRENT_DATE);
2023-01-13 08:02:55.736 GMT [61866] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:02:55.736 GMT [61866] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:02:55.737 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.737 GMT [61866] STATEMENT:  RETURN passed;
2023-01-13 08:02:55.738 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.742 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:02:55.742 GMT [61866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:02:55.742 GMT [61866] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:02:55.742 GMT [61866] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:02:55.742 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  RETURN passed;
2023-01-13 08:02:55.742 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.742 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:02:55.742 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:02:55.743 GMT [61866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:02:55.743 GMT [61866] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:02:55.743 GMT [61866] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:02:55.743 GMT [61866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:02:55.743 GMT [61866] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:02:55.743 GMT [61866] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:02:55.743 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.743 GMT [61866] STATEMENT:  RETURN passed;
2023-01-13 08:02:55.743 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.744 GMT [61866] ERROR:  schema "client" does not exist
2023-01-13 08:02:55.744 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:02:55.744 GMT [61866] ERROR:  schema "client" does not exist
2023-01-13 08:02:55.744 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:02:55.745 GMT [61866] ERROR:  schema "client" does not exist
2023-01-13 08:02:55.745 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:02:55.746 GMT [61866] ERROR:  schema "client" does not exist
2023-01-13 08:02:55.746 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:02:55.746 GMT [61866] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:02:55.746 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:02:55.746 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:02:55.746 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:02:55.746 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.746 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:02:55.747 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.747 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:02:55.747 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:02:55.747 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.747 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:02:55.747 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.747 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:02:55.747 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:02:55.747 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.747 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:02:55.747 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.747 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:02:55.747 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:02:55.748 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.748 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:02:55.748 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.748 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:02:55.748 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:02:55.748 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.748 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:02:55.748 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.748 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:02:55.748 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:02:55.749 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.749 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:02:55.749 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.749 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:02:55.749 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:02:55.749 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.749 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:02:55.749 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.749 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:02:55.749 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:02:55.750 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.750 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:02:55.750 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.750 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:02:55.750 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:02:55.751 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.751 GMT [61866] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:02:55.751 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.751 GMT [61866] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:02:55.751 GMT [61866] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:02:55.751 GMT [61866] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:02:55.751 GMT [61866] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:02:55.753 GMT [61866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:02:55.753 GMT [61866] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:02:55.753 GMT [61866] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:02:55.753 GMT [61866] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:02:55.753 GMT [61866] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:02:55.753 GMT [61866] STATEMENT:  END IF;
2023-01-13 08:02:55.753 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.753 GMT [61866] STATEMENT:  RETURN customer_id;
2023-01-13 08:02:55.754 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:02:55.754 GMT [61866] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:02:55.754 GMT [61866] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:02:55.755 GMT [61866] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:02:55.755 GMT [61866] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:02:55.755 GMT [61866] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:02:55.755 GMT [61866] STATEMENT:  END LOOP;
2023-01-13 08:02:55.755 GMT [61866] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:02:55.755 GMT [61866] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:02:55.755 GMT [61866] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:02:55.755 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.755 GMT [61866] STATEMENT:  RETURN account_id;
2023-01-13 08:02:55.755 GMT [61866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:02:55.755 GMT [61866] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:02:55.756 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.756 GMT [61866] STATEMENT:  RETURN NULL;
2023-01-13 08:02:55.756 GMT [61866] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:02:55.756 GMT [61866] STATEMENT:  END IF;
2023-01-13 08:02:55.756 GMT [61866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:02:55.756 GMT [61866] STATEMENT:  RETURN success;
2023-01-13 08:02:55.757 GMT [61866] WARNING:  there is no transaction in progress
2023-01-13 08:02:55.757 GMT [61866] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:02:55.757 GMT [61866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:04:41.495 GMT [61827] LOG:  received fast shutdown request
2023-01-13 08:04:41.498 GMT [61827] LOG:  aborting any active transactions
2023-01-13 08:04:41.504 GMT [61827] LOG:  background worker "logical replication launcher" (PID 61834) exited with exit code 1
2023-01-13 08:04:41.505 GMT [61829] LOG:  shutting down
2023-01-13 08:04:41.568 GMT [61827] LOG:  database system is shut down
2023-01-13 08:04:43.211 GMT [62262] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:04:43.211 GMT [62262] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:04:43.213 GMT [62262] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:04:43.218 GMT [62263] LOG:  database system was shut down at 2023-01-13 08:04:42 GMT
2023-01-13 08:04:43.224 GMT [62262] LOG:  database system is ready to accept connections
2023-01-13 08:04:44.165 GMT [62298] ERROR:  syntax error at or near "DECLARE" at character 4686
2023-01-13 08:04:44.165 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_id INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:04:44.168 GMT [62298] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:04:44.168 GMT [62298] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_id);
2023-01-13 08:04:44.168 GMT [62298] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:04:44.168 GMT [62298] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:04:44.168 GMT [62298] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Updated personal information', CURRENT_DATE);
2023-01-13 08:04:44.169 GMT [62298] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:04:44.169 GMT [62298] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:04:44.170 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.170 GMT [62298] STATEMENT:  RETURN passed;
2023-01-13 08:04:44.170 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.170 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:04:44.170 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:04:44.171 GMT [62298] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:04:44.171 GMT [62298] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:04:44.171 GMT [62298] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:04:44.171 GMT [62298] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:04:44.171 GMT [62298] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:04:44.171 GMT [62298] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:04:44.171 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.171 GMT [62298] STATEMENT:  RETURN passed;
2023-01-13 08:04:44.171 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.172 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:04:44.172 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:04:44.172 GMT [62298] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:04:44.172 GMT [62298] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:04:44.172 GMT [62298] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:04:44.172 GMT [62298] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:04:44.173 GMT [62298] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:04:44.173 GMT [62298] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:04:44.173 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.173 GMT [62298] STATEMENT:  RETURN passed;
2023-01-13 08:04:44.173 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.174 GMT [62298] ERROR:  schema "client" does not exist
2023-01-13 08:04:44.174 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:04:44.174 GMT [62298] ERROR:  schema "client" does not exist
2023-01-13 08:04:44.174 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:04:44.174 GMT [62298] ERROR:  schema "client" does not exist
2023-01-13 08:04:44.174 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:04:44.175 GMT [62298] ERROR:  schema "client" does not exist
2023-01-13 08:04:44.175 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:04:44.175 GMT [62298] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:04:44.175 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:04:44.175 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:04:44.175 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:04:44.175 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.175 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:04:44.176 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.176 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:04:44.176 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:04:44.176 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.176 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:04:44.176 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.176 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:04:44.176 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:04:44.177 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.177 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:04:44.178 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.178 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:04:44.178 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:04:44.178 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.178 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:04:44.178 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.178 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:04:44.178 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:04:44.179 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.179 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:04:44.179 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.179 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:04:44.179 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:04:44.181 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.181 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:04:44.185 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.185 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:04:44.185 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:04:44.186 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.186 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:04:44.186 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.187 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:04:44.187 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:04:44.187 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.187 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:04:44.188 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.188 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:04:44.188 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:04:44.188 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.188 GMT [62298] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:04:44.189 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.189 GMT [62298] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:04:44.189 GMT [62298] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:04:44.190 GMT [62298] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:04:44.190 GMT [62298] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:04:44.195 GMT [62298] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:04:44.195 GMT [62298] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:04:44.195 GMT [62298] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:04:44.195 GMT [62298] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:04:44.196 GMT [62298] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:04:44.196 GMT [62298] STATEMENT:  END IF;
2023-01-13 08:04:44.196 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.196 GMT [62298] STATEMENT:  RETURN customer_id;
2023-01-13 08:04:44.197 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.197 GMT [62298] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:04:44.197 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:04:44.197 GMT [62298] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:04:44.197 GMT [62298] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:04:44.198 GMT [62298] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:04:44.198 GMT [62298] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:04:44.198 GMT [62298] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:04:44.198 GMT [62298] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:04:44.198 GMT [62298] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:04:44.198 GMT [62298] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:04:44.199 GMT [62298] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:04:44.199 GMT [62298] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:04:44.199 GMT [62298] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:04:44.199 GMT [62298] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:04:44.200 GMT [62298] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:04:44.200 GMT [62298] STATEMENT:  END LOOP;
2023-01-13 08:04:44.200 GMT [62298] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:04:44.200 GMT [62298] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:04:44.200 GMT [62298] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:04:44.201 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.201 GMT [62298] STATEMENT:  RETURN account_id;
2023-01-13 08:04:44.201 GMT [62298] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:04:44.201 GMT [62298] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:04:44.201 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.201 GMT [62298] STATEMENT:  RETURN NULL;
2023-01-13 08:04:44.201 GMT [62298] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:04:44.201 GMT [62298] STATEMENT:  END IF;
2023-01-13 08:04:44.202 GMT [62298] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:04:44.202 GMT [62298] STATEMENT:  RETURN success;
2023-01-13 08:04:44.202 GMT [62298] WARNING:  there is no transaction in progress
2023-01-13 08:04:44.202 GMT [62298] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:04:44.202 GMT [62298] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:05:12.321 GMT [62262] LOG:  received fast shutdown request
2023-01-13 08:05:12.323 GMT [62262] LOG:  aborting any active transactions
2023-01-13 08:05:12.328 GMT [62262] LOG:  background worker "logical replication launcher" (PID 62269) exited with exit code 1
2023-01-13 08:05:12.330 GMT [62264] LOG:  shutting down
2023-01-13 08:05:12.391 GMT [62262] LOG:  database system is shut down
2023-01-13 08:05:13.915 GMT [62466] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:05:13.916 GMT [62466] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:05:13.918 GMT [62466] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:05:13.923 GMT [62467] LOG:  database system was shut down at 2023-01-13 08:05:13 GMT
2023-01-13 08:05:13.930 GMT [62466] LOG:  database system is ready to accept connections
2023-01-13 08:05:14.771 GMT [62502] ERROR:  syntax error at or near "DECLARE" at character 4694
2023-01-13 08:05:14.771 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:05:14.772 GMT [62502] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:05:14.772 GMT [62502] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-13 08:05:14.772 GMT [62502] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:05:14.772 GMT [62502] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated personal information', CURRENT_DATE);
2023-01-13 08:05:14.773 GMT [62502] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:05:14.773 GMT [62502] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:05:14.774 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.774 GMT [62502] STATEMENT:  RETURN passed;
2023-01-13 08:05:14.775 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.775 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:05:14.775 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:05:14.775 GMT [62502] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:05:14.775 GMT [62502] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:05:14.776 GMT [62502] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:05:14.776 GMT [62502] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:05:14.776 GMT [62502] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:05:14.776 GMT [62502] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:05:14.776 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.776 GMT [62502] STATEMENT:  RETURN passed;
2023-01-13 08:05:14.776 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.777 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:05:14.777 GMT [62502] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:05:14.777 GMT [62502] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:05:14.777 GMT [62502] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:05:14.777 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  RETURN passed;
2023-01-13 08:05:14.777 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.777 GMT [62502] ERROR:  schema "client" does not exist
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:05:14.777 GMT [62502] ERROR:  schema "client" does not exist
2023-01-13 08:05:14.777 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:05:14.779 GMT [62502] ERROR:  schema "client" does not exist
2023-01-13 08:05:14.779 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:05:14.779 GMT [62502] ERROR:  schema "client" does not exist
2023-01-13 08:05:14.779 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:05:14.780 GMT [62502] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:05:14.780 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:05:14.781 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:05:14.781 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:05:14.782 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.782 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:05:14.782 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.782 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:05:14.782 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:05:14.783 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.783 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:05:14.783 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.783 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:05:14.783 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:05:14.783 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.783 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:05:14.784 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.784 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:05:14.784 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:05:14.784 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.784 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:05:14.784 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.784 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:05:14.784 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:05:14.785 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.785 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:05:14.785 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.786 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:05:14.786 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:05:14.786 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.786 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:05:14.786 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.787 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:05:14.787 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:05:14.787 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.787 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:05:14.787 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.788 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:05:14.788 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:05:14.788 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.788 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:05:14.788 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.788 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:05:14.788 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:05:14.788 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.788 GMT [62502] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:05:14.789 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.789 GMT [62502] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:05:14.789 GMT [62502] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:05:14.789 GMT [62502] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:05:14.789 GMT [62502] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:05:14.790 GMT [62502] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:05:14.790 GMT [62502] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:05:14.790 GMT [62502] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:05:14.790 GMT [62502] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:05:14.791 GMT [62502] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:05:14.791 GMT [62502] STATEMENT:  END IF;
2023-01-13 08:05:14.791 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.791 GMT [62502] STATEMENT:  RETURN customer_id;
2023-01-13 08:05:14.791 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.791 GMT [62502] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:05:14.791 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:05:14.791 GMT [62502] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:05:14.791 GMT [62502] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:05:14.792 GMT [62502] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:05:14.792 GMT [62502] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:05:14.792 GMT [62502] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:05:14.792 GMT [62502] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:05:14.792 GMT [62502] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:05:14.792 GMT [62502] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:05:14.792 GMT [62502] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:05:14.792 GMT [62502] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:05:14.793 GMT [62502] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:05:14.793 GMT [62502] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:05:14.794 GMT [62502] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:05:14.794 GMT [62502] STATEMENT:  END LOOP;
2023-01-13 08:05:14.794 GMT [62502] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:05:14.794 GMT [62502] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:05:14.794 GMT [62502] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:05:14.795 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.795 GMT [62502] STATEMENT:  RETURN account_id;
2023-01-13 08:05:14.797 GMT [62502] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:05:14.797 GMT [62502] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:05:14.798 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.798 GMT [62502] STATEMENT:  RETURN NULL;
2023-01-13 08:05:14.799 GMT [62502] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:05:14.799 GMT [62502] STATEMENT:  END IF;
2023-01-13 08:05:14.799 GMT [62502] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:05:14.799 GMT [62502] STATEMENT:  RETURN success;
2023-01-13 08:05:14.799 GMT [62502] WARNING:  there is no transaction in progress
2023-01-13 08:05:14.800 GMT [62502] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:05:14.800 GMT [62502] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:07:07.886 GMT [62466] LOG:  received fast shutdown request
2023-01-13 08:07:07.888 GMT [62466] LOG:  aborting any active transactions
2023-01-13 08:07:07.893 GMT [62466] LOG:  background worker "logical replication launcher" (PID 62473) exited with exit code 1
2023-01-13 08:07:07.900 GMT [62468] LOG:  shutting down
2023-01-13 08:07:07.954 GMT [62466] LOG:  database system is shut down
2023-01-13 08:07:09.632 GMT [62922] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:07:09.632 GMT [62922] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:07:09.637 GMT [62922] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:07:09.643 GMT [62923] LOG:  database system was shut down at 2023-01-13 08:07:09 GMT
2023-01-13 08:07:09.649 GMT [62922] LOG:  database system is ready to accept connections
2023-01-13 08:07:10.568 GMT [62961] ERROR:  syntax error at or near "DECLARE" at character 4694
2023-01-13 08:07:10.568 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:07:10.569 GMT [62961] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:07:10.569 GMT [62961] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-13 08:07:10.569 GMT [62961] ERROR:  column "account_identifier" does not exist at character 122
2023-01-13 08:07:10.569 GMT [62961] STATEMENT:  INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
2023-01-13 08:07:10.569 GMT [62961] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:07:10.569 GMT [62961] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:07:10.569 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.569 GMT [62961] STATEMENT:  RETURN passed;
2023-01-13 08:07:10.570 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.570 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:07:10.570 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:07:10.574 GMT [62961] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:07:10.574 GMT [62961] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:07:10.574 GMT [62961] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:07:10.574 GMT [62961] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:07:10.575 GMT [62961] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:07:10.575 GMT [62961] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:07:10.575 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.575 GMT [62961] STATEMENT:  RETURN passed;
2023-01-13 08:07:10.576 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.576 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:07:10.576 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:07:10.577 GMT [62961] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:07:10.577 GMT [62961] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:07:10.578 GMT [62961] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:07:10.578 GMT [62961] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:07:10.578 GMT [62961] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:07:10.578 GMT [62961] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:07:10.578 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.578 GMT [62961] STATEMENT:  RETURN passed;
2023-01-13 08:07:10.578 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.579 GMT [62961] ERROR:  schema "client" does not exist
2023-01-13 08:07:10.579 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:07:10.579 GMT [62961] ERROR:  schema "client" does not exist
2023-01-13 08:07:10.579 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:07:10.579 GMT [62961] ERROR:  schema "client" does not exist
2023-01-13 08:07:10.579 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:07:10.579 GMT [62961] ERROR:  schema "client" does not exist
2023-01-13 08:07:10.579 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:07:10.580 GMT [62961] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:07:10.580 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:07:10.581 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:07:10.581 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:07:10.581 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.581 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:07:10.581 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.581 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:07:10.581 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:07:10.582 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.582 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:07:10.582 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.582 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:07:10.582 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:07:10.583 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.583 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:07:10.583 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.586 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:07:10.586 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:07:10.587 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.587 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:07:10.587 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.587 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:07:10.587 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:07:10.587 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.587 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:07:10.588 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.594 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:07:10.594 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:07:10.594 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.594 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:07:10.595 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.595 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:07:10.595 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:07:10.595 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.595 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:07:10.595 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.595 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:07:10.595 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:07:10.595 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.595 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:07:10.597 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.598 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:07:10.598 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:07:10.598 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.598 GMT [62961] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:07:10.598 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.598 GMT [62961] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:07:10.598 GMT [62961] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:07:10.599 GMT [62961] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:07:10.599 GMT [62961] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:07:10.601 GMT [62961] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:07:10.601 GMT [62961] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:07:10.602 GMT [62961] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:07:10.602 GMT [62961] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:07:10.602 GMT [62961] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:07:10.602 GMT [62961] STATEMENT:  END IF;
2023-01-13 08:07:10.602 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.602 GMT [62961] STATEMENT:  RETURN customer_id;
2023-01-13 08:07:10.603 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.603 GMT [62961] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:07:10.603 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:07:10.603 GMT [62961] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:07:10.603 GMT [62961] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:07:10.604 GMT [62961] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:07:10.604 GMT [62961] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:07:10.604 GMT [62961] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:07:10.604 GMT [62961] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:07:10.604 GMT [62961] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:07:10.604 GMT [62961] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:07:10.605 GMT [62961] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:07:10.605 GMT [62961] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:07:10.605 GMT [62961] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:07:10.605 GMT [62961] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:07:10.605 GMT [62961] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:07:10.605 GMT [62961] STATEMENT:  END LOOP;
2023-01-13 08:07:10.605 GMT [62961] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:07:10.605 GMT [62961] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:07:10.605 GMT [62961] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:07:10.607 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.607 GMT [62961] STATEMENT:  RETURN account_id;
2023-01-13 08:07:10.607 GMT [62961] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:07:10.607 GMT [62961] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:07:10.607 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.607 GMT [62961] STATEMENT:  RETURN NULL;
2023-01-13 08:07:10.608 GMT [62961] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:07:10.608 GMT [62961] STATEMENT:  END IF;
2023-01-13 08:07:10.608 GMT [62961] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:07:10.608 GMT [62961] STATEMENT:  RETURN success;
2023-01-13 08:07:10.608 GMT [62961] WARNING:  there is no transaction in progress
2023-01-13 08:07:10.608 GMT [62961] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:07:10.608 GMT [62961] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:08:56.566 GMT [62922] LOG:  received fast shutdown request
2023-01-13 08:08:56.568 GMT [62922] LOG:  aborting any active transactions
2023-01-13 08:08:56.574 GMT [62922] LOG:  background worker "logical replication launcher" (PID 62929) exited with exit code 1
2023-01-13 08:08:56.574 GMT [62924] LOG:  shutting down
2023-01-13 08:08:56.620 GMT [62922] LOG:  database system is shut down
2023-01-13 08:08:58.002 GMT [63346] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:08:58.003 GMT [63346] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:08:58.005 GMT [63346] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:08:58.013 GMT [63350] LOG:  database system was shut down at 2023-01-13 08:08:57 GMT
2023-01-13 08:08:58.019 GMT [63346] LOG:  database system is ready to accept connections
2023-01-13 08:08:58.843 GMT [63385] ERROR:  syntax error at or near "DECLARE" at character 4694
2023-01-13 08:08:58.843 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:08:58.845 GMT [63385] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:08:58.845 GMT [63385] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-13 08:08:58.845 GMT [63385] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:08:58.845 GMT [63385] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:08:58.846 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.846 GMT [63385] STATEMENT:  RETURN passed;
2023-01-13 08:08:58.846 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.847 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:08:58.847 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:08:58.847 GMT [63385] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:08:58.847 GMT [63385] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-13 08:08:58.848 GMT [63385] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:08:58.848 GMT [63385] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-13 08:08:58.849 GMT [63385] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:08:58.849 GMT [63385] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:08:58.849 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.849 GMT [63385] STATEMENT:  RETURN passed;
2023-01-13 08:08:58.850 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.850 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:08:58.850 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:08:58.850 GMT [63385] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-13 08:08:58.850 GMT [63385] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-13 08:08:58.850 GMT [63385] ERROR:  column "account_identifier" does not exist at character 76
2023-01-13 08:08:58.850 GMT [63385] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-13 08:08:58.851 GMT [63385] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:08:58.851 GMT [63385] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:08:58.851 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.851 GMT [63385] STATEMENT:  RETURN passed;
2023-01-13 08:08:58.852 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.853 GMT [63385] ERROR:  schema "client" does not exist
2023-01-13 08:08:58.853 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:08:58.854 GMT [63385] ERROR:  schema "client" does not exist
2023-01-13 08:08:58.854 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:08:58.854 GMT [63385] ERROR:  schema "client" does not exist
2023-01-13 08:08:58.854 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:08:58.854 GMT [63385] ERROR:  schema "client" does not exist
2023-01-13 08:08:58.854 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:08:58.855 GMT [63385] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:08:58.855 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:08:58.856 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:08:58.856 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:08:58.856 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.856 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:08:58.856 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.857 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:08:58.857 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:08:58.858 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.858 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:08:58.862 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.863 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:08:58.863 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:08:58.864 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.864 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:08:58.864 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.864 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:08:58.864 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:08:58.865 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.865 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:08:58.865 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.865 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:08:58.865 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:08:58.865 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.865 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:08:58.865 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.866 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:08:58.866 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:08:58.866 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.866 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:08:58.866 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.866 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:08:58.866 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:08:58.867 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.867 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:08:58.867 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.867 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:08:58.867 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:08:58.867 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.867 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:08:58.867 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.868 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:08:58.868 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:08:58.868 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.868 GMT [63385] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:08:58.868 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.869 GMT [63385] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:08:58.869 GMT [63385] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:08:58.869 GMT [63385] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:08:58.869 GMT [63385] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:08:58.871 GMT [63385] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:08:58.871 GMT [63385] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:08:58.871 GMT [63385] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:08:58.871 GMT [63385] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:08:58.871 GMT [63385] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:08:58.871 GMT [63385] STATEMENT:  END IF;
2023-01-13 08:08:58.872 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.872 GMT [63385] STATEMENT:  RETURN customer_id;
2023-01-13 08:08:58.872 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.872 GMT [63385] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:08:58.872 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:08:58.872 GMT [63385] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:08:58.872 GMT [63385] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:08:58.872 GMT [63385] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:08:58.872 GMT [63385] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:08:58.873 GMT [63385] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:08:58.873 GMT [63385] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:08:58.873 GMT [63385] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:08:58.873 GMT [63385] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:08:58.874 GMT [63385] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:08:58.874 GMT [63385] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:08:58.874 GMT [63385] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:08:58.874 GMT [63385] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:08:58.874 GMT [63385] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:08:58.874 GMT [63385] STATEMENT:  END LOOP;
2023-01-13 08:08:58.875 GMT [63385] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:08:58.875 GMT [63385] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:08:58.875 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  RETURN account_id;
2023-01-13 08:08:58.875 GMT [63385] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:08:58.875 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  RETURN NULL;
2023-01-13 08:08:58.875 GMT [63385] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  END IF;
2023-01-13 08:08:58.875 GMT [63385] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:08:58.875 GMT [63385] STATEMENT:  RETURN success;
2023-01-13 08:08:58.876 GMT [63385] WARNING:  there is no transaction in progress
2023-01-13 08:08:58.876 GMT [63385] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:08:58.876 GMT [63385] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:09:31.867 GMT [63346] LOG:  received fast shutdown request
2023-01-13 08:09:31.870 GMT [63346] LOG:  aborting any active transactions
2023-01-13 08:09:31.874 GMT [63346] LOG:  background worker "logical replication launcher" (PID 63356) exited with exit code 1
2023-01-13 08:09:31.875 GMT [63351] LOG:  shutting down
2023-01-13 08:09:31.921 GMT [63346] LOG:  database system is shut down
2023-01-13 08:09:33.666 GMT [63562] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:09:33.666 GMT [63562] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:09:33.668 GMT [63562] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:09:33.674 GMT [63563] LOG:  database system was shut down at 2023-01-13 08:09:33 GMT
2023-01-13 08:09:33.680 GMT [63562] LOG:  database system is ready to accept connections
2023-01-13 08:09:34.529 GMT [63598] ERROR:  syntax error at or near "CREATE" at character 4709
2023-01-13 08:09:34.529 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION get_next_account_number()
	RETURNS INT AS $$
	DECLARE next_account_number INT;
	BEGIN
	    SELECT MAX(account_number) INTO next_account_number FROM debit_account;
	    IF next_account_number IS NULL THEN
	        next_account_number = 10000000;
	    ELSE
	        next_account_number = next_account_number + 1;
	    END IF;
	    RETURN next_account_number;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW 
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
	
	-- CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	-- RETURNS BOOLEAN AS $$
	
	
	
	
	
	
	
	
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.529 GMT [63598] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:09:34.529 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:09:34.530 GMT [63598] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:09:34.530 GMT [63598] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:09:34.530 GMT [63598] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:09:34.530 GMT [63598] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:09:34.530 GMT [63598] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:09:34.530 GMT [63598] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:09:34.530 GMT [63598] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:09:34.530 GMT [63598] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:09:34.531 GMT [63598] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:09:34.531 GMT [63598] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:09:34.531 GMT [63598] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:09:34.531 GMT [63598] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:09:34.532 GMT [63598] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:09:34.532 GMT [63598] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:09:34.532 GMT [63598] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:09:34.532 GMT [63598] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:09:34.532 GMT [63598] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:09:34.532 GMT [63598] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:09:34.532 GMT [63598] STATEMENT:  RETURN passed;
2023-01-13 08:09:34.532 GMT [63598] WARNING:  there is no transaction in progress
2023-01-13 08:09:34.532 GMT [63598] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:09:34.532 GMT [63598] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:09:34.533 GMT [63598] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:09:34.533 GMT [63598] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:09:34.533 GMT [63598] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:09:34.533 GMT [63598] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:09:34.533 GMT [63598] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:09:34.534 GMT [63598] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:09:34.534 GMT [63598] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:09:34.534 GMT [63598] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  RETURN passed;
2023-01-13 08:09:34.534 GMT [63598] WARNING:  there is no transaction in progress
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:09:34.534 GMT [63598] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:09:34.534 GMT [63598] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:09:34.535 GMT [63598] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:09:34.535 GMT [63598] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:09:34.535 GMT [63598] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:09:34.535 GMT [63598] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:09:34.535 GMT [63598] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:09:34.535 GMT [63598] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  RETURN passed;
2023-01-13 08:09:34.535 GMT [63598] WARNING:  there is no transaction in progress
2023-01-13 08:09:34.535 GMT [63598] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:09:34.535 GMT [63598] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:09:34.535 GMT [63598] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:09:34.535 GMT [63598] STATEMENT:  RETURN account_type;
2023-01-13 08:09:34.535 GMT [63598] WARNING:  there is no transaction in progress
2023-01-13 08:09:34.536 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.536 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.536 GMT [63598] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:09:34.536 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.536 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.536 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.536 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.536 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.536 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.536 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.537 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.537 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.537 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.537 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.537 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.537 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.537 GMT [63598] ERROR:  schema "client" does not exist
2023-01-13 08:09:34.537 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:09:34.537 GMT [63598] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:09:34.537 GMT [63598] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:11:21.196 GMT [63562] LOG:  received fast shutdown request
2023-01-13 08:11:21.197 GMT [63562] LOG:  aborting any active transactions
2023-01-13 08:11:21.204 GMT [63562] LOG:  background worker "logical replication launcher" (PID 63569) exited with exit code 1
2023-01-13 08:11:21.205 GMT [63564] LOG:  shutting down
2023-01-13 08:11:21.262 GMT [63562] LOG:  database system is shut down
2023-01-13 08:11:22.944 GMT [64035] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:11:22.945 GMT [64035] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:11:22.946 GMT [64035] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:11:22.954 GMT [64036] LOG:  database system was shut down at 2023-01-13 08:11:22 GMT
2023-01-13 08:11:22.963 GMT [64035] LOG:  database system is ready to accept connections
2023-01-13 08:11:23.846 GMT [64071] ERROR:  syntax error at or near "CREATE" at character 25
2023-01-13 08:11:23.846 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW 
	CREATE SCHEMA IF NOT EXISTS client;
2023-01-13 08:11:23.849 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.849 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
2023-01-13 08:11:23.853 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.853 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
2023-01-13 08:11:23.856 GMT [64071] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-13 08:11:23.856 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-13 08:11:23.858 GMT [64071] ERROR:  relation "debit_accounts_statements" does not exist at character 397
2023-01-13 08:11:23.858 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-13 08:11:23.859 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.859 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
2023-01-13 08:11:23.859 GMT [64071] ERROR:  relation "credit_accounts" does not exist at character 322
2023-01-13 08:11:23.859 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
2023-01-13 08:11:23.860 GMT [64071] ERROR:  relation "credit_accounts_statements" does not exist at character 501
2023-01-13 08:11:23.860 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-13 08:11:23.861 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.861 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
2023-01-13 08:11:23.861 GMT [64071] ERROR:  relation "savings_accounts" does not exist at character 252
2023-01-13 08:11:23.861 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
2023-01-13 08:11:23.863 GMT [64071] ERROR:  column loan_application.account_id does not exist at character 216
2023-01-13 08:11:23.863 GMT [64071] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
2023-01-13 08:11:23.864 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.864 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.865 GMT [64071] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:11:23.865 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:23.865 GMT [64071] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:11:23.865 GMT [64071] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:11:23.866 GMT [64071] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:23.866 GMT [64071] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:23.866 GMT [64071] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:23.866 GMT [64071] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:23.866 GMT [64071] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:11:23.866 GMT [64071] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:11:23.867 GMT [64071] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:11:23.867 GMT [64071] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:11:23.867 GMT [64071] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:11:23.867 GMT [64071] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:11:23.867 GMT [64071] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:23.867 GMT [64071] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:23.867 GMT [64071] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:11:23.867 GMT [64071] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:23.867 GMT [64071] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:23.868 GMT [64071] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:23.868 GMT [64071] STATEMENT:  RETURN passed;
2023-01-13 08:11:23.868 GMT [64071] WARNING:  there is no transaction in progress
2023-01-13 08:11:23.868 GMT [64071] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:11:23.868 GMT [64071] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:23.868 GMT [64071] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:11:23.868 GMT [64071] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:11:23.868 GMT [64071] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:23.868 GMT [64071] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:23.868 GMT [64071] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:23.868 GMT [64071] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:23.869 GMT [64071] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:11:23.869 GMT [64071] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:11:23.869 GMT [64071] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:11:23.869 GMT [64071] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:11:23.869 GMT [64071] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:11:23.869 GMT [64071] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:11:23.870 GMT [64071] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:23.870 GMT [64071] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:23.870 GMT [64071] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:11:23.870 GMT [64071] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:11:23.870 GMT [64071] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:23.870 GMT [64071] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:11:23.870 GMT [64071] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:11:23.870 GMT [64071] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:23.870 GMT [64071] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:23.871 GMT [64071] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:23.871 GMT [64071] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:23.871 GMT [64071] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:11:23.871 GMT [64071] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:11:23.871 GMT [64071] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:11:23.871 GMT [64071] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:11:23.872 GMT [64071] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:23.872 GMT [64071] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:23.872 GMT [64071] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:11:23.872 GMT [64071] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:11:23.872 GMT [64071] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:11:23.872 GMT [64071] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:23.872 GMT [64071] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:23.873 GMT [64071] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:23.873 GMT [64071] STATEMENT:  RETURN passed;
2023-01-13 08:11:23.873 GMT [64071] WARNING:  there is no transaction in progress
2023-01-13 08:11:23.873 GMT [64071] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:11:23.873 GMT [64071] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:23.874 GMT [64071] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:11:23.874 GMT [64071] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:11:23.874 GMT [64071] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:11:23.874 GMT [64071] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:11:23.874 GMT [64071] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:11:23.874 GMT [64071] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:11:23.875 GMT [64071] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:11:23.875 GMT [64071] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:11:23.875 GMT [64071] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:11:23.875 GMT [64071] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:23.875 GMT [64071] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:23.875 GMT [64071] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:11:23.875 GMT [64071] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:23.875 GMT [64071] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:23.876 GMT [64071] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:23.876 GMT [64071] STATEMENT:  RETURN passed;
2023-01-13 08:11:23.876 GMT [64071] WARNING:  there is no transaction in progress
2023-01-13 08:11:23.876 GMT [64071] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:11:23.876 GMT [64071] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:11:23.876 GMT [64071] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:23.876 GMT [64071] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:11:23.876 GMT [64071] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:23.876 GMT [64071] STATEMENT:  RETURN account_type;
2023-01-13 08:11:23.877 GMT [64071] WARNING:  there is no transaction in progress
2023-01-13 08:11:23.877 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.877 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.877 GMT [64071] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:11:23.877 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.878 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.878 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.878 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.878 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.878 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.878 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.879 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.879 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.879 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.879 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.879 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.879 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.879 GMT [64071] ERROR:  schema "client" does not exist
2023-01-13 08:11:23.879 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:23.880 GMT [64071] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:11:23.880 GMT [64071] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:11:42.123 GMT [64035] LOG:  received fast shutdown request
2023-01-13 08:11:42.124 GMT [64035] LOG:  aborting any active transactions
2023-01-13 08:11:42.130 GMT [64035] LOG:  background worker "logical replication launcher" (PID 64042) exited with exit code 1
2023-01-13 08:11:42.133 GMT [64037] LOG:  shutting down
2023-01-13 08:11:42.196 GMT [64035] LOG:  database system is shut down
2023-01-13 08:11:43.708 GMT [64203] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:11:43.708 GMT [64203] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:11:43.710 GMT [64203] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:11:43.715 GMT [64204] LOG:  database system was shut down at 2023-01-13 08:11:43 GMT
2023-01-13 08:11:43.722 GMT [64203] LOG:  database system is ready to accept connections
2023-01-13 08:11:44.621 GMT [64239] ERROR:  column "interest_rate" specified more than once
2023-01-13 08:11:44.621 GMT [64239] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
2023-01-13 08:11:44.621 GMT [64239] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-13 08:11:44.621 GMT [64239] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-13 08:11:44.622 GMT [64239] ERROR:  relation "debit_accounts_statements" does not exist at character 397
2023-01-13 08:11:44.622 GMT [64239] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-13 08:11:44.628 GMT [64239] ERROR:  column "amount" specified more than once
2023-01-13 08:11:44.628 GMT [64239] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-13 08:11:44.635 GMT [64239] ERROR:  column loan_application.account_id does not exist at character 216
2023-01-13 08:11:44.635 GMT [64239] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
2023-01-13 08:11:44.637 GMT [64239] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:11:44.637 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:44.638 GMT [64239] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:11:44.638 GMT [64239] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:11:44.638 GMT [64239] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:44.638 GMT [64239] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:44.638 GMT [64239] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:44.638 GMT [64239] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:44.639 GMT [64239] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:11:44.639 GMT [64239] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:11:44.639 GMT [64239] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:11:44.639 GMT [64239] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:11:44.643 GMT [64239] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:11:44.643 GMT [64239] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:11:44.644 GMT [64239] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:44.644 GMT [64239] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:44.644 GMT [64239] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:11:44.644 GMT [64239] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:44.644 GMT [64239] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:44.645 GMT [64239] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:44.645 GMT [64239] STATEMENT:  RETURN passed;
2023-01-13 08:11:44.646 GMT [64239] WARNING:  there is no transaction in progress
2023-01-13 08:11:44.646 GMT [64239] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:11:44.646 GMT [64239] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:44.647 GMT [64239] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:11:44.647 GMT [64239] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:11:44.648 GMT [64239] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:44.648 GMT [64239] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:44.648 GMT [64239] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:44.648 GMT [64239] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:44.650 GMT [64239] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:11:44.650 GMT [64239] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:11:44.651 GMT [64239] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:11:44.651 GMT [64239] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:11:44.653 GMT [64239] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:11:44.653 GMT [64239] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:11:44.654 GMT [64239] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:44.654 GMT [64239] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:44.654 GMT [64239] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:11:44.655 GMT [64239] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:11:44.655 GMT [64239] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:44.655 GMT [64239] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:11:44.655 GMT [64239] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:11:44.655 GMT [64239] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:11:44.655 GMT [64239] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:11:44.656 GMT [64239] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:44.656 GMT [64239] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:11:44.656 GMT [64239] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:11:44.656 GMT [64239] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:11:44.656 GMT [64239] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:11:44.656 GMT [64239] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:11:44.657 GMT [64239] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:44.657 GMT [64239] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:44.657 GMT [64239] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:11:44.657 GMT [64239] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:11:44.657 GMT [64239] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:11:44.657 GMT [64239] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:44.657 GMT [64239] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:44.657 GMT [64239] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:44.657 GMT [64239] STATEMENT:  RETURN passed;
2023-01-13 08:11:44.657 GMT [64239] WARNING:  there is no transaction in progress
2023-01-13 08:11:44.657 GMT [64239] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:11:44.657 GMT [64239] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:11:44.658 GMT [64239] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:11:44.658 GMT [64239] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:11:44.658 GMT [64239] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:11:44.658 GMT [64239] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:11:44.658 GMT [64239] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:11:44.658 GMT [64239] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:11:44.658 GMT [64239] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:11:44.658 GMT [64239] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:11:44.658 GMT [64239] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:44.658 GMT [64239] STATEMENT:  RETURN passed;
2023-01-13 08:11:44.659 GMT [64239] WARNING:  there is no transaction in progress
2023-01-13 08:11:44.659 GMT [64239] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:11:44.659 GMT [64239] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:11:44.659 GMT [64239] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:11:44.659 GMT [64239] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:11:44.659 GMT [64239] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:11:44.659 GMT [64239] STATEMENT:  RETURN account_type;
2023-01-13 08:11:44.659 GMT [64239] WARNING:  there is no transaction in progress
2023-01-13 08:11:44.660 GMT [64239] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:11:44.660 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.660 GMT [64239] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:11:44.660 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.665 GMT [64239] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:11:44.665 GMT [64239] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:11:44.665 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.666 GMT [64239] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:11:44.666 GMT [64239] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:11:44.666 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.666 GMT [64239] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:11:44.666 GMT [64239] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:11:44.666 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.666 GMT [64239] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:11:44.666 GMT [64239] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:11:44.666 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:11:44.667 GMT [64239] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:11:44.667 GMT [64239] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:12:16.024 GMT [64203] LOG:  received fast shutdown request
2023-01-13 08:12:16.027 GMT [64203] LOG:  aborting any active transactions
2023-01-13 08:12:16.037 GMT [64203] LOG:  background worker "logical replication launcher" (PID 64210) exited with exit code 1
2023-01-13 08:12:16.041 GMT [64205] LOG:  shutting down
2023-01-13 08:12:16.105 GMT [64203] LOG:  database system is shut down
2023-01-13 08:12:17.518 GMT [64436] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:12:17.518 GMT [64436] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:12:17.520 GMT [64436] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:12:17.525 GMT [64437] LOG:  database system was shut down at 2023-01-13 08:12:17 GMT
2023-01-13 08:12:17.531 GMT [64436] LOG:  database system is ready to accept connections
2023-01-13 08:12:18.461 GMT [64476] ERROR:  column "amount" specified more than once
2023-01-13 08:12:18.461 GMT [64476] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-13 08:12:18.465 GMT [64476] ERROR:  column "amount" specified more than once
2023-01-13 08:12:18.465 GMT [64476] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-13 08:12:18.472 GMT [64476] ERROR:  column loan_application.account_id does not exist at character 216
2023-01-13 08:12:18.472 GMT [64476] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
2023-01-13 08:12:18.475 GMT [64476] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:12:18.475 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:12:18.475 GMT [64476] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:12:18.475 GMT [64476] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:12:18.476 GMT [64476] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:12:18.476 GMT [64476] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:12:18.476 GMT [64476] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:12:18.476 GMT [64476] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:12:18.476 GMT [64476] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:12:18.476 GMT [64476] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:12:18.476 GMT [64476] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:12:18.476 GMT [64476] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:12:18.477 GMT [64476] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:12:18.477 GMT [64476] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:12:18.477 GMT [64476] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:12:18.477 GMT [64476] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:12:18.477 GMT [64476] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:12:18.477 GMT [64476] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:12:18.477 GMT [64476] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:12:18.477 GMT [64476] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:12:18.477 GMT [64476] STATEMENT:  RETURN passed;
2023-01-13 08:12:18.478 GMT [64476] WARNING:  there is no transaction in progress
2023-01-13 08:12:18.478 GMT [64476] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:12:18.478 GMT [64476] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:12:18.478 GMT [64476] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:12:18.478 GMT [64476] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:12:18.478 GMT [64476] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:12:18.478 GMT [64476] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:12:18.479 GMT [64476] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:12:18.479 GMT [64476] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:12:18.479 GMT [64476] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:12:18.479 GMT [64476] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:12:18.479 GMT [64476] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:12:18.479 GMT [64476] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:12:18.480 GMT [64476] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:12:18.480 GMT [64476] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:12:18.480 GMT [64476] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:12:18.480 GMT [64476] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:12:18.480 GMT [64476] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:12:18.480 GMT [64476] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:12:18.480 GMT [64476] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:12:18.481 GMT [64476] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:12:18.481 GMT [64476] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:12:18.481 GMT [64476] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:12:18.481 GMT [64476] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:12:18.482 GMT [64476] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:12:18.482 GMT [64476] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:12:18.482 GMT [64476] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:12:18.482 GMT [64476] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:12:18.483 GMT [64476] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:12:18.483 GMT [64476] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:12:18.485 GMT [64476] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:12:18.485 GMT [64476] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:12:18.485 GMT [64476] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:12:18.486 GMT [64476] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:12:18.486 GMT [64476] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:12:18.486 GMT [64476] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:12:18.486 GMT [64476] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:12:18.486 GMT [64476] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:12:18.486 GMT [64476] STATEMENT:  RETURN passed;
2023-01-13 08:12:18.487 GMT [64476] WARNING:  there is no transaction in progress
2023-01-13 08:12:18.487 GMT [64476] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:12:18.487 GMT [64476] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:12:18.487 GMT [64476] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:12:18.487 GMT [64476] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:12:18.488 GMT [64476] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:12:18.488 GMT [64476] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:12:18.488 GMT [64476] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:12:18.488 GMT [64476] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:12:18.488 GMT [64476] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:12:18.488 GMT [64476] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:12:18.488 GMT [64476] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:12:18.489 GMT [64476] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:12:18.489 GMT [64476] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:12:18.489 GMT [64476] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:12:18.489 GMT [64476] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:12:18.489 GMT [64476] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:12:18.490 GMT [64476] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:12:18.490 GMT [64476] STATEMENT:  RETURN passed;
2023-01-13 08:12:18.490 GMT [64476] WARNING:  there is no transaction in progress
2023-01-13 08:12:18.490 GMT [64476] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:12:18.490 GMT [64476] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:12:18.490 GMT [64476] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:12:18.490 GMT [64476] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:12:18.490 GMT [64476] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:12:18.490 GMT [64476] STATEMENT:  RETURN account_type;
2023-01-13 08:12:18.491 GMT [64476] WARNING:  there is no transaction in progress
2023-01-13 08:12:18.492 GMT [64476] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:12:18.492 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.494 GMT [64476] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:12:18.494 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.509 GMT [64476] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:12:18.509 GMT [64476] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:12:18.509 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.510 GMT [64476] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:12:18.510 GMT [64476] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:12:18.510 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.511 GMT [64476] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:12:18.511 GMT [64476] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:12:18.511 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.513 GMT [64476] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:12:18.513 GMT [64476] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:12:18.513 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:12:18.513 GMT [64476] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:12:18.513 GMT [64476] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:13:37.219 GMT [64436] LOG:  received fast shutdown request
2023-01-13 08:13:37.221 GMT [64436] LOG:  aborting any active transactions
2023-01-13 08:13:37.226 GMT [64436] LOG:  background worker "logical replication launcher" (PID 64443) exited with exit code 1
2023-01-13 08:13:37.228 GMT [64438] LOG:  shutting down
2023-01-13 08:13:37.293 GMT [64436] LOG:  database system is shut down
2023-01-13 08:13:38.631 GMT [64781] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:13:38.632 GMT [64781] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:13:38.633 GMT [64781] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:13:38.638 GMT [64782] LOG:  database system was shut down at 2023-01-13 08:13:38 GMT
2023-01-13 08:13:38.647 GMT [64781] LOG:  database system is ready to accept connections
2023-01-13 08:13:39.486 GMT [64820] ERROR:  column loan_application.account_id does not exist at character 216
2023-01-13 08:13:39.486 GMT [64820] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.account_id;
2023-01-13 08:13:39.490 GMT [64820] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:13:39.490 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:13:39.490 GMT [64820] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:13:39.490 GMT [64820] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:13:39.493 GMT [64820] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:13:39.493 GMT [64820] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:13:39.494 GMT [64820] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:13:39.494 GMT [64820] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:13:39.494 GMT [64820] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:13:39.494 GMT [64820] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:13:39.495 GMT [64820] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:13:39.495 GMT [64820] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:13:39.495 GMT [64820] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:13:39.495 GMT [64820] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:13:39.495 GMT [64820] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:13:39.495 GMT [64820] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:13:39.495 GMT [64820] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:13:39.496 GMT [64820] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:13:39.496 GMT [64820] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:13:39.496 GMT [64820] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:13:39.496 GMT [64820] STATEMENT:  RETURN passed;
2023-01-13 08:13:39.496 GMT [64820] WARNING:  there is no transaction in progress
2023-01-13 08:13:39.497 GMT [64820] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:13:39.497 GMT [64820] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:13:39.497 GMT [64820] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:13:39.497 GMT [64820] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:13:39.498 GMT [64820] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:13:39.498 GMT [64820] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:13:39.498 GMT [64820] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:13:39.498 GMT [64820] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:13:39.498 GMT [64820] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:13:39.498 GMT [64820] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:13:39.499 GMT [64820] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:13:39.499 GMT [64820] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:13:39.499 GMT [64820] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:13:39.499 GMT [64820] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:13:39.499 GMT [64820] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:13:39.499 GMT [64820] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:13:39.499 GMT [64820] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:13:39.499 GMT [64820] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:13:39.499 GMT [64820] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:13:39.499 GMT [64820] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:13:39.501 GMT [64820] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:13:39.501 GMT [64820] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:13:39.501 GMT [64820] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:13:39.501 GMT [64820] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:13:39.501 GMT [64820] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:13:39.502 GMT [64820] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:13:39.502 GMT [64820] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:13:39.503 GMT [64820] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:13:39.503 GMT [64820] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:13:39.503 GMT [64820] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:13:39.503 GMT [64820] STATEMENT:  RETURN passed;
2023-01-13 08:13:39.503 GMT [64820] WARNING:  there is no transaction in progress
2023-01-13 08:13:39.504 GMT [64820] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:13:39.504 GMT [64820] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:13:39.504 GMT [64820] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:13:39.504 GMT [64820] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:13:39.504 GMT [64820] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:13:39.504 GMT [64820] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:13:39.504 GMT [64820] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:13:39.504 GMT [64820] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:13:39.504 GMT [64820] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  RETURN passed;
2023-01-13 08:13:39.505 GMT [64820] WARNING:  there is no transaction in progress
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  RETURN account_type;
2023-01-13 08:13:39.505 GMT [64820] WARNING:  there is no transaction in progress
2023-01-13 08:13:39.505 GMT [64820] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:13:39.505 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.506 GMT [64820] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:13:39.506 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.512 GMT [64820] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:13:39.512 GMT [64820] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:13:39.512 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.513 GMT [64820] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:13:39.513 GMT [64820] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:13:39.513 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.515 GMT [64820] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:13:39.515 GMT [64820] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:13:39.515 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.517 GMT [64820] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:13:39.517 GMT [64820] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:13:39.517 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:13:39.518 GMT [64820] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:13:39.518 GMT [64820] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:14:22.069 GMT [64781] LOG:  received fast shutdown request
2023-01-13 08:14:22.071 GMT [64781] LOG:  aborting any active transactions
2023-01-13 08:14:22.077 GMT [64781] LOG:  background worker "logical replication launcher" (PID 64788) exited with exit code 1
2023-01-13 08:14:22.078 GMT [64783] LOG:  shutting down
2023-01-13 08:14:22.133 GMT [64781] LOG:  database system is shut down
2023-01-13 08:14:23.546 GMT [65014] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:14:23.546 GMT [65014] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:14:23.548 GMT [65014] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:14:23.553 GMT [65015] LOG:  database system was shut down at 2023-01-13 08:14:23 GMT
2023-01-13 08:14:23.560 GMT [65014] LOG:  database system is ready to accept connections
2023-01-13 08:14:24.444 GMT [65050] ERROR:  column loan.amount does not exist at character 77
2023-01-13 08:14:24.444 GMT [65050] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
2023-01-13 08:14:24.446 GMT [65050] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:14:24.446 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:14:24.446 GMT [65050] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:14:24.446 GMT [65050] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:14:24.446 GMT [65050] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:14:24.446 GMT [65050] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:14:24.446 GMT [65050] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:14:24.446 GMT [65050] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:14:24.447 GMT [65050] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:14:24.447 GMT [65050] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:14:24.447 GMT [65050] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:14:24.447 GMT [65050] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:14:24.447 GMT [65050] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:14:24.447 GMT [65050] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:14:24.447 GMT [65050] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:14:24.447 GMT [65050] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:14:24.447 GMT [65050] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:14:24.448 GMT [65050] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:14:24.448 GMT [65050] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:14:24.448 GMT [65050] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:14:24.448 GMT [65050] STATEMENT:  RETURN passed;
2023-01-13 08:14:24.448 GMT [65050] WARNING:  there is no transaction in progress
2023-01-13 08:14:24.448 GMT [65050] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:14:24.448 GMT [65050] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:14:24.449 GMT [65050] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:14:24.449 GMT [65050] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:14:24.449 GMT [65050] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:14:24.449 GMT [65050] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:14:24.449 GMT [65050] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:14:24.449 GMT [65050] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:14:24.449 GMT [65050] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:14:24.449 GMT [65050] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:14:24.449 GMT [65050] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:14:24.449 GMT [65050] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:14:24.450 GMT [65050] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:14:24.450 GMT [65050] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:14:24.450 GMT [65050] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:14:24.450 GMT [65050] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:14:24.450 GMT [65050] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:14:24.450 GMT [65050] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:14:24.450 GMT [65050] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:14:24.451 GMT [65050] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:14:24.451 GMT [65050] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:14:24.451 GMT [65050] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:14:24.451 GMT [65050] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:14:24.451 GMT [65050] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:14:24.451 GMT [65050] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:14:24.452 GMT [65050] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:14:24.452 GMT [65050] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:14:24.452 GMT [65050] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:14:24.452 GMT [65050] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:14:24.453 GMT [65050] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:14:24.453 GMT [65050] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:14:24.453 GMT [65050] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:14:24.453 GMT [65050] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:14:24.453 GMT [65050] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:14:24.453 GMT [65050] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:14:24.453 GMT [65050] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:14:24.454 GMT [65050] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:14:24.454 GMT [65050] STATEMENT:  RETURN passed;
2023-01-13 08:14:24.454 GMT [65050] WARNING:  there is no transaction in progress
2023-01-13 08:14:24.454 GMT [65050] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:14:24.454 GMT [65050] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:14:24.454 GMT [65050] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:14:24.454 GMT [65050] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:14:24.455 GMT [65050] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:14:24.455 GMT [65050] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:14:24.455 GMT [65050] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:14:24.455 GMT [65050] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:14:24.455 GMT [65050] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:14:24.455 GMT [65050] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:14:24.455 GMT [65050] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:14:24.456 GMT [65050] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:14:24.456 GMT [65050] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:14:24.456 GMT [65050] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:14:24.456 GMT [65050] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:14:24.456 GMT [65050] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:14:24.456 GMT [65050] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:14:24.456 GMT [65050] STATEMENT:  RETURN passed;
2023-01-13 08:14:24.456 GMT [65050] WARNING:  there is no transaction in progress
2023-01-13 08:14:24.456 GMT [65050] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:14:24.456 GMT [65050] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:14:24.457 GMT [65050] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:14:24.457 GMT [65050] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:14:24.457 GMT [65050] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:14:24.457 GMT [65050] STATEMENT:  RETURN account_type;
2023-01-13 08:14:24.457 GMT [65050] WARNING:  there is no transaction in progress
2023-01-13 08:14:24.458 GMT [65050] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:14:24.458 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.459 GMT [65050] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:14:24.459 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.465 GMT [65050] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:14:24.465 GMT [65050] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:14:24.465 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.466 GMT [65050] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:14:24.466 GMT [65050] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:14:24.466 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.467 GMT [65050] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:14:24.467 GMT [65050] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:14:24.467 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.468 GMT [65050] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:14:24.468 GMT [65050] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:14:24.468 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:14:24.470 GMT [65050] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:14:24.470 GMT [65050] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:15:47.557 GMT [65014] LOG:  received fast shutdown request
2023-01-13 08:15:47.560 GMT [65014] LOG:  aborting any active transactions
2023-01-13 08:15:47.567 GMT [65014] LOG:  background worker "logical replication launcher" (PID 65021) exited with exit code 1
2023-01-13 08:15:47.567 GMT [65016] LOG:  shutting down
2023-01-13 08:15:47.680 GMT [65014] LOG:  database system is shut down
2023-01-13 08:15:49.229 GMT [65409] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:15:49.230 GMT [65409] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:15:49.232 GMT [65409] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:15:49.243 GMT [65410] LOG:  database system was shut down at 2023-01-13 08:15:48 GMT
2023-01-13 08:15:49.249 GMT [65409] LOG:  database system is ready to accept connections
2023-01-13 08:15:50.319 GMT [65448] ERROR:  column loan.term does not exist at character 126
2023-01-13 08:15:50.319 GMT [65448] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.term, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
2023-01-13 08:15:50.323 GMT [65448] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:15:50.323 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:15:50.324 GMT [65448] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:15:50.324 GMT [65448] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:15:50.325 GMT [65448] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:15:50.325 GMT [65448] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:15:50.326 GMT [65448] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:15:50.326 GMT [65448] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:15:50.326 GMT [65448] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:15:50.326 GMT [65448] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:15:50.327 GMT [65448] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:15:50.327 GMT [65448] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:15:50.327 GMT [65448] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:15:50.327 GMT [65448] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:15:50.328 GMT [65448] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:15:50.328 GMT [65448] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:15:50.328 GMT [65448] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:15:50.328 GMT [65448] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:15:50.328 GMT [65448] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:15:50.328 GMT [65448] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:15:50.328 GMT [65448] STATEMENT:  RETURN passed;
2023-01-13 08:15:50.329 GMT [65448] WARNING:  there is no transaction in progress
2023-01-13 08:15:50.329 GMT [65448] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:15:50.329 GMT [65448] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:15:50.329 GMT [65448] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:15:50.329 GMT [65448] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:15:50.329 GMT [65448] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:15:50.329 GMT [65448] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:15:50.330 GMT [65448] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:15:50.330 GMT [65448] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:15:50.330 GMT [65448] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:15:50.330 GMT [65448] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:15:50.330 GMT [65448] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:15:50.330 GMT [65448] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:15:50.331 GMT [65448] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:15:50.331 GMT [65448] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:15:50.331 GMT [65448] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:15:50.331 GMT [65448] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:15:50.331 GMT [65448] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:15:50.332 GMT [65448] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:15:50.332 GMT [65448] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:15:50.332 GMT [65448] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:15:50.332 GMT [65448] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:15:50.332 GMT [65448] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:15:50.332 GMT [65448] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:15:50.333 GMT [65448] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:15:50.333 GMT [65448] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:15:50.333 GMT [65448] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:15:50.333 GMT [65448] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:15:50.333 GMT [65448] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:15:50.333 GMT [65448] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:15:50.334 GMT [65448] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:15:50.334 GMT [65448] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:15:50.334 GMT [65448] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:15:50.334 GMT [65448] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:15:50.334 GMT [65448] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:15:50.334 GMT [65448] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:15:50.334 GMT [65448] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:15:50.335 GMT [65448] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:15:50.335 GMT [65448] STATEMENT:  RETURN passed;
2023-01-13 08:15:50.335 GMT [65448] WARNING:  there is no transaction in progress
2023-01-13 08:15:50.335 GMT [65448] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:15:50.335 GMT [65448] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:15:50.336 GMT [65448] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:15:50.336 GMT [65448] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:15:50.336 GMT [65448] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:15:50.336 GMT [65448] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:15:50.336 GMT [65448] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:15:50.336 GMT [65448] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:15:50.337 GMT [65448] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:15:50.337 GMT [65448] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:15:50.337 GMT [65448] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:15:50.337 GMT [65448] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:15:50.337 GMT [65448] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:15:50.337 GMT [65448] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:15:50.337 GMT [65448] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:15:50.337 GMT [65448] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:15:50.338 GMT [65448] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:15:50.338 GMT [65448] STATEMENT:  RETURN passed;
2023-01-13 08:15:50.338 GMT [65448] WARNING:  there is no transaction in progress
2023-01-13 08:15:50.338 GMT [65448] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:15:50.338 GMT [65448] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:15:50.338 GMT [65448] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:15:50.338 GMT [65448] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:15:50.339 GMT [65448] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:15:50.339 GMT [65448] STATEMENT:  RETURN account_type;
2023-01-13 08:15:50.339 GMT [65448] WARNING:  there is no transaction in progress
2023-01-13 08:15:50.341 GMT [65448] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:15:50.341 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.341 GMT [65448] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:15:50.341 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.352 GMT [65448] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:15:50.352 GMT [65448] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:15:50.352 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.354 GMT [65448] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:15:50.354 GMT [65448] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:15:50.354 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.356 GMT [65448] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:15:50.356 GMT [65448] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:15:50.356 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.357 GMT [65448] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:15:50.357 GMT [65448] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:15:50.357 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:15:50.358 GMT [65448] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:15:50.358 GMT [65448] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:16:08.476 GMT [65409] LOG:  received fast shutdown request
2023-01-13 08:16:08.478 GMT [65409] LOG:  aborting any active transactions
2023-01-13 08:16:08.483 GMT [65409] LOG:  background worker "logical replication launcher" (PID 65416) exited with exit code 1
2023-01-13 08:16:08.486 GMT [65411] LOG:  shutting down
2023-01-13 08:16:08.547 GMT [65409] LOG:  database system is shut down
2023-01-13 08:16:09.943 GMT [65580] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:16:09.943 GMT [65580] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:16:09.945 GMT [65580] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:16:09.950 GMT [65581] LOG:  database system was shut down at 2023-01-13 08:16:09 GMT
2023-01-13 08:16:09.956 GMT [65580] LOG:  database system is ready to accept connections
2023-01-13 08:16:10.898 GMT [65619] ERROR:  syntax error at or near "DECLARE" at character 541
2023-01-13 08:16:10.898 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:16:10.899 GMT [65619] ERROR:  syntax error at or near "INT" at character 30
2023-01-13 08:16:10.899 GMT [65619] STATEMENT:  DECLARE debit_account_number INT;
2023-01-13 08:16:10.899 GMT [65619] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:16:10.899 GMT [65619] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:16:10.899 GMT [65619] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:16:10.899 GMT [65619] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:16:10.900 GMT [65619] ERROR:  syntax error at or near "INTO" at character 151
2023-01-13 08:16:10.900 GMT [65619] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO debit_account_number;
2023-01-13 08:16:10.900 GMT [65619] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 08:16:10.900 GMT [65619] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id);
2023-01-13 08:16:10.901 GMT [65619] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 08:16:10.901 GMT [65619] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_id);
2023-01-13 08:16:10.902 GMT [65619] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:16:10.902 GMT [65619] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:16:10.902 GMT [65619] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-13 08:16:10.904 GMT [65619] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:16:10.904 GMT [65619] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:16:10.905 GMT [65619] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:10.905 GMT [65619] STATEMENT:  RETURN passed;
2023-01-13 08:16:10.905 GMT [65619] WARNING:  there is no transaction in progress
2023-01-13 08:16:10.906 GMT [65619] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:16:10.906 GMT [65619] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:16:10.906 GMT [65619] ERROR:  syntax error at or near "INT" at character 31
2023-01-13 08:16:10.906 GMT [65619] STATEMENT:  DECLARE credit_account_number INT;
2023-01-13 08:16:10.907 GMT [65619] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:16:10.907 GMT [65619] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:16:10.907 GMT [65619] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:16:10.907 GMT [65619] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:16:10.908 GMT [65619] ERROR:  syntax error at or near "INTO" at character 173
2023-01-13 08:16:10.908 GMT [65619] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
2023-01-13 08:16:10.908 GMT [65619] ERROR:  column "account_id" of relation "credit_statement" does not exist at character 107
2023-01-13 08:16:10.908 GMT [65619] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
2023-01-13 08:16:10.908 GMT [65619] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-13 08:16:10.908 GMT [65619] STATEMENT:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
2023-01-13 08:16:10.909 GMT [65619] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:16:10.909 GMT [65619] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:16:10.909 GMT [65619] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-13 08:16:10.909 GMT [65619] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-13 08:16:10.909 GMT [65619] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:16:10.910 GMT [65619] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:16:10.910 GMT [65619] STATEMENT:  DECLARE savings_account_id INT;
2023-01-13 08:16:10.910 GMT [65619] ERROR:  syntax error at or near "INT" at character 29
2023-01-13 08:16:10.910 GMT [65619] STATEMENT:  DECLARE next_account_number INT;
2023-01-13 08:16:10.911 GMT [65619] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:16:10.911 GMT [65619] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-13 08:16:10.911 GMT [65619] ERROR:  syntax error at or near "INTO" at character 153
2023-01-13 08:16:10.911 GMT [65619] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id INTO savings_account_id;
2023-01-13 08:16:10.912 GMT [65619] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:16:10.912 GMT [65619] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
2023-01-13 08:16:10.912 GMT [65619] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:16:10.912 GMT [65619] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:16:10.912 GMT [65619] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-13 08:16:10.912 GMT [65619] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:16:10.912 GMT [65619] STATEMENT:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678');
2023-01-13 08:16:10.913 GMT [65619] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:16:10.913 GMT [65619] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:16:10.913 GMT [65619] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:10.913 GMT [65619] STATEMENT:  RETURN passed;
2023-01-13 08:16:10.914 GMT [65619] WARNING:  there is no transaction in progress
2023-01-13 08:16:10.914 GMT [65619] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-13 08:16:10.914 GMT [65619] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-13 08:16:10.914 GMT [65619] ERROR:  syntax error at or near "INT" at character 17
2023-01-13 08:16:10.914 GMT [65619] STATEMENT:  DECLARE loan_id INT;
2023-01-13 08:16:10.914 GMT [65619] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-13 08:16:10.914 GMT [65619] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-13 08:16:10.915 GMT [65619] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-13 08:16:10.915 GMT [65619] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
2023-01-13 08:16:10.916 GMT [65619] ERROR:  column "loan_id" does not exist at character 68
2023-01-13 08:16:10.916 GMT [65619] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-13 08:16:10.916 GMT [65619] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-13 08:16:10.916 GMT [65619] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:16:10.916 GMT [65619] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:16:10.916 GMT [65619] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-13 08:16:10.916 GMT [65619] ERROR:  syntax error at or near "passed" at character 1
2023-01-13 08:16:10.916 GMT [65619] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-13 08:16:10.917 GMT [65619] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:10.917 GMT [65619] STATEMENT:  RETURN passed;
2023-01-13 08:16:10.917 GMT [65619] WARNING:  there is no transaction in progress
2023-01-13 08:16:10.917 GMT [65619] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$" at character 1
2023-01-13 08:16:10.917 GMT [65619] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
2023-01-13 08:16:10.918 GMT [65619] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-13 08:16:10.918 GMT [65619] STATEMENT:  BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
2023-01-13 08:16:10.918 GMT [65619] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:10.918 GMT [65619] STATEMENT:  RETURN account_type;
2023-01-13 08:16:10.919 GMT [65619] WARNING:  there is no transaction in progress
2023-01-13 08:16:10.920 GMT [65619] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:16:10.920 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.922 GMT [65619] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:16:10.922 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.927 GMT [65619] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:16:10.927 GMT [65619] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:16:10.927 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.928 GMT [65619] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:16:10.928 GMT [65619] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:16:10.928 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.929 GMT [65619] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:16:10.929 GMT [65619] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:16:10.929 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.931 GMT [65619] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:16:10.931 GMT [65619] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:16:10.931 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:10.932 GMT [65619] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:16:10.932 GMT [65619] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:16:32.727 GMT [65580] LOG:  received fast shutdown request
2023-01-13 08:16:32.729 GMT [65580] LOG:  aborting any active transactions
2023-01-13 08:16:32.740 GMT [65580] LOG:  background worker "logical replication launcher" (PID 65587) exited with exit code 1
2023-01-13 08:16:32.742 GMT [65582] LOG:  shutting down
2023-01-13 08:16:32.804 GMT [65580] LOG:  database system is shut down
2023-01-13 08:16:34.315 GMT [65760] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:16:34.316 GMT [65760] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:16:34.318 GMT [65760] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:16:34.323 GMT [65761] LOG:  database system was shut down at 2023-01-13 08:16:33 GMT
2023-01-13 08:16:34.329 GMT [65760] LOG:  database system is ready to accept connections
2023-01-13 08:16:35.389 GMT [65796] ERROR:  "credit_account_id" is not a known variable at character 437
2023-01-13 08:16:35.389 GMT [65796] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING id INTO credit_account_id;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_id);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
2023-01-13 08:16:35.398 GMT [65796] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:16:35.398 GMT [65796] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:16:35.399 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:16:35.399 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:16:35.401 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.401 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:16:35.401 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.405 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:16:35.405 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:16:35.405 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.405 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:16:35.406 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.406 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:16:35.406 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:16:35.407 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.407 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:16:35.407 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.408 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:16:35.408 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:16:35.408 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.408 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:16:35.408 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.408 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:16:35.408 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:16:35.409 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.409 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:16:35.409 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.409 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:16:35.409 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:16:35.409 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.409 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:16:35.410 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.411 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:16:35.411 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:16:35.411 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.411 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:16:35.411 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.412 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:16:35.412 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:16:35.412 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.412 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:16:35.413 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.413 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:16:35.413 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:16:35.413 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.413 GMT [65796] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:16:35.413 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.414 GMT [65796] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:16:35.414 GMT [65796] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:16:35.414 GMT [65796] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:16:35.414 GMT [65796] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:16:35.416 GMT [65796] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:16:35.416 GMT [65796] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:16:35.416 GMT [65796] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:16:35.416 GMT [65796] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:16:35.416 GMT [65796] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:16:35.416 GMT [65796] STATEMENT:  END IF;
2023-01-13 08:16:35.416 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.416 GMT [65796] STATEMENT:  RETURN customer_id;
2023-01-13 08:16:35.417 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.417 GMT [65796] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:16:35.417 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:16:35.417 GMT [65796] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:16:35.417 GMT [65796] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:16:35.417 GMT [65796] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:16:35.417 GMT [65796] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:16:35.418 GMT [65796] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:16:35.418 GMT [65796] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:16:35.418 GMT [65796] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:16:35.418 GMT [65796] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:16:35.418 GMT [65796] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:16:35.418 GMT [65796] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:16:35.419 GMT [65796] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:16:35.419 GMT [65796] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:16:35.419 GMT [65796] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:16:35.419 GMT [65796] STATEMENT:  END LOOP;
2023-01-13 08:16:35.421 GMT [65796] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:16:35.421 GMT [65796] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:16:35.421 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  RETURN account_id;
2023-01-13 08:16:35.421 GMT [65796] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:16:35.421 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  RETURN NULL;
2023-01-13 08:16:35.421 GMT [65796] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  END IF;
2023-01-13 08:16:35.421 GMT [65796] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:16:35.421 GMT [65796] STATEMENT:  RETURN success;
2023-01-13 08:16:35.422 GMT [65796] WARNING:  there is no transaction in progress
2023-01-13 08:16:35.422 GMT [65796] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:16:35.422 GMT [65796] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:17:19.004 GMT [65760] LOG:  received fast shutdown request
2023-01-13 08:17:19.007 GMT [65760] LOG:  aborting any active transactions
2023-01-13 08:17:19.013 GMT [65760] LOG:  background worker "logical replication launcher" (PID 65767) exited with exit code 1
2023-01-13 08:17:19.013 GMT [65762] LOG:  shutting down
2023-01-13 08:17:19.066 GMT [65760] LOG:  database system is shut down
2023-01-13 08:17:20.490 GMT [66015] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:17:20.490 GMT [66015] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:17:20.492 GMT [66015] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:17:20.496 GMT [66016] LOG:  database system was shut down at 2023-01-13 08:17:20 GMT
2023-01-13 08:17:20.502 GMT [66015] LOG:  database system is ready to accept connections
2023-01-13 08:17:21.468 GMT [66054] ERROR:  syntax error at or near "INSERT" at character 657
2023-01-13 08:17:21.468 GMT [66054] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_account_type(account_number INT)
	RETURNS TEXT AS $$
	DECLARE account_type TEXT;
	BEGIN
	    SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END INTO account_type;
	    RETURN account_type;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	END;
2023-01-13 08:17:21.469 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$" at character 1
2023-01-13 08:17:21.469 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-13 08:17:21.472 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.472 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-13 08:17:21.472 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.474 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:17:21.474 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-13 08:17:21.474 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.474 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-13 08:17:21.477 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.479 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-13 08:17:21.479 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-13 08:17:21.479 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.479 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-13 08:17:21.480 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.481 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-13 08:17:21.481 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-13 08:17:21.481 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.481 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-13 08:17:21.481 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.481 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:17:21.481 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
2023-01-13 08:17:21.482 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.482 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
2023-01-13 08:17:21.482 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.482 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:17:21.482 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
2023-01-13 08:17:21.482 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.482 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
2023-01-13 08:17:21.482 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.482 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:17:21.482 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
2023-01-13 08:17:21.482 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.482 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
2023-01-13 08:17:21.483 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.483 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:17:21.483 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
2023-01-13 08:17:21.483 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.483 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-13 08:17:21.483 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.483 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-13 08:17:21.483 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-13 08:17:21.483 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.483 GMT [66054] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-13 08:17:21.484 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.484 GMT [66054] ERROR:  syntax error at or near "DECLARE" at character 1790
2023-01-13 08:17:21.484 GMT [66054] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-13 08:17:21.484 GMT [66054] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:17:21.484 GMT [66054] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-13 08:17:21.486 GMT [66054] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:17:21.486 GMT [66054] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-13 08:17:21.486 GMT [66054] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-13 08:17:21.486 GMT [66054] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-13 08:17:21.486 GMT [66054] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:17:21.486 GMT [66054] STATEMENT:  END IF;
2023-01-13 08:17:21.486 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.486 GMT [66054] STATEMENT:  RETURN customer_id;
2023-01-13 08:17:21.487 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.487 GMT [66054] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-13 08:17:21.487 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-13 08:17:21.487 GMT [66054] ERROR:  syntax error at or near "INT" at character 27
2023-01-13 08:17:21.487 GMT [66054] STATEMENT:  DECLARE online_account_id INT;
2023-01-13 08:17:21.488 GMT [66054] ERROR:  syntax error at or near "INT" at character 28
2023-01-13 08:17:21.488 GMT [66054] STATEMENT:  DECLARE question_choice_id INT;
2023-01-13 08:17:21.488 GMT [66054] ERROR:  syntax error at or near "IF" at character 11
2023-01-13 08:17:21.488 GMT [66054] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-13 08:17:21.488 GMT [66054] ERROR:  syntax error at or near "INTO" at character 131
2023-01-13 08:17:21.488 GMT [66054] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-13 08:17:21.489 GMT [66054] ERROR:  syntax error at or near "FOR" at character 1
2023-01-13 08:17:21.489 GMT [66054] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-13 08:17:21.489 GMT [66054] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-13 08:17:21.489 GMT [66054] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-13 08:17:21.489 GMT [66054] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-13 08:17:21.489 GMT [66054] STATEMENT:  END LOOP;
2023-01-13 08:17:21.490 GMT [66054] ERROR:  column "account_id" does not exist at character 117
2023-01-13 08:17:21.490 GMT [66054] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-13 08:17:21.490 GMT [66054] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-13 08:17:21.490 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.490 GMT [66054] STATEMENT:  RETURN account_id;
2023-01-13 08:17:21.491 GMT [66054] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-13 08:17:21.491 GMT [66054] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-13 08:17:21.491 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.491 GMT [66054] STATEMENT:  RETURN NULL;
2023-01-13 08:17:21.492 GMT [66054] ERROR:  syntax error at or near "IF" at character 5
2023-01-13 08:17:21.492 GMT [66054] STATEMENT:  END IF;
2023-01-13 08:17:21.492 GMT [66054] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-13 08:17:21.492 GMT [66054] STATEMENT:  RETURN success;
2023-01-13 08:17:21.492 GMT [66054] WARNING:  there is no transaction in progress
2023-01-13 08:17:21.493 GMT [66054] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-13 08:17:21.493 GMT [66054] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate)
	VALUES ('12345678', 1, 2000.00, 2.05);
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-13 08:18:12.063 GMT [66015] LOG:  received fast shutdown request
2023-01-13 08:18:12.065 GMT [66015] LOG:  aborting any active transactions
2023-01-13 08:18:12.070 GMT [66015] LOG:  background worker "logical replication launcher" (PID 66022) exited with exit code 1
2023-01-13 08:18:12.072 GMT [66017] LOG:  shutting down
2023-01-13 08:18:12.128 GMT [66015] LOG:  database system is shut down
2023-01-13 08:18:13.839 GMT [66296] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:18:13.839 GMT [66296] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:18:13.843 GMT [66296] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:18:13.850 GMT [66300] LOG:  database system was shut down at 2023-01-13 08:18:13 GMT
2023-01-13 08:18:13.856 GMT [66296] LOG:  database system is ready to accept connections
2023-01-13 08:18:14.810 GMT [66335] ERROR:  syntax error at or near "END" at character 644
2023-01-13 08:18:14.810 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.811 GMT [66335] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:18:14.811 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.819 GMT [66335] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:14.819 GMT [66335] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:18:14.819 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.820 GMT [66335] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:14.820 GMT [66335] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:18:14.820 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.824 GMT [66335] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:14.824 GMT [66335] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:18:14.824 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.825 GMT [66335] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:14.825 GMT [66335] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:18:14.825 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:14.825 GMT [66335] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:18:14.825 GMT [66335] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:18:43.301 GMT [66296] LOG:  received fast shutdown request
2023-01-13 08:18:43.304 GMT [66296] LOG:  aborting any active transactions
2023-01-13 08:18:43.310 GMT [66296] LOG:  background worker "logical replication launcher" (PID 66306) exited with exit code 1
2023-01-13 08:18:43.311 GMT [66301] LOG:  shutting down
2023-01-13 08:18:43.367 GMT [66296] LOG:  database system is shut down
2023-01-13 08:18:44.881 GMT [66499] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:18:44.882 GMT [66499] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:18:44.883 GMT [66499] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:18:44.892 GMT [66503] LOG:  database system was shut down at 2023-01-13 08:18:44 GMT
2023-01-13 08:18:44.899 GMT [66499] LOG:  database system is ready to accept connections
2023-01-13 08:18:45.794 GMT [66538] ERROR:  syntax error at or near "," at character 205
2023-01-13 08:18:45.794 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, interest_rate, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:45.800 GMT [66538] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:45.800 GMT [66538] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:18:45.800 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:45.801 GMT [66538] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:45.801 GMT [66538] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:18:45.801 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:45.801 GMT [66538] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:45.801 GMT [66538] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:18:45.801 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:45.802 GMT [66538] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:18:45.802 GMT [66538] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:18:45.802 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:18:45.802 GMT [66538] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:18:45.802 GMT [66538] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:20:17.316 GMT [66499] LOG:  received fast shutdown request
2023-01-13 08:20:17.321 GMT [66499] LOG:  aborting any active transactions
2023-01-13 08:20:17.324 GMT [66499] LOG:  background worker "logical replication launcher" (PID 66509) exited with exit code 1
2023-01-13 08:20:17.330 GMT [66504] LOG:  shutting down
2023-01-13 08:20:17.389 GMT [66499] LOG:  database system is shut down
2023-01-13 08:20:18.895 GMT [66875] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:20:18.895 GMT [66875] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:20:18.897 GMT [66875] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:20:18.903 GMT [66876] LOG:  database system was shut down at 2023-01-13 08:20:18 GMT
2023-01-13 08:20:18.910 GMT [66875] LOG:  database system is ready to accept connections
2023-01-13 08:20:19.877 GMT [66914] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:20:19.877 GMT [66914] CONTEXT:  compilation of PL/pgSQL function "view_savings_statements" near line 1
2023-01-13 08:20:19.877 GMT [66914] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:20:19.879 GMT [66914] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:20:19.879 GMT [66914] CONTEXT:  compilation of PL/pgSQL function "view_debit_statements" near line 1
2023-01-13 08:20:19.879 GMT [66914] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:20:19.879 GMT [66914] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:20:19.879 GMT [66914] CONTEXT:  compilation of PL/pgSQL function "view_credit_statements" near line 1
2023-01-13 08:20:19.879 GMT [66914] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_id INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:20:19.881 GMT [66914] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:20:19.881 GMT [66914] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:20:19.881 GMT [66914] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:20:19.881 GMT [66914] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:20:19.881 GMT [66914] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:22:38.286 GMT [66875] LOG:  received fast shutdown request
2023-01-13 08:22:38.288 GMT [66875] LOG:  aborting any active transactions
2023-01-13 08:22:38.294 GMT [66875] LOG:  background worker "logical replication launcher" (PID 66882) exited with exit code 1
2023-01-13 08:22:38.296 GMT [66877] LOG:  shutting down
2023-01-13 08:22:38.360 GMT [66875] LOG:  database system is shut down
2023-01-13 08:22:39.897 GMT [67398] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:22:39.897 GMT [67398] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:22:39.899 GMT [67398] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:22:39.903 GMT [67399] LOG:  database system was shut down at 2023-01-13 08:22:39 GMT
2023-01-13 08:22:39.910 GMT [67398] LOG:  database system is ready to accept connections
2023-01-13 08:22:40.916 GMT [67437] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:22:40.916 GMT [67437] CONTEXT:  compilation of PL/pgSQL function "view_debit_statement" near line 1
2023-01-13 08:22:40.916 GMT [67437] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_id
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:22:40.918 GMT [67437] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:22:40.918 GMT [67437] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:23:27.390 GMT [67398] LOG:  received fast shutdown request
2023-01-13 08:23:27.391 GMT [67398] LOG:  aborting any active transactions
2023-01-13 08:23:27.402 GMT [67398] LOG:  background worker "logical replication launcher" (PID 67405) exited with exit code 1
2023-01-13 08:23:27.405 GMT [67400] LOG:  shutting down
2023-01-13 08:23:27.464 GMT [67398] LOG:  database system is shut down
2023-01-13 08:23:29.051 GMT [67657] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:23:29.052 GMT [67657] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:23:29.053 GMT [67657] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:23:29.059 GMT [67658] LOG:  database system was shut down at 2023-01-13 08:23:28 GMT
2023-01-13 08:23:29.067 GMT [67657] LOG:  database system is ready to accept connections
2023-01-13 08:23:30.034 GMT [67693] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:23:30.034 GMT [67693] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:24:57.195 GMT [67657] LOG:  received fast shutdown request
2023-01-13 08:24:57.197 GMT [67657] LOG:  aborting any active transactions
2023-01-13 08:24:57.204 GMT [67657] LOG:  background worker "logical replication launcher" (PID 67664) exited with exit code 1
2023-01-13 08:24:57.205 GMT [67659] LOG:  shutting down
2023-01-13 08:24:57.262 GMT [67657] LOG:  database system is shut down
2023-01-13 08:24:58.692 GMT [68051] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:24:58.692 GMT [68051] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:24:58.694 GMT [68051] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:24:58.700 GMT [68052] LOG:  database system was shut down at 2023-01-13 08:24:58 GMT
2023-01-13 08:24:58.707 GMT [68051] LOG:  database system is ready to accept connections
2023-01-13 08:24:59.642 GMT [68090] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:24:59.642 GMT [68090] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:24:59.667 GMT [68090] ERROR:  column "id" does not exist at character 150
2023-01-13 08:24:59.667 GMT [68090] QUERY:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING id
2023-01-13 08:24:59.667 GMT [68090] CONTEXT:  PL/pgSQL function open_savings_account(integer) line 9 at SQL statement
2023-01-13 08:24:59.667 GMT [68090] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-13 08:26:02.633 GMT [68051] LOG:  received fast shutdown request
2023-01-13 08:26:02.635 GMT [68051] LOG:  aborting any active transactions
2023-01-13 08:26:02.638 GMT [68051] LOG:  background worker "logical replication launcher" (PID 68058) exited with exit code 1
2023-01-13 08:26:02.644 GMT [68053] LOG:  shutting down
2023-01-13 08:26:02.708 GMT [68051] LOG:  database system is shut down
2023-01-13 08:26:04.060 GMT [68363] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:26:04.061 GMT [68363] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:26:04.064 GMT [68363] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:26:04.070 GMT [68364] LOG:  database system was shut down at 2023-01-13 08:26:03 GMT
2023-01-13 08:26:04.076 GMT [68363] LOG:  database system is ready to accept connections
2023-01-13 08:26:04.935 GMT [68402] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:26:04.935 GMT [68402] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:26:04.964 GMT [68402] ERROR:  column "account_id" of relation "savings_statement" does not exist at character 65
2023-01-13 08:26:04.964 GMT [68402] QUERY:  INSERT INTO savings_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id)
2023-01-13 08:26:04.964 GMT [68402] CONTEXT:  PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-13 08:26:04.964 GMT [68402] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-13 08:27:47.597 GMT [68363] LOG:  received fast shutdown request
2023-01-13 08:27:47.600 GMT [68363] LOG:  aborting any active transactions
2023-01-13 08:27:47.605 GMT [68363] LOG:  background worker "logical replication launcher" (PID 68370) exited with exit code 1
2023-01-13 08:27:47.605 GMT [68365] LOG:  shutting down
2023-01-13 08:27:47.658 GMT [68363] LOG:  database system is shut down
2023-01-13 08:27:49.132 GMT [68776] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:27:49.132 GMT [68776] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:27:49.134 GMT [68776] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:27:49.148 GMT [68777] LOG:  database system was shut down at 2023-01-13 08:27:48 GMT
2023-01-13 08:27:49.159 GMT [68776] LOG:  database system is ready to accept connections
2023-01-13 08:27:50.111 GMT [68817] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:27:50.111 GMT [68817] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:27:50.149 GMT [68817] ERROR:  relation "external_account" does not exist at character 13
2023-01-13 08:27:50.149 GMT [68817] QUERY:  INSERT INTO external_account (account_id, external_account_number) VALUES (savings_account_id, '12345678')
2023-01-13 08:27:50.149 GMT [68817] CONTEXT:  PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-13 08:27:50.149 GMT [68817] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-13 08:28:09.859 GMT [68776] LOG:  received fast shutdown request
2023-01-13 08:28:09.860 GMT [68776] LOG:  aborting any active transactions
2023-01-13 08:28:09.866 GMT [68776] LOG:  background worker "logical replication launcher" (PID 68783) exited with exit code 1
2023-01-13 08:28:09.866 GMT [68778] LOG:  shutting down
2023-01-13 08:28:09.927 GMT [68776] LOG:  database system is shut down
2023-01-13 08:28:11.816 GMT [68956] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:28:11.817 GMT [68956] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:28:11.822 GMT [68956] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:28:11.830 GMT [68958] LOG:  database system was shut down at 2023-01-13 08:28:11 GMT
2023-01-13 08:28:11.835 GMT [68956] LOG:  database system is ready to accept connections
2023-01-13 08:28:12.806 GMT [68995] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:28:12.806 GMT [68995] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:28:12.852 GMT [68995] ERROR:  column "rowcount" does not exist at character 22
2023-01-13 08:28:12.852 GMT [68995] QUERY:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END
2023-01-13 08:28:12.852 GMT [68995] CONTEXT:  PL/pgSQL function open_savings_account(integer) line 12 at assignment
2023-01-13 08:28:12.852 GMT [68995] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-13 08:30:56.058 GMT [68956] LOG:  received fast shutdown request
2023-01-13 08:30:56.060 GMT [68956] LOG:  aborting any active transactions
2023-01-13 08:30:56.065 GMT [68956] LOG:  background worker "logical replication launcher" (PID 68967) exited with exit code 1
2023-01-13 08:30:56.073 GMT [68962] LOG:  shutting down
2023-01-13 08:30:56.175 GMT [68956] LOG:  database system is shut down
2023-01-13 08:30:58.361 GMT [69575] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:30:58.362 GMT [69575] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:30:58.364 GMT [69575] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:30:58.371 GMT [69576] LOG:  database system was shut down at 2023-01-13 08:30:57 GMT
2023-01-13 08:30:58.378 GMT [69575] LOG:  database system is ready to accept connections
2023-01-13 08:30:59.413 GMT [69604] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:30:59.413 GMT [69604] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:31:55.567 GMT [69575] LOG:  received fast shutdown request
2023-01-13 08:31:55.569 GMT [69575] LOG:  aborting any active transactions
2023-01-13 08:31:55.576 GMT [69575] LOG:  background worker "logical replication launcher" (PID 69582) exited with exit code 1
2023-01-13 08:31:55.579 GMT [69577] LOG:  shutting down
2023-01-13 08:31:55.642 GMT [69575] LOG:  database system is shut down
2023-01-13 08:31:57.022 GMT [69863] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:31:57.023 GMT [69863] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:31:57.024 GMT [69863] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:31:57.030 GMT [69864] LOG:  database system was shut down at 2023-01-13 08:31:56 GMT
2023-01-13 08:31:57.036 GMT [69863] LOG:  database system is ready to accept connections
2023-01-13 08:31:57.989 GMT [69902] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:31:57.989 GMT [69902] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:32:46.328 GMT [69863] LOG:  received fast shutdown request
2023-01-13 08:32:46.330 GMT [69863] LOG:  aborting any active transactions
2023-01-13 08:32:46.336 GMT [69863] LOG:  background worker "logical replication launcher" (PID 69870) exited with exit code 1
2023-01-13 08:32:46.336 GMT [69865] LOG:  shutting down
2023-01-13 08:32:46.391 GMT [69863] LOG:  database system is shut down
2023-01-13 08:32:47.938 GMT [70120] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:32:47.938 GMT [70120] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:32:47.940 GMT [70120] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:32:47.945 GMT [70121] LOG:  database system was shut down at 2023-01-13 08:32:47 GMT
2023-01-13 08:32:47.952 GMT [70120] LOG:  database system is ready to accept connections
2023-01-13 08:32:48.946 GMT [70163] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:32:48.946 GMT [70163] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:32:48.979 GMT [70163] ERROR:  missing FROM-clause entry for table "account" at character 8
2023-01-13 08:32:48.979 GMT [70163] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
2023-01-13 08:32:48.979 GMT [70163] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:32:48.979 GMT [70163] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:33:49.331 GMT [70120] LOG:  received fast shutdown request
2023-01-13 08:33:49.333 GMT [70120] LOG:  aborting any active transactions
2023-01-13 08:33:49.340 GMT [70120] LOG:  background worker "logical replication launcher" (PID 70127) exited with exit code 1
2023-01-13 08:33:49.341 GMT [70122] LOG:  shutting down
2023-01-13 08:33:49.414 GMT [70120] LOG:  database system is shut down
2023-01-13 08:33:50.861 GMT [70444] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:33:50.862 GMT [70444] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:33:50.863 GMT [70444] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:33:50.869 GMT [70445] LOG:  database system was shut down at 2023-01-13 08:33:50 GMT
2023-01-13 08:33:50.875 GMT [70444] LOG:  database system is ready to accept connections
2023-01-13 08:33:51.781 GMT [70480] ERROR:  syntax error at or near "END" at character 769
2023-01-13 08:33:51.781 GMT [70480] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INT)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, debit_accounts, credit_accounts, savings_accounts, loans
	        WHERE account.account_id = account_id
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:33:51.793 GMT [70480] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:33:51.793 GMT [70480] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:33:51.821 GMT [70480] ERROR:  function client.view_accounts(integer) does not exist at character 15
2023-01-13 08:33:51.821 GMT [70480] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-13 08:33:51.821 GMT [70480] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:34:49.631 GMT [70444] LOG:  received fast shutdown request
2023-01-13 08:34:49.633 GMT [70444] LOG:  aborting any active transactions
2023-01-13 08:34:49.638 GMT [70444] LOG:  background worker "logical replication launcher" (PID 70451) exited with exit code 1
2023-01-13 08:34:49.638 GMT [70446] LOG:  shutting down
2023-01-13 08:34:49.696 GMT [70444] LOG:  database system is shut down
2023-01-13 08:34:51.526 GMT [70713] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:34:51.526 GMT [70713] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:34:51.527 GMT [70713] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:34:51.531 GMT [70714] LOG:  database system was shut down at 2023-01-13 08:34:51 GMT
2023-01-13 08:34:51.539 GMT [70713] LOG:  database system is ready to accept connections
2023-01-13 08:34:52.535 GMT [70752] ERROR:  syntax error at or near "END" at character 773
2023-01-13 08:34:52.535 GMT [70752] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_id INTEGER)
	RETURNS TABLE (account_number INT) AS $$
	
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, debit_accounts, credit_accounts, savings_accounts, loans
	        WHERE account.account_id = account_id
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:34:52.548 GMT [70752] ERROR:  syntax error at or near "INSERT" at character 1028
2023-01-13 08:34:52.548 GMT [70752] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
2023-01-13 08:34:52.580 GMT [70752] ERROR:  function client.view_accounts(integer) does not exist at character 15
2023-01-13 08:34:52.580 GMT [70752] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-13 08:34:52.580 GMT [70752] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:36:01.893 GMT [70713] LOG:  received fast shutdown request
2023-01-13 08:36:01.894 GMT [70713] LOG:  aborting any active transactions
2023-01-13 08:36:01.902 GMT [70713] LOG:  background worker "logical replication launcher" (PID 70720) exited with exit code 1
2023-01-13 08:36:01.902 GMT [70715] LOG:  shutting down
2023-01-13 08:36:01.973 GMT [70713] LOG:  database system is shut down
2023-01-13 08:36:03.262 GMT [71055] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:36:03.263 GMT [71055] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:36:03.264 GMT [71055] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:36:03.268 GMT [71056] LOG:  database system was shut down at 2023-01-13 08:36:02 GMT
2023-01-13 08:36:03.274 GMT [71055] LOG:  database system is ready to accept connections
2023-01-13 08:36:04.181 GMT [71094] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:04.181 GMT [71094] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:36:04.181 GMT [71094] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:04.183 GMT [71094] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:04.183 GMT [71094] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:36:04.183 GMT [71094] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:04.218 GMT [71094] ERROR:  relation "debit_accounts" does not exist at character 403
2023-01-13 08:36:04.218 GMT [71094] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, debit_accounts, credit_accounts, savings_accounts, loans
	        WHERE account.account_id = account_id
2023-01-13 08:36:04.218 GMT [71094] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:36:04.218 GMT [71094] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:36:21.045 GMT [71055] LOG:  received fast shutdown request
2023-01-13 08:36:21.049 GMT [71055] LOG:  aborting any active transactions
2023-01-13 08:36:21.052 GMT [71055] LOG:  background worker "logical replication launcher" (PID 71062) exited with exit code 1
2023-01-13 08:36:21.055 GMT [71057] LOG:  shutting down
2023-01-13 08:36:21.118 GMT [71055] LOG:  database system is shut down
2023-01-13 08:36:22.669 GMT [71227] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:36:22.670 GMT [71227] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:36:22.672 GMT [71227] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:36:22.677 GMT [71228] LOG:  database system was shut down at 2023-01-13 08:36:22 GMT
2023-01-13 08:36:22.683 GMT [71227] LOG:  database system is ready to accept connections
2023-01-13 08:36:23.697 GMT [71267] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:23.697 GMT [71267] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:36:23.697 GMT [71267] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:23.698 GMT [71267] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:23.698 GMT [71267] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:36:23.698 GMT [71267] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:23.729 GMT [71267] ERROR:  relation "loans" does not exist at character 451
2023-01-13 08:36:23.729 GMT [71267] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, debit_account, credit_account, savings_account, loans
	        WHERE account.account_id = account_id
2023-01-13 08:36:23.729 GMT [71267] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:36:23.729 GMT [71267] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:36:31.578 GMT [71227] LOG:  received fast shutdown request
2023-01-13 08:36:31.581 GMT [71227] LOG:  aborting any active transactions
2023-01-13 08:36:31.587 GMT [71227] LOG:  background worker "logical replication launcher" (PID 71234) exited with exit code 1
2023-01-13 08:36:31.591 GMT [71229] LOG:  shutting down
2023-01-13 08:36:31.659 GMT [71227] LOG:  database system is shut down
2023-01-13 08:36:33.044 GMT [71372] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:36:33.044 GMT [71372] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:36:33.046 GMT [71372] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:36:33.050 GMT [71373] LOG:  database system was shut down at 2023-01-13 08:36:32 GMT
2023-01-13 08:36:33.057 GMT [71372] LOG:  database system is ready to accept connections
2023-01-13 08:36:34.041 GMT [71411] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:34.041 GMT [71411] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:36:34.041 GMT [71411] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:34.045 GMT [71411] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:36:34.045 GMT [71411] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:36:34.045 GMT [71411] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:36:34.082 GMT [71411] ERROR:  missing FROM-clause entry for table "debit_accounts" at character 28
2023-01-13 08:36:34.082 GMT [71411] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, debit_account, credit_account, savings_account, loan
	        WHERE account.account_id = account_id
2023-01-13 08:36:34.082 GMT [71411] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:36:34.082 GMT [71411] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:37:00.820 GMT [71372] LOG:  received fast shutdown request
2023-01-13 08:37:00.822 GMT [71372] LOG:  aborting any active transactions
2023-01-13 08:37:00.827 GMT [71372] LOG:  background worker "logical replication launcher" (PID 71379) exited with exit code 1
2023-01-13 08:37:00.827 GMT [71374] LOG:  shutting down
2023-01-13 08:37:00.890 GMT [71372] LOG:  database system is shut down
2023-01-13 08:37:02.559 GMT [71577] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:37:02.560 GMT [71577] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:37:02.562 GMT [71577] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:37:02.568 GMT [71578] LOG:  database system was shut down at 2023-01-13 08:37:02 GMT
2023-01-13 08:37:02.574 GMT [71577] LOG:  database system is ready to accept connections
2023-01-13 08:37:03.524 GMT [71616] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:03.524 GMT [71616] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:37:03.524 GMT [71616] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:03.526 GMT [71616] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:03.526 GMT [71616] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:37:03.526 GMT [71616] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:03.565 GMT [71616] ERROR:  missing FROM-clause entry for table "loans" at character 131
2023-01-13 08:37:03.565 GMT [71616] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, loan
	        WHERE account.account_id = account_id
2023-01-13 08:37:03.565 GMT [71616] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:37:03.565 GMT [71616] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:37:20.171 GMT [71577] LOG:  received fast shutdown request
2023-01-13 08:37:20.173 GMT [71577] LOG:  aborting any active transactions
2023-01-13 08:37:20.178 GMT [71577] LOG:  background worker "logical replication launcher" (PID 71584) exited with exit code 1
2023-01-13 08:37:20.178 GMT [71579] LOG:  shutting down
2023-01-13 08:37:20.236 GMT [71577] LOG:  database system is shut down
2023-01-13 08:37:21.699 GMT [71746] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:37:21.699 GMT [71746] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:37:21.700 GMT [71746] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:37:21.705 GMT [71747] LOG:  database system was shut down at 2023-01-13 08:37:21 GMT
2023-01-13 08:37:21.712 GMT [71746] LOG:  database system is ready to accept connections
2023-01-13 08:37:22.700 GMT [71785] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:22.700 GMT [71785] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:37:22.700 GMT [71785] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:22.701 GMT [71785] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:22.701 GMT [71785] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:37:22.701 GMT [71785] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:22.746 GMT [71785] ERROR:  column loans.loan_amount does not exist at character 131
2023-01-13 08:37:22.746 GMT [71785] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.loan_amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.loan_interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_id
2023-01-13 08:37:22.746 GMT [71785] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:37:22.746 GMT [71785] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:37:41.580 GMT [71746] LOG:  received fast shutdown request
2023-01-13 08:37:41.583 GMT [71746] LOG:  aborting any active transactions
2023-01-13 08:37:41.587 GMT [71746] LOG:  background worker "logical replication launcher" (PID 71753) exited with exit code 1
2023-01-13 08:37:41.590 GMT [71748] LOG:  shutting down
2023-01-13 08:37:41.662 GMT [71746] LOG:  database system is shut down
2023-01-13 08:37:43.041 GMT [71921] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:37:43.041 GMT [71921] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:37:43.043 GMT [71921] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:37:43.048 GMT [71922] LOG:  database system was shut down at 2023-01-13 08:37:42 GMT
2023-01-13 08:37:43.054 GMT [71921] LOG:  database system is ready to accept connections
2023-01-13 08:37:43.979 GMT [71960] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:43.979 GMT [71960] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:37:43.979 GMT [71960] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:43.979 GMT [71960] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:37:43.979 GMT [71960] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:37:43.979 GMT [71960] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:37:44.022 GMT [71960] ERROR:  function get_account_type(integer) does not exist at character 314
2023-01-13 08:37:44.022 GMT [71960] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-13 08:37:44.022 GMT [71960] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_id
2023-01-13 08:37:44.022 GMT [71960] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:37:44.022 GMT [71960] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:51:48.819 GMT [71921] LOG:  received fast shutdown request
2023-01-13 08:51:48.821 GMT [71921] LOG:  aborting any active transactions
2023-01-13 08:51:48.825 GMT [71921] LOG:  background worker "logical replication launcher" (PID 71928) exited with exit code 1
2023-01-13 08:51:48.829 GMT [71923] LOG:  shutting down
2023-01-13 08:51:48.847 GMT [71921] LOG:  database system is shut down
2023-01-13 08:51:50.417 GMT [73562] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:51:50.418 GMT [73562] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:51:50.420 GMT [73562] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:51:50.426 GMT [73563] LOG:  database system was shut down at 2023-01-13 08:51:50 GMT
2023-01-13 08:51:50.434 GMT [73562] LOG:  database system is ready to accept connections
2023-01-13 08:51:51.966 GMT [73601] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:51:51.966 GMT [73601] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:51:51.966 GMT [73601] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:51:51.967 GMT [73601] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:51:51.967 GMT [73601] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:51:51.967 GMT [73601] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:51:52.003 GMT [73601] ERROR:  column reference "account_id" is ambiguous at character 513
2023-01-13 08:51:52.003 GMT [73601] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_id
2023-01-13 08:51:52.003 GMT [73601] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:51:52.003 GMT [73601] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:54:45.611 GMT [73562] LOG:  received fast shutdown request
2023-01-13 08:54:45.613 GMT [73562] LOG:  aborting any active transactions
2023-01-13 08:54:45.619 GMT [73562] LOG:  background worker "logical replication launcher" (PID 73569) exited with exit code 1
2023-01-13 08:54:45.619 GMT [73564] LOG:  shutting down
2023-01-13 08:54:45.700 GMT [73562] LOG:  database system is shut down
2023-01-13 08:54:47.346 GMT [74177] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:54:47.346 GMT [74177] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:54:47.347 GMT [74177] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:54:47.359 GMT [74178] LOG:  database system was shut down at 2023-01-13 08:54:46 GMT
2023-01-13 08:54:47.365 GMT [74177] LOG:  database system is ready to accept connections
2023-01-13 08:54:48.466 GMT [74213] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:54:48.466 GMT [74213] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:54:48.466 GMT [74213] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:54:48.469 GMT [74213] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:54:48.469 GMT [74213] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:54:48.469 GMT [74213] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:54:48.511 GMT [74213] ERROR:  column "account_id" does not exist at character 76
2023-01-13 08:54:48.511 GMT [74213] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-13 08:54:48.511 GMT [74213] QUERY:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE)
2023-01-13 08:54:48.511 GMT [74213] CONTEXT:  PL/pgSQL function view_accounts(integer) line 4 at SQL statement
2023-01-13 08:54:48.511 GMT [74213] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:55:55.555 GMT [74177] LOG:  received fast shutdown request
2023-01-13 08:55:55.557 GMT [74177] LOG:  aborting any active transactions
2023-01-13 08:55:55.565 GMT [74177] LOG:  background worker "logical replication launcher" (PID 74184) exited with exit code 1
2023-01-13 08:55:55.566 GMT [74179] LOG:  shutting down
2023-01-13 08:55:55.627 GMT [74177] LOG:  database system is shut down
2023-01-13 08:55:57.109 GMT [74478] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:55:57.110 GMT [74478] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:55:57.111 GMT [74478] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:55:57.117 GMT [74479] LOG:  database system was shut down at 2023-01-13 08:55:56 GMT
2023-01-13 08:55:57.124 GMT [74478] LOG:  database system is ready to accept connections
2023-01-13 08:55:58.093 GMT [74514] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:55:58.093 GMT [74514] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:55:58.093 GMT [74514] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:55:58.097 GMT [74514] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:55:58.097 GMT [74514] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:55:58.097 GMT [74514] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:55:58.292 GMT [74514] ERROR:  structure of query does not match function result type
2023-01-13 08:55:58.292 GMT [74514] DETAIL:  Number of returned columns (5) does not match expected column count (1).
2023-01-13 08:55:58.292 GMT [74514] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 08:55:58.292 GMT [74514] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:56:12.587 GMT [74478] LOG:  received fast shutdown request
2023-01-13 08:56:12.589 GMT [74478] LOG:  aborting any active transactions
2023-01-13 08:56:12.596 GMT [74478] LOG:  background worker "logical replication launcher" (PID 74485) exited with exit code 1
2023-01-13 08:56:12.596 GMT [74480] LOG:  shutting down
2023-01-13 08:56:12.659 GMT [74478] LOG:  database system is shut down
2023-01-13 08:56:14.322 GMT [74637] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:56:14.322 GMT [74637] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:56:14.324 GMT [74637] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:56:14.332 GMT [74638] LOG:  database system was shut down at 2023-01-13 08:56:13 GMT
2023-01-13 08:56:14.340 GMT [74637] LOG:  database system is ready to accept connections
2023-01-13 08:56:15.336 GMT [74676] ERROR:  syntax error at or near "AS" at character 87
2023-01-13 08:56:15.336 GMT [74676] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE AS $$
	
	BEGIN
	    --INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:56:15.349 GMT [74676] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:56:15.349 GMT [74676] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:56:15.349 GMT [74676] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:56:15.350 GMT [74676] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:56:15.350 GMT [74676] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:56:15.350 GMT [74676] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:56:15.380 GMT [74676] ERROR:  function client.view_accounts(integer) does not exist at character 15
2023-01-13 08:56:15.380 GMT [74676] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-13 08:56:15.380 GMT [74676] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 08:57:34.892 GMT [74637] LOG:  received fast shutdown request
2023-01-13 08:57:34.895 GMT [74637] LOG:  aborting any active transactions
2023-01-13 08:57:34.898 GMT [74637] LOG:  background worker "logical replication launcher" (PID 74644) exited with exit code 1
2023-01-13 08:57:34.902 GMT [74639] LOG:  shutting down
2023-01-13 08:57:34.985 GMT [74637] LOG:  database system is shut down
2023-01-13 08:57:36.341 GMT [75017] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 08:57:36.342 GMT [75017] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 08:57:36.343 GMT [75017] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 08:57:36.349 GMT [75018] LOG:  database system was shut down at 2023-01-13 08:57:35 GMT
2023-01-13 08:57:36.357 GMT [75017] LOG:  database system is ready to accept connections
2023-01-13 08:57:37.461 GMT [75053] ERROR:  syntax error at or near "," at character 102
2023-01-13 08:57:37.461 GMT [75053] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number, account_id, balance, interest_rate, account_type) AS $$
	
	BEGIN
	    --INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed accounts', CURRENT_DATE);
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account, client.debit_accounts, client.credit_accounts, client.savings_accounts, client.loans
	        WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:57:37.477 GMT [75053] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:57:37.477 GMT [75053] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 08:57:37.477 GMT [75053] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:57:37.480 GMT [75053] ERROR:  parameter name "account_id" used more than once
2023-01-13 08:57:37.480 GMT [75053] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 08:57:37.480 GMT [75053] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 08:57:37.519 GMT [75053] ERROR:  function client.view_accounts(integer) does not exist at character 15
2023-01-13 08:57:37.519 GMT [75053] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-13 08:57:37.519 GMT [75053] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:00:29.174 GMT [75017] LOG:  received fast shutdown request
2023-01-13 09:00:29.176 GMT [75017] LOG:  aborting any active transactions
2023-01-13 09:00:29.179 GMT [75017] LOG:  background worker "logical replication launcher" (PID 75024) exited with exit code 1
2023-01-13 09:00:29.182 GMT [75019] LOG:  shutting down
2023-01-13 09:00:29.277 GMT [75017] LOG:  database system is shut down
2023-01-13 09:00:30.983 GMT [75612] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:00:30.984 GMT [75612] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:00:30.986 GMT [75612] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:00:30.992 GMT [75613] LOG:  database system was shut down at 2023-01-13 09:00:30 GMT
2023-01-13 09:00:30.999 GMT [75612] LOG:  database system is ready to accept connections
2023-01-13 09:00:32.156 GMT [75651] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:00:32.156 GMT [75651] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:00:32.156 GMT [75651] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:00:32.157 GMT [75651] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:00:32.157 GMT [75651] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:00:32.157 GMT [75651] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:01:07.422 GMT [75612] LOG:  received fast shutdown request
2023-01-13 09:01:07.424 GMT [75612] LOG:  aborting any active transactions
2023-01-13 09:01:07.431 GMT [75612] LOG:  background worker "logical replication launcher" (PID 75619) exited with exit code 1
2023-01-13 09:01:07.431 GMT [75614] LOG:  shutting down
2023-01-13 09:01:07.501 GMT [75612] LOG:  database system is shut down
2023-01-13 09:01:08.909 GMT [75835] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:01:08.909 GMT [75835] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:01:08.910 GMT [75835] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:01:08.915 GMT [75836] LOG:  database system was shut down at 2023-01-13 09:01:08 GMT
2023-01-13 09:01:08.922 GMT [75835] LOG:  database system is ready to accept connections
2023-01-13 09:01:09.876 GMT [75871] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:01:09.876 GMT [75871] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:01:09.876 GMT [75871] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:01:09.877 GMT [75871] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:01:09.877 GMT [75871] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:01:09.877 GMT [75871] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:01:09.904 GMT [75871] ERROR:  duplicate key value violates unique constraint "savings_account_pkey"
2023-01-13 09:01:09.904 GMT [75871] DETAIL:  Key (account_number)=(12345678) already exists.
2023-01-13 09:01:09.904 GMT [75871] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES ('12345678', 1, 2000.00, 2.05);
2023-01-13 09:03:51.151 GMT [75835] LOG:  received fast shutdown request
2023-01-13 09:03:51.152 GMT [75835] LOG:  aborting any active transactions
2023-01-13 09:03:51.158 GMT [75835] LOG:  background worker "logical replication launcher" (PID 75842) exited with exit code 1
2023-01-13 09:03:51.158 GMT [75837] LOG:  shutting down
2023-01-13 09:03:51.212 GMT [75835] LOG:  database system is shut down
2023-01-13 09:03:52.789 GMT [76394] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:03:52.789 GMT [76394] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:03:52.791 GMT [76394] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:03:52.797 GMT [76395] LOG:  database system was shut down at 2023-01-13 09:03:52 GMT
2023-01-13 09:03:52.811 GMT [76394] LOG:  database system is ready to accept connections
2023-01-13 09:03:53.835 GMT [76430] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:03:53.835 GMT [76430] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:03:53.835 GMT [76430] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:03:53.836 GMT [76430] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:03:53.836 GMT [76430] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:03:53.836 GMT [76430] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:05:50.546 GMT [76394] LOG:  received fast shutdown request
2023-01-13 09:05:50.547 GMT [76394] LOG:  aborting any active transactions
2023-01-13 09:05:50.550 GMT [76394] LOG:  background worker "logical replication launcher" (PID 76401) exited with exit code 1
2023-01-13 09:05:50.555 GMT [76396] LOG:  shutting down
2023-01-13 09:05:50.610 GMT [76394] LOG:  database system is shut down
2023-01-13 09:05:52.265 GMT [76869] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:05:52.266 GMT [76869] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:05:52.270 GMT [76869] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:05:52.276 GMT [76870] LOG:  database system was shut down at 2023-01-13 09:05:51 GMT
2023-01-13 09:05:52.282 GMT [76869] LOG:  database system is ready to accept connections
2023-01-13 09:05:53.463 GMT [76905] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:05:53.463 GMT [76905] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:05:53.463 GMT [76905] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:05:53.463 GMT [76905] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:05:53.463 GMT [76905] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:05:53.463 GMT [76905] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:05:53.506 GMT [76905] ERROR:  column loans.account_number does not exist at character 755
2023-01-13 09:05:53.506 GMT [76905] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance, loans.amount) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate, loans.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account
	        INNER JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	        INNER JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	        INNER JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	        INNER JOIN client.loans ON account.account_number = loans.account_number
	        WHERE account.account_id = account_identifier
2023-01-13 09:05:53.506 GMT [76905] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 09:05:53.506 GMT [76905] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:06:27.678 GMT [76869] LOG:  received fast shutdown request
2023-01-13 09:06:27.679 GMT [76869] LOG:  aborting any active transactions
2023-01-13 09:06:27.685 GMT [76869] LOG:  background worker "logical replication launcher" (PID 76876) exited with exit code 1
2023-01-13 09:06:27.687 GMT [76871] LOG:  shutting down
2023-01-13 09:06:27.740 GMT [76869] LOG:  database system is shut down
2023-01-13 09:06:29.277 GMT [77097] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:06:29.277 GMT [77097] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:06:29.278 GMT [77097] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:06:29.283 GMT [77098] LOG:  database system was shut down at 2023-01-13 09:06:28 GMT
2023-01-13 09:06:29.290 GMT [77097] LOG:  database system is ready to accept connections
2023-01-13 09:06:30.253 GMT [77136] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:06:30.253 GMT [77136] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:06:30.253 GMT [77136] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:06:30.253 GMT [77136] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:06:30.253 GMT [77136] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:06:30.253 GMT [77136] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:06:53.817 GMT [77097] LOG:  received fast shutdown request
2023-01-13 09:06:53.819 GMT [77097] LOG:  aborting any active transactions
2023-01-13 09:06:53.824 GMT [77097] LOG:  background worker "logical replication launcher" (PID 77104) exited with exit code 1
2023-01-13 09:06:53.824 GMT [77099] LOG:  shutting down
2023-01-13 09:06:53.888 GMT [77097] LOG:  database system is shut down
2023-01-13 09:06:55.249 GMT [77282] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:06:55.250 GMT [77282] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:06:55.251 GMT [77282] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:06:55.257 GMT [77283] LOG:  database system was shut down at 2023-01-13 09:06:54 GMT
2023-01-13 09:06:55.263 GMT [77282] LOG:  database system is ready to accept connections
2023-01-13 09:06:56.293 GMT [77325] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:06:56.293 GMT [77325] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:06:56.293 GMT [77325] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:06:56.295 GMT [77325] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:06:56.295 GMT [77325] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:06:56.295 GMT [77325] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:06:56.334 GMT [77325] ERROR:  column reference "account_number" is ambiguous at character 60
2023-01-13 09:06:56.334 GMT [77325] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-13 09:06:56.334 GMT [77325] QUERY:  SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END
2023-01-13 09:06:56.334 GMT [77325] CONTEXT:  PL/pgSQL function get_account_type(integer) line 4 at SQL statement
	SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account
	        LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	        LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	        LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	        WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 09:06:56.334 GMT [77325] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:09:37.804 GMT [77282] LOG:  received fast shutdown request
2023-01-13 09:09:37.805 GMT [77282] LOG:  aborting any active transactions
2023-01-13 09:09:37.810 GMT [77282] LOG:  background worker "logical replication launcher" (PID 77289) exited with exit code 1
2023-01-13 09:09:37.811 GMT [77284] LOG:  shutting down
2023-01-13 09:09:37.878 GMT [77282] LOG:  database system is shut down
2023-01-13 09:09:42.064 GMT [78146] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:09:42.065 GMT [78146] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:09:42.066 GMT [78146] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:09:42.071 GMT [78147] LOG:  database system was shut down at 2023-01-13 09:09:41 GMT
2023-01-13 09:09:42.084 GMT [78146] LOG:  database system is ready to accept connections
2023-01-13 09:09:43.152 GMT [78186] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:09:43.152 GMT [78186] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:09:43.152 GMT [78186] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:09:43.154 GMT [78186] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:09:43.154 GMT [78186] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:09:43.154 GMT [78186] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:09:43.194 GMT [78186] ERROR:  column reference "account_number" is ambiguous at character 60
2023-01-13 09:09:43.194 GMT [78186] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-13 09:09:43.194 GMT [78186] QUERY:  SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END
2023-01-13 09:09:43.194 GMT [78186] CONTEXT:  PL/pgSQL function get_account_type(integer) line 4 at SQL statement
	SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	        COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	        get_account_type(account.account_number) AS account_type
	        FROM account
	        LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	        LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	        LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	        WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-13 09:09:43.194 GMT [78186] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:12:32.643 GMT [78146] LOG:  received fast shutdown request
2023-01-13 09:12:32.647 GMT [78146] LOG:  aborting any active transactions
2023-01-13 09:12:32.655 GMT [78146] LOG:  background worker "logical replication launcher" (PID 78153) exited with exit code 1
2023-01-13 09:12:32.657 GMT [78148] LOG:  shutting down
2023-01-13 09:12:32.725 GMT [78146] LOG:  database system is shut down
2023-01-13 09:12:34.313 GMT [78790] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:12:34.314 GMT [78790] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:12:34.315 GMT [78790] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:12:34.323 GMT [78791] LOG:  database system was shut down at 2023-01-13 09:12:33 GMT
2023-01-13 09:12:34.331 GMT [78790] LOG:  database system is ready to accept connections
2023-01-13 09:12:35.354 GMT [78829] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:12:35.354 GMT [78829] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:12:35.354 GMT [78829] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:12:35.354 GMT [78829] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:12:35.354 GMT [78829] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:12:35.354 GMT [78829] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:12:35.405 GMT [78829] ERROR:  structure of query does not match function result type
2023-01-13 09:12:35.405 GMT [78829] DETAIL:  Returned type numeric(15,2) does not match expected type integer in column 1.
2023-01-13 09:12:35.405 GMT [78829] CONTEXT:  SQL statement "SELECT COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 15 at RETURN QUERY
2023-01-13 09:12:35.405 GMT [78829] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:12:53.610 GMT [78790] LOG:  received fast shutdown request
2023-01-13 09:12:53.612 GMT [78790] LOG:  aborting any active transactions
2023-01-13 09:12:53.617 GMT [78790] LOG:  background worker "logical replication launcher" (PID 78797) exited with exit code 1
2023-01-13 09:12:53.617 GMT [78792] LOG:  shutting down
2023-01-13 09:12:53.676 GMT [78790] LOG:  database system is shut down
2023-01-13 09:12:55.091 GMT [78959] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:12:55.091 GMT [78959] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:12:55.093 GMT [78959] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:12:55.098 GMT [78960] LOG:  database system was shut down at 2023-01-13 09:12:54 GMT
2023-01-13 09:12:55.106 GMT [78959] LOG:  database system is ready to accept connections
2023-01-13 09:12:56.158 GMT [79002] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:12:56.158 GMT [79002] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:12:56.158 GMT [79002] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:12:56.159 GMT [79002] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:12:56.159 GMT [79002] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:12:56.159 GMT [79002] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:12:56.195 GMT [79002] ERROR:  column reference "account_number" is ambiguous at character 60
2023-01-13 09:12:56.195 GMT [79002] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-13 09:12:56.195 GMT [79002] QUERY:  SELECT CASE WHEN EXISTS (SELECT * FROM debit_account WHERE account_number = account_number) THEN 'DEBIT'
	                WHEN EXISTS (SELECT * FROM credit_account WHERE account_number = account_number) THEN 'CREDIT'
	                WHEN EXISTS (SELECT * FROM savings_account WHERE account_number = account_number) THEN 'SAVINGS'
	                ELSE 'UNKNOWN' END
2023-01-13 09:12:56.195 GMT [79002] CONTEXT:  PL/pgSQL function get_account_type(integer) line 4 at SQL statement
	SQL statement "SELECT COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 15 at RETURN QUERY
2023-01-13 09:12:56.195 GMT [79002] STATEMENT:  SELECT * FROM client.view_accounts(1)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 09:14:33.676 GMT [78959] LOG:  received fast shutdown request
2023-01-13 09:14:33.678 GMT [78959] LOG:  aborting any active transactions
2023-01-13 09:14:33.681 GMT [78959] LOG:  background worker "logical replication launcher" (PID 78966) exited with exit code 1
2023-01-13 09:14:33.684 GMT [78961] LOG:  shutting down
2023-01-13 09:14:33.753 GMT [78959] LOG:  database system is shut down
2023-01-13 09:14:35.196 GMT [79377] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:14:35.197 GMT [79377] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:14:35.198 GMT [79377] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:14:35.204 GMT [79378] LOG:  database system was shut down at 2023-01-13 09:14:34 GMT
2023-01-13 09:14:35.210 GMT [79377] LOG:  database system is ready to accept connections
2023-01-13 09:14:36.326 GMT [79416] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:14:36.326 GMT [79416] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:14:36.326 GMT [79416] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:14:36.327 GMT [79416] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:14:36.327 GMT [79416] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:14:36.327 GMT [79416] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:16:03.779 GMT [79377] LOG:  received fast shutdown request
2023-01-13 09:16:03.783 GMT [79377] LOG:  aborting any active transactions
2023-01-13 09:16:03.790 GMT [79377] LOG:  background worker "logical replication launcher" (PID 79384) exited with exit code 1
2023-01-13 09:16:03.794 GMT [79379] LOG:  shutting down
2023-01-13 09:16:03.866 GMT [79377] LOG:  database system is shut down
2023-01-13 09:16:05.302 GMT [79754] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:16:05.303 GMT [79754] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:16:05.304 GMT [79754] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:16:05.310 GMT [79755] LOG:  database system was shut down at 2023-01-13 09:16:04 GMT
2023-01-13 09:16:05.320 GMT [79754] LOG:  database system is ready to accept connections
2023-01-13 09:16:06.395 GMT [79790] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:16:06.395 GMT [79790] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:16:06.395 GMT [79790] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:16:06.396 GMT [79790] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:16:06.396 GMT [79790] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:16:06.396 GMT [79790] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:16:49.960 GMT [79754] LOG:  received fast shutdown request
2023-01-13 09:16:49.962 GMT [79754] LOG:  aborting any active transactions
2023-01-13 09:16:49.970 GMT [79754] LOG:  background worker "logical replication launcher" (PID 79761) exited with exit code 1
2023-01-13 09:16:49.971 GMT [79756] LOG:  shutting down
2023-01-13 09:16:50.043 GMT [79754] LOG:  database system is shut down
2023-01-13 09:16:51.449 GMT [80006] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:16:51.450 GMT [80006] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:16:51.458 GMT [80006] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:16:51.462 GMT [80007] LOG:  database system was shut down at 2023-01-13 09:16:51 GMT
2023-01-13 09:16:51.468 GMT [80006] LOG:  database system is ready to accept connections
2023-01-13 09:16:52.439 GMT [80042] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:16:52.439 GMT [80042] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:16:52.439 GMT [80042] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:16:52.440 GMT [80042] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:16:52.440 GMT [80042] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:16:52.440 GMT [80042] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:17:24.252 GMT [80006] LOG:  received fast shutdown request
2023-01-13 09:17:24.254 GMT [80006] LOG:  aborting any active transactions
2023-01-13 09:17:24.259 GMT [80006] LOG:  background worker "logical replication launcher" (PID 80013) exited with exit code 1
2023-01-13 09:17:24.260 GMT [80008] LOG:  shutting down
2023-01-13 09:17:24.321 GMT [80006] LOG:  database system is shut down
2023-01-13 09:17:25.712 GMT [80233] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:17:25.712 GMT [80233] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:17:25.714 GMT [80233] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:17:25.719 GMT [80234] LOG:  database system was shut down at 2023-01-13 09:17:25 GMT
2023-01-13 09:17:25.726 GMT [80233] LOG:  database system is ready to accept connections
2023-01-13 09:17:26.692 GMT [80272] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:17:26.692 GMT [80272] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:17:26.692 GMT [80272] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:17:26.693 GMT [80272] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:17:26.693 GMT [80272] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:17:26.693 GMT [80272] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:18:11.781 GMT [80233] LOG:  received fast shutdown request
2023-01-13 09:18:11.783 GMT [80233] LOG:  aborting any active transactions
2023-01-13 09:18:11.788 GMT [80233] LOG:  background worker "logical replication launcher" (PID 80240) exited with exit code 1
2023-01-13 09:18:11.788 GMT [80235] LOG:  shutting down
2023-01-13 09:18:11.845 GMT [80233] LOG:  database system is shut down
2023-01-13 09:18:13.236 GMT [80488] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:18:13.236 GMT [80488] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:18:13.237 GMT [80488] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:18:13.243 GMT [80489] LOG:  database system was shut down at 2023-01-13 09:18:12 GMT
2023-01-13 09:18:13.250 GMT [80488] LOG:  database system is ready to accept connections
2023-01-13 09:18:14.157 GMT [80527] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:18:14.157 GMT [80527] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:18:14.157 GMT [80527] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:18:14.158 GMT [80527] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:18:14.158 GMT [80527] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:18:14.158 GMT [80527] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:18:14.200 GMT [80527] ERROR:  column "overdraft_limit" of relation "debit_account" does not exist at character 73
2023-01-13 09:18:14.200 GMT [80527] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, overdraft_limit, interest_rate)
	VALUES ('12938693', 1, 100.00, 2000.00, 4.22);
2023-01-13 09:19:03.772 GMT [80488] LOG:  received fast shutdown request
2023-01-13 09:19:03.775 GMT [80488] LOG:  aborting any active transactions
2023-01-13 09:19:03.781 GMT [80488] LOG:  background worker "logical replication launcher" (PID 80495) exited with exit code 1
2023-01-13 09:19:03.782 GMT [80490] LOG:  shutting down
2023-01-13 09:19:03.852 GMT [80488] LOG:  database system is shut down
2023-01-13 09:19:05.425 GMT [80764] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:19:05.425 GMT [80764] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:19:05.427 GMT [80764] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:19:05.432 GMT [80765] LOG:  database system was shut down at 2023-01-13 09:19:05 GMT
2023-01-13 09:19:05.440 GMT [80764] LOG:  database system is ready to accept connections
2023-01-13 09:19:06.360 GMT [80803] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:19:06.360 GMT [80803] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:19:06.360 GMT [80803] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:19:06.361 GMT [80803] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:19:06.361 GMT [80803] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:19:06.361 GMT [80803] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:22:13.337 GMT [80764] LOG:  received fast shutdown request
2023-01-13 09:22:13.339 GMT [80764] LOG:  aborting any active transactions
2023-01-13 09:22:13.345 GMT [80764] LOG:  background worker "logical replication launcher" (PID 80771) exited with exit code 1
2023-01-13 09:22:13.346 GMT [80766] LOG:  shutting down
2023-01-13 09:22:13.412 GMT [80764] LOG:  database system is shut down
2023-01-13 09:22:14.991 GMT [81414] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:22:14.991 GMT [81414] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:22:14.992 GMT [81414] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:22:14.997 GMT [81415] LOG:  database system was shut down at 2023-01-13 09:22:14 GMT
2023-01-13 09:22:15.004 GMT [81414] LOG:  database system is ready to accept connections
2023-01-13 09:22:15.998 GMT [81450] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:22:15.998 GMT [81450] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:22:15.998 GMT [81450] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:22:15.999 GMT [81450] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:22:15.999 GMT [81450] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:22:15.999 GMT [81450] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:22:16.025 GMT [81450] ERROR:  syntax error at or near "SELECT" at character 39
2023-01-13 09:22:16.025 GMT [81450] STATEMENT:  SELECT * FROM client.view_accounts(1)
	SELECT * FROM client.debit_accounts;
2023-01-13 09:22:24.159 GMT [81414] LOG:  received fast shutdown request
2023-01-13 09:22:24.162 GMT [81414] LOG:  aborting any active transactions
2023-01-13 09:22:24.170 GMT [81414] LOG:  background worker "logical replication launcher" (PID 81421) exited with exit code 1
2023-01-13 09:22:24.171 GMT [81416] LOG:  shutting down
2023-01-13 09:22:24.227 GMT [81414] LOG:  database system is shut down
2023-01-13 09:22:25.667 GMT [81555] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:22:25.668 GMT [81555] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:22:25.669 GMT [81555] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:22:25.674 GMT [81556] LOG:  database system was shut down at 2023-01-13 09:22:25 GMT
2023-01-13 09:22:25.680 GMT [81555] LOG:  database system is ready to accept connections
2023-01-13 09:22:26.643 GMT [81591] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:22:26.643 GMT [81591] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:22:26.643 GMT [81591] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:22:26.645 GMT [81591] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:22:26.645 GMT [81591] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:22:26.645 GMT [81591] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:22:58.703 GMT [81555] LOG:  received fast shutdown request
2023-01-13 09:22:58.707 GMT [81555] LOG:  aborting any active transactions
2023-01-13 09:22:58.714 GMT [81555] LOG:  background worker "logical replication launcher" (PID 81562) exited with exit code 1
2023-01-13 09:22:58.714 GMT [81557] LOG:  shutting down
2023-01-13 09:22:58.787 GMT [81555] LOG:  database system is shut down
2023-01-13 09:23:00.253 GMT [81762] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:23:00.253 GMT [81762] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:23:00.255 GMT [81762] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:23:00.260 GMT [81763] LOG:  database system was shut down at 2023-01-13 09:22:59 GMT
2023-01-13 09:23:00.267 GMT [81762] LOG:  database system is ready to accept connections
2023-01-13 09:23:01.221 GMT [81801] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:23:01.221 GMT [81801] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:23:01.221 GMT [81801] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:23:01.222 GMT [81801] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:23:01.222 GMT [81801] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:23:01.222 GMT [81801] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:23:19.034 GMT [81762] LOG:  received fast shutdown request
2023-01-13 09:23:19.036 GMT [81762] LOG:  aborting any active transactions
2023-01-13 09:23:19.055 GMT [81762] LOG:  background worker "logical replication launcher" (PID 81769) exited with exit code 1
2023-01-13 09:23:19.064 GMT [81764] LOG:  shutting down
2023-01-13 09:23:19.162 GMT [81762] LOG:  database system is shut down
2023-01-13 09:23:20.531 GMT [81948] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:23:20.531 GMT [81948] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:23:20.534 GMT [81948] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:23:20.539 GMT [81949] LOG:  database system was shut down at 2023-01-13 09:23:20 GMT
2023-01-13 09:23:20.546 GMT [81948] LOG:  database system is ready to accept connections
2023-01-13 09:23:21.535 GMT [81984] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:23:21.535 GMT [81984] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:23:21.535 GMT [81984] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:23:21.539 GMT [81984] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:23:21.539 GMT [81984] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:23:21.539 GMT [81984] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:24:05.262 GMT [81948] LOG:  received fast shutdown request
2023-01-13 09:24:05.264 GMT [81948] LOG:  aborting any active transactions
2023-01-13 09:24:05.270 GMT [81948] LOG:  background worker "logical replication launcher" (PID 81955) exited with exit code 1
2023-01-13 09:24:05.271 GMT [81950] LOG:  shutting down
2023-01-13 09:24:05.329 GMT [81948] LOG:  database system is shut down
2023-01-13 09:24:06.810 GMT [82186] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:24:06.811 GMT [82186] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:24:06.813 GMT [82186] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:24:06.819 GMT [82187] LOG:  database system was shut down at 2023-01-13 09:24:06 GMT
2023-01-13 09:24:06.824 GMT [82186] LOG:  database system is ready to accept connections
2023-01-13 09:24:07.769 GMT [82225] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:24:07.769 GMT [82225] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:24:07.769 GMT [82225] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:24:07.770 GMT [82225] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:24:07.770 GMT [82225] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:24:07.770 GMT [82225] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:25:25.764 GMT [82186] LOG:  received fast shutdown request
2023-01-13 09:25:25.767 GMT [82186] LOG:  aborting any active transactions
2023-01-13 09:25:25.772 GMT [82186] LOG:  background worker "logical replication launcher" (PID 82193) exited with exit code 1
2023-01-13 09:25:25.773 GMT [82188] LOG:  shutting down
2023-01-13 09:25:25.836 GMT [82186] LOG:  database system is shut down
2023-01-13 09:25:27.335 GMT [82550] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:25:27.336 GMT [82550] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:25:27.337 GMT [82550] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:25:27.342 GMT [82551] LOG:  database system was shut down at 2023-01-13 09:25:26 GMT
2023-01-13 09:25:27.350 GMT [82550] LOG:  database system is ready to accept connections
2023-01-13 09:25:28.261 GMT [82586] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:25:28.261 GMT [82586] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:25:28.261 GMT [82586] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:25:28.263 GMT [82586] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:25:28.263 GMT [82586] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:25:28.263 GMT [82586] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:25:28.316 GMT [82586] ERROR:  column "debit_account_id" does not exist at character 118
2023-01-13 09:25:28.316 GMT [82586] QUERY:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_id)
2023-01-13 09:25:28.316 GMT [82586] CONTEXT:  PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-13 09:25:28.316 GMT [82586] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-13 09:26:15.160 GMT [82550] LOG:  received fast shutdown request
2023-01-13 09:26:15.162 GMT [82550] LOG:  aborting any active transactions
2023-01-13 09:26:15.169 GMT [82550] LOG:  background worker "logical replication launcher" (PID 82557) exited with exit code 1
2023-01-13 09:26:15.170 GMT [82552] LOG:  shutting down
2023-01-13 09:26:15.235 GMT [82550] LOG:  database system is shut down
2023-01-13 09:26:16.753 GMT [82823] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:26:16.753 GMT [82823] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:26:16.755 GMT [82823] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:26:16.759 GMT [82824] LOG:  database system was shut down at 2023-01-13 09:26:16 GMT
2023-01-13 09:26:16.767 GMT [82823] LOG:  database system is ready to accept connections
2023-01-13 09:26:17.848 GMT [82866] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:26:17.848 GMT [82866] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:26:17.848 GMT [82866] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:26:17.850 GMT [82866] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:26:17.850 GMT [82866] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:26:17.850 GMT [82866] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:26:17.890 GMT [82866] ERROR:  column "account_id" of relation "debit_overdraft" does not exist at character 79
2023-01-13 09:26:17.890 GMT [82866] QUERY:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_id) VALUES (0, 0, 0.01, debit_account_number)
2023-01-13 09:26:17.890 GMT [82866] CONTEXT:  PL/pgSQL function open_debit_account(integer) line 11 at SQL statement
2023-01-13 09:26:17.890 GMT [82866] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-13 09:26:36.652 GMT [82823] LOG:  received fast shutdown request
2023-01-13 09:26:36.654 GMT [82823] LOG:  aborting any active transactions
2023-01-13 09:26:36.658 GMT [82823] LOG:  background worker "logical replication launcher" (PID 82830) exited with exit code 1
2023-01-13 09:26:36.660 GMT [82825] LOG:  shutting down
2023-01-13 09:26:36.733 GMT [82823] LOG:  database system is shut down
2023-01-13 09:26:38.100 GMT [82999] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:26:38.100 GMT [82999] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:26:38.102 GMT [82999] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:26:38.106 GMT [83001] LOG:  database system was shut down at 2023-01-13 09:26:37 GMT
2023-01-13 09:26:38.113 GMT [82999] LOG:  database system is ready to accept connections
2023-01-13 09:26:39.027 GMT [83038] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:26:39.027 GMT [83038] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:26:39.027 GMT [83038] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:26:39.028 GMT [83038] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:26:39.028 GMT [83038] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:26:39.028 GMT [83038] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:26:39.056 GMT [83038] ERROR:  column "rowcount" does not exist at character 22
2023-01-13 09:26:39.056 GMT [83038] QUERY:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END
2023-01-13 09:26:39.056 GMT [83038] CONTEXT:  PL/pgSQL function open_debit_account(integer) line 13 at assignment
2023-01-13 09:26:39.056 GMT [83038] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-13 09:27:18.501 GMT [82999] LOG:  received fast shutdown request
2023-01-13 09:27:18.504 GMT [82999] LOG:  aborting any active transactions
2023-01-13 09:27:18.508 GMT [82999] LOG:  background worker "logical replication launcher" (PID 83008) exited with exit code 1
2023-01-13 09:27:18.512 GMT [83003] LOG:  shutting down
2023-01-13 09:27:18.574 GMT [82999] LOG:  database system is shut down
2023-01-13 09:27:20.146 GMT [83230] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 09:27:20.147 GMT [83230] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 09:27:20.149 GMT [83230] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 09:27:20.154 GMT [83231] LOG:  database system was shut down at 2023-01-13 09:27:19 GMT
2023-01-13 09:27:20.163 GMT [83230] LOG:  database system is ready to accept connections
2023-01-13 09:27:21.151 GMT [83273] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:27:21.151 GMT [83273] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 09:27:21.151 GMT [83273] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 09:27:21.153 GMT [83273] ERROR:  parameter name "account_id" used more than once
2023-01-13 09:27:21.153 GMT [83273] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 09:27:21.153 GMT [83273] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 11:30:58.509 GMT [4587] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 11:30:58.514 GMT [4587] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 11:30:58.516 GMT [4587] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 11:30:58.521 GMT [4588] LOG:  database system was shut down at 2023-01-13 11:30:58 GMT
2023-01-13 11:30:58.527 GMT [4587] LOG:  database system is ready to accept connections
2023-01-13 11:30:59.655 GMT [4638] ERROR:  parameter name "account_id" used more than once
2023-01-13 11:30:59.655 GMT [4638] CONTEXT:  compilation of PL/pgSQL function "view_credit_statement" near line 1
2023-01-13 11:30:59.655 GMT [4638] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_id INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_id
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 11:30:59.657 GMT [4638] ERROR:  parameter name "account_id" used more than once
2023-01-13 11:30:59.657 GMT [4638] CONTEXT:  compilation of PL/pgSQL function "view_savings_statement" near line 1
2023-01-13 11:30:59.657 GMT [4638] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_id INT, savings_account_id INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_id
	        AND savings_accounts_statement.account_number = savings_account_id
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-13 11:34:29.551 GMT [4587] LOG:  received fast shutdown request
2023-01-13 11:34:29.552 GMT [4587] LOG:  aborting any active transactions
2023-01-13 11:34:29.561 GMT [4587] LOG:  background worker "logical replication launcher" (PID 4594) exited with exit code 1
2023-01-13 11:34:29.562 GMT [4589] LOG:  shutting down
2023-01-13 11:34:29.630 GMT [4587] LOG:  database system is shut down
2023-01-13 11:34:31.048 GMT [5520] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 11:34:31.048 GMT [5520] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 11:34:31.050 GMT [5520] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 11:34:31.055 GMT [5521] LOG:  database system was shut down at 2023-01-13 11:34:30 GMT
2023-01-13 11:34:31.062 GMT [5520] LOG:  database system is ready to accept connections
2023-01-13 13:52:23.126 GMT [5520] LOG:  received fast shutdown request
2023-01-13 13:52:23.129 GMT [5520] LOG:  aborting any active transactions
2023-01-13 13:52:23.138 GMT [5520] LOG:  background worker "logical replication launcher" (PID 5527) exited with exit code 1
2023-01-13 13:52:23.139 GMT [5522] LOG:  shutting down
2023-01-13 13:52:23.154 GMT [5520] LOG:  database system is shut down
2023-01-13 13:52:27.111 GMT [23019] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 13:52:27.112 GMT [23019] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 13:52:27.114 GMT [23019] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 13:52:27.119 GMT [23020] LOG:  database system was shut down at 2023-01-13 13:52:26 GMT
2023-01-13 13:52:27.125 GMT [23019] LOG:  database system is ready to accept connections
2023-01-13 13:52:28.011 GMT [23060] ERROR:  column online_account.account_id does not exist at character 172
2023-01-13 13:52:28.011 GMT [23060] STATEMENT:  CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON online_account.account_id = customer.account_id;
2023-01-13 13:52:28.013 GMT [23060] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 13:52:28.013 GMT [23060] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 13:53:15.752 GMT [23019] LOG:  received fast shutdown request
2023-01-13 13:53:15.753 GMT [23019] LOG:  aborting any active transactions
2023-01-13 13:53:15.759 GMT [23019] LOG:  background worker "logical replication launcher" (PID 23026) exited with exit code 1
2023-01-13 13:53:15.759 GMT [23021] LOG:  shutting down
2023-01-13 13:53:15.808 GMT [23019] LOG:  database system is shut down
2023-01-13 13:53:17.091 GMT [23309] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 13:53:17.091 GMT [23309] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 13:53:17.093 GMT [23309] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 13:53:17.098 GMT [23310] LOG:  database system was shut down at 2023-01-13 13:53:16 GMT
2023-01-13 13:53:17.103 GMT [23309] LOG:  database system is ready to accept connections
2023-01-13 13:53:17.948 GMT [23338] ERROR:  column customer.account_id does not exist at character 198
2023-01-13 13:53:17.948 GMT [23338] STATEMENT:  CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON online_account.id = customer.account_id;
2023-01-13 13:53:17.950 GMT [23338] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 13:53:17.950 GMT [23338] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 13:53:36.521 GMT [23309] LOG:  received fast shutdown request
2023-01-13 13:53:36.524 GMT [23309] LOG:  aborting any active transactions
2023-01-13 13:53:36.527 GMT [23309] LOG:  background worker "logical replication launcher" (PID 23316) exited with exit code 1
2023-01-13 13:53:36.529 GMT [23311] LOG:  shutting down
2023-01-13 13:53:36.579 GMT [23309] LOG:  database system is shut down
2023-01-13 13:53:37.997 GMT [23477] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 13:53:37.997 GMT [23477] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 13:53:38.001 GMT [23477] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 13:53:38.010 GMT [23478] LOG:  database system was shut down at 2023-01-13 13:53:37 GMT
2023-01-13 13:53:38.017 GMT [23477] LOG:  database system is ready to accept connections
2023-01-13 13:53:38.947 GMT [23516] ERROR:  relation "customers" does not exist at character 167
2023-01-13 13:53:38.947 GMT [23516] STATEMENT:  CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customers.last_name
	    FROM online_account
	    INNER JOIN customers ON online_account.id = customers.account_id;
2023-01-13 13:53:38.948 GMT [23516] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 13:53:38.948 GMT [23516] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 13:53:47.595 GMT [23477] LOG:  received fast shutdown request
2023-01-13 13:53:47.597 GMT [23477] LOG:  aborting any active transactions
2023-01-13 13:53:47.599 GMT [23477] LOG:  background worker "logical replication launcher" (PID 23484) exited with exit code 1
2023-01-13 13:53:47.602 GMT [23479] LOG:  shutting down
2023-01-13 13:53:47.660 GMT [23477] LOG:  database system is shut down
2023-01-13 13:53:48.922 GMT [23622] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 13:53:48.923 GMT [23622] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 13:53:48.925 GMT [23622] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 13:53:48.931 GMT [23626] LOG:  database system was shut down at 2023-01-13 13:53:48 GMT
2023-01-13 13:53:48.939 GMT [23622] LOG:  database system is ready to accept connections
2023-01-13 13:53:49.833 GMT [23661] ERROR:  relation "staff.customers" does not exist at character 167
2023-01-13 13:53:49.833 GMT [23661] STATEMENT:  CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customers.last_name
	    FROM online_account
	    INNER JOIN staff.customers ON online_account.id = customers.account_id;
2023-01-13 13:53:49.835 GMT [23661] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 13:53:49.835 GMT [23661] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 14:00:04.691 GMT [23622] LOG:  received fast shutdown request
2023-01-13 14:00:04.692 GMT [23622] LOG:  aborting any active transactions
2023-01-13 14:00:04.698 GMT [23622] LOG:  background worker "logical replication launcher" (PID 23632) exited with exit code 1
2023-01-13 14:00:04.698 GMT [23627] LOG:  shutting down
2023-01-13 14:00:04.717 GMT [23622] LOG:  database system is shut down
2023-01-13 14:00:05.998 GMT [24764] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:00:05.999 GMT [24764] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:00:06.001 GMT [24764] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:00:06.006 GMT [24765] LOG:  database system was shut down at 2023-01-13 14:00:05 GMT
2023-01-13 14:00:06.013 GMT [24764] LOG:  database system is ready to accept connections
2023-01-13 14:00:06.873 GMT [24793] ERROR:  missing FROM-clause entry for table "customers" at character 108
2023-01-13 14:00:06.873 GMT [24793] STATEMENT:  CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customers.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
2023-01-13 14:00:06.875 GMT [24793] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 14:00:06.875 GMT [24793] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 14:00:16.895 GMT [24764] LOG:  received fast shutdown request
2023-01-13 14:00:16.897 GMT [24764] LOG:  aborting any active transactions
2023-01-13 14:00:16.902 GMT [24764] LOG:  background worker "logical replication launcher" (PID 24771) exited with exit code 1
2023-01-13 14:00:16.902 GMT [24766] LOG:  shutting down
2023-01-13 14:00:16.953 GMT [24764] LOG:  database system is shut down
2023-01-13 14:00:18.330 GMT [24912] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:00:18.331 GMT [24912] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:00:18.333 GMT [24912] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:00:18.338 GMT [24913] LOG:  database system was shut down at 2023-01-13 14:00:18 GMT
2023-01-13 14:00:18.344 GMT [24912] LOG:  database system is ready to accept connections
2023-01-13 14:00:19.239 GMT [24951] ERROR:  syntax error at or near "RETURN" at character 692
2023-01-13 14:00:19.239 GMT [24951] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account_number, account_id FROM account;
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM account
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM account
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM account
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	END
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (CURRENT_DATE, CURRENT_DATE, 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN success;
	END;
	$$ LANGUAGE plpgsql;
	
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-13 14:01:14.713 GMT [24912] LOG:  received fast shutdown request
2023-01-13 14:01:14.714 GMT [24912] LOG:  aborting any active transactions
2023-01-13 14:01:14.717 GMT [24912] LOG:  background worker "logical replication launcher" (PID 24919) exited with exit code 1
2023-01-13 14:01:14.724 GMT [24914] LOG:  shutting down
2023-01-13 14:01:14.782 GMT [24912] LOG:  database system is shut down
2023-01-13 14:01:16.188 GMT [25192] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:01:16.189 GMT [25192] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:01:16.191 GMT [25192] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:01:16.197 GMT [25193] LOG:  database system was shut down at 2023-01-13 14:01:15 GMT
2023-01-13 14:01:16.205 GMT [25192] LOG:  database system is ready to accept connections
2023-01-13 14:01:17.412 GMT [25231] ERROR:  column loan_statement.end_date does not exist at character 138
2023-01-13 14:01:17.412 GMT [25231] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.end_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-13 14:01:17.413 GMT [25231] ERROR:  column loan.acccount_id does not exist at character 63
2023-01-13 14:01:17.413 GMT [25231] HINT:  Perhaps you meant to reference the column "loan.account_id".
2023-01-13 14:01:17.413 GMT [25231] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-13 14:02:50.740 GMT [25192] LOG:  received fast shutdown request
2023-01-13 14:02:50.742 GMT [25192] LOG:  aborting any active transactions
2023-01-13 14:02:50.746 GMT [25192] LOG:  background worker "logical replication launcher" (PID 25199) exited with exit code 1
2023-01-13 14:02:50.747 GMT [25194] LOG:  shutting down
2023-01-13 14:02:50.799 GMT [25192] LOG:  database system is shut down
2023-01-13 14:02:52.133 GMT [25577] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:02:52.134 GMT [25577] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:02:52.136 GMT [25577] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:02:52.141 GMT [25578] LOG:  database system was shut down at 2023-01-13 14:02:51 GMT
2023-01-13 14:02:52.147 GMT [25577] LOG:  database system is ready to accept connections
2023-01-13 14:02:53.064 GMT [25613] ERROR:  column loan_statement.minimum_payment does not exist at character 161
2023-01-13 14:02:53.064 GMT [25613] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.amount, loan_statement.minimum_payment, loan_statement.minimum_payment_due_date
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-13 14:02:53.065 GMT [25613] ERROR:  column loan.acccount_id does not exist at character 63
2023-01-13 14:02:53.065 GMT [25613] HINT:  Perhaps you meant to reference the column "loan.account_id".
2023-01-13 14:02:53.065 GMT [25613] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-13 14:03:18.177 GMT [25577] LOG:  received fast shutdown request
2023-01-13 14:03:18.178 GMT [25577] LOG:  aborting any active transactions
2023-01-13 14:03:18.184 GMT [25577] LOG:  background worker "logical replication launcher" (PID 25584) exited with exit code 1
2023-01-13 14:03:18.184 GMT [25579] LOG:  shutting down
2023-01-13 14:03:18.243 GMT [25577] LOG:  database system is shut down
2023-01-13 14:03:19.623 GMT [25790] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:03:19.624 GMT [25790] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:03:19.625 GMT [25790] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:03:19.630 GMT [25791] LOG:  database system was shut down at 2023-01-13 14:03:19 GMT
2023-01-13 14:03:19.637 GMT [25790] LOG:  database system is ready to accept connections
2023-01-13 14:03:20.528 GMT [25826] ERROR:  column "id" specified more than once
2023-01-13 14:03:20.528 GMT [25826] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id, loan_statement.starting_date, loan_statement.amount
	    FROM loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-13 14:03:20.529 GMT [25826] ERROR:  column loan.acccount_id does not exist at character 63
2023-01-13 14:03:20.529 GMT [25826] HINT:  Perhaps you meant to reference the column "loan.account_id".
2023-01-13 14:03:20.529 GMT [25826] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-13 14:03:41.271 GMT [25790] LOG:  received fast shutdown request
2023-01-13 14:03:41.278 GMT [25790] LOG:  aborting any active transactions
2023-01-13 14:03:41.289 GMT [25790] LOG:  background worker "logical replication launcher" (PID 25797) exited with exit code 1
2023-01-13 14:03:41.289 GMT [25792] LOG:  shutting down
2023-01-13 14:03:41.353 GMT [25790] LOG:  database system is shut down
2023-01-13 14:03:42.598 GMT [25969] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:03:42.598 GMT [25969] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:03:42.600 GMT [25969] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:03:42.604 GMT [25970] LOG:  database system was shut down at 2023-01-13 14:03:42 GMT
2023-01-13 14:03:42.611 GMT [25969] LOG:  database system is ready to accept connections
2023-01-13 14:03:43.410 GMT [25995] ERROR:  column loan.acccount_id does not exist at character 63
2023-01-13 14:03:43.410 GMT [25995] HINT:  Perhaps you meant to reference the column "loan.account_id".
2023-01-13 14:03:43.410 GMT [25995] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-13 14:04:11.861 GMT [25969] LOG:  received fast shutdown request
2023-01-13 14:04:11.863 GMT [25969] LOG:  aborting any active transactions
2023-01-13 14:04:11.869 GMT [25969] LOG:  background worker "logical replication launcher" (PID 25976) exited with exit code 1
2023-01-13 14:04:11.869 GMT [25971] LOG:  shutting down
2023-01-13 14:04:11.918 GMT [25969] LOG:  database system is shut down
2023-01-13 14:04:13.168 GMT [26162] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:04:13.168 GMT [26162] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:04:13.170 GMT [26162] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:04:13.174 GMT [26163] LOG:  database system was shut down at 2023-01-13 14:04:12 GMT
2023-01-13 14:04:13.182 GMT [26162] LOG:  database system is ready to accept connections
2023-01-13 14:04:14.026 GMT [26188] ERROR:  column loan.acccount_id does not exist at character 63
2023-01-13 14:04:14.026 GMT [26188] HINT:  Perhaps you meant to reference the column "loan.account_id".
2023-01-13 14:04:14.026 GMT [26188] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.acccount_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-13 14:05:05.404 GMT [26162] LOG:  received fast shutdown request
2023-01-13 14:05:05.406 GMT [26162] LOG:  aborting any active transactions
2023-01-13 14:05:05.411 GMT [26162] LOG:  background worker "logical replication launcher" (PID 26169) exited with exit code 1
2023-01-13 14:05:05.411 GMT [26164] LOG:  shutting down
2023-01-13 14:05:05.463 GMT [26162] LOG:  database system is shut down
2023-01-13 14:05:06.625 GMT [26421] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-13 14:05:06.625 GMT [26421] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-13 14:05:06.627 GMT [26421] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-13 14:05:06.631 GMT [26422] LOG:  database system was shut down at 2023-01-13 14:05:06 GMT
2023-01-13 14:05:06.638 GMT [26421] LOG:  database system is ready to accept connections
2023-01-13 15:11:12.170 GMT [26421] LOG:  received smart shutdown request
2023-01-13 15:11:12.183 GMT [26421] LOG:  received SIGHUP, reloading configuration files
2023-01-13 15:11:12.183 GMT [26421] LOG:  background worker "logical replication launcher" (PID 26428) exited with exit code 1
2023-01-13 15:11:12.184 GMT [26423] LOG:  shutting down
2023-01-13 15:11:12.227 GMT [26421] LOG:  database system is shut down
2023-01-14 17:54:16.757 GMT [22079] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 17:54:16.760 GMT [22079] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 17:54:16.761 GMT [22079] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 17:54:16.766 GMT [22080] LOG:  database system was shut down at 2023-01-14 17:54:16 GMT
2023-01-14 17:54:16.772 GMT [22079] LOG:  database system is ready to accept connections
2023-01-14 17:54:17.639 GMT [22119] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 17:54:17.639 GMT [22119] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:54:17.642 GMT [22119] ERROR:  syntax error at or near ";" at character 941
2023-01-14 17:54:17.642 GMT [22119] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:54:17.662 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.662 GMT [22119] STATEMENT:  client.open_savings_account(1);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_savings_account(2);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_savings_account(3);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_savings_account(4);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_debit_account(1);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_debit_account(2);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_debit_account(3);
2023-01-14 17:54:17.663 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.663 GMT [22119] STATEMENT:  client.open_debit_account(4);
2023-01-14 17:54:17.664 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.664 GMT [22119] STATEMENT:  client.open_credit_account(1);
2023-01-14 17:54:17.664 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.664 GMT [22119] STATEMENT:  client.open_credit_account(2);
2023-01-14 17:54:17.664 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.664 GMT [22119] STATEMENT:  client.open_credit_account(3);
2023-01-14 17:54:17.664 GMT [22119] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:54:17.664 GMT [22119] STATEMENT:  client.open_credit_account(4);
2023-01-14 17:55:14.302 GMT [22079] LOG:  received fast shutdown request
2023-01-14 17:55:14.304 GMT [22079] LOG:  aborting any active transactions
2023-01-14 17:55:14.309 GMT [22079] LOG:  background worker "logical replication launcher" (PID 22086) exited with exit code 1
2023-01-14 17:55:14.309 GMT [22081] LOG:  shutting down
2023-01-14 17:55:14.354 GMT [22079] LOG:  database system is shut down
2023-01-14 17:55:15.691 GMT [22391] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 17:55:15.692 GMT [22391] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 17:55:15.693 GMT [22391] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 17:55:15.699 GMT [22392] LOG:  database system was shut down at 2023-01-14 17:55:15 GMT
2023-01-14 17:55:15.705 GMT [22391] LOG:  database system is ready to accept connections
2023-01-14 17:55:16.619 GMT [22430] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 17:55:16.619 GMT [22430] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:55:16.621 GMT [22430] ERROR:  syntax error at or near ";" at character 941
2023-01-14 17:55:16.621 GMT [22430] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:55:16.669 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.669 GMT [22430] STATEMENT:  client.open_savings_account(1);
2023-01-14 17:55:16.672 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.672 GMT [22430] STATEMENT:  client.open_savings_account(2);
2023-01-14 17:55:16.673 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.673 GMT [22430] STATEMENT:  client.open_savings_account(3);
2023-01-14 17:55:16.673 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.673 GMT [22430] STATEMENT:  client.open_savings_account(4);
2023-01-14 17:55:16.673 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.673 GMT [22430] STATEMENT:  client.open_debit_account(1);
2023-01-14 17:55:16.673 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.673 GMT [22430] STATEMENT:  client.open_debit_account(2);
2023-01-14 17:55:16.673 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.673 GMT [22430] STATEMENT:  client.open_debit_account(3);
2023-01-14 17:55:16.674 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.674 GMT [22430] STATEMENT:  client.open_debit_account(4);
2023-01-14 17:55:16.674 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.674 GMT [22430] STATEMENT:  client.open_credit_account(1);
2023-01-14 17:55:16.674 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.674 GMT [22430] STATEMENT:  client.open_credit_account(2);
2023-01-14 17:55:16.674 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.674 GMT [22430] STATEMENT:  client.open_credit_account(3);
2023-01-14 17:55:16.674 GMT [22430] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:55:16.674 GMT [22430] STATEMENT:  client.open_credit_account(4);
2023-01-14 17:56:25.220 GMT [22391] LOG:  received fast shutdown request
2023-01-14 17:56:25.222 GMT [22391] LOG:  aborting any active transactions
2023-01-14 17:56:25.227 GMT [22391] LOG:  background worker "logical replication launcher" (PID 22398) exited with exit code 1
2023-01-14 17:56:25.227 GMT [22393] LOG:  shutting down
2023-01-14 17:56:25.278 GMT [22391] LOG:  database system is shut down
2023-01-14 17:56:26.691 GMT [22696] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 17:56:26.692 GMT [22696] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 17:56:26.693 GMT [22696] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 17:56:26.702 GMT [22697] LOG:  database system was shut down at 2023-01-14 17:56:26 GMT
2023-01-14 17:56:26.708 GMT [22696] LOG:  database system is ready to accept connections
2023-01-14 17:56:27.622 GMT [22735] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 17:56:27.622 GMT [22735] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:56:27.625 GMT [22735] ERROR:  syntax error at or near ";" at character 941
2023-01-14 17:56:27.625 GMT [22735] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:56:27.660 GMT [22735] ERROR:  syntax error at or near "PERFORM" at character 1
2023-01-14 17:56:27.660 GMT [22735] STATEMENT:  PERFORM SELECT * FROM client.open_savings_account(1);
2023-01-14 17:56:27.661 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.661 GMT [22735] STATEMENT:  client.open_savings_account(1);
2023-01-14 17:56:27.661 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.661 GMT [22735] STATEMENT:  client.open_savings_account(2);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_savings_account(3);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_savings_account(4);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_debit_account(1);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_debit_account(2);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_debit_account(3);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_debit_account(4);
2023-01-14 17:56:27.662 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.662 GMT [22735] STATEMENT:  client.open_credit_account(1);
2023-01-14 17:56:27.663 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.663 GMT [22735] STATEMENT:  client.open_credit_account(2);
2023-01-14 17:56:27.663 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.663 GMT [22735] STATEMENT:  client.open_credit_account(3);
2023-01-14 17:56:27.663 GMT [22735] ERROR:  syntax error at or near "client" at character 1
2023-01-14 17:56:27.663 GMT [22735] STATEMENT:  client.open_credit_account(4);
2023-01-14 17:57:53.029 GMT [22696] LOG:  received fast shutdown request
2023-01-14 17:57:53.031 GMT [22696] LOG:  aborting any active transactions
2023-01-14 17:57:53.036 GMT [22696] LOG:  background worker "logical replication launcher" (PID 22703) exited with exit code 1
2023-01-14 17:57:53.036 GMT [22698] LOG:  shutting down
2023-01-14 17:57:53.085 GMT [22696] LOG:  database system is shut down
2023-01-14 17:57:54.435 GMT [23137] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 17:57:54.435 GMT [23137] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 17:57:54.436 GMT [23137] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 17:57:54.441 GMT [23138] LOG:  database system was shut down at 2023-01-14 17:57:54 GMT
2023-01-14 17:57:54.452 GMT [23137] LOG:  database system is ready to accept connections
2023-01-14 17:57:55.350 GMT [23172] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 17:57:55.350 GMT [23172] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:57:55.354 GMT [23172] ERROR:  syntax error at or near ";" at character 941
2023-01-14 17:57:55.354 GMT [23172] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:57:55.390 GMT [23172] ERROR:  duplicate key value violates unique constraint "savings_account_pkey"
2023-01-14 17:57:55.390 GMT [23172] DETAIL:  Key (account_number)=(10000000) already exists.
2023-01-14 17:57:55.390 GMT [23172] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-14 17:57:55.390 GMT [23172] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-14 17:57:55.391 GMT [23172] ERROR:  duplicate key value violates unique constraint "savings_account_pkey"
2023-01-14 17:57:55.391 GMT [23172] DETAIL:  Key (account_number)=(10000000) already exists.
2023-01-14 17:57:55.391 GMT [23172] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-14 17:57:55.391 GMT [23172] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-14 17:57:55.391 GMT [23172] ERROR:  duplicate key value violates unique constraint "savings_account_pkey"
2023-01-14 17:57:55.391 GMT [23172] DETAIL:  Key (account_number)=(10000000) already exists.
2023-01-14 17:57:55.391 GMT [23172] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-14 17:57:55.391 GMT [23172] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-14 17:57:55.391 GMT [23172] ERROR:  duplicate key value violates unique constraint "savings_account_pkey"
2023-01-14 17:57:55.391 GMT [23172] DETAIL:  Key (account_number)=(10000000) already exists.
2023-01-14 17:57:55.391 GMT [23172] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-14 17:57:55.391 GMT [23172] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-14 17:57:55.399 GMT [23172] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:57:55.399 GMT [23172] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:57:55.399 GMT [23172] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:57:55.399 GMT [23172] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 17:57:55.400 GMT [23172] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:57:55.400 GMT [23172] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:57:55.400 GMT [23172] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:57:55.400 GMT [23172] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 17:57:55.401 GMT [23172] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:57:55.401 GMT [23172] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:57:55.401 GMT [23172] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:57:55.401 GMT [23172] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 17:57:55.401 GMT [23172] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:57:55.401 GMT [23172] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:57:55.401 GMT [23172] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:57:55.401 GMT [23172] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 17:59:11.313 GMT [23137] LOG:  received fast shutdown request
2023-01-14 17:59:11.316 GMT [23137] LOG:  aborting any active transactions
2023-01-14 17:59:11.319 GMT [23137] LOG:  background worker "logical replication launcher" (PID 23144) exited with exit code 1
2023-01-14 17:59:11.323 GMT [23139] LOG:  shutting down
2023-01-14 17:59:11.372 GMT [23137] LOG:  database system is shut down
2023-01-14 17:59:12.819 GMT [23496] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 17:59:12.820 GMT [23496] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 17:59:12.821 GMT [23496] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 17:59:12.827 GMT [23497] LOG:  database system was shut down at 2023-01-14 17:59:12 GMT
2023-01-14 17:59:12.833 GMT [23496] LOG:  database system is ready to accept connections
2023-01-14 17:59:13.708 GMT [23532] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 17:59:13.708 GMT [23532] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:59:13.712 GMT [23532] ERROR:  syntax error at or near ";" at character 941
2023-01-14 17:59:13.712 GMT [23532] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 17:59:13.766 GMT [23532] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:59:13.766 GMT [23532] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:59:13.766 GMT [23532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:59:13.766 GMT [23532] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 17:59:13.767 GMT [23532] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:59:13.767 GMT [23532] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:59:13.767 GMT [23532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:59:13.767 GMT [23532] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 17:59:13.769 GMT [23532] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:59:13.769 GMT [23532] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:59:13.769 GMT [23532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:59:13.769 GMT [23532] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 17:59:13.769 GMT [23532] ERROR:  column "credit_account_id" of relation "credit_account_application" does not exist at character 41
2023-01-14 17:59:13.769 GMT [23532] QUERY:  INSERT INTO credit_account_application (credit_account_id, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 17:59:13.769 GMT [23532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 17:59:13.769 GMT [23532] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:00:03.661 GMT [23496] LOG:  received fast shutdown request
2023-01-14 18:00:03.663 GMT [23496] LOG:  aborting any active transactions
2023-01-14 18:00:03.667 GMT [23496] LOG:  background worker "logical replication launcher" (PID 23503) exited with exit code 1
2023-01-14 18:00:03.667 GMT [23498] LOG:  shutting down
2023-01-14 18:00:03.719 GMT [23496] LOG:  database system is shut down
2023-01-14 18:00:04.908 GMT [23761] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:00:04.909 GMT [23761] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:00:04.910 GMT [23761] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:00:04.914 GMT [23762] LOG:  database system was shut down at 2023-01-14 18:00:04 GMT
2023-01-14 18:00:04.920 GMT [23761] LOG:  database system is ready to accept connections
2023-01-14 18:00:05.745 GMT [23790] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:00:05.745 GMT [23790] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:00:05.747 GMT [23790] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:00:05.747 GMT [23790] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:00:05.802 GMT [23790] ERROR:  column "credit_account_number" of relation "credit_account_application" does not exist at character 41
2023-01-14 18:00:05.802 GMT [23790] QUERY:  INSERT INTO credit_account_application (credit_account_number, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 18:00:05.802 GMT [23790] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 18:00:05.802 GMT [23790] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:00:05.803 GMT [23790] ERROR:  column "credit_account_number" of relation "credit_account_application" does not exist at character 41
2023-01-14 18:00:05.803 GMT [23790] QUERY:  INSERT INTO credit_account_application (credit_account_number, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 18:00:05.803 GMT [23790] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 18:00:05.803 GMT [23790] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:00:05.804 GMT [23790] ERROR:  column "credit_account_number" of relation "credit_account_application" does not exist at character 41
2023-01-14 18:00:05.804 GMT [23790] QUERY:  INSERT INTO credit_account_application (credit_account_number, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 18:00:05.804 GMT [23790] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 18:00:05.804 GMT [23790] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:00:05.805 GMT [23790] ERROR:  column "credit_account_number" of relation "credit_account_application" does not exist at character 41
2023-01-14 18:00:05.805 GMT [23790] QUERY:  INSERT INTO credit_account_application (credit_account_number, application_status) VALUES (credit_account_number, 'PENDING')
2023-01-14 18:00:05.805 GMT [23790] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 11 at SQL statement
2023-01-14 18:00:05.805 GMT [23790] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:00:38.257 GMT [23761] LOG:  received fast shutdown request
2023-01-14 18:00:38.259 GMT [23761] LOG:  aborting any active transactions
2023-01-14 18:00:38.263 GMT [23761] LOG:  background worker "logical replication launcher" (PID 23768) exited with exit code 1
2023-01-14 18:00:38.267 GMT [23763] LOG:  shutting down
2023-01-14 18:00:38.314 GMT [23761] LOG:  database system is shut down
2023-01-14 18:00:39.750 GMT [23967] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:00:39.751 GMT [23967] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:00:39.755 GMT [23967] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:00:39.759 GMT [23968] LOG:  database system was shut down at 2023-01-14 18:00:39 GMT
2023-01-14 18:00:39.773 GMT [23967] LOG:  database system is ready to accept connections
2023-01-14 18:00:40.631 GMT [24006] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:00:40.631 GMT [24006] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:00:40.636 GMT [24006] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:00:40.636 GMT [24006] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:00:40.700 GMT [24006] ERROR:  control reached end of function without RETURN
2023-01-14 18:00:40.700 GMT [24006] CONTEXT:  PL/pgSQL function open_credit_account(integer)
2023-01-14 18:00:40.700 GMT [24006] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:00:40.702 GMT [24006] ERROR:  control reached end of function without RETURN
2023-01-14 18:00:40.702 GMT [24006] CONTEXT:  PL/pgSQL function open_credit_account(integer)
2023-01-14 18:00:40.702 GMT [24006] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:00:40.703 GMT [24006] ERROR:  control reached end of function without RETURN
2023-01-14 18:00:40.703 GMT [24006] CONTEXT:  PL/pgSQL function open_credit_account(integer)
2023-01-14 18:00:40.703 GMT [24006] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:00:40.705 GMT [24006] ERROR:  control reached end of function without RETURN
2023-01-14 18:00:40.705 GMT [24006] CONTEXT:  PL/pgSQL function open_credit_account(integer)
2023-01-14 18:00:40.705 GMT [24006] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:01:21.524 GMT [23967] LOG:  received fast shutdown request
2023-01-14 18:01:21.526 GMT [23967] LOG:  aborting any active transactions
2023-01-14 18:01:21.529 GMT [23967] LOG:  background worker "logical replication launcher" (PID 23974) exited with exit code 1
2023-01-14 18:01:21.534 GMT [23969] LOG:  shutting down
2023-01-14 18:01:21.586 GMT [23967] LOG:  database system is shut down
2023-01-14 18:01:22.870 GMT [24263] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:01:22.871 GMT [24263] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:01:22.872 GMT [24263] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:01:22.881 GMT [24264] LOG:  database system was shut down at 2023-01-14 18:01:22 GMT
2023-01-14 18:01:22.888 GMT [24263] LOG:  database system is ready to accept connections
2023-01-14 18:01:23.674 GMT [24289] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:01:23.674 GMT [24289] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:01:23.676 GMT [24289] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:01:23.676 GMT [24289] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:01:46.723 GMT [24263] LOG:  received fast shutdown request
2023-01-14 18:01:46.725 GMT [24263] LOG:  aborting any active transactions
2023-01-14 18:01:46.734 GMT [24263] LOG:  background worker "logical replication launcher" (PID 24270) exited with exit code 1
2023-01-14 18:01:46.734 GMT [24265] LOG:  shutting down
2023-01-14 18:01:46.795 GMT [24263] LOG:  database system is shut down
2023-01-14 18:01:48.221 GMT [24451] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:01:48.221 GMT [24451] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:01:48.223 GMT [24451] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:01:48.227 GMT [24452] LOG:  database system was shut down at 2023-01-14 18:01:47 GMT
2023-01-14 18:01:48.233 GMT [24451] LOG:  database system is ready to accept connections
2023-01-14 18:01:49.115 GMT [24487] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:01:49.115 GMT [24487] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:01:49.118 GMT [24487] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:01:49.118 GMT [24487] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:02:08.141 GMT [24451] LOG:  received fast shutdown request
2023-01-14 18:02:08.143 GMT [24451] LOG:  aborting any active transactions
2023-01-14 18:02:08.145 GMT [24451] LOG:  background worker "logical replication launcher" (PID 24458) exited with exit code 1
2023-01-14 18:02:08.150 GMT [24453] LOG:  shutting down
2023-01-14 18:02:08.198 GMT [24451] LOG:  database system is shut down
2023-01-14 18:02:09.466 GMT [24637] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:02:09.466 GMT [24637] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:02:09.468 GMT [24637] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:02:09.474 GMT [24638] LOG:  database system was shut down at 2023-01-14 18:02:09 GMT
2023-01-14 18:02:09.480 GMT [24637] LOG:  database system is ready to accept connections
2023-01-14 18:02:10.343 GMT [24666] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:02:10.343 GMT [24666] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:02:10.346 GMT [24666] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:02:10.346 GMT [24666] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:03:06.118 GMT [24637] LOG:  received fast shutdown request
2023-01-14 18:03:06.122 GMT [24637] LOG:  aborting any active transactions
2023-01-14 18:03:06.126 GMT [24637] LOG:  background worker "logical replication launcher" (PID 24644) exited with exit code 1
2023-01-14 18:03:06.127 GMT [24639] LOG:  shutting down
2023-01-14 18:03:06.173 GMT [24637] LOG:  database system is shut down
2023-01-14 18:03:07.884 GMT [24924] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:03:07.885 GMT [24924] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:03:07.887 GMT [24924] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:03:07.891 GMT [24925] LOG:  database system was shut down at 2023-01-14 18:03:07 GMT
2023-01-14 18:03:07.897 GMT [24924] LOG:  database system is ready to accept connections
2023-01-14 18:03:08.763 GMT [24963] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:03:08.763 GMT [24963] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:03:08.769 GMT [24963] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:03:08.769 GMT [24963] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:06:12.752 GMT [24924] LOG:  received fast shutdown request
2023-01-14 18:06:12.755 GMT [24924] LOG:  aborting any active transactions
2023-01-14 18:06:12.757 GMT [24924] LOG:  background worker "logical replication launcher" (PID 24931) exited with exit code 1
2023-01-14 18:06:12.761 GMT [24926] LOG:  shutting down
2023-01-14 18:06:12.813 GMT [24924] LOG:  database system is shut down
2023-01-14 18:06:14.501 GMT [25674] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:06:14.501 GMT [25674] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:06:14.503 GMT [25674] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:06:14.508 GMT [25675] LOG:  database system was shut down at 2023-01-14 18:06:14 GMT
2023-01-14 18:06:14.514 GMT [25674] LOG:  database system is ready to accept connections
2023-01-14 18:06:15.417 GMT [25710] ERROR:  syntax error at or near "SELECT" at character 468
2023-01-14 18:06:15.417 GMT [25710] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id BOOLEAN;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM debit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM credit_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        ELSE 
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (account_number, now()::date, now()::date + 30, 0);
	            return SELECT id INTO statement_id FROM savings_account WHERE account_number = account_number AND starting_date <= now()::date AND end_date >= now()::date;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:06:15.421 GMT [25710] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:06:15.421 GMT [25710] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:06:15.494 GMT [25710] ERROR:  function client.initiate_transfer(integer, integer, numeric, integer, integer) does not exist at character 15
2023-01-14 18:06:15.494 GMT [25710] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-14 18:06:15.494 GMT [25710] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:09:39.523 GMT [25674] LOG:  received fast shutdown request
2023-01-14 18:09:39.525 GMT [25674] LOG:  aborting any active transactions
2023-01-14 18:09:39.529 GMT [25674] LOG:  background worker "logical replication launcher" (PID 25681) exited with exit code 1
2023-01-14 18:09:39.531 GMT [25676] LOG:  shutting down
2023-01-14 18:09:39.582 GMT [25674] LOG:  database system is shut down
2023-01-14 18:09:40.888 GMT [26413] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:09:40.889 GMT [26413] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:09:40.892 GMT [26413] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:09:40.900 GMT [26414] LOG:  database system was shut down at 2023-01-14 18:09:40 GMT
2023-01-14 18:09:40.906 GMT [26413] LOG:  database system is ready to accept connections
2023-01-14 18:09:41.800 GMT [26439] ERROR:  syntax error at or near ";" at character 941
2023-01-14 18:09:41.800 GMT [26439] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	       
	    ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	        SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount) INTO passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 18:09:41.876 GMT [26439] ERROR:  function client.initiate_transfer(integer, integer, numeric, integer, integer) does not exist at character 15
2023-01-14 18:09:41.876 GMT [26439] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-14 18:09:41.876 GMT [26439] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:10:21.477 GMT [26413] LOG:  received fast shutdown request
2023-01-14 18:10:21.483 GMT [26413] LOG:  aborting any active transactions
2023-01-14 18:10:21.488 GMT [26413] LOG:  background worker "logical replication launcher" (PID 26420) exited with exit code 1
2023-01-14 18:10:21.488 GMT [26415] LOG:  shutting down
2023-01-14 18:10:21.542 GMT [26413] LOG:  database system is shut down
2023-01-14 18:10:22.738 GMT [26648] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:10:22.739 GMT [26648] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:10:22.740 GMT [26648] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:10:22.745 GMT [26649] LOG:  database system was shut down at 2023-01-14 18:10:22 GMT
2023-01-14 18:10:22.751 GMT [26648] LOG:  database system is ready to accept connections
2023-01-14 18:10:23.671 GMT [26677] ERROR:  function client.initiate_transfer(integer, integer, numeric, integer, integer) does not exist at character 15
2023-01-14 18:10:23.671 GMT [26677] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-14 18:10:23.671 GMT [26677] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:10:56.578 GMT [26648] LOG:  received fast shutdown request
2023-01-14 18:10:56.580 GMT [26648] LOG:  aborting any active transactions
2023-01-14 18:10:56.585 GMT [26648] LOG:  background worker "logical replication launcher" (PID 26655) exited with exit code 1
2023-01-14 18:10:56.585 GMT [26650] LOG:  shutting down
2023-01-14 18:10:56.644 GMT [26648] LOG:  database system is shut down
2023-01-14 18:10:58.158 GMT [26888] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:10:58.158 GMT [26888] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:10:58.159 GMT [26888] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:10:58.163 GMT [26889] LOG:  database system was shut down at 2023-01-14 18:10:57 GMT
2023-01-14 18:10:58.169 GMT [26888] LOG:  database system is ready to accept connections
2023-01-14 18:10:59.085 GMT [26924] ERROR:  column reference "account_number" is ambiguous at character 75
2023-01-14 18:10:59.085 GMT [26924] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-14 18:10:59.085 GMT [26924] QUERY:  SELECT account_id                          FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code
2023-01-14 18:10:59.085 GMT [26924] CONTEXT:  PL/pgSQL function client.initiate_transfer(integer,integer,numeric,integer,text) line 7 at SQL statement
2023-01-14 18:10:59.085 GMT [26924] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, '123456');
2023-01-14 18:12:42.602 GMT [26888] LOG:  received fast shutdown request
2023-01-14 18:12:42.603 GMT [26888] LOG:  aborting any active transactions
2023-01-14 18:12:42.608 GMT [26888] LOG:  background worker "logical replication launcher" (PID 26895) exited with exit code 1
2023-01-14 18:12:42.608 GMT [26890] LOG:  shutting down
2023-01-14 18:12:42.656 GMT [26888] LOG:  database system is shut down
2023-01-14 18:12:43.842 GMT [27312] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:12:43.843 GMT [27312] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:12:43.844 GMT [27312] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:12:43.849 GMT [27313] LOG:  database system was shut down at 2023-01-14 18:12:43 GMT
2023-01-14 18:12:43.855 GMT [27312] LOG:  database system is ready to accept connections
2023-01-14 18:12:44.767 GMT [27341] ERROR:  operator does not exist: integer = text at character 130
2023-01-14 18:12:44.767 GMT [27341] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-14 18:12:44.767 GMT [27341] QUERY:  SELECT account_id                          FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code
2023-01-14 18:12:44.767 GMT [27341] CONTEXT:  PL/pgSQL function client.initiate_transfer(integer,integer,numeric,integer,text) line 7 at SQL statement
2023-01-14 18:12:44.767 GMT [27341] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, '123456');
2023-01-14 18:15:39.761 GMT [27312] LOG:  received fast shutdown request
2023-01-14 18:15:39.763 GMT [27312] LOG:  aborting any active transactions
2023-01-14 18:15:39.765 GMT [27312] LOG:  background worker "logical replication launcher" (PID 27319) exited with exit code 1
2023-01-14 18:15:39.771 GMT [27314] LOG:  shutting down
2023-01-14 18:15:39.816 GMT [27312] LOG:  database system is shut down
2023-01-14 18:15:41.192 GMT [27962] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:15:41.192 GMT [27962] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:15:41.194 GMT [27962] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:15:41.199 GMT [27963] LOG:  database system was shut down at 2023-01-14 18:15:40 GMT
2023-01-14 18:15:41.205 GMT [27962] LOG:  database system is ready to accept connections
2023-01-14 18:15:42.140 GMT [27997] ERROR:  column "account_number" does not exist at character 73
2023-01-14 18:15:42.140 GMT [27997] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, account_number, transfer_account_number, transfer_amount)
2023-01-14 18:15:42.140 GMT [27997] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:15:42.140 GMT [27997] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:16:09.827 GMT [27962] LOG:  received fast shutdown request
2023-01-14 18:16:09.829 GMT [27962] LOG:  aborting any active transactions
2023-01-14 18:16:09.834 GMT [27962] LOG:  background worker "logical replication launcher" (PID 27969) exited with exit code 1
2023-01-14 18:16:09.834 GMT [27964] LOG:  shutting down
2023-01-14 18:16:09.886 GMT [27962] LOG:  database system is shut down
2023-01-14 18:16:11.014 GMT [28170] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:16:11.014 GMT [28170] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:16:11.015 GMT [28170] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:16:11.019 GMT [28171] LOG:  database system was shut down at 2023-01-14 18:16:10 GMT
2023-01-14 18:16:11.025 GMT [28170] LOG:  database system is ready to accept connections
2023-01-14 18:16:11.889 GMT [28199] ERROR:  column reference "account_number" is ambiguous at character 87
2023-01-14 18:16:11.889 GMT [28199] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-14 18:16:11.889 GMT [28199] QUERY:  EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number)
2023-01-14 18:16:11.889 GMT [28199] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 7 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:16:11.889 GMT [28199] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:20:38.348 GMT [28170] LOG:  received fast shutdown request
2023-01-14 18:20:38.350 GMT [28170] LOG:  aborting any active transactions
2023-01-14 18:20:38.354 GMT [28170] LOG:  background worker "logical replication launcher" (PID 28177) exited with exit code 1
2023-01-14 18:20:38.354 GMT [28172] LOG:  shutting down
2023-01-14 18:20:38.406 GMT [28170] LOG:  database system is shut down
2023-01-14 18:20:39.640 GMT [29043] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:20:39.641 GMT [29043] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:20:39.643 GMT [29043] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:20:39.647 GMT [29044] LOG:  database system was shut down at 2023-01-14 18:20:39 GMT
2023-01-14 18:20:39.655 GMT [29043] LOG:  database system is ready to accept connections
2023-01-14 18:20:40.564 GMT [29072] ERROR:  column "balance" does not exist at character 46
2023-01-14 18:20:40.564 GMT [29072] QUERY:  UPDATE client.savings_accounts SET balance = balance + transaction_amount WHERE savings_accounts.account_number = orig_account_number
2023-01-14 18:20:40.564 GMT [29072] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:20:40.564 GMT [29072] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:22:55.075 GMT [29043] LOG:  received fast shutdown request
2023-01-14 18:22:55.077 GMT [29043] LOG:  aborting any active transactions
2023-01-14 18:22:55.081 GMT [29043] LOG:  background worker "logical replication launcher" (PID 29050) exited with exit code 1
2023-01-14 18:22:55.084 GMT [29045] LOG:  shutting down
2023-01-14 18:22:55.130 GMT [29043] LOG:  database system is shut down
2023-01-14 18:22:56.250 GMT [29628] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:22:56.250 GMT [29628] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:22:56.252 GMT [29628] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:22:56.257 GMT [29629] LOG:  database system was shut down at 2023-01-14 18:22:56 GMT
2023-01-14 18:22:56.262 GMT [29628] LOG:  database system is ready to accept connections
2023-01-14 18:22:57.147 GMT [29657] ERROR:  missing FROM-clause entry for table "savings_accounts" at character 89
2023-01-14 18:22:57.147 GMT [29657] QUERY:  UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_accounts.account_number = orig_account_number
2023-01-14 18:22:57.147 GMT [29657] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:22:57.147 GMT [29657] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:23:54.180 GMT [29628] LOG:  received fast shutdown request
2023-01-14 18:23:54.182 GMT [29628] LOG:  aborting any active transactions
2023-01-14 18:23:54.188 GMT [29628] LOG:  background worker "logical replication launcher" (PID 29635) exited with exit code 1
2023-01-14 18:23:54.190 GMT [29630] LOG:  shutting down
2023-01-14 18:23:54.236 GMT [29628] LOG:  database system is shut down
2023-01-14 18:23:55.473 GMT [29908] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:23:55.473 GMT [29908] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:23:55.474 GMT [29908] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:23:55.479 GMT [29909] LOG:  database system was shut down at 2023-01-14 18:23:55 GMT
2023-01-14 18:23:55.484 GMT [29908] LOG:  database system is ready to accept connections
2023-01-14 18:23:56.440 GMT [29937] ERROR:  column reference "account_number" is ambiguous at character 87
2023-01-14 18:23:56.440 GMT [29937] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-14 18:23:56.440 GMT [29937] QUERY:  EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number)
2023-01-14 18:23:56.440 GMT [29937] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) line 4 at CASE
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:23:56.440 GMT [29937] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:28:10.538 GMT [29908] LOG:  received fast shutdown request
2023-01-14 18:28:10.540 GMT [29908] LOG:  aborting any active transactions
2023-01-14 18:28:10.542 GMT [29908] LOG:  background worker "logical replication launcher" (PID 29915) exited with exit code 1
2023-01-14 18:28:10.545 GMT [29910] LOG:  shutting down
2023-01-14 18:28:10.595 GMT [29908] LOG:  database system is shut down
2023-01-14 18:28:11.747 GMT [30845] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:28:11.747 GMT [30845] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:28:11.749 GMT [30845] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:28:11.753 GMT [30846] LOG:  database system was shut down at 2023-01-14 18:28:11 GMT
2023-01-14 18:28:11.758 GMT [30845] LOG:  database system is ready to accept connections
2023-01-14 18:28:12.676 GMT [30871] ERROR:  column "id" does not exist at character 8
2023-01-14 18:28:12.676 GMT [30871] QUERY:  SELECT id                   FROM savings_account WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date
2023-01-14 18:28:12.676 GMT [30871] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) line 24 at SQL statement
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:28:12.676 GMT [30871] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:29:41.759 GMT [30845] LOG:  received fast shutdown request
2023-01-14 18:29:41.762 GMT [30845] LOG:  aborting any active transactions
2023-01-14 18:29:41.768 GMT [30845] LOG:  background worker "logical replication launcher" (PID 30852) exited with exit code 1
2023-01-14 18:29:41.769 GMT [30847] LOG:  shutting down
2023-01-14 18:29:41.816 GMT [30845] LOG:  database system is shut down
2023-01-14 18:29:43.171 GMT [31219] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:29:43.171 GMT [31219] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:29:43.173 GMT [31219] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:29:43.179 GMT [31223] LOG:  database system was shut down at 2023-01-14 18:29:42 GMT
2023-01-14 18:29:43.189 GMT [31219] LOG:  database system is ready to accept connections
2023-01-14 18:29:44.106 GMT [31248] ERROR:  invalid input syntax for type integer: "t"
2023-01-14 18:29:44.106 GMT [31248] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) while casting return value to function's return type
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:29:44.106 GMT [31248] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:30:50.786 GMT [31219] LOG:  received fast shutdown request
2023-01-14 18:30:50.789 GMT [31219] LOG:  aborting any active transactions
2023-01-14 18:30:50.796 GMT [31219] LOG:  background worker "logical replication launcher" (PID 31229) exited with exit code 1
2023-01-14 18:30:50.798 GMT [31224] LOG:  shutting down
2023-01-14 18:30:50.846 GMT [31219] LOG:  database system is shut down
2023-01-14 18:30:52.158 GMT [31547] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:30:52.158 GMT [31547] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:30:52.160 GMT [31547] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:30:52.164 GMT [31548] LOG:  database system was shut down at 2023-01-14 18:30:51 GMT
2023-01-14 18:30:52.169 GMT [31547] LOG:  database system is ready to accept connections
2023-01-14 18:30:53.067 GMT [31573] ERROR:  column "statement_id" of relation "transaction" does not exist at character 76
2023-01-14 18:30:53.067 GMT [31573] QUERY:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, statement_id)
2023-01-14 18:30:53.067 GMT [31573] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 22 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:30:53.067 GMT [31573] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:31:53.158 GMT [31547] LOG:  received fast shutdown request
2023-01-14 18:31:53.160 GMT [31547] LOG:  aborting any active transactions
2023-01-14 18:31:53.166 GMT [31547] LOG:  background worker "logical replication launcher" (PID 31554) exited with exit code 1
2023-01-14 18:31:53.166 GMT [31549] LOG:  shutting down
2023-01-14 18:31:53.217 GMT [31547] LOG:  database system is shut down
2023-01-14 18:31:54.624 GMT [31839] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:31:54.625 GMT [31839] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:31:54.626 GMT [31839] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:31:54.629 GMT [31840] LOG:  database system was shut down at 2023-01-14 18:31:54 GMT
2023-01-14 18:31:54.633 GMT [31839] LOG:  database system is ready to accept connections
2023-01-14 18:31:55.624 GMT [31875] ERROR:  INSERT has more target columns than expressions at character 76
2023-01-14 18:31:55.624 GMT [31875] QUERY:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, statement_id)
2023-01-14 18:31:55.624 GMT [31875] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 22 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 15 at SQL statement
2023-01-14 18:31:55.624 GMT [31875] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:32:49.809 GMT [31839] LOG:  received fast shutdown request
2023-01-14 18:32:49.811 GMT [31839] LOG:  aborting any active transactions
2023-01-14 18:32:49.816 GMT [31839] LOG:  background worker "logical replication launcher" (PID 31846) exited with exit code 1
2023-01-14 18:32:49.816 GMT [31841] LOG:  shutting down
2023-01-14 18:32:49.865 GMT [31839] LOG:  database system is shut down
2023-01-14 18:32:51.318 GMT [32136] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:32:51.318 GMT [32136] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:32:51.319 GMT [32136] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:32:51.324 GMT [32137] LOG:  database system was shut down at 2023-01-14 18:32:51 GMT
2023-01-14 18:32:51.330 GMT [32136] LOG:  database system is ready to accept connections
2023-01-14 18:32:52.169 GMT [32172] ERROR:  control reached end of function without RETURN
2023-01-14 18:32:52.169 GMT [32172] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer)
2023-01-14 18:32:52.169 GMT [32172] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 18:35:32.743 GMT [32136] LOG:  received fast shutdown request
2023-01-14 18:35:32.745 GMT [32136] LOG:  aborting any active transactions
2023-01-14 18:35:32.748 GMT [32136] LOG:  background worker "logical replication launcher" (PID 32143) exited with exit code 1
2023-01-14 18:35:32.752 GMT [32138] LOG:  shutting down
2023-01-14 18:35:32.793 GMT [32136] LOG:  database system is shut down
2023-01-14 18:35:34.026 GMT [32758] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:35:34.026 GMT [32758] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:35:34.028 GMT [32758] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:35:34.033 GMT [32759] LOG:  database system was shut down at 2023-01-14 18:35:33 GMT
2023-01-14 18:35:34.038 GMT [32758] LOG:  database system is ready to accept connections
2023-01-14 18:35:54.300 GMT [32758] LOG:  received fast shutdown request
2023-01-14 18:35:54.302 GMT [32758] LOG:  aborting any active transactions
2023-01-14 18:35:54.305 GMT [32758] LOG:  background worker "logical replication launcher" (PID 32765) exited with exit code 1
2023-01-14 18:35:54.311 GMT [32760] LOG:  shutting down
2023-01-14 18:35:54.362 GMT [32758] LOG:  database system is shut down
2023-01-14 18:35:55.928 GMT [32967] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:35:55.928 GMT [32967] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:35:55.930 GMT [32967] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:35:55.934 GMT [32968] LOG:  database system was shut down at 2023-01-14 18:35:55 GMT
2023-01-14 18:35:55.939 GMT [32967] LOG:  database system is ready to accept connections
2023-01-14 18:41:20.726 GMT [32967] LOG:  received fast shutdown request
2023-01-14 18:41:20.728 GMT [32967] LOG:  aborting any active transactions
2023-01-14 18:41:20.734 GMT [32967] LOG:  background worker "logical replication launcher" (PID 32974) exited with exit code 1
2023-01-14 18:41:20.754 GMT [32969] LOG:  shutting down
2023-01-14 18:41:20.766 GMT [32967] LOG:  database system is shut down
2023-01-14 18:41:21.901 GMT [34005] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:41:21.902 GMT [34005] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:41:21.903 GMT [34005] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:41:21.906 GMT [34006] LOG:  database system was shut down at 2023-01-14 18:41:21 GMT
2023-01-14 18:41:21.911 GMT [34005] LOG:  database system is ready to accept connections
2023-01-14 18:41:22.809 GMT [34034] ERROR:  column reference "account_number" is ambiguous at character 315
2023-01-14 18:41:22.809 GMT [34034] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-14 18:41:22.809 GMT [34034] QUERY:  SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number
	        AND savings_accounts_statements.account_id = account_identifier
2023-01-14 18:41:22.809 GMT [34034] CONTEXT:  PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-14 18:41:22.809 GMT [34034] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-14 18:44:06.208 GMT [34005] LOG:  received fast shutdown request
2023-01-14 18:44:06.209 GMT [34005] LOG:  aborting any active transactions
2023-01-14 18:44:06.213 GMT [34005] LOG:  background worker "logical replication launcher" (PID 34012) exited with exit code 1
2023-01-14 18:44:06.214 GMT [34007] LOG:  shutting down
2023-01-14 18:44:06.263 GMT [34005] LOG:  database system is shut down
2023-01-14 18:44:07.597 GMT [34542] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:44:07.597 GMT [34542] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:44:07.599 GMT [34542] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:44:07.604 GMT [34543] LOG:  database system was shut down at 2023-01-14 18:44:07 GMT
2023-01-14 18:44:07.609 GMT [34542] LOG:  database system is ready to accept connections
2023-01-14 18:44:08.565 GMT [34577] ERROR:  structure of query does not match function result type
2023-01-14 18:44:08.565 GMT [34577] DETAIL:  Returned type integer does not match expected type date in column 1.
2023-01-14 18:44:08.565 GMT [34577] CONTEXT:  SQL statement "SELECT savings_accounts_statements.account_id, savings_accounts_statements.account_number, savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier"
	PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-14 18:44:08.565 GMT [34577] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-14 18:45:34.927 GMT [34542] LOG:  received fast shutdown request
2023-01-14 18:45:34.930 GMT [34542] LOG:  aborting any active transactions
2023-01-14 18:45:34.938 GMT [34542] LOG:  background worker "logical replication launcher" (PID 34549) exited with exit code 1
2023-01-14 18:45:34.938 GMT [34544] LOG:  shutting down
2023-01-14 18:45:34.998 GMT [34542] LOG:  database system is shut down
2023-01-14 18:45:36.245 GMT [34945] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:45:36.245 GMT [34945] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:45:36.246 GMT [34945] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:45:36.252 GMT [34946] LOG:  database system was shut down at 2023-01-14 18:45:36 GMT
2023-01-14 18:45:36.257 GMT [34945] LOG:  database system is ready to accept connections
2023-01-14 18:45:37.223 GMT [34974] ERROR:  structure of query does not match function result type
2023-01-14 18:45:37.223 GMT [34974] DETAIL:  Returned type integer does not match expected type numeric in column 3.
2023-01-14 18:45:37.223 GMT [34974] CONTEXT:  SQL statement "SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier"
	PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-14 18:45:37.223 GMT [34974] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-14 18:46:59.153 GMT [34945] LOG:  received fast shutdown request
2023-01-14 18:46:59.155 GMT [34945] LOG:  aborting any active transactions
2023-01-14 18:46:59.159 GMT [34945] LOG:  background worker "logical replication launcher" (PID 34952) exited with exit code 1
2023-01-14 18:46:59.159 GMT [34947] LOG:  shutting down
2023-01-14 18:46:59.209 GMT [34945] LOG:  database system is shut down
2023-01-14 18:47:00.561 GMT [35314] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:47:00.561 GMT [35314] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:47:00.563 GMT [35314] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:47:00.567 GMT [35318] LOG:  database system was shut down at 2023-01-14 18:47:00 GMT
2023-01-14 18:47:00.573 GMT [35314] LOG:  database system is ready to accept connections
2023-01-14 18:47:01.464 GMT [35343] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:47:01.464 GMT [35343] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:47:01.464 GMT [35343] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:47:01.464 GMT [35343] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:47:01.464 GMT [35343] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:47:01.465 GMT [35343] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:47:01.465 GMT [35343] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:47:01.465 GMT [35343] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:47:01.465 GMT [35343] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:47:01.465 GMT [35343] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:47:01.467 GMT [35343] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:47:01.467 GMT [35343] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:47:01.467 GMT [35343] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:47:01.467 GMT [35343] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:47:01.467 GMT [35343] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:47:01.467 GMT [35343] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:47:01.467 GMT [35343] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:47:01.467 GMT [35343] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:47:01.467 GMT [35343] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:47:01.467 GMT [35343] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:51:10.618 GMT [35314] LOG:  received fast shutdown request
2023-01-14 18:51:10.621 GMT [35314] LOG:  aborting any active transactions
2023-01-14 18:51:10.626 GMT [35314] LOG:  background worker "logical replication launcher" (PID 35324) exited with exit code 1
2023-01-14 18:51:10.626 GMT [35319] LOG:  shutting down
2023-01-14 18:51:10.678 GMT [35314] LOG:  database system is shut down
2023-01-14 18:51:11.960 GMT [36190] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:51:11.960 GMT [36190] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:51:11.962 GMT [36190] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:51:11.968 GMT [36191] LOG:  database system was shut down at 2023-01-14 18:51:11 GMT
2023-01-14 18:51:11.974 GMT [36190] LOG:  database system is ready to accept connections
2023-01-14 18:51:12.974 GMT [36216] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:12.974 GMT [36216] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:12.974 GMT [36216] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:12.974 GMT [36216] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:12.974 GMT [36216] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:51:12.976 GMT [36216] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:12.976 GMT [36216] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:12.976 GMT [36216] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:12.976 GMT [36216] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:12.976 GMT [36216] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:51:12.977 GMT [36216] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:12.977 GMT [36216] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:12.977 GMT [36216] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:12.977 GMT [36216] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:12.977 GMT [36216] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:51:12.984 GMT [36216] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:12.984 GMT [36216] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:12.984 GMT [36216] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:12.984 GMT [36216] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:12.984 GMT [36216] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:51:55.852 GMT [36190] LOG:  received fast shutdown request
2023-01-14 18:51:55.854 GMT [36190] LOG:  aborting any active transactions
2023-01-14 18:51:55.858 GMT [36190] LOG:  background worker "logical replication launcher" (PID 36197) exited with exit code 1
2023-01-14 18:51:55.860 GMT [36192] LOG:  shutting down
2023-01-14 18:51:55.910 GMT [36190] LOG:  database system is shut down
2023-01-14 18:51:57.408 GMT [36435] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:51:57.409 GMT [36435] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:51:57.411 GMT [36435] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:51:57.416 GMT [36436] LOG:  database system was shut down at 2023-01-14 18:51:57 GMT
2023-01-14 18:51:57.425 GMT [36435] LOG:  database system is ready to accept connections
2023-01-14 18:51:58.413 GMT [36478] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:58.413 GMT [36478] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:58.413 GMT [36478] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:58.413 GMT [36478] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:58.413 GMT [36478] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:51:58.414 GMT [36478] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:58.414 GMT [36478] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:58.414 GMT [36478] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:58.414 GMT [36478] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:58.414 GMT [36478] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:51:58.415 GMT [36478] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:58.415 GMT [36478] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:58.415 GMT [36478] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:58.415 GMT [36478] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:58.415 GMT [36478] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:51:58.416 GMT [36478] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:51:58.416 GMT [36478] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:51:58.416 GMT [36478] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:51:58.416 GMT [36478] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:51:58.416 GMT [36478] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:54:54.364 GMT [36435] LOG:  received fast shutdown request
2023-01-14 18:54:54.366 GMT [36435] LOG:  aborting any active transactions
2023-01-14 18:54:54.372 GMT [36435] LOG:  background worker "logical replication launcher" (PID 36442) exited with exit code 1
2023-01-14 18:54:54.373 GMT [36437] LOG:  shutting down
2023-01-14 18:54:54.429 GMT [36435] LOG:  database system is shut down
2023-01-14 18:54:55.668 GMT [37050] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:54:55.668 GMT [37050] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:54:55.670 GMT [37050] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:54:55.675 GMT [37051] LOG:  database system was shut down at 2023-01-14 18:54:55 GMT
2023-01-14 18:54:55.681 GMT [37050] LOG:  database system is ready to accept connections
2023-01-14 18:54:56.597 GMT [37076] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:54:56.597 GMT [37076] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:54:56.597 GMT [37076] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:54:56.597 GMT [37076] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:54:56.597 GMT [37076] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:54:56.597 GMT [37076] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:54:56.597 GMT [37076] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:54:56.597 GMT [37076] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:54:56.597 GMT [37076] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:54:56.597 GMT [37076] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:54:56.598 GMT [37076] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:54:56.598 GMT [37076] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:54:56.598 GMT [37076] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:54:56.598 GMT [37076] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:54:56.598 GMT [37076] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:54:56.600 GMT [37076] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:54:56.600 GMT [37076] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:54:56.600 GMT [37076] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:54:56.600 GMT [37076] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:54:56.600 GMT [37076] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:55:53.971 GMT [37050] LOG:  received fast shutdown request
2023-01-14 18:55:53.973 GMT [37050] LOG:  aborting any active transactions
2023-01-14 18:55:53.979 GMT [37050] LOG:  background worker "logical replication launcher" (PID 37057) exited with exit code 1
2023-01-14 18:55:53.980 GMT [37052] LOG:  shutting down
2023-01-14 18:55:54.043 GMT [37050] LOG:  database system is shut down
2023-01-14 18:55:55.611 GMT [37339] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:55:55.611 GMT [37339] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:55:55.613 GMT [37339] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:55:55.618 GMT [37340] LOG:  database system was shut down at 2023-01-14 18:55:55 GMT
2023-01-14 18:55:55.625 GMT [37339] LOG:  database system is ready to accept connections
2023-01-14 18:55:56.568 GMT [37375] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:55:56.568 GMT [37375] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:55:56.568 GMT [37375] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:55:56.568 GMT [37375] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:55:56.568 GMT [37375] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:55:56.570 GMT [37375] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:55:56.570 GMT [37375] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:55:56.570 GMT [37375] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:55:56.570 GMT [37375] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:55:56.570 GMT [37375] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:55:56.571 GMT [37375] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:55:56.571 GMT [37375] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:55:56.571 GMT [37375] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:55:56.571 GMT [37375] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:55:56.571 GMT [37375] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:55:56.573 GMT [37375] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:55:56.573 GMT [37375] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:55:56.573 GMT [37375] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:55:56.573 GMT [37375] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:55:56.573 GMT [37375] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:58:19.058 GMT [37339] LOG:  received fast shutdown request
2023-01-14 18:58:19.059 GMT [37339] LOG:  aborting any active transactions
2023-01-14 18:58:19.070 GMT [37339] LOG:  background worker "logical replication launcher" (PID 37346) exited with exit code 1
2023-01-14 18:58:19.070 GMT [37341] LOG:  shutting down
2023-01-14 18:58:19.143 GMT [37339] LOG:  database system is shut down
2023-01-14 18:58:20.601 GMT [37883] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:58:20.601 GMT [37883] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:58:20.603 GMT [37883] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:58:20.607 GMT [37884] LOG:  database system was shut down at 2023-01-14 18:58:20 GMT
2023-01-14 18:58:20.612 GMT [37883] LOG:  database system is ready to accept connections
2023-01-14 18:58:21.432 GMT [37919] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:21.432 GMT [37919] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:21.432 GMT [37919] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:21.432 GMT [37919] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:21.432 GMT [37919] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:58:21.433 GMT [37919] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:21.433 GMT [37919] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:21.433 GMT [37919] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:21.433 GMT [37919] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:21.433 GMT [37919] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:58:21.434 GMT [37919] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:21.434 GMT [37919] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:21.434 GMT [37919] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:21.434 GMT [37919] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:21.434 GMT [37919] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:58:21.435 GMT [37919] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:21.435 GMT [37919] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:21.435 GMT [37919] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:21.435 GMT [37919] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:21.435 GMT [37919] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 18:58:44.525 GMT [37883] LOG:  received fast shutdown request
2023-01-14 18:58:44.527 GMT [37883] LOG:  aborting any active transactions
2023-01-14 18:58:44.533 GMT [37883] LOG:  background worker "logical replication launcher" (PID 37890) exited with exit code 1
2023-01-14 18:58:44.533 GMT [37885] LOG:  shutting down
2023-01-14 18:58:44.588 GMT [37883] LOG:  database system is shut down
2023-01-14 18:58:45.918 GMT [38075] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 18:58:45.919 GMT [38075] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 18:58:45.921 GMT [38075] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 18:58:45.929 GMT [38076] LOG:  database system was shut down at 2023-01-14 18:58:45 GMT
2023-01-14 18:58:45.936 GMT [38075] LOG:  database system is ready to accept connections
2023-01-14 18:58:46.796 GMT [38101] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:46.796 GMT [38101] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:46.796 GMT [38101] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:46.796 GMT [38101] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:46.796 GMT [38101] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 18:58:46.797 GMT [38101] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:46.797 GMT [38101] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:46.797 GMT [38101] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:46.797 GMT [38101] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:46.797 GMT [38101] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 18:58:46.797 GMT [38101] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:46.797 GMT [38101] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:46.797 GMT [38101] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:46.797 GMT [38101] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:46.797 GMT [38101] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 18:58:46.798 GMT [38101] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 18:58:46.798 GMT [38101] HINT:  You will need to rewrite or cast the expression.
2023-01-14 18:58:46.798 GMT [38101] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 18:58:46.798 GMT [38101] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 18:58:46.798 GMT [38101] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:00:30.690 GMT [38075] LOG:  received fast shutdown request
2023-01-14 19:00:30.693 GMT [38075] LOG:  aborting any active transactions
2023-01-14 19:00:30.699 GMT [38075] LOG:  background worker "logical replication launcher" (PID 38082) exited with exit code 1
2023-01-14 19:00:30.702 GMT [38077] LOG:  shutting down
2023-01-14 19:00:30.770 GMT [38075] LOG:  database system is shut down
2023-01-14 19:00:32.455 GMT [38496] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:00:32.455 GMT [38496] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:00:32.456 GMT [38496] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:00:32.462 GMT [38497] LOG:  database system was shut down at 2023-01-14 19:00:32 GMT
2023-01-14 19:00:32.468 GMT [38496] LOG:  database system is ready to accept connections
2023-01-14 19:00:33.353 GMT [38532] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:00:33.353 GMT [38532] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:00:33.353 GMT [38532] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:00:33.353 GMT [38532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:00:33.353 GMT [38532] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:00:33.354 GMT [38532] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:00:33.354 GMT [38532] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:00:33.354 GMT [38532] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:00:33.354 GMT [38532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:00:33.354 GMT [38532] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:00:33.355 GMT [38532] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:00:33.355 GMT [38532] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:00:33.355 GMT [38532] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:00:33.355 GMT [38532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:00:33.355 GMT [38532] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:00:33.356 GMT [38532] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:00:33.356 GMT [38532] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:00:33.356 GMT [38532] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:00:33.356 GMT [38532] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:00:33.356 GMT [38532] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:01:04.477 GMT [38496] LOG:  received fast shutdown request
2023-01-14 19:01:04.481 GMT [38496] LOG:  aborting any active transactions
2023-01-14 19:01:04.488 GMT [38496] LOG:  background worker "logical replication launcher" (PID 38503) exited with exit code 1
2023-01-14 19:01:04.489 GMT [38498] LOG:  shutting down
2023-01-14 19:01:04.548 GMT [38496] LOG:  database system is shut down
2023-01-14 19:01:05.885 GMT [38732] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:01:05.885 GMT [38732] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:01:05.887 GMT [38732] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:01:05.893 GMT [38733] LOG:  database system was shut down at 2023-01-14 19:01:05 GMT
2023-01-14 19:01:05.898 GMT [38732] LOG:  database system is ready to accept connections
2023-01-14 19:01:06.801 GMT [38768] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:01:06.801 GMT [38768] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:01:06.801 GMT [38768] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:01:06.801 GMT [38768] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:01:06.801 GMT [38768] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:01:06.802 GMT [38768] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:01:06.802 GMT [38768] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:01:06.802 GMT [38768] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:01:06.802 GMT [38768] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:01:06.802 GMT [38768] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:01:06.804 GMT [38768] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:01:06.804 GMT [38768] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:01:06.804 GMT [38768] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:01:06.804 GMT [38768] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:01:06.804 GMT [38768] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:01:06.807 GMT [38768] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:01:06.807 GMT [38768] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:01:06.807 GMT [38768] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:01:06.807 GMT [38768] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:01:06.807 GMT [38768] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:02:11.546 GMT [38732] LOG:  received fast shutdown request
2023-01-14 19:02:11.548 GMT [38732] LOG:  aborting any active transactions
2023-01-14 19:02:11.551 GMT [38732] LOG:  background worker "logical replication launcher" (PID 38739) exited with exit code 1
2023-01-14 19:02:11.553 GMT [38734] LOG:  shutting down
2023-01-14 19:02:11.602 GMT [38732] LOG:  database system is shut down
2023-01-14 19:02:12.883 GMT [39083] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:02:12.883 GMT [39083] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:02:12.885 GMT [39083] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:02:12.891 GMT [39084] LOG:  database system was shut down at 2023-01-14 19:02:12 GMT
2023-01-14 19:02:12.899 GMT [39083] LOG:  database system is ready to accept connections
2023-01-14 19:02:13.812 GMT [39109] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:02:13.812 GMT [39109] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:02:13.812 GMT [39109] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:02:13.812 GMT [39109] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:02:13.812 GMT [39109] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:02:13.813 GMT [39109] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:02:13.813 GMT [39109] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:02:13.813 GMT [39109] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:02:13.813 GMT [39109] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:02:13.813 GMT [39109] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:02:13.814 GMT [39109] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:02:13.814 GMT [39109] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:02:13.814 GMT [39109] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:02:13.814 GMT [39109] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:02:13.814 GMT [39109] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:02:13.815 GMT [39109] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:02:13.815 GMT [39109] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:02:13.815 GMT [39109] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:02:13.815 GMT [39109] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:02:13.815 GMT [39109] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:03:32.480 GMT [39083] LOG:  received fast shutdown request
2023-01-14 19:03:32.482 GMT [39083] LOG:  aborting any active transactions
2023-01-14 19:03:32.487 GMT [39083] LOG:  background worker "logical replication launcher" (PID 39090) exited with exit code 1
2023-01-14 19:03:32.487 GMT [39085] LOG:  shutting down
2023-01-14 19:03:32.534 GMT [39083] LOG:  database system is shut down
2023-01-14 19:03:33.673 GMT [39430] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:03:33.673 GMT [39430] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:03:33.675 GMT [39430] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:03:33.680 GMT [39431] LOG:  database system was shut down at 2023-01-14 19:03:33 GMT
2023-01-14 19:03:33.685 GMT [39430] LOG:  database system is ready to accept connections
2023-01-14 19:03:34.546 GMT [39456] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:03:34.546 GMT [39456] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:03:34.546 GMT [39456] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:03:34.546 GMT [39456] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:03:34.546 GMT [39456] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:03:34.547 GMT [39456] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:03:34.547 GMT [39456] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:03:34.547 GMT [39456] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:03:34.547 GMT [39456] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:03:34.547 GMT [39456] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:03:34.548 GMT [39456] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:03:34.548 GMT [39456] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:03:34.548 GMT [39456] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:03:34.548 GMT [39456] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:03:34.548 GMT [39456] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:03:34.548 GMT [39456] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:03:34.548 GMT [39456] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:03:34.548 GMT [39456] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:03:34.548 GMT [39456] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:03:34.548 GMT [39456] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:03:34.561 GMT [39456] ERROR:  query has no destination for result data
2023-01-14 19:03:34.561 GMT [39456] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-14 19:03:34.561 GMT [39456] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) line 24 at SQL statement
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-14 19:03:34.561 GMT [39456] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 19:04:51.282 GMT [39430] LOG:  received fast shutdown request
2023-01-14 19:04:51.285 GMT [39430] LOG:  aborting any active transactions
2023-01-14 19:04:51.290 GMT [39430] LOG:  background worker "logical replication launcher" (PID 39437) exited with exit code 1
2023-01-14 19:04:51.291 GMT [39432] LOG:  shutting down
2023-01-14 19:04:51.336 GMT [39430] LOG:  database system is shut down
2023-01-14 19:04:52.845 GMT [39796] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:04:52.846 GMT [39796] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:04:52.847 GMT [39796] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:04:52.852 GMT [39797] LOG:  database system was shut down at 2023-01-14 19:04:52 GMT
2023-01-14 19:04:52.859 GMT [39796] LOG:  database system is ready to accept connections
2023-01-14 19:04:53.739 GMT [39835] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:04:53.739 GMT [39835] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:04:53.739 GMT [39835] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:04:53.739 GMT [39835] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:04:53.739 GMT [39835] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:04:53.741 GMT [39835] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:04:53.741 GMT [39835] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:04:53.741 GMT [39835] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:04:53.741 GMT [39835] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:04:53.741 GMT [39835] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:04:53.742 GMT [39835] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:04:53.742 GMT [39835] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:04:53.742 GMT [39835] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:04:53.742 GMT [39835] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:04:53.742 GMT [39835] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:04:53.743 GMT [39835] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:04:53.743 GMT [39835] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:04:53.743 GMT [39835] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:04:53.743 GMT [39835] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:04:53.743 GMT [39835] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:14:38.432 GMT [39796] LOG:  received fast shutdown request
2023-01-14 19:14:38.434 GMT [39796] LOG:  aborting any active transactions
2023-01-14 19:14:38.438 GMT [39796] LOG:  background worker "logical replication launcher" (PID 39803) exited with exit code 1
2023-01-14 19:14:38.438 GMT [39798] LOG:  shutting down
2023-01-14 19:14:38.455 GMT [39796] LOG:  database system is shut down
2023-01-14 19:14:39.834 GMT [41461] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:14:39.835 GMT [41461] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:14:39.836 GMT [41461] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:14:39.841 GMT [41462] LOG:  database system was shut down at 2023-01-14 19:14:39 GMT
2023-01-14 19:14:39.848 GMT [41461] LOG:  database system is ready to accept connections
2023-01-14 19:14:40.726 GMT [41500] ERROR:  syntax error at or near "SELECT" at character 2155
2023-01-14 19:14:40.726 GMT [41500] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            RETURN statement_id;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            RETURN statement_id;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        RAISE NOTICE 'NUMBER OF STATEMENTS %', SELECT count(*) FROM savings_statement;
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-14 19:14:40.780 GMT [41500] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:14:40.780 GMT [41500] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:14:40.780 GMT [41500] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:14:40.780 GMT [41500] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:14:40.780 GMT [41500] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:14:40.781 GMT [41500] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:14:40.781 GMT [41500] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:14:40.781 GMT [41500] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:14:40.781 GMT [41500] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:14:40.781 GMT [41500] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:14:40.782 GMT [41500] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:14:40.782 GMT [41500] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:14:40.782 GMT [41500] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:14:40.782 GMT [41500] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:14:40.782 GMT [41500] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:14:40.782 GMT [41500] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:14:40.782 GMT [41500] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:14:40.782 GMT [41500] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:14:40.782 GMT [41500] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:14:40.782 GMT [41500] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:14:40.792 GMT [41500] ERROR:  function client.get_or_create_statement(integer, integer) does not exist at character 15
2023-01-14 19:14:40.792 GMT [41500] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-14 19:14:40.792 GMT [41500] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)
2023-01-14 19:14:40.792 GMT [41500] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-14 19:14:40.792 GMT [41500] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 19:16:00.502 GMT [41461] LOG:  received fast shutdown request
2023-01-14 19:16:00.504 GMT [41461] LOG:  aborting any active transactions
2023-01-14 19:16:00.507 GMT [41461] LOG:  background worker "logical replication launcher" (PID 41468) exited with exit code 1
2023-01-14 19:16:00.511 GMT [41463] LOG:  shutting down
2023-01-14 19:16:00.555 GMT [41461] LOG:  database system is shut down
2023-01-14 19:16:01.974 GMT [41843] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:16:01.974 GMT [41843] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:16:01.976 GMT [41843] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:16:01.982 GMT [41844] LOG:  database system was shut down at 2023-01-14 19:16:01 GMT
2023-01-14 19:16:01.988 GMT [41843] LOG:  database system is ready to accept connections
2023-01-14 19:16:02.913 GMT [41879] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:16:02.913 GMT [41879] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:16:02.913 GMT [41879] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:16:02.913 GMT [41879] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:16:02.913 GMT [41879] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:16:02.914 GMT [41879] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:16:02.914 GMT [41879] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:16:02.914 GMT [41879] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:16:02.914 GMT [41879] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:16:02.914 GMT [41879] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:16:02.914 GMT [41879] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:16:02.914 GMT [41879] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:16:02.914 GMT [41879] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:16:02.914 GMT [41879] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:16:02.914 GMT [41879] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:16:02.915 GMT [41879] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:16:02.915 GMT [41879] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:16:02.915 GMT [41879] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:16:02.915 GMT [41879] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:16:02.915 GMT [41879] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:18:15.715 GMT [41843] LOG:  received fast shutdown request
2023-01-14 19:18:15.717 GMT [41843] LOG:  aborting any active transactions
2023-01-14 19:18:15.720 GMT [41843] LOG:  background worker "logical replication launcher" (PID 41850) exited with exit code 1
2023-01-14 19:18:15.721 GMT [41845] LOG:  shutting down
2023-01-14 19:18:15.775 GMT [41843] LOG:  database system is shut down
2023-01-14 19:18:17.116 GMT [42331] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:18:17.116 GMT [42331] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:18:17.118 GMT [42331] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:18:17.123 GMT [42332] LOG:  database system was shut down at 2023-01-14 19:18:16 GMT
2023-01-14 19:18:17.128 GMT [42331] LOG:  database system is ready to accept connections
2023-01-14 19:18:18.138 GMT [42370] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:18:18.138 GMT [42370] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:18:18.138 GMT [42370] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:18:18.138 GMT [42370] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:18:18.138 GMT [42370] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:18:18.139 GMT [42370] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:18:18.139 GMT [42370] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:18:18.139 GMT [42370] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:18:18.139 GMT [42370] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:18:18.139 GMT [42370] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:18:18.140 GMT [42370] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:18:18.140 GMT [42370] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:18:18.140 GMT [42370] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:18:18.140 GMT [42370] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:18:18.140 GMT [42370] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:18:18.141 GMT [42370] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:18:18.141 GMT [42370] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:18:18.141 GMT [42370] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:18:18.141 GMT [42370] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:18:18.141 GMT [42370] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:19:04.665 GMT [42331] LOG:  received fast shutdown request
2023-01-14 19:19:04.667 GMT [42331] LOG:  aborting any active transactions
2023-01-14 19:19:04.671 GMT [42331] LOG:  background worker "logical replication launcher" (PID 42338) exited with exit code 1
2023-01-14 19:19:04.671 GMT [42333] LOG:  shutting down
2023-01-14 19:19:04.722 GMT [42331] LOG:  database system is shut down
2023-01-14 19:19:06.005 GMT [42605] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:19:06.005 GMT [42605] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:19:06.007 GMT [42605] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:19:06.012 GMT [42606] LOG:  database system was shut down at 2023-01-14 19:19:05 GMT
2023-01-14 19:19:06.018 GMT [42605] LOG:  database system is ready to accept connections
2023-01-14 19:19:06.947 GMT [42634] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:19:06.947 GMT [42634] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:19:06.947 GMT [42634] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:19:06.947 GMT [42634] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:19:06.947 GMT [42634] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:19:06.948 GMT [42634] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:19:06.948 GMT [42634] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:19:06.948 GMT [42634] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:19:06.948 GMT [42634] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:19:06.948 GMT [42634] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:19:06.949 GMT [42634] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:19:06.949 GMT [42634] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:19:06.949 GMT [42634] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:19:06.949 GMT [42634] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:19:06.949 GMT [42634] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:19:06.951 GMT [42634] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 165
2023-01-14 19:19:06.951 GMT [42634] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:19:06.951 GMT [42634] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (CURRENT_DATE, CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:19:06.951 GMT [42634] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:19:06.951 GMT [42634] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:21:49.527 GMT [42605] LOG:  received fast shutdown request
2023-01-14 19:21:49.529 GMT [42605] LOG:  aborting any active transactions
2023-01-14 19:21:49.532 GMT [42605] LOG:  background worker "logical replication launcher" (PID 42612) exited with exit code 1
2023-01-14 19:21:49.534 GMT [42607] LOG:  shutting down
2023-01-14 19:21:49.581 GMT [42605] LOG:  database system is shut down
2023-01-14 19:21:51.051 GMT [43236] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:21:51.051 GMT [43236] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:21:51.053 GMT [43236] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:21:51.058 GMT [43237] LOG:  database system was shut down at 2023-01-14 19:21:50 GMT
2023-01-14 19:21:51.066 GMT [43236] LOG:  database system is ready to accept connections
2023-01-14 19:21:51.981 GMT [43275] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 185
2023-01-14 19:21:51.981 GMT [43275] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:21:51.981 GMT [43275] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:21:51.981 GMT [43275] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:21:51.981 GMT [43275] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:21:51.982 GMT [43275] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 185
2023-01-14 19:21:51.982 GMT [43275] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:21:51.982 GMT [43275] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:21:51.982 GMT [43275] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:21:51.982 GMT [43275] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:21:51.983 GMT [43275] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 185
2023-01-14 19:21:51.983 GMT [43275] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:21:51.983 GMT [43275] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:21:51.983 GMT [43275] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:21:51.983 GMT [43275] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:21:51.983 GMT [43275] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 185
2023-01-14 19:21:51.983 GMT [43275] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:21:51.983 GMT [43275] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), CURRENT_DATE, 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:21:51.983 GMT [43275] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:21:51.983 GMT [43275] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 19:24:35.787 GMT [43236] LOG:  received fast shutdown request
2023-01-14 19:24:35.789 GMT [43236] LOG:  aborting any active transactions
2023-01-14 19:24:35.794 GMT [43236] LOG:  background worker "logical replication launcher" (PID 43243) exited with exit code 1
2023-01-14 19:24:35.796 GMT [43238] LOG:  shutting down
2023-01-14 19:24:35.845 GMT [43236] LOG:  database system is shut down
2023-01-14 19:24:37.058 GMT [43853] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 19:24:37.058 GMT [43853] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 19:24:37.060 GMT [43853] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 19:24:37.064 GMT [43854] LOG:  database system was shut down at 2023-01-14 19:24:36 GMT
2023-01-14 19:24:37.070 GMT [43853] LOG:  database system is ready to accept connections
2023-01-14 19:24:37.924 GMT [43882] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 19:24:37.924 GMT [43882] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:24:37.924 GMT [43882] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:24:37.924 GMT [43882] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:24:37.924 GMT [43882] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 19:24:37.925 GMT [43882] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 19:24:37.925 GMT [43882] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:24:37.925 GMT [43882] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:24:37.925 GMT [43882] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:24:37.925 GMT [43882] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 19:24:37.926 GMT [43882] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 19:24:37.926 GMT [43882] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:24:37.926 GMT [43882] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:24:37.926 GMT [43882] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:24:37.926 GMT [43882] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 19:24:37.928 GMT [43882] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 19:24:37.928 GMT [43882] HINT:  You will need to rewrite or cast the expression.
2023-01-14 19:24:37.928 GMT [43882] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 19:24:37.928 GMT [43882] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 19:24:37.928 GMT [43882] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:13:24.008 GMT [43853] LOG:  received fast shutdown request
2023-01-14 21:13:24.011 GMT [43853] LOG:  aborting any active transactions
2023-01-14 21:13:24.016 GMT [43853] LOG:  background worker "logical replication launcher" (PID 43860) exited with exit code 1
2023-01-14 21:13:24.017 GMT [43855] LOG:  shutting down
2023-01-14 21:13:24.031 GMT [43853] LOG:  database system is shut down
2023-01-14 21:13:27.951 GMT [59113] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:13:27.951 GMT [59113] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:13:27.953 GMT [59113] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:13:27.957 GMT [59114] LOG:  database system was shut down at 2023-01-14 21:13:27 GMT
2023-01-14 21:13:27.963 GMT [59113] LOG:  database system is ready to accept connections
2023-01-14 21:13:28.853 GMT [59147] ERROR:  syntax error at or near "DECLARE" at character 2447
2023-01-14 21:13:28.853 GMT [59147] STATEMENT:  CREATE OR REPLACE FUNCTION client.place_transaction_out_of_account(orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE statement_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction out of account', CURRENT_DATE);
	
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
	
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
	
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
	    ELSE
	        RAISE NOTICE 'Account does not exist';
	        RETURN FALSE;
	    END CASE;
	    RETURN TRUE;
	END;
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-14 21:13:28.853 GMT [59147] ERROR:  syntax error at or near "INT" at character 29
2023-01-14 21:13:28.853 GMT [59147] STATEMENT:  DECLARE internal_account_id INT;
2023-01-14 21:13:28.853 GMT [59147] ERROR:  syntax error at or near "INT" at character 19
2023-01-14 21:13:28.853 GMT [59147] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-14 21:13:28.854 GMT [59147] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-14 21:13:28.854 GMT [59147] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-14 21:13:28.854 GMT [59147] ERROR:  column "transfer_account_number" does not exist at character 92
2023-01-14 21:13:28.854 GMT [59147] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-14 21:13:28.855 GMT [59147] ERROR:  syntax error at or near "IF" at character 1
2023-01-14 21:13:28.855 GMT [59147] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-14 21:13:28.855 GMT [59147] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-14 21:13:28.855 GMT [59147] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-14 21:13:28.855 GMT [59147] ERROR:  syntax error at or near "INTO" at character 136
2023-01-14 21:13:28.855 GMT [59147] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-14 21:13:28.856 GMT [59147] ERROR:  syntax error at or near "GET" at character 1
2023-01-14 21:13:28.856 GMT [59147] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-14 21:13:28.856 GMT [59147] ERROR:  syntax error at or near "passed" at character 1
2023-01-14 21:13:28.856 GMT [59147] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-14 21:13:28.856 GMT [59147] ERROR:  syntax error at or near "IF" at character 5
2023-01-14 21:13:28.856 GMT [59147] STATEMENT:  END IF;
2023-01-14 21:13:28.856 GMT [59147] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-14 21:13:28.856 GMT [59147] STATEMENT:  RETURN passed;
2023-01-14 21:13:28.856 GMT [59147] WARNING:  there is no transaction in progress
2023-01-14 21:13:28.857 GMT [59147] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-14 21:13:28.857 GMT [59147] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-14 21:13:28.857 GMT [59147] ERROR:  syntax error at or near "IF" at character 11
2023-01-14 21:13:28.857 GMT [59147] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-14 21:13:28.858 GMT [59147] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-14 21:13:28.858 GMT [59147] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-14 21:13:28.859 GMT [59147] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-14 21:13:28.859 GMT [59147] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-14 21:13:28.859 GMT [59147] ERROR:  syntax error at or near "IF" at character 5
2023-01-14 21:13:28.859 GMT [59147] STATEMENT:  END IF;
2023-01-14 21:13:28.859 GMT [59147] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-14 21:13:28.859 GMT [59147] STATEMENT:  RETURN customer_id;
2023-01-14 21:13:28.859 GMT [59147] WARNING:  there is no transaction in progress
2023-01-14 21:13:28.859 GMT [59147] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-14 21:13:28.859 GMT [59147] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-14 21:13:28.859 GMT [59147] ERROR:  syntax error at or near "INT" at character 27
2023-01-14 21:13:28.859 GMT [59147] STATEMENT:  DECLARE online_account_id INT;
2023-01-14 21:13:28.860 GMT [59147] ERROR:  syntax error at or near "INT" at character 28
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  DECLARE question_choice_id INT;
2023-01-14 21:13:28.860 GMT [59147] ERROR:  syntax error at or near "IF" at character 11
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-14 21:13:28.860 GMT [59147] ERROR:  syntax error at or near "INTO" at character 131
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-14 21:13:28.860 GMT [59147] ERROR:  syntax error at or near "FOR" at character 1
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-14 21:13:28.860 GMT [59147] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-14 21:13:28.860 GMT [59147] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-14 21:13:28.860 GMT [59147] STATEMENT:  END LOOP;
2023-01-14 21:13:28.861 GMT [59147] ERROR:  column "account_id" does not exist at character 117
2023-01-14 21:13:28.861 GMT [59147] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-14 21:13:28.861 GMT [59147] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-14 21:13:28.861 GMT [59147] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-14 21:13:28.861 GMT [59147] STATEMENT:  RETURN account_id;
2023-01-14 21:13:28.861 GMT [59147] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-14 21:13:28.861 GMT [59147] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-14 21:13:28.861 GMT [59147] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-14 21:13:28.861 GMT [59147] STATEMENT:  RETURN NULL;
2023-01-14 21:13:28.861 GMT [59147] ERROR:  syntax error at or near "IF" at character 5
2023-01-14 21:13:28.861 GMT [59147] STATEMENT:  END IF;
2023-01-14 21:13:28.862 GMT [59147] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-14 21:13:28.862 GMT [59147] STATEMENT:  RETURN success;
2023-01-14 21:13:28.862 GMT [59147] WARNING:  there is no transaction in progress
2023-01-14 21:13:28.862 GMT [59147] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-14 21:13:28.862 GMT [59147] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-14 21:14:00.648 GMT [59113] LOG:  received fast shutdown request
2023-01-14 21:14:00.650 GMT [59113] LOG:  aborting any active transactions
2023-01-14 21:14:00.653 GMT [59113] LOG:  background worker "logical replication launcher" (PID 59120) exited with exit code 1
2023-01-14 21:14:00.656 GMT [59115] LOG:  shutting down
2023-01-14 21:14:00.702 GMT [59113] LOG:  database system is shut down
2023-01-14 21:14:01.987 GMT [59342] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:14:01.989 GMT [59342] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:14:01.991 GMT [59342] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:14:01.995 GMT [59343] LOG:  database system was shut down at 2023-01-14 21:14:01 GMT
2023-01-14 21:14:02.001 GMT [59342] LOG:  database system is ready to accept connections
2023-01-14 21:14:02.905 GMT [59368] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:02.905 GMT [59368] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:02.905 GMT [59368] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:02.905 GMT [59368] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:02.905 GMT [59368] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:14:02.906 GMT [59368] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:02.906 GMT [59368] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:02.906 GMT [59368] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:02.906 GMT [59368] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:02.906 GMT [59368] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:14:02.908 GMT [59368] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:02.908 GMT [59368] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:02.908 GMT [59368] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:02.908 GMT [59368] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:02.908 GMT [59368] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:14:02.910 GMT [59368] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:02.910 GMT [59368] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:02.910 GMT [59368] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:02.910 GMT [59368] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:02.910 GMT [59368] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:14:31.001 GMT [59342] LOG:  received fast shutdown request
2023-01-14 21:14:31.003 GMT [59342] LOG:  aborting any active transactions
2023-01-14 21:14:31.007 GMT [59342] LOG:  background worker "logical replication launcher" (PID 59349) exited with exit code 1
2023-01-14 21:14:31.007 GMT [59344] LOG:  shutting down
2023-01-14 21:14:31.060 GMT [59342] LOG:  database system is shut down
2023-01-14 21:14:32.170 GMT [59553] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:14:32.170 GMT [59553] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:14:32.172 GMT [59553] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:14:32.176 GMT [59554] LOG:  database system was shut down at 2023-01-14 21:14:31 GMT
2023-01-14 21:14:32.183 GMT [59553] LOG:  database system is ready to accept connections
2023-01-14 21:14:33.076 GMT [59582] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:33.076 GMT [59582] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:33.076 GMT [59582] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:33.076 GMT [59582] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:33.076 GMT [59582] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:14:33.077 GMT [59582] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:33.077 GMT [59582] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:33.077 GMT [59582] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:33.077 GMT [59582] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:33.077 GMT [59582] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:14:33.077 GMT [59582] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:33.077 GMT [59582] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:33.077 GMT [59582] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:33.077 GMT [59582] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:33.077 GMT [59582] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:14:33.078 GMT [59582] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:14:33.078 GMT [59582] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:14:33.078 GMT [59582] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:14:33.078 GMT [59582] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:14:33.078 GMT [59582] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:16:49.574 GMT [59553] LOG:  received fast shutdown request
2023-01-14 21:16:49.576 GMT [59553] LOG:  aborting any active transactions
2023-01-14 21:16:49.578 GMT [59553] LOG:  background worker "logical replication launcher" (PID 59560) exited with exit code 1
2023-01-14 21:16:49.580 GMT [59555] LOG:  shutting down
2023-01-14 21:16:49.626 GMT [59553] LOG:  database system is shut down
2023-01-14 21:16:50.680 GMT [60102] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:16:50.681 GMT [60102] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:16:50.682 GMT [60102] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:16:50.687 GMT [60103] LOG:  database system was shut down at 2023-01-14 21:16:50 GMT
2023-01-14 21:16:50.693 GMT [60102] LOG:  database system is ready to accept connections
2023-01-14 21:16:51.456 GMT [60131] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:16:51.456 GMT [60131] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:16:51.456 GMT [60131] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:16:51.456 GMT [60131] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:16:51.456 GMT [60131] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:16:51.457 GMT [60131] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:16:51.457 GMT [60131] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:16:51.457 GMT [60131] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:16:51.457 GMT [60131] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:16:51.457 GMT [60131] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:16:51.457 GMT [60131] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:16:51.457 GMT [60131] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:16:51.457 GMT [60131] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:16:51.457 GMT [60131] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:16:51.457 GMT [60131] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:16:51.458 GMT [60131] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:16:51.458 GMT [60131] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:16:51.458 GMT [60131] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:16:51.458 GMT [60131] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:16:51.458 GMT [60131] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:16:51.465 GMT [60131] ERROR:  column "account_identifier" does not exist at character 76
2023-01-14 21:16:51.465 GMT [60131] QUERY:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction out of account', CURRENT_DATE)
2023-01-14 21:16:51.465 GMT [60131] CONTEXT:  PL/pgSQL function place_transaction_out_of_account(integer,integer,numeric) line 5 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_out_of_account(transfer_account_number, orig_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 17 at SQL statement
2023-01-14 21:16:51.465 GMT [60131] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 21:17:36.247 GMT [60102] LOG:  received fast shutdown request
2023-01-14 21:17:36.249 GMT [60102] LOG:  aborting any active transactions
2023-01-14 21:17:36.254 GMT [60102] LOG:  background worker "logical replication launcher" (PID 60109) exited with exit code 1
2023-01-14 21:17:36.254 GMT [60104] LOG:  shutting down
2023-01-14 21:17:36.299 GMT [60102] LOG:  database system is shut down
2023-01-14 21:17:37.523 GMT [60381] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:17:37.527 GMT [60381] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:17:37.529 GMT [60381] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:17:37.532 GMT [60383] LOG:  database system was shut down at 2023-01-14 21:17:37 GMT
2023-01-14 21:17:37.538 GMT [60381] LOG:  database system is ready to accept connections
2023-01-14 21:17:38.472 GMT [60413] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:17:38.472 GMT [60413] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:17:38.472 GMT [60413] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:17:38.472 GMT [60413] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:17:38.472 GMT [60413] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:17:38.473 GMT [60413] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:17:38.473 GMT [60413] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:17:38.473 GMT [60413] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:17:38.473 GMT [60413] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:17:38.473 GMT [60413] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:17:38.474 GMT [60413] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:17:38.474 GMT [60413] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:17:38.474 GMT [60413] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:17:38.474 GMT [60413] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:17:38.474 GMT [60413] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:17:38.475 GMT [60413] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:17:38.475 GMT [60413] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:17:38.475 GMT [60413] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:17:38.475 GMT [60413] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:17:38.475 GMT [60413] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:17:38.491 GMT [60413] ERROR:  column "account_identifier" does not exist at character 46
2023-01-14 21:17:38.491 GMT [60413] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)
2023-01-14 21:17:38.491 GMT [60413] CONTEXT:  PL/pgSQL function place_transaction_out_of_account(integer,integer,numeric) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_out_of_account(transfer_account_number, orig_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 17 at SQL statement
2023-01-14 21:17:38.491 GMT [60413] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 21:21:12.009 GMT [60381] LOG:  received fast shutdown request
2023-01-14 21:21:12.010 GMT [60381] LOG:  aborting any active transactions
2023-01-14 21:21:12.016 GMT [60381] LOG:  background worker "logical replication launcher" (PID 60389) exited with exit code 1
2023-01-14 21:21:12.017 GMT [60384] LOG:  shutting down
2023-01-14 21:21:12.060 GMT [60381] LOG:  database system is shut down
2023-01-14 21:21:13.252 GMT [61171] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:21:13.253 GMT [61171] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:21:13.254 GMT [61171] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:21:13.259 GMT [61172] LOG:  database system was shut down at 2023-01-14 21:21:12 GMT
2023-01-14 21:21:13.265 GMT [61171] LOG:  database system is ready to accept connections
2023-01-14 21:21:14.088 GMT [61200] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:21:14.088 GMT [61200] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:21:14.088 GMT [61200] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:21:14.088 GMT [61200] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:21:14.088 GMT [61200] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:21:14.089 GMT [61200] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:21:14.089 GMT [61200] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:21:14.089 GMT [61200] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:21:14.089 GMT [61200] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:21:14.089 GMT [61200] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:21:14.090 GMT [61200] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:21:14.090 GMT [61200] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:21:14.090 GMT [61200] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:21:14.090 GMT [61200] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:21:14.090 GMT [61200] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:21:14.091 GMT [61200] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:21:14.091 GMT [61200] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:21:14.091 GMT [61200] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:21:14.091 GMT [61200] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:21:14.091 GMT [61200] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:21:14.103 GMT [61200] ERROR:  column "account_identifier" does not exist at character 46
2023-01-14 21:21:14.103 GMT [61200] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)
2023-01-14 21:21:14.103 GMT [61200] CONTEXT:  PL/pgSQL function place_transaction_out_of_account(integer,integer,integer,numeric) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_out_of_account(account_identifier, transfer_account_number, orig_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 17 at SQL statement
2023-01-14 21:21:14.103 GMT [61200] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 21:23:19.933 GMT [61171] LOG:  received fast shutdown request
2023-01-14 21:23:19.935 GMT [61171] LOG:  aborting any active transactions
2023-01-14 21:23:19.940 GMT [61171] LOG:  background worker "logical replication launcher" (PID 61178) exited with exit code 1
2023-01-14 21:23:19.941 GMT [61173] LOG:  shutting down
2023-01-14 21:23:19.991 GMT [61171] LOG:  database system is shut down
2023-01-14 21:23:21.135 GMT [61690] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:23:21.135 GMT [61690] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:23:21.137 GMT [61690] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:23:21.142 GMT [61691] LOG:  database system was shut down at 2023-01-14 21:23:20 GMT
2023-01-14 21:23:21.147 GMT [61690] LOG:  database system is ready to accept connections
2023-01-14 21:23:21.989 GMT [61716] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:21.989 GMT [61716] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:21.989 GMT [61716] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:21.989 GMT [61716] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:21.989 GMT [61716] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:23:21.990 GMT [61716] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:21.990 GMT [61716] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:21.990 GMT [61716] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:21.990 GMT [61716] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:21.990 GMT [61716] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:23:21.990 GMT [61716] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:21.990 GMT [61716] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:21.990 GMT [61716] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:21.990 GMT [61716] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:21.990 GMT [61716] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:23:21.990 GMT [61716] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:21.990 GMT [61716] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:21.990 GMT [61716] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:21.990 GMT [61716] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:21.990 GMT [61716] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-14 21:23:21.997 GMT [61716] ERROR:  column "account_identifier" does not exist at character 76
2023-01-14 21:23:21.997 GMT [61716] QUERY:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction out of account', CURRENT_DATE)
2023-01-14 21:23:21.997 GMT [61716] CONTEXT:  PL/pgSQL function place_transaction_out_of_account(integer,integer,integer,numeric) line 5 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_out_of_account(account_identifier, transfer_account_number, orig_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 17 at SQL statement
2023-01-14 21:23:21.997 GMT [61716] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-14 21:23:46.681 GMT [61690] LOG:  received fast shutdown request
2023-01-14 21:23:46.683 GMT [61690] LOG:  aborting any active transactions
2023-01-14 21:23:46.687 GMT [61690] LOG:  background worker "logical replication launcher" (PID 61697) exited with exit code 1
2023-01-14 21:23:46.687 GMT [61692] LOG:  shutting down
2023-01-14 21:23:46.736 GMT [61690] LOG:  database system is shut down
2023-01-14 21:23:47.917 GMT [61878] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-14 21:23:47.917 GMT [61878] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-14 21:23:47.919 GMT [61878] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-14 21:23:47.925 GMT [61879] LOG:  database system was shut down at 2023-01-14 21:23:47 GMT
2023-01-14 21:23:47.931 GMT [61878] LOG:  database system is ready to accept connections
2023-01-14 21:23:48.768 GMT [61907] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:48.768 GMT [61907] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:48.768 GMT [61907] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:48.768 GMT [61907] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:48.768 GMT [61907] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-14 21:23:48.771 GMT [61907] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:48.771 GMT [61907] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:48.771 GMT [61907] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:48.771 GMT [61907] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:48.771 GMT [61907] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-14 21:23:48.772 GMT [61907] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:48.772 GMT [61907] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:48.772 GMT [61907] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:48.772 GMT [61907] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:48.772 GMT [61907] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-14 21:23:48.773 GMT [61907] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-14 21:23:48.773 GMT [61907] HINT:  You will need to rewrite or cast the expression.
2023-01-14 21:23:48.773 GMT [61907] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-14 21:23:48.773 GMT [61907] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-14 21:23:48.773 GMT [61907] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-15 21:44:14.031 GMT [61878] LOG:  received smart shutdown request
2023-01-15 21:44:14.050 GMT [61878] LOG:  background worker "logical replication launcher" (PID 61885) exited with exit code 1
2023-01-15 21:44:14.052 GMT [61878] LOG:  received SIGHUP, reloading configuration files
2023-01-15 21:44:14.061 GMT [61880] LOG:  shutting down
2023-01-15 21:44:14.164 GMT [61878] LOG:  database system is shut down
2023-01-16 16:17:17.518 GMT [33664] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:17:17.520 GMT [33664] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:17:17.521 GMT [33664] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:17:17.526 GMT [33665] LOG:  database system was shut down at 2023-01-16 16:17:17 GMT
2023-01-16 16:17:17.532 GMT [33664] LOG:  database system is ready to accept connections
2023-01-16 16:17:18.279 GMT [33690] ERROR:  column pending_transaction.origin_account_id does not exist at character 88
2023-01-16 16:17:18.279 GMT [33690] STATEMENT:  CREATE OR REPLACE VIEW bank.pending_transactions AS
	    SELECT pending_transaction.id, pending_transaction.origin_account_id, transaction.dest_account_id, transaction.sort_code, transaction.amount, transaction.date, get_account_type(transaction.origin_account_id) AS origin_account_type
	    FROM pending_transaction
	    INNER JOIN transaction ON pending_transaction.id = transaction.id;
2023-01-16 16:17:18.282 GMT [33690] ERROR:  syntax error at or near "ELIF" at character 577
2023-01-16 16:17:18.282 GMT [33690] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction_type(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	BEGIN
	    -- check pending transaction exists
	    IF EXISTS (SELECT * FROM bank.pending_transactions) THEN
	        --check is it is a transfer
	        IF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE) THEN
	            RAISE NOTICE 'Transfer transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, TRUE) INTO transaction_approved;
	        ELIF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = FALSE) THEN
	            RAISE NOTICE 'Payment transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, FALSE) INTO transaction_approved;
	        ELSE
	            RAISE NOTICE 'Unknown transaction type';
	            transaction_approved = FALSE;
	        END IF;
	    ELSE
	        RAISE NOTICE 'Transaction does not exist';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 16:17:18.282 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1898
2023-01-16 16:17:18.282 GMT [33690] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    -- check pending transaction exists
	    IF verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
	        transaction_approved = TRUE;
	    ELSE
	        RAISE NOTICE 'Transaction not approved';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	END;
2023-01-16 16:17:18.282 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 16:17:18.282 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 16:17:18.282 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.283 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.283 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.283 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.284 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 16:17:18.284 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.284 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.285 GMT [33690] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.285 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:17:18.285 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.285 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.286 GMT [33690] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:17:18.286 GMT [33690] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:17:18.286 GMT [33690] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 16:17:18.286 GMT [33690] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 16:17:18.286 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.286 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.288 GMT [33690] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 16:17:18.288 GMT [33690] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 16:17:18.289 GMT [33690] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 16:17:18.289 GMT [33690] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 16:17:18.289 GMT [33690] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:17:18.289 GMT [33690] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.289 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 16:17:18.290 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.290 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.290 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.290 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.290 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.290 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.290 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.290 GMT [33690] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 16:17:18.290 GMT [33690] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 16:17:18.290 GMT [33690] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:17:18.290 GMT [33690] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:17:18.291 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.291 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.291 GMT [33690] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:17:18.291 GMT [33690] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:17:18.291 GMT [33690] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 16:17:18.291 GMT [33690] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 16:17:18.291 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.291 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.292 GMT [33690] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 16:17:18.292 GMT [33690] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 16:17:18.292 GMT [33690] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 16:17:18.292 GMT [33690] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 16:17:18.292 GMT [33690] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:17:18.292 GMT [33690] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.292 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 16:17:18.292 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.292 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.295 GMT [33690] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:17:18.295 GMT [33690] STATEMENT:  return PASSED;
2023-01-16 16:17:18.295 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 16:17:18.295 GMT [33690] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.295 GMT [33690] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:17:18.295 GMT [33690] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 16:17:18.296 GMT [33690] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:17:18.296 GMT [33690] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:17:18.296 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.296 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.296 GMT [33690] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:17:18.296 GMT [33690] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:17:18.296 GMT [33690] ERROR:  syntax error at or near "INTO" at character 165
2023-01-16 16:17:18.296 GMT [33690] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 16:17:18.296 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.296 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.297 GMT [33690] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 16:17:18.297 GMT [33690] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 16:17:18.297 GMT [33690] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:17:18.297 GMT [33690] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.297 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 16:17:18.297 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.297 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.297 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.297 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.297 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.297 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.297 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.298 GMT [33690] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  DECLARE loan_id INT;
2023-01-16 16:17:18.298 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.298 GMT [33690] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 16:17:18.298 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.298 GMT [33690] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 16:17:18.298 GMT [33690] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 16:17:18.298 GMT [33690] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 16:17:18.298 GMT [33690] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:17:18.298 GMT [33690] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.298 GMT [33690] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.299 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 16:17:18.299 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 16:17:18.299 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 16:17:18.299 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.299 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 16:17:18.299 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 16:17:18.300 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 16:17:18.300 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 16:17:18.300 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.300 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.300 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 16:17:18.301 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  RETURN statement_id;
2023-01-16 16:17:18.301 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.301 GMT [33690] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:17:18.302 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  RETURN statement_id;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  return statement_id;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:17:18.302 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  return statement_id;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  return statement_id;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:17:18.302 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  return statement_id;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  END CASE;
2023-01-16 16:17:18.302 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  DECLARE statement_id INT;
2023-01-16 16:17:18.302 GMT [33690] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:17:18.302 GMT [33690] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 16:17:18.303 GMT [33690] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
2023-01-16 16:17:18.303 GMT [33690] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:17:18.303 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 112
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:17:18.303 GMT [33690] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
2023-01-16 16:17:18.303 GMT [33690] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:17:18.303 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 113
2023-01-16 16:17:18.303 GMT [33690] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:17:18.304 GMT [33690] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:17:18.304 GMT [33690] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
2023-01-16 16:17:18.304 GMT [33690] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:17:18.304 GMT [33690] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:17:18.304 GMT [33690] ERROR:  column "orig_account_number" does not exist at character 114
2023-01-16 16:17:18.304 GMT [33690] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:17:18.304 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.304 GMT [33690] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 16:17:18.309 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.309 GMT [33690] STATEMENT:  RETURN FALSE;
2023-01-16 16:17:18.309 GMT [33690] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:17:18.309 GMT [33690] STATEMENT:  END CASE;
2023-01-16 16:17:18.309 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.309 GMT [33690] STATEMENT:  RETURN TRUE;
2023-01-16 16:17:18.310 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 16:17:18.310 GMT [33690] ERROR:  relation "client.accounts" does not exist at character 49
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "INTO" at character 136
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:17:18.310 GMT [33690] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:17:18.310 GMT [33690] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:17:18.311 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.311 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.311 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.311 GMT [33690] STATEMENT:  RETURN passed;
2023-01-16 16:17:18.311 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.311 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:17:18.311 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 16:17:18.311 GMT [33690] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:17:18.311 GMT [33690] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 16:17:18.313 GMT [33690] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  RETURN customer_id;
2023-01-16 16:17:18.313 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 16:17:18.313 GMT [33690] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:17:18.313 GMT [33690] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  END LOOP;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  column "account_id" does not exist at character 117
2023-01-16 16:17:18.314 GMT [33690] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  RETURN account_id;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  RETURN NULL;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  END IF;
2023-01-16 16:17:18.314 GMT [33690] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:17:18.314 GMT [33690] STATEMENT:  RETURN success;
2023-01-16 16:17:18.314 GMT [33690] WARNING:  there is no transaction in progress
2023-01-16 16:17:18.315 GMT [33690] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 16:17:18.315 GMT [33690] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 16:18:11.950 GMT [33664] LOG:  received fast shutdown request
2023-01-16 16:18:11.952 GMT [33664] LOG:  aborting any active transactions
2023-01-16 16:18:11.956 GMT [33664] LOG:  background worker "logical replication launcher" (PID 33671) exited with exit code 1
2023-01-16 16:18:11.958 GMT [33666] LOG:  shutting down
2023-01-16 16:18:11.996 GMT [33664] LOG:  database system is shut down
2023-01-16 16:18:13.091 GMT [33923] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:18:13.091 GMT [33923] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:18:13.093 GMT [33923] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:18:13.097 GMT [33924] LOG:  database system was shut down at 2023-01-16 16:18:12 GMT
2023-01-16 16:18:13.104 GMT [33923] LOG:  database system is ready to accept connections
2023-01-16 16:18:13.782 GMT [33952] ERROR:  column transaction.sort_code does not exist at character 148
2023-01-16 16:18:13.782 GMT [33952] STATEMENT:  CREATE OR REPLACE VIEW bank.pending_transactions AS
	    SELECT pending_transaction.id, transaction.origin_account_id, transaction.dest_account_id, transaction.sort_code, transaction.amount, transaction.date, get_account_type(transaction.origin_account_id) AS origin_account_type
	    FROM pending_transaction
	    INNER JOIN transaction ON pending_transaction.id = transaction.id;
2023-01-16 16:18:13.784 GMT [33952] ERROR:  syntax error at or near "ELIF" at character 577
2023-01-16 16:18:13.784 GMT [33952] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction_type(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	BEGIN
	    -- check pending transaction exists
	    IF EXISTS (SELECT * FROM bank.pending_transactions) THEN
	        --check is it is a transfer
	        IF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE) THEN
	            RAISE NOTICE 'Transfer transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, TRUE) INTO transaction_approved;
	        ELIF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = FALSE) THEN
	            RAISE NOTICE 'Payment transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, FALSE) INTO transaction_approved;
	        ELSE
	            RAISE NOTICE 'Unknown transaction type';
	            transaction_approved = FALSE;
	        END IF;
	    ELSE
	        RAISE NOTICE 'Transaction does not exist';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 16:18:13.784 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1898
2023-01-16 16:18:13.784 GMT [33952] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    -- check pending transaction exists
	    IF verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
	        transaction_approved = TRUE;
	    ELSE
	        RAISE NOTICE 'Transaction not approved';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	END;
2023-01-16 16:18:13.785 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 16:18:13.785 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 16:18:13.786 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.788 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.788 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.790 GMT [33952] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:13.790 GMT [33952] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 16:18:13.790 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.790 GMT [33952] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.792 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.792 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.793 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.794 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.794 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.794 GMT [33952] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 16:18:13.794 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.794 GMT [33952] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 16:18:13.794 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.794 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.795 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.795 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.795 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.796 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 16:18:13.796 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.796 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.797 GMT [33952] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 16:18:13.797 GMT [33952] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 16:18:13.797 GMT [33952] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 16:18:13.797 GMT [33952] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 16:18:13.797 GMT [33952] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:13.797 GMT [33952] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.797 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 16:18:13.797 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.797 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.797 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.797 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.798 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.798 GMT [33952] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 16:18:13.798 GMT [33952] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 16:18:13.799 GMT [33952] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 16:18:13.799 GMT [33952] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:13.799 GMT [33952] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  return PASSED;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.799 GMT [33952] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:13.799 GMT [33952] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:13.800 GMT [33952] ERROR:  syntax error at or near "INTO" at character 165
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 16:18:13.800 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.800 GMT [33952] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 16:18:13.800 GMT [33952] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:13.800 GMT [33952] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 16:18:13.800 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.800 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.800 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.800 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.800 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.801 GMT [33952] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  DECLARE loan_id INT;
2023-01-16 16:18:13.801 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.801 GMT [33952] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 16:18:13.801 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.801 GMT [33952] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 16:18:13.801 GMT [33952] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 16:18:13.801 GMT [33952] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 16:18:13.801 GMT [33952] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:13.801 GMT [33952] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 16:18:13.801 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.801 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.802 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.802 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.802 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.802 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 16:18:13.802 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 16:18:13.802 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.802 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 16:18:13.802 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 16:18:13.803 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.803 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:18:13.803 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 16:18:13.804 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.804 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 16:18:13.804 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.804 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:18:13.804 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 16:18:13.805 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.805 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 16:18:13.805 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.805 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:18:13.805 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 16:18:13.805 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.805 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 16:18:13.805 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 16:18:13.806 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:13.806 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 16:18:13.806 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.806 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:13.807 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.807 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.807 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 16:18:13.807 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.807 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:13.807 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.807 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.807 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 16:18:13.807 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.807 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:13.807 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:13.808 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:13.808 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.808 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.808 GMT [33952] STATEMENT:  RETURN statement_id;
2023-01-16 16:18:13.809 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:13.809 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.809 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  RETURN statement_id;
2023-01-16 16:18:13.809 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.809 GMT [33952] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.809 GMT [33952] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:13.809 GMT [33952] STATEMENT:  return statement_id;
2023-01-16 16:18:13.810 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.810 GMT [33952] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:13.810 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 16:18:13.810 GMT [33952] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.810 GMT [33952] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:13.810 GMT [33952] STATEMENT:  return statement_id;
2023-01-16 16:18:13.810 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.810 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.810 GMT [33952] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:13.810 GMT [33952] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.811 GMT [33952] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:13.811 GMT [33952] STATEMENT:  return statement_id;
2023-01-16 16:18:13.811 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.811 GMT [33952] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:13.811 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 16:18:13.811 GMT [33952] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:13.811 GMT [33952] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:13.811 GMT [33952] STATEMENT:  return statement_id;
2023-01-16 16:18:13.812 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.812 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.812 GMT [33952] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:18:13.812 GMT [33952] STATEMENT:  END CASE;
2023-01-16 16:18:13.812 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.812 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.812 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.812 GMT [33952] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 16:18:13.812 GMT [33952] STATEMENT:  DECLARE statement_id INT;
2023-01-16 16:18:13.812 GMT [33952] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:13.812 GMT [33952] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 16:18:13.813 GMT [33952] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 16:18:13.813 GMT [33952] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
2023-01-16 16:18:13.813 GMT [33952] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:13.813 GMT [33952] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:13.813 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 112
2023-01-16 16:18:13.813 GMT [33952] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:13.813 GMT [33952] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:13.813 GMT [33952] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
2023-01-16 16:18:13.813 GMT [33952] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:13.813 GMT [33952] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:13.814 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 113
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:13.814 GMT [33952] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
2023-01-16 16:18:13.814 GMT [33952] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:13.814 GMT [33952] ERROR:  column "orig_account_number" does not exist at character 114
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:13.814 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 16:18:13.814 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  RETURN FALSE;
2023-01-16 16:18:13.814 GMT [33952] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:18:13.814 GMT [33952] STATEMENT:  END CASE;
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  RETURN TRUE;
2023-01-16 16:18:13.815 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 16:18:13.815 GMT [33952] ERROR:  relation "client.accounts" does not exist at character 49
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-16 16:18:13.815 GMT [33952] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 16:18:13.815 GMT [33952] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "INTO" at character 136
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.816 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.816 GMT [33952] STATEMENT:  RETURN passed;
2023-01-16 16:18:13.816 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.817 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:13.817 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 16:18:13.817 GMT [33952] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:18:13.817 GMT [33952] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 16:18:13.818 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.818 GMT [33952] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 16:18:13.819 GMT [33952] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 16:18:13.819 GMT [33952] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 16:18:13.819 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.819 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.820 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.820 GMT [33952] STATEMENT:  RETURN customer_id;
2023-01-16 16:18:13.820 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.820 GMT [33952] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:13.820 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 16:18:13.821 GMT [33952] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 16:18:13.821 GMT [33952] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 16:18:13.821 GMT [33952] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:18:13.821 GMT [33952] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 16:18:13.821 GMT [33952] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:18:13.821 GMT [33952] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 16:18:13.821 GMT [33952] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 16:18:13.821 GMT [33952] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 16:18:13.821 GMT [33952] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 16:18:13.821 GMT [33952] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 16:18:13.822 GMT [33952] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 16:18:13.822 GMT [33952] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 16:18:13.822 GMT [33952] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 16:18:13.822 GMT [33952] STATEMENT:  END LOOP;
2023-01-16 16:18:13.822 GMT [33952] ERROR:  column "account_id" does not exist at character 117
2023-01-16 16:18:13.822 GMT [33952] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:13.822 GMT [33952] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 16:18:13.822 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.822 GMT [33952] STATEMENT:  RETURN account_id;
2023-01-16 16:18:13.822 GMT [33952] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:13.822 GMT [33952] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 16:18:13.823 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.823 GMT [33952] STATEMENT:  RETURN NULL;
2023-01-16 16:18:13.823 GMT [33952] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:13.823 GMT [33952] STATEMENT:  END IF;
2023-01-16 16:18:13.823 GMT [33952] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:13.823 GMT [33952] STATEMENT:  RETURN success;
2023-01-16 16:18:13.823 GMT [33952] WARNING:  there is no transaction in progress
2023-01-16 16:18:13.824 GMT [33952] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 16:18:13.824 GMT [33952] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 16:18:56.701 GMT [33923] LOG:  received fast shutdown request
2023-01-16 16:18:56.702 GMT [33923] LOG:  aborting any active transactions
2023-01-16 16:18:56.707 GMT [33923] LOG:  background worker "logical replication launcher" (PID 33930) exited with exit code 1
2023-01-16 16:18:56.707 GMT [33925] LOG:  shutting down
2023-01-16 16:18:56.748 GMT [33923] LOG:  database system is shut down
2023-01-16 16:18:57.946 GMT [34153] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:18:57.946 GMT [34153] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:18:57.948 GMT [34153] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:18:57.953 GMT [34154] LOG:  database system was shut down at 2023-01-16 16:18:57 GMT
2023-01-16 16:18:57.958 GMT [34153] LOG:  database system is ready to accept connections
2023-01-16 16:18:58.675 GMT [34179] ERROR:  syntax error at or near "ELIF" at character 577
2023-01-16 16:18:58.675 GMT [34179] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction_type(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	BEGIN
	    -- check pending transaction exists
	    IF EXISTS (SELECT * FROM bank.pending_transactions) THEN
	        --check is it is a transfer
	        IF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE) THEN
	            RAISE NOTICE 'Transfer transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, TRUE) INTO transaction_approved;
	        ELIF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = FALSE) THEN
	            RAISE NOTICE 'Payment transaction';
	            SELECT * FROM verify_transaction_amounts(pending_transaction_id, FALSE) INTO transaction_approved;
	        ELSE
	            RAISE NOTICE 'Unknown transaction type';
	            transaction_approved = FALSE;
	        END IF;
	    ELSE
	        RAISE NOTICE 'Transaction does not exist';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 16:18:58.675 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1898
2023-01-16 16:18:58.675 GMT [34179] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    -- check pending transaction exists
	    IF verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
	        transaction_approved = TRUE;
	    ELSE
	        RAISE NOTICE 'Transaction not approved';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	END;
2023-01-16 16:18:58.676 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 16:18:58.676 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 16:18:58.677 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.678 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.678 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.679 GMT [34179] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:58.679 GMT [34179] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 16:18:58.680 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.680 GMT [34179] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.680 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.680 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.681 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.681 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.681 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.682 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.682 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.684 GMT [34179] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:58.684 GMT [34179] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 16:18:58.685 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.685 GMT [34179] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 16:18:58.685 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.685 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.685 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.685 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.685 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.685 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.686 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 16:18:58.686 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.686 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.687 GMT [34179] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 16:18:58.687 GMT [34179] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 16:18:58.688 GMT [34179] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 16:18:58.688 GMT [34179] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 16:18:58.689 GMT [34179] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:58.689 GMT [34179] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.689 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 16:18:58.689 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.689 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.689 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.689 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.689 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.689 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.689 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 16:18:58.690 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.690 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.691 GMT [34179] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 16:18:58.691 GMT [34179] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 16:18:58.691 GMT [34179] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 16:18:58.691 GMT [34179] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 16:18:58.693 GMT [34179] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:58.693 GMT [34179] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 16:18:58.693 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.693 GMT [34179] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  return PASSED;
2023-01-16 16:18:58.693 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.693 GMT [34179] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 16:18:58.693 GMT [34179] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:58.693 GMT [34179] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:18:58.694 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.694 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.694 GMT [34179] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:18:58.694 GMT [34179] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:18:58.694 GMT [34179] ERROR:  syntax error at or near "INTO" at character 165
2023-01-16 16:18:58.694 GMT [34179] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 16:18:58.695 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.695 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.695 GMT [34179] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 16:18:58.695 GMT [34179] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 16:18:58.695 GMT [34179] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:58.695 GMT [34179] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.695 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 16:18:58.695 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.695 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.695 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.695 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.695 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.696 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.696 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.696 GMT [34179] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 16:18:58.696 GMT [34179] STATEMENT:  DECLARE loan_id INT;
2023-01-16 16:18:58.696 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.696 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.696 GMT [34179] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:58.696 GMT [34179] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 16:18:58.696 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.696 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.697 GMT [34179] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 16:18:58.697 GMT [34179] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 16:18:58.697 GMT [34179] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 16:18:58.697 GMT [34179] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:18:58.697 GMT [34179] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 16:18:58.697 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.697 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.697 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.697 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 16:18:58.697 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.697 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 16:18:58.697 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.697 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:18:58.697 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 16:18:58.699 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 16:18:58.699 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 16:18:58.699 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 16:18:58.699 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.699 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 16:18:58.700 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.700 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.700 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 16:18:58.700 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.700 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:58.700 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.700 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.700 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 16:18:58.700 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.700 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:58.700 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.700 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.700 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 16:18:58.701 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:58.701 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:58.701 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 16:18:58.701 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.701 GMT [34179] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 16:18:58.701 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  RETURN statement_id;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:58.702 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  RETURN statement_id;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  return statement_id;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:58.702 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.702 GMT [34179] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:58.702 GMT [34179] STATEMENT:  return statement_id;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  return statement_id;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:18:58.703 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  return statement_id;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  END CASE;
2023-01-16 16:18:58.703 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.703 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.703 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  DECLARE statement_id INT;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 112
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:58.704 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 113
2023-01-16 16:18:58.704 GMT [34179] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:58.705 GMT [34179] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:18:58.705 GMT [34179] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
2023-01-16 16:18:58.705 GMT [34179] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:18:58.705 GMT [34179] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:18:58.705 GMT [34179] ERROR:  column "orig_account_number" does not exist at character 114
2023-01-16 16:18:58.705 GMT [34179] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  RETURN FALSE;
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  END CASE;
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  RETURN TRUE;
2023-01-16 16:18:58.706 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:18:58.706 GMT [34179] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 16:18:58.706 GMT [34179] ERROR:  relation "client.accounts" does not exist at character 49
2023-01-16 16:18:58.706 GMT [34179] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "INTO" at character 136
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  RETURN passed;
2023-01-16 16:18:58.707 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.707 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:58.707 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 16:18:58.708 GMT [34179] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:18:58.708 GMT [34179] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 16:18:58.710 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.710 GMT [34179] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 16:18:58.710 GMT [34179] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 16:18:58.710 GMT [34179] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 16:18:58.711 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.711 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.711 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.711 GMT [34179] STATEMENT:  RETURN customer_id;
2023-01-16 16:18:58.711 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.711 GMT [34179] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 16:18:58.711 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 16:18:58.711 GMT [34179] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 16:18:58.711 GMT [34179] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 16:18:58.712 GMT [34179] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:18:58.712 GMT [34179] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 16:18:58.712 GMT [34179] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:18:58.712 GMT [34179] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 16:18:58.712 GMT [34179] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 16:18:58.712 GMT [34179] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 16:18:58.712 GMT [34179] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 16:18:58.712 GMT [34179] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 16:18:58.713 GMT [34179] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 16:18:58.713 GMT [34179] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 16:18:58.713 GMT [34179] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 16:18:58.713 GMT [34179] STATEMENT:  END LOOP;
2023-01-16 16:18:58.713 GMT [34179] ERROR:  column "account_id" does not exist at character 117
2023-01-16 16:18:58.713 GMT [34179] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 16:18:58.713 GMT [34179] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 16:18:58.713 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.713 GMT [34179] STATEMENT:  RETURN account_id;
2023-01-16 16:18:58.714 GMT [34179] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:18:58.714 GMT [34179] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 16:18:58.714 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.714 GMT [34179] STATEMENT:  RETURN NULL;
2023-01-16 16:18:58.714 GMT [34179] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:18:58.714 GMT [34179] STATEMENT:  END IF;
2023-01-16 16:18:58.714 GMT [34179] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:18:58.714 GMT [34179] STATEMENT:  RETURN success;
2023-01-16 16:18:58.714 GMT [34179] WARNING:  there is no transaction in progress
2023-01-16 16:18:58.715 GMT [34179] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 16:18:58.715 GMT [34179] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 16:23:38.922 GMT [34153] LOG:  received fast shutdown request
2023-01-16 16:23:38.925 GMT [34153] LOG:  aborting any active transactions
2023-01-16 16:23:38.930 GMT [34153] LOG:  background worker "logical replication launcher" (PID 34160) exited with exit code 1
2023-01-16 16:23:38.931 GMT [34155] LOG:  shutting down
2023-01-16 16:23:38.970 GMT [34153] LOG:  database system is shut down
2023-01-16 16:23:40.104 GMT [35050] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:23:40.104 GMT [35050] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:23:40.106 GMT [35050] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:23:40.110 GMT [35051] LOG:  database system was shut down at 2023-01-16 16:23:39 GMT
2023-01-16 16:23:40.115 GMT [35050] LOG:  database system is ready to accept connections
2023-01-16 16:23:40.834 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1898
2023-01-16 16:23:40.834 GMT [35079] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    -- check pending transaction exists
	    IF verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
	        transaction_approved = TRUE;
	    ELSE
	        RAISE NOTICE 'Transaction not approved';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	END;
2023-01-16 16:23:40.834 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 16:23:40.834 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 16:23:40.835 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.836 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.836 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.837 GMT [35079] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:23:40.837 GMT [35079] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 16:23:40.838 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.838 GMT [35079] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.839 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.839 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.840 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.841 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.841 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.842 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.842 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.842 GMT [35079] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:23:40.842 GMT [35079] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 16:23:40.843 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.843 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.844 GMT [35079] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:23:40.844 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 16:23:40.844 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.844 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.844 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.844 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.845 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.845 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.845 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.845 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.845 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.846 GMT [35079] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:23:40.846 GMT [35079] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 16:23:40.846 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.846 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.847 GMT [35079] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:23:40.847 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 16:23:40.847 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.847 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.847 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.847 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.847 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.847 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.847 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.848 GMT [35079] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 16:23:40.848 GMT [35079] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 16:23:40.849 GMT [35079] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 16:23:40.849 GMT [35079] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:23:40.849 GMT [35079] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 16:23:40.849 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.849 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.849 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.849 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.849 GMT [35079] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 16:23:40.849 GMT [35079] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.850 GMT [35079] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 16:23:40.850 GMT [35079] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 16:23:40.851 GMT [35079] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 16:23:40.851 GMT [35079] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 16:23:40.851 GMT [35079] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:23:40.851 GMT [35079] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.851 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 16:23:40.851 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.851 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  return PASSED;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.852 GMT [35079] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:23:40.852 GMT [35079] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:23:40.853 GMT [35079] ERROR:  syntax error at or near "INTO" at character 165
2023-01-16 16:23:40.853 GMT [35079] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 16:23:40.853 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.853 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.853 GMT [35079] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 16:23:40.853 GMT [35079] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 16:23:40.854 GMT [35079] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:23:40.854 GMT [35079] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.854 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 16:23:40.854 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.854 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.854 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.854 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.854 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.854 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.854 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.855 GMT [35079] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 16:23:40.855 GMT [35079] STATEMENT:  DECLARE loan_id INT;
2023-01-16 16:23:40.855 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.855 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.855 GMT [35079] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:23:40.855 GMT [35079] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 16:23:40.855 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.855 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.855 GMT [35079] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 16:23:40.855 GMT [35079] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 16:23:40.856 GMT [35079] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 16:23:40.856 GMT [35079] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.856 GMT [35079] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 16:23:40.856 GMT [35079] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:23:40.856 GMT [35079] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.856 GMT [35079] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 16:23:40.857 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.857 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.857 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.857 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.857 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.858 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 16:23:40.858 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 16:23:40.858 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.858 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 16:23:40.858 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 16:23:40.858 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.858 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:23:40.858 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 16:23:40.859 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 16:23:40.859 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 16:23:40.859 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.859 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:23:40.859 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 16:23:40.860 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.860 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 16:23:40.860 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.860 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.860 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 16:23:40.860 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.860 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 16:23:40.860 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.860 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.860 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 16:23:40.860 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.860 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 16:23:40.860 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.861 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.861 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 16:23:40.861 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.861 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 16:23:40.861 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.861 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.861 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 16:23:40.861 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.861 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 16:23:40.862 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 16:23:40.862 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 16:23:40.862 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.862 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.862 GMT [35079] STATEMENT:  RETURN statement_id;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:23:40.863 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  RETURN statement_id;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  return statement_id;
2023-01-16 16:23:40.863 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.863 GMT [35079] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:23:40.864 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 16:23:40.864 GMT [35079] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.864 GMT [35079] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:23:40.864 GMT [35079] STATEMENT:  return statement_id;
2023-01-16 16:23:40.864 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.864 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.864 GMT [35079] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:23:40.864 GMT [35079] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.864 GMT [35079] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:23:40.864 GMT [35079] STATEMENT:  return statement_id;
2023-01-16 16:23:40.865 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:23:40.865 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:23:40.865 GMT [35079] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  return statement_id;
2023-01-16 16:23:40.865 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.865 GMT [35079] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  END CASE;
2023-01-16 16:23:40.865 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.865 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.865 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.866 GMT [35079] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 16:23:40.866 GMT [35079] STATEMENT:  DECLARE statement_id INT;
2023-01-16 16:23:40.866 GMT [35079] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:23:40.866 GMT [35079] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 16:23:40.866 GMT [35079] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 16:23:40.866 GMT [35079] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
2023-01-16 16:23:40.866 GMT [35079] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:23:40.866 GMT [35079] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:23:40.866 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 112
2023-01-16 16:23:40.866 GMT [35079] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:23:40.867 GMT [35079] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:23:40.867 GMT [35079] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
2023-01-16 16:23:40.867 GMT [35079] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:23:40.867 GMT [35079] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:23:40.867 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 113
2023-01-16 16:23:40.867 GMT [35079] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:23:40.867 GMT [35079] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:23:40.867 GMT [35079] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
2023-01-16 16:23:40.868 GMT [35079] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:23:40.868 GMT [35079] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:23:40.868 GMT [35079] ERROR:  column "orig_account_number" does not exist at character 114
2023-01-16 16:23:40.868 GMT [35079] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:23:40.868 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.868 GMT [35079] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  RETURN FALSE;
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  END CASE;
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  RETURN TRUE;
2023-01-16 16:23:40.869 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:23:40.869 GMT [35079] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:23:40.869 GMT [35079] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 16:23:40.870 GMT [35079] ERROR:  relation "client.accounts" does not exist at character 49
2023-01-16 16:23:40.870 GMT [35079] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-16 16:23:40.870 GMT [35079] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 16:23:40.870 GMT [35079] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
2023-01-16 16:23:40.870 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.870 GMT [35079] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-16 16:23:40.870 GMT [35079] ERROR:  syntax error at or near "INTO" at character 136
2023-01-16 16:23:40.870 GMT [35079] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-16 16:23:40.870 GMT [35079] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:23:40.870 GMT [35079] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:23:40.871 GMT [35079] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:23:40.871 GMT [35079] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:23:40.871 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.871 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.871 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.871 GMT [35079] STATEMENT:  RETURN passed;
2023-01-16 16:23:40.871 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.871 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:23:40.871 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 16:23:40.871 GMT [35079] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:23:40.871 GMT [35079] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 16:23:40.875 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.875 GMT [35079] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 16:23:40.876 GMT [35079] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 16:23:40.876 GMT [35079] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 16:23:40.877 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.877 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.879 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.879 GMT [35079] STATEMENT:  RETURN customer_id;
2023-01-16 16:23:40.879 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.880 GMT [35079] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 16:23:40.880 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 16:23:40.880 GMT [35079] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 16:23:40.880 GMT [35079] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 16:23:40.881 GMT [35079] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 16:23:40.881 GMT [35079] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 16:23:40.881 GMT [35079] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 16:23:40.881 GMT [35079] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 16:23:40.881 GMT [35079] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 16:23:40.881 GMT [35079] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 16:23:40.881 GMT [35079] STATEMENT:  END LOOP;
2023-01-16 16:23:40.882 GMT [35079] ERROR:  column "account_id" does not exist at character 117
2023-01-16 16:23:40.882 GMT [35079] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 16:23:40.882 GMT [35079] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 16:23:40.882 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.882 GMT [35079] STATEMENT:  RETURN account_id;
2023-01-16 16:23:40.882 GMT [35079] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:23:40.882 GMT [35079] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 16:23:40.882 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.882 GMT [35079] STATEMENT:  RETURN NULL;
2023-01-16 16:23:40.883 GMT [35079] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:23:40.883 GMT [35079] STATEMENT:  END IF;
2023-01-16 16:23:40.883 GMT [35079] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:23:40.883 GMT [35079] STATEMENT:  RETURN success;
2023-01-16 16:23:40.884 GMT [35079] WARNING:  there is no transaction in progress
2023-01-16 16:23:40.885 GMT [35079] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 16:23:40.885 GMT [35079] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 16:52:30.806 GMT [35050] LOG:  received fast shutdown request
2023-01-16 16:52:30.808 GMT [35050] LOG:  aborting any active transactions
2023-01-16 16:52:30.814 GMT [35050] LOG:  background worker "logical replication launcher" (PID 35057) exited with exit code 1
2023-01-16 16:52:30.814 GMT [35052] LOG:  shutting down
2023-01-16 16:52:30.833 GMT [35050] LOG:  database system is shut down
2023-01-16 16:52:34.771 GMT [39837] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:52:34.772 GMT [39837] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:52:34.773 GMT [39837] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:52:34.778 GMT [39838] LOG:  database system was shut down at 2023-01-16 16:52:34 GMT
2023-01-16 16:52:34.788 GMT [39837] LOG:  database system is ready to accept connections
2023-01-16 16:52:35.579 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1898
2023-01-16 16:52:35.579 GMT [39866] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    -- check pending transaction exists
	    IF verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
	        transaction_approved = TRUE;
	    ELSE
	        RAISE NOTICE 'Transaction not approved';
	        transaction_approved = FALSE;
	    END IF;
	    RETURN transaction_approved;
	END;
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
	END;
2023-01-16 16:52:35.579 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 16:52:35.579 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 16:52:35.579 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.580 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.580 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.581 GMT [39866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:52:35.581 GMT [39866] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 16:52:35.584 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.584 GMT [39866] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.584 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.584 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.585 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.585 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.585 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.585 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.585 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.585 GMT [39866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:52:35.585 GMT [39866] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 16:52:35.585 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.585 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.586 GMT [39866] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:52:35.586 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 16:52:35.586 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.586 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.586 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.586 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.587 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.587 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.587 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.587 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.587 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.587 GMT [39866] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 16:52:35.587 GMT [39866] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 16:52:35.587 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.587 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.587 GMT [39866] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 16:52:35.587 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 16:52:35.588 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.588 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.588 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.588 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.588 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.588 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.588 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.588 GMT [39866] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 16:52:35.588 GMT [39866] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 16:52:35.588 GMT [39866] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:52:35.588 GMT [39866] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:52:35.589 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.589 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.589 GMT [39866] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:52:35.589 GMT [39866] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:52:35.589 GMT [39866] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 16:52:35.589 GMT [39866] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 16:52:35.590 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.590 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.590 GMT [39866] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 16:52:35.590 GMT [39866] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 16:52:35.591 GMT [39866] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 16:52:35.591 GMT [39866] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:52:35.591 GMT [39866] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 16:52:35.591 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.591 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.591 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.591 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.591 GMT [39866] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 16:52:35.591 GMT [39866] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:52:35.591 GMT [39866] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:52:35.592 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.592 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.592 GMT [39866] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:52:35.592 GMT [39866] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:52:35.592 GMT [39866] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 16:52:35.592 GMT [39866] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 16:52:35.592 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.592 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.592 GMT [39866] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 16:52:35.592 GMT [39866] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 16:52:35.593 GMT [39866] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 16:52:35.593 GMT [39866] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 16:52:35.594 GMT [39866] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:52:35.594 GMT [39866] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 16:52:35.594 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.594 GMT [39866] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  return PASSED;
2023-01-16 16:52:35.594 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.594 GMT [39866] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 16:52:35.594 GMT [39866] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:52:35.594 GMT [39866] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 16:52:35.595 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.595 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.595 GMT [39866] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 16:52:35.595 GMT [39866] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 16:52:35.595 GMT [39866] ERROR:  syntax error at or near "INTO" at character 165
2023-01-16 16:52:35.595 GMT [39866] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 16:52:35.595 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.595 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.596 GMT [39866] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 16:52:35.596 GMT [39866] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 16:52:35.596 GMT [39866] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:52:35.596 GMT [39866] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.596 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 16:52:35.596 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.596 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.598 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.598 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.598 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.598 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.598 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.599 GMT [39866] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 16:52:35.599 GMT [39866] STATEMENT:  DECLARE loan_id INT;
2023-01-16 16:52:35.599 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.599 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.600 GMT [39866] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:52:35.600 GMT [39866] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 16:52:35.600 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.600 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.601 GMT [39866] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 16:52:35.601 GMT [39866] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 16:52:35.601 GMT [39866] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 16:52:35.601 GMT [39866] ERROR:  column "account_id" does not exist at character 76
2023-01-16 16:52:35.601 GMT [39866] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 16:52:35.601 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.601 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.601 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.601 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 16:52:35.601 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 16:52:35.602 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.602 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 16:52:35.602 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 16:52:35.602 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.603 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:52:35.603 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 16:52:35.603 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.603 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 16:52:35.603 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.603 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:52:35.603 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 16:52:35.603 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.603 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 16:52:35.603 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.604 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 16:52:35.604 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 16:52:35.604 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.604 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 16:52:35.604 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.604 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 16:52:35.604 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 16:52:35.604 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.604 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 16:52:35.604 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.604 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.604 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 16:52:35.605 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 16:52:35.605 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 16:52:35.605 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 16:52:35.605 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.605 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 16:52:35.606 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 16:52:35.606 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 16:52:35.606 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  RETURN statement_id;
2023-01-16 16:52:35.606 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.606 GMT [39866] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:52:35.607 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  RETURN statement_id;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  return statement_id;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:52:35.607 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  return statement_id;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.607 GMT [39866] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:52:35.607 GMT [39866] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.608 GMT [39866] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:52:35.608 GMT [39866] STATEMENT:  return statement_id;
2023-01-16 16:52:35.608 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.608 GMT [39866] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 16:52:35.608 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 16:52:35.608 GMT [39866] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 16:52:35.608 GMT [39866] ERROR:  syntax error at or near "return" at character 1
2023-01-16 16:52:35.608 GMT [39866] STATEMENT:  return statement_id;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  END CASE;
2023-01-16 16:52:35.609 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  DECLARE statement_id INT;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE debit_account SET current_balance = current_balance + transaction_amount WHERE debit_account.account_number = orig_account_number;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:52:35.609 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 112
2023-01-16 16:52:35.609 GMT [39866] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:52:35.610 GMT [39866] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:52:35.610 GMT [39866] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE credit_account SET outstanding_balance = outstanding_balance + transaction_amount WHERE credit_account.account_number = orig_account_number;
2023-01-16 16:52:35.610 GMT [39866] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:52:35.610 GMT [39866] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:52:35.610 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 113
2023-01-16 16:52:35.610 GMT [39866] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:52:35.610 GMT [39866] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 16:52:35.610 GMT [39866] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        UPDATE savings_account SET current_balance = current_balance + transaction_amount WHERE savings_account.account_number = orig_account_number;
2023-01-16 16:52:35.614 GMT [39866] ERROR:  syntax error at or near "INTO" at character 87
2023-01-16 16:52:35.614 GMT [39866] STATEMENT:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 16:52:35.614 GMT [39866] ERROR:  column "orig_account_number" does not exist at character 114
2023-01-16 16:52:35.614 GMT [39866] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id);
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  RETURN FALSE;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  END CASE;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  RETURN TRUE;
2023-01-16 16:52:35.615 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 16:52:35.615 GMT [39866] ERROR:  relation "client.accounts" does not exist at character 49
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  SELECT account_id INTO internal_account_id FROM client.accounts
	    WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  IF internal_account_id IS NULL THEN
	       RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
2023-01-16 16:52:35.615 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.615 GMT [39866] STATEMENT:  ELSE
	        RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
2023-01-16 16:52:35.616 GMT [39866] ERROR:  syntax error at or near "INTO" at character 136
2023-01-16 16:52:35.616 GMT [39866] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount) INTO passed;
2023-01-16 16:52:35.616 GMT [39866] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 16:52:35.616 GMT [39866] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 16:52:35.616 GMT [39866] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 16:52:35.616 GMT [39866] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 16:52:35.617 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.617 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.617 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.617 GMT [39866] STATEMENT:  RETURN passed;
2023-01-16 16:52:35.617 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.617 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 16:52:35.617 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 16:52:35.618 GMT [39866] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:52:35.618 GMT [39866] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 16:52:35.621 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.621 GMT [39866] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 16:52:35.621 GMT [39866] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 16:52:35.621 GMT [39866] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 16:52:35.621 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.621 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.621 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.621 GMT [39866] STATEMENT:  RETURN customer_id;
2023-01-16 16:52:35.621 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 16:52:35.622 GMT [39866] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 16:52:35.622 GMT [39866] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 16:52:35.622 GMT [39866] STATEMENT:  END LOOP;
2023-01-16 16:52:35.623 GMT [39866] ERROR:  column "account_id" does not exist at character 117
2023-01-16 16:52:35.623 GMT [39866] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 16:52:35.623 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  RETURN account_id;
2023-01-16 16:52:35.623 GMT [39866] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 16:52:35.623 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  RETURN NULL;
2023-01-16 16:52:35.623 GMT [39866] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  END IF;
2023-01-16 16:52:35.623 GMT [39866] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 16:52:35.623 GMT [39866] STATEMENT:  RETURN success;
2023-01-16 16:52:35.623 GMT [39866] WARNING:  there is no transaction in progress
2023-01-16 16:52:35.624 GMT [39866] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 16:52:35.624 GMT [39866] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
	
	SELECT * FROM client.view_accounts(1);
	
	
	
	SELECT * FROM client.view_savings_statements(1, 10000000);
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 16:53:39.436 GMT [39837] LOG:  received fast shutdown request
2023-01-16 16:53:39.438 GMT [39837] LOG:  aborting any active transactions
2023-01-16 16:53:39.446 GMT [39837] LOG:  background worker "logical replication launcher" (PID 39844) exited with exit code 1
2023-01-16 16:53:39.448 GMT [39839] LOG:  shutting down
2023-01-16 16:53:39.510 GMT [39837] LOG:  database system is shut down
2023-01-16 16:53:41.203 GMT [40129] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:53:41.203 GMT [40129] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:53:41.205 GMT [40129] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:53:41.213 GMT [40130] LOG:  database system was shut down at 2023-01-16 16:53:40 GMT
2023-01-16 16:53:41.222 GMT [40129] LOG:  database system is ready to accept connections
2023-01-16 16:53:42.080 GMT [40168] ERROR:  missing FROM-clause entry for table "account" at character 344
2023-01-16 16:53:42.080 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
2023-01-16 16:53:42.080 GMT [40168] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-16 16:53:42.080 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-16 16:53:42.081 GMT [40168] ERROR:  relation "debit_accounts_statements" does not exist at character 413
2023-01-16 16:53:42.081 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-16 16:53:42.081 GMT [40168] ERROR:  missing FROM-clause entry for table "account" at character 304
2023-01-16 16:53:42.081 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
2023-01-16 16:53:42.081 GMT [40168] ERROR:  relation "credit_accounts" does not exist at character 322
2023-01-16 16:53:42.081 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
2023-01-16 16:53:42.081 GMT [40168] ERROR:  relation "credit_accounts_statements" does not exist at character 517
2023-01-16 16:53:42.081 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-16 16:53:42.082 GMT [40168] ERROR:  missing FROM-clause entry for table "account" at character 228
2023-01-16 16:53:42.082 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
2023-01-16 16:53:42.082 GMT [40168] ERROR:  relation "savings_accounts" does not exist at character 252
2023-01-16 16:53:42.082 GMT [40168] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
2023-01-16 16:53:42.162 GMT [40168] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-16 16:53:42.162 GMT [40168] HINT:  You will need to rewrite or cast the expression.
2023-01-16 16:53:42.162 GMT [40168] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-16 16:53:42.162 GMT [40168] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-16 16:53:42.162 GMT [40168] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-16 16:53:42.163 GMT [40168] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-16 16:53:42.163 GMT [40168] HINT:  You will need to rewrite or cast the expression.
2023-01-16 16:53:42.163 GMT [40168] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-16 16:53:42.163 GMT [40168] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-16 16:53:42.163 GMT [40168] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-16 16:53:42.164 GMT [40168] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-16 16:53:42.164 GMT [40168] HINT:  You will need to rewrite or cast the expression.
2023-01-16 16:53:42.164 GMT [40168] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-16 16:53:42.164 GMT [40168] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-16 16:53:42.164 GMT [40168] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-16 16:53:42.164 GMT [40168] ERROR:  column "minimum_payment_due_date" is of type numeric but expression is of type date at character 236
2023-01-16 16:53:42.164 GMT [40168] HINT:  You will need to rewrite or cast the expression.
2023-01-16 16:53:42.164 GMT [40168] QUERY:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)
2023-01-16 16:53:42.164 GMT [40168] CONTEXT:  PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-16 16:53:42.164 GMT [40168] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-16 16:53:42.165 GMT [40168] ERROR:  relation "client.credit_accounts" does not exist at character 391
2023-01-16 16:53:42.165 GMT [40168] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:53:42.165 GMT [40168] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:53:42.165 GMT [40168] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:53:42.167 GMT [40168] ERROR:  relation "client.debit_accounts" does not exist at character 23
2023-01-16 16:53:42.167 GMT [40168] QUERY:  EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)
2023-01-16 16:53:42.167 GMT [40168] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 7 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 16:53:42.167 GMT [40168] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 16:53:42.168 GMT [40168] ERROR:  relation "client.credit_accounts" does not exist at character 391
2023-01-16 16:53:42.168 GMT [40168] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:53:42.168 GMT [40168] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:53:42.168 GMT [40168] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:53:42.169 GMT [40168] ERROR:  relation "client.savings_accounts_statements" does not exist at character 177
2023-01-16 16:53:42.169 GMT [40168] QUERY:  SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier
2023-01-16 16:53:42.169 GMT [40168] CONTEXT:  PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-16 16:53:42.169 GMT [40168] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-16 16:55:12.744 GMT [40129] LOG:  received fast shutdown request
2023-01-16 16:55:12.746 GMT [40129] LOG:  aborting any active transactions
2023-01-16 16:55:12.749 GMT [40129] LOG:  background worker "logical replication launcher" (PID 40136) exited with exit code 1
2023-01-16 16:55:12.753 GMT [40131] LOG:  shutting down
2023-01-16 16:55:12.805 GMT [40129] LOG:  database system is shut down
2023-01-16 16:55:13.918 GMT [40496] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:55:13.918 GMT [40496] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:55:13.919 GMT [40496] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:55:13.924 GMT [40497] LOG:  database system was shut down at 2023-01-16 16:55:13 GMT
2023-01-16 16:55:13.931 GMT [40496] LOG:  database system is ready to accept connections
2023-01-16 16:55:14.694 GMT [40525] ERROR:  missing FROM-clause entry for table "account" at character 344
2023-01-16 16:55:14.694 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT account.account_id, account.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON account.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON account.account_number = debit_overdraft.account_number;
2023-01-16 16:55:14.694 GMT [40525] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-16 16:55:14.694 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-16 16:55:14.694 GMT [40525] ERROR:  relation "debit_accounts_statements" does not exist at character 413
2023-01-16 16:55:14.694 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-16 16:55:14.694 GMT [40525] ERROR:  missing FROM-clause entry for table "account" at character 304
2023-01-16 16:55:14.694 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT account.account_id, account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON account.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON account.account_number = credit_account_application.account_number;
2023-01-16 16:55:14.695 GMT [40525] ERROR:  relation "credit_accounts" does not exist at character 322
2023-01-16 16:55:14.695 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
2023-01-16 16:55:14.695 GMT [40525] ERROR:  relation "credit_accounts_statements" does not exist at character 517
2023-01-16 16:55:14.695 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-16 16:55:14.695 GMT [40525] ERROR:  missing FROM-clause entry for table "account" at character 228
2023-01-16 16:55:14.695 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
2023-01-16 16:55:14.695 GMT [40525] ERROR:  relation "savings_accounts" does not exist at character 252
2023-01-16 16:55:14.695 GMT [40525] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
2023-01-16 16:55:14.778 GMT [40525] ERROR:  relation "client.credit_accounts" does not exist at character 391
2023-01-16 16:55:14.778 GMT [40525] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:55:14.778 GMT [40525] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:55:14.778 GMT [40525] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:55:14.779 GMT [40525] ERROR:  relation "client.debit_accounts" does not exist at character 23
2023-01-16 16:55:14.779 GMT [40525] QUERY:  EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)
2023-01-16 16:55:14.779 GMT [40525] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 7 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 16:55:14.779 GMT [40525] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 16:55:14.780 GMT [40525] ERROR:  relation "client.credit_accounts" does not exist at character 391
2023-01-16 16:55:14.780 GMT [40525] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:55:14.780 GMT [40525] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:55:14.780 GMT [40525] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:55:14.780 GMT [40525] ERROR:  relation "client.savings_accounts_statements" does not exist at character 177
2023-01-16 16:55:14.780 GMT [40525] QUERY:  SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier
2023-01-16 16:55:14.780 GMT [40525] CONTEXT:  PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-16 16:55:14.780 GMT [40525] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-16 16:57:28.814 GMT [40496] LOG:  received fast shutdown request
2023-01-16 16:57:28.816 GMT [40496] LOG:  aborting any active transactions
2023-01-16 16:57:28.822 GMT [40496] LOG:  background worker "logical replication launcher" (PID 40503) exited with exit code 1
2023-01-16 16:57:28.824 GMT [40498] LOG:  shutting down
2023-01-16 16:57:28.872 GMT [40496] LOG:  database system is shut down
2023-01-16 16:57:30.051 GMT [41025] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:57:30.051 GMT [41025] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:57:30.053 GMT [41025] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:57:30.058 GMT [41026] LOG:  database system was shut down at 2023-01-16 16:57:29 GMT
2023-01-16 16:57:30.065 GMT [41025] LOG:  database system is ready to accept connections
2023-01-16 16:57:30.954 GMT [41054] ERROR:  missing FROM-clause entry for table "account" at character 228
2023-01-16 16:57:30.954 GMT [41054] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT account.account_id, account.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON account.account_number = savings_account.account_number;
2023-01-16 16:57:30.954 GMT [41054] ERROR:  relation "savings_accounts" does not exist at character 252
2023-01-16 16:57:30.954 GMT [41054] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
2023-01-16 16:57:31.060 GMT [41054] ERROR:  relation "client.savings_accounts" does not exist at character 597
2023-01-16 16:57:31.060 GMT [41054] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:57:31.060 GMT [41054] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:57:31.060 GMT [41054] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:57:31.063 GMT [41054] ERROR:  relation "client.savings_accounts" does not exist at character 23
2023-01-16 16:57:31.063 GMT [41054] QUERY:  EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)
2023-01-16 16:57:31.063 GMT [41054] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 7 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 16:57:31.063 GMT [41054] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 16:57:31.064 GMT [41054] ERROR:  relation "client.savings_accounts" does not exist at character 597
2023-01-16 16:57:31.064 GMT [41054] QUERY:  SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-16 16:57:31.064 GMT [41054] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-16 16:57:31.064 GMT [41054] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 16:57:31.064 GMT [41054] ERROR:  relation "client.savings_accounts_statements" does not exist at character 177
2023-01-16 16:57:31.064 GMT [41054] QUERY:  SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier
2023-01-16 16:57:31.064 GMT [41054] CONTEXT:  PL/pgSQL function view_savings_statements(integer,integer) line 6 at RETURN QUERY
2023-01-16 16:57:31.064 GMT [41054] STATEMENT:  SELECT * FROM client.view_savings_statements(1, 10000000);
2023-01-16 16:57:50.857 GMT [41025] LOG:  received fast shutdown request
2023-01-16 16:57:50.859 GMT [41025] LOG:  aborting any active transactions
2023-01-16 16:57:50.861 GMT [41025] LOG:  background worker "logical replication launcher" (PID 41032) exited with exit code 1
2023-01-16 16:57:50.864 GMT [41027] LOG:  shutting down
2023-01-16 16:57:50.910 GMT [41025] LOG:  database system is shut down
2023-01-16 16:57:52.056 GMT [41202] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 16:57:52.056 GMT [41202] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 16:57:52.062 GMT [41202] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 16:57:52.067 GMT [41203] LOG:  database system was shut down at 2023-01-16 16:57:51 GMT
2023-01-16 16:57:52.072 GMT [41202] LOG:  database system is ready to accept connections
2023-01-16 18:01:04.083 GMT [41202] LOG:  received fast shutdown request
2023-01-16 18:01:04.084 GMT [41202] LOG:  aborting any active transactions
2023-01-16 18:01:04.090 GMT [41202] LOG:  background worker "logical replication launcher" (PID 41209) exited with exit code 1
2023-01-16 18:01:04.093 GMT [41204] LOG:  shutting down
2023-01-16 18:01:04.112 GMT [41202] LOG:  database system is shut down
2023-01-16 18:01:16.865 GMT [51170] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:01:16.865 GMT [51170] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:01:16.867 GMT [51170] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:01:16.871 GMT [51171] LOG:  database system was shut down at 2023-01-16 18:01:16 GMT
2023-01-16 18:01:16.877 GMT [51170] LOG:  database system is ready to accept connections
2023-01-16 18:01:17.762 GMT [51209] ERROR:  column "transaction_id" of relation "pending_transaction" does not exist at character 34
2023-01-16 18:01:17.762 GMT [51209] QUERY:  INSERT INTO pending_transaction (transaction_id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)
2023-01-16 18:01:17.762 GMT [51209] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:01:17.762 GMT [51209] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 18:02:25.747 GMT [51170] LOG:  received fast shutdown request
2023-01-16 18:02:25.748 GMT [51170] LOG:  aborting any active transactions
2023-01-16 18:02:25.753 GMT [51170] LOG:  background worker "logical replication launcher" (PID 51177) exited with exit code 1
2023-01-16 18:02:25.753 GMT [51172] LOG:  shutting down
2023-01-16 18:02:25.803 GMT [51170] LOG:  database system is shut down
2023-01-16 18:02:26.894 GMT [51503] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:02:26.894 GMT [51503] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:02:26.896 GMT [51503] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:02:26.902 GMT [51504] LOG:  database system was shut down at 2023-01-16 18:02:26 GMT
2023-01-16 18:02:26.907 GMT [51503] LOG:  database system is ready to accept connections
2023-01-16 18:02:27.701 GMT [51529] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:02:27.701 GMT [51529] DETAIL:  Key (account_id)=(10000000) is not present in table "account".
2023-01-16 18:02:27.701 GMT [51529] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:02:27.701 GMT [51529] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 18:05:18.955 GMT [51503] LOG:  received fast shutdown request
2023-01-16 18:05:18.956 GMT [51503] LOG:  aborting any active transactions
2023-01-16 18:05:18.960 GMT [51503] LOG:  background worker "logical replication launcher" (PID 51510) exited with exit code 1
2023-01-16 18:05:18.962 GMT [51505] LOG:  shutting down
2023-01-16 18:05:19.014 GMT [51503] LOG:  database system is shut down
2023-01-16 18:05:20.106 GMT [52102] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:05:20.106 GMT [52102] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:05:20.108 GMT [52102] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:05:20.112 GMT [52103] LOG:  database system was shut down at 2023-01-16 18:05:19 GMT
2023-01-16 18:05:20.120 GMT [52102] LOG:  database system is ready to accept connections
2023-01-16 18:05:20.752 GMT [52128] ERROR:  syntax error at or near "account_id" at character 120
2023-01-16 18:05:20.752 GMT [52128] STATEMENT:  CREATE TABLE IF NOT EXISTS pending_transaction (
	    id SERIAL PRIMARY KEY REFERENCES transaction(id),
	    FOREIGN KEY account_id INT REFERENCES account(account_number),
	    is_transfer BOOLEAN
	);
2023-01-16 18:05:20.810 GMT [52128] ERROR:  relation "pending_transaction" does not exist at character 315
2023-01-16 18:05:20.810 GMT [52128] STATEMENT:  CREATE OR REPLACE VIEW bank.pending_transactions AS
	    SELECT pending_transaction.id, transaction.origin_account_id, transaction.dest_account_id, transaction.dest_account_sort_code as sort_code, transaction.amount, transaction.date, get_account_type(transaction.origin_account_id) AS origin_account_type
	    FROM pending_transaction
	    INNER JOIN transaction ON pending_transaction.id = transaction.id;
2023-01-16 18:05:20.955 GMT [52128] ERROR:  relation "pending_transaction" does not exist at character 13
2023-01-16 18:05:20.955 GMT [52128] QUERY:  INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)
2023-01-16 18:05:20.955 GMT [52128] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:05:20.955 GMT [52128] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 18:05:58.672 GMT [52102] LOG:  received fast shutdown request
2023-01-16 18:05:58.674 GMT [52102] LOG:  aborting any active transactions
2023-01-16 18:05:58.678 GMT [52102] LOG:  background worker "logical replication launcher" (PID 52109) exited with exit code 1
2023-01-16 18:05:58.680 GMT [52104] LOG:  shutting down
2023-01-16 18:05:58.735 GMT [52102] LOG:  database system is shut down
2023-01-16 18:05:59.740 GMT [52315] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:05:59.741 GMT [52315] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:05:59.742 GMT [52315] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:05:59.746 GMT [52316] LOG:  database system was shut down at 2023-01-16 18:05:59 GMT
2023-01-16 18:05:59.751 GMT [52315] LOG:  database system is ready to accept connections
2023-01-16 18:06:00.603 GMT [52341] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:06:00.603 GMT [52341] DETAIL:  Key (account_id)=(10000000) is not present in table "account".
2023-01-16 18:06:00.603 GMT [52341] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:06:00.603 GMT [52341] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 18:17:40.058 GMT [52315] LOG:  received fast shutdown request
2023-01-16 18:17:40.060 GMT [52315] LOG:  aborting any active transactions
2023-01-16 18:17:40.064 GMT [52315] LOG:  background worker "logical replication launcher" (PID 52322) exited with exit code 1
2023-01-16 18:17:40.066 GMT [52317] LOG:  shutting down
2023-01-16 18:17:40.078 GMT [52315] LOG:  database system is shut down
2023-01-16 18:17:41.262 GMT [54389] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:17:41.263 GMT [54389] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:17:41.269 GMT [54389] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:17:41.273 GMT [54390] LOG:  database system was shut down at 2023-01-16 18:17:40 GMT
2023-01-16 18:17:41.280 GMT [54389] LOG:  database system is ready to accept connections
2023-01-16 18:17:42.037 GMT [54415] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:17:42.037 GMT [54415] DETAIL:  Key (account_id)=(10000000) is not present in table "account".
2023-01-16 18:17:42.037 GMT [54415] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:17:42.037 GMT [54415] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000000, 100.00, 10000001, 123456);
2023-01-16 18:18:33.172 GMT [54389] LOG:  received fast shutdown request
2023-01-16 18:18:33.174 GMT [54389] LOG:  aborting any active transactions
2023-01-16 18:18:33.181 GMT [54389] LOG:  background worker "logical replication launcher" (PID 54396) exited with exit code 1
2023-01-16 18:18:33.181 GMT [54391] LOG:  shutting down
2023-01-16 18:18:33.235 GMT [54389] LOG:  database system is shut down
2023-01-16 18:18:34.394 GMT [54639] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:18:34.394 GMT [54639] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:18:34.397 GMT [54639] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:18:34.402 GMT [54640] LOG:  database system was shut down at 2023-01-16 18:18:34 GMT
2023-01-16 18:18:34.409 GMT [54639] LOG:  database system is ready to accept connections
2023-01-16 18:18:35.431 GMT [54672] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:18:35.431 GMT [54672] DETAIL:  Key (account_id)=(10000001) is not present in table "account".
2023-01-16 18:18:35.431 GMT [54672] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:18:35.431 GMT [54672] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-16 18:20:10.408 GMT [54639] LOG:  received fast shutdown request
2023-01-16 18:20:10.412 GMT [54639] LOG:  aborting any active transactions
2023-01-16 18:20:10.416 GMT [54639] LOG:  background worker "logical replication launcher" (PID 54646) exited with exit code 1
2023-01-16 18:20:10.416 GMT [54641] LOG:  shutting down
2023-01-16 18:20:10.462 GMT [54639] LOG:  database system is shut down
2023-01-16 18:20:11.610 GMT [55027] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:20:11.610 GMT [55027] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:20:11.612 GMT [55027] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:20:11.617 GMT [55028] LOG:  database system was shut down at 2023-01-16 18:20:11 GMT
2023-01-16 18:20:11.626 GMT [55027] LOG:  database system is ready to accept connections
2023-01-16 18:20:36.516 GMT [55027] LOG:  received fast shutdown request
2023-01-16 18:20:36.518 GMT [55027] LOG:  aborting any active transactions
2023-01-16 18:20:36.520 GMT [55027] LOG:  background worker "logical replication launcher" (PID 55034) exited with exit code 1
2023-01-16 18:20:36.525 GMT [55029] LOG:  shutting down
2023-01-16 18:20:36.573 GMT [55027] LOG:  database system is shut down
2023-01-16 18:20:37.668 GMT [55231] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:20:37.669 GMT [55231] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:20:37.670 GMT [55231] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:20:37.675 GMT [55232] LOG:  database system was shut down at 2023-01-16 18:20:37 GMT
2023-01-16 18:20:37.680 GMT [55231] LOG:  database system is ready to accept connections
2023-01-16 18:23:27.510 GMT [55231] LOG:  received fast shutdown request
2023-01-16 18:23:27.512 GMT [55231] LOG:  aborting any active transactions
2023-01-16 18:23:27.515 GMT [55231] LOG:  background worker "logical replication launcher" (PID 55238) exited with exit code 1
2023-01-16 18:23:27.519 GMT [55233] LOG:  shutting down
2023-01-16 18:23:27.570 GMT [55231] LOG:  database system is shut down
2023-01-16 18:23:28.628 GMT [55861] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:23:28.628 GMT [55861] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:23:28.630 GMT [55861] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:23:28.634 GMT [55862] LOG:  database system was shut down at 2023-01-16 18:23:28 GMT
2023-01-16 18:23:28.642 GMT [55861] LOG:  database system is ready to accept connections
2023-01-16 18:24:23.996 GMT [55861] LOG:  received fast shutdown request
2023-01-16 18:24:24.001 GMT [55861] LOG:  aborting any active transactions
2023-01-16 18:24:24.007 GMT [55861] LOG:  background worker "logical replication launcher" (PID 55868) exited with exit code 1
2023-01-16 18:24:24.007 GMT [55863] LOG:  shutting down
2023-01-16 18:24:24.060 GMT [55861] LOG:  database system is shut down
2023-01-16 18:24:25.158 GMT [56154] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:24:25.158 GMT [56154] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:24:25.159 GMT [56154] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:24:25.163 GMT [56155] LOG:  database system was shut down at 2023-01-16 18:24:24 GMT
2023-01-16 18:24:25.168 GMT [56154] LOG:  database system is ready to accept connections
2023-01-16 18:25:20.536 GMT [56154] LOG:  received fast shutdown request
2023-01-16 18:25:20.538 GMT [56154] LOG:  aborting any active transactions
2023-01-16 18:25:20.544 GMT [56154] LOG:  background worker "logical replication launcher" (PID 56161) exited with exit code 1
2023-01-16 18:25:20.545 GMT [56156] LOG:  shutting down
2023-01-16 18:25:20.589 GMT [56154] LOG:  database system is shut down
2023-01-16 18:25:21.616 GMT [56424] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:25:21.617 GMT [56424] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:25:21.618 GMT [56424] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:25:21.623 GMT [56425] LOG:  database system was shut down at 2023-01-16 18:25:21 GMT
2023-01-16 18:25:21.628 GMT [56424] LOG:  database system is ready to accept connections
2023-01-16 18:26:19.493 GMT [56424] LOG:  received fast shutdown request
2023-01-16 18:26:19.495 GMT [56424] LOG:  aborting any active transactions
2023-01-16 18:26:19.500 GMT [56424] LOG:  background worker "logical replication launcher" (PID 56431) exited with exit code 1
2023-01-16 18:26:19.500 GMT [56426] LOG:  shutting down
2023-01-16 18:26:19.541 GMT [56424] LOG:  database system is shut down
2023-01-16 18:26:20.617 GMT [56687] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:26:20.618 GMT [56687] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:26:20.619 GMT [56687] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:26:20.624 GMT [56688] LOG:  database system was shut down at 2023-01-16 18:26:20 GMT
2023-01-16 18:26:20.630 GMT [56687] LOG:  database system is ready to accept connections
2023-01-16 18:26:21.441 GMT [56713] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:26:21.441 GMT [56713] DETAIL:  Key (account_id)=(10000001) is not present in table "account".
2023-01-16 18:26:21.441 GMT [56713] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:26:21.441 GMT [56713] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-16 18:29:13.814 GMT [56687] LOG:  received fast shutdown request
2023-01-16 18:29:13.815 GMT [56687] LOG:  aborting any active transactions
2023-01-16 18:29:13.820 GMT [56687] LOG:  background worker "logical replication launcher" (PID 56694) exited with exit code 1
2023-01-16 18:29:13.820 GMT [56689] LOG:  shutting down
2023-01-16 18:29:13.865 GMT [56687] LOG:  database system is shut down
2023-01-16 18:29:14.878 GMT [57292] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:29:14.878 GMT [57292] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:29:14.879 GMT [57292] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:29:14.884 GMT [57293] LOG:  database system was shut down at 2023-01-16 18:29:14 GMT
2023-01-16 18:29:14.890 GMT [57292] LOG:  database system is ready to accept connections
2023-01-16 18:29:15.639 GMT [57318] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:29:15.639 GMT [57318] DETAIL:  Key (account_id)=(10000001) is not present in table "account".
2023-01-16 18:29:15.639 GMT [57318] CONTEXT:  SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 16 at SQL statement
2023-01-16 18:29:15.639 GMT [57318] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-16 18:37:51.899 GMT [57292] LOG:  received fast shutdown request
2023-01-16 18:37:51.902 GMT [57292] LOG:  aborting any active transactions
2023-01-16 18:37:51.907 GMT [57292] LOG:  background worker "logical replication launcher" (PID 57299) exited with exit code 1
2023-01-16 18:37:51.907 GMT [57294] LOG:  shutting down
2023-01-16 18:37:51.925 GMT [57292] LOG:  database system is shut down
2023-01-16 18:37:53.079 GMT [58869] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:37:53.080 GMT [58869] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:37:53.081 GMT [58869] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:37:53.085 GMT [58870] LOG:  database system was shut down at 2023-01-16 18:37:52 GMT
2023-01-16 18:37:53.091 GMT [58869] LOG:  database system is ready to accept connections
2023-01-16 18:37:53.941 GMT [58895] ERROR:  insert or update on table "pending_transaction" violates foreign key constraint "pending_transaction_account_id_fkey"
2023-01-16 18:37:53.941 GMT [58895] DETAIL:  Key (account_id)=(10000001) is not present in table "account".
2023-01-16 18:37:53.941 GMT [58895] STATEMENT:  INSERT INTO pending_transaction(id, account_id, is_transfer) VALUES (1, 10000001, true);
2023-01-16 18:38:58.513 GMT [58869] LOG:  received fast shutdown request
2023-01-16 18:38:58.514 GMT [58869] LOG:  aborting any active transactions
2023-01-16 18:38:58.518 GMT [58869] LOG:  background worker "logical replication launcher" (PID 58876) exited with exit code 1
2023-01-16 18:38:58.519 GMT [58871] LOG:  shutting down
2023-01-16 18:38:58.564 GMT [58869] LOG:  database system is shut down
2023-01-16 18:38:59.616 GMT [59180] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:38:59.617 GMT [59180] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:38:59.628 GMT [59180] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:38:59.634 GMT [59181] LOG:  database system was shut down at 2023-01-16 18:38:59 GMT
2023-01-16 18:38:59.639 GMT [59180] LOG:  database system is ready to accept connections
2023-01-16 18:39:35.957 GMT [59180] LOG:  received fast shutdown request
2023-01-16 18:39:35.958 GMT [59180] LOG:  aborting any active transactions
2023-01-16 18:39:35.962 GMT [59180] LOG:  background worker "logical replication launcher" (PID 59187) exited with exit code 1
2023-01-16 18:39:35.964 GMT [59182] LOG:  shutting down
2023-01-16 18:39:36.007 GMT [59180] LOG:  database system is shut down
2023-01-16 18:39:37.084 GMT [59385] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:39:37.084 GMT [59385] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:39:37.086 GMT [59385] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:39:37.089 GMT [59386] LOG:  database system was shut down at 2023-01-16 18:39:36 GMT
2023-01-16 18:39:37.095 GMT [59385] LOG:  database system is ready to accept connections
2023-01-16 18:48:22.650 GMT [59385] LOG:  received fast shutdown request
2023-01-16 18:48:22.652 GMT [59385] LOG:  aborting any active transactions
2023-01-16 18:48:22.657 GMT [59385] LOG:  background worker "logical replication launcher" (PID 59392) exited with exit code 1
2023-01-16 18:48:22.657 GMT [59387] LOG:  shutting down
2023-01-16 18:48:22.672 GMT [59385] LOG:  database system is shut down
2023-01-16 18:48:23.826 GMT [60886] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:48:23.826 GMT [60886] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:48:23.830 GMT [60886] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:48:23.833 GMT [60887] LOG:  database system was shut down at 2023-01-16 18:48:23 GMT
2023-01-16 18:48:23.840 GMT [60886] LOG:  database system is ready to accept connections
2023-01-16 18:52:09.595 GMT [60886] LOG:  received fast shutdown request
2023-01-16 18:52:09.597 GMT [60886] LOG:  aborting any active transactions
2023-01-16 18:52:09.602 GMT [60886] LOG:  background worker "logical replication launcher" (PID 60893) exited with exit code 1
2023-01-16 18:52:09.602 GMT [60888] LOG:  shutting down
2023-01-16 18:52:09.651 GMT [60886] LOG:  database system is shut down
2023-01-16 18:52:10.802 GMT [61694] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:52:10.803 GMT [61694] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:52:10.804 GMT [61694] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:52:10.808 GMT [61695] LOG:  database system was shut down at 2023-01-16 18:52:10 GMT
2023-01-16 18:52:10.814 GMT [61694] LOG:  database system is ready to accept connections
2023-01-16 18:52:11.663 GMT [61723] ERROR:  account_id 10000001 does not exist
2023-01-16 18:52:11.663 GMT [61723] CONTEXT:  PL/pgSQL function pseudo_fk_account_id() line 4 at RAISE
2023-01-16 18:52:11.663 GMT [61723] STATEMENT:  INSERT INTO pending_transaction(id, account_id, is_transfer) VALUES (1, 10000001, true);
2023-01-16 18:52:48.772 GMT [61694] LOG:  received fast shutdown request
2023-01-16 18:52:48.774 GMT [61694] LOG:  aborting any active transactions
2023-01-16 18:52:48.776 GMT [61694] LOG:  background worker "logical replication launcher" (PID 61701) exited with exit code 1
2023-01-16 18:52:48.779 GMT [61696] LOG:  shutting down
2023-01-16 18:52:48.824 GMT [61694] LOG:  database system is shut down
2023-01-16 18:52:49.819 GMT [62390] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:52:49.820 GMT [62390] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:52:49.821 GMT [62390] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:52:49.825 GMT [62391] LOG:  database system was shut down at 2023-01-16 18:52:49 GMT
2023-01-16 18:52:49.832 GMT [62390] LOG:  database system is ready to accept connections
2023-01-16 18:53:21.047 GMT [62390] LOG:  received fast shutdown request
2023-01-16 18:53:21.049 GMT [62390] LOG:  aborting any active transactions
2023-01-16 18:53:21.054 GMT [62390] LOG:  background worker "logical replication launcher" (PID 62397) exited with exit code 1
2023-01-16 18:53:21.055 GMT [62392] LOG:  shutting down
2023-01-16 18:53:21.104 GMT [62390] LOG:  database system is shut down
2023-01-16 18:53:22.188 GMT [62583] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:53:22.188 GMT [62583] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:53:22.191 GMT [62583] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:53:22.196 GMT [62584] LOG:  database system was shut down at 2023-01-16 18:53:21 GMT
2023-01-16 18:53:22.202 GMT [62583] LOG:  database system is ready to accept connections
2023-01-16 18:53:23.048 GMT [62612] ERROR:  account_id 10000001 does not exist
2023-01-16 18:53:23.048 GMT [62612] CONTEXT:  PL/pgSQL function pseudo_fk_account_id() line 4 at RAISE
2023-01-16 18:53:23.048 GMT [62612] STATEMENT:  INSERT INTO pending_transaction(id, account_id, is_transfer) VALUES (1, 10000001, true);
2023-01-16 18:53:29.995 GMT [62583] LOG:  received fast shutdown request
2023-01-16 18:53:29.997 GMT [62583] LOG:  aborting any active transactions
2023-01-16 18:53:30.002 GMT [62583] LOG:  background worker "logical replication launcher" (PID 62590) exited with exit code 1
2023-01-16 18:53:30.002 GMT [62585] LOG:  shutting down
2023-01-16 18:53:30.064 GMT [62583] LOG:  database system is shut down
2023-01-16 18:53:31.093 GMT [62709] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:53:31.093 GMT [62709] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:53:31.094 GMT [62709] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:53:31.098 GMT [62710] LOG:  database system was shut down at 2023-01-16 18:53:30 GMT
2023-01-16 18:53:31.104 GMT [62709] LOG:  database system is ready to accept connections
2023-01-16 18:54:57.953 GMT [62709] LOG:  received fast shutdown request
2023-01-16 18:54:57.954 GMT [62709] LOG:  aborting any active transactions
2023-01-16 18:54:57.960 GMT [62709] LOG:  background worker "logical replication launcher" (PID 62716) exited with exit code 1
2023-01-16 18:54:57.960 GMT [62711] LOG:  shutting down
2023-01-16 18:54:58.049 GMT [62709] LOG:  database system is shut down
2023-01-16 18:54:59.031 GMT [63069] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:54:59.032 GMT [63069] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:54:59.033 GMT [63069] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:54:59.037 GMT [63070] LOG:  database system was shut down at 2023-01-16 18:54:58 GMT
2023-01-16 18:54:59.042 GMT [63069] LOG:  database system is ready to accept connections
2023-01-16 18:55:42.780 GMT [63069] LOG:  received fast shutdown request
2023-01-16 18:55:42.782 GMT [63069] LOG:  aborting any active transactions
2023-01-16 18:55:42.785 GMT [63069] LOG:  background worker "logical replication launcher" (PID 63076) exited with exit code 1
2023-01-16 18:55:42.790 GMT [63071] LOG:  shutting down
2023-01-16 18:55:42.831 GMT [63069] LOG:  database system is shut down
2023-01-16 18:55:43.935 GMT [63332] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:55:43.935 GMT [63332] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:55:43.937 GMT [63332] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:55:43.941 GMT [63333] LOG:  database system was shut down at 2023-01-16 18:55:43 GMT
2023-01-16 18:55:43.946 GMT [63332] LOG:  database system is ready to accept connections
2023-01-16 18:55:44.746 GMT [63358] ERROR:  function verify_transaction_type(integer) does not exist at character 1
2023-01-16 18:55:44.746 GMT [63358] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 18:55:44.746 GMT [63358] QUERY:  verify_transaction_type(pending_transaction_id) = TRUE
2023-01-16 18:55:44.746 GMT [63358] CONTEXT:  PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 18:55:44.746 GMT [63358] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 18:57:40.393 GMT [63332] LOG:  received fast shutdown request
2023-01-16 18:57:40.396 GMT [63332] LOG:  aborting any active transactions
2023-01-16 18:57:40.400 GMT [63332] LOG:  background worker "logical replication launcher" (PID 63339) exited with exit code 1
2023-01-16 18:57:40.400 GMT [63334] LOG:  shutting down
2023-01-16 18:57:40.450 GMT [63332] LOG:  database system is shut down
2023-01-16 18:57:41.534 GMT [63754] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:57:41.534 GMT [63754] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:57:41.535 GMT [63754] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:57:41.538 GMT [63755] LOG:  database system was shut down at 2023-01-16 18:57:41 GMT
2023-01-16 18:57:41.545 GMT [63754] LOG:  database system is ready to accept connections
2023-01-16 18:57:42.382 GMT [63780] ERROR:  column "is_transfer" does not exist at character 87
2023-01-16 18:57:42.382 GMT [63780] QUERY:  EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE)
2023-01-16 18:57:42.382 GMT [63780] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 7 at IF
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 18:57:42.382 GMT [63780] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 18:58:40.948 GMT [63754] LOG:  received fast shutdown request
2023-01-16 18:58:40.951 GMT [63754] LOG:  aborting any active transactions
2023-01-16 18:58:40.956 GMT [63754] LOG:  background worker "logical replication launcher" (PID 63761) exited with exit code 1
2023-01-16 18:58:40.958 GMT [63756] LOG:  shutting down
2023-01-16 18:58:41.008 GMT [63754] LOG:  database system is shut down
2023-01-16 18:58:41.986 GMT [64057] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:58:41.987 GMT [64057] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:58:41.988 GMT [64057] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:58:41.992 GMT [64058] LOG:  database system was shut down at 2023-01-16 18:58:41 GMT
2023-01-16 18:58:41.997 GMT [64057] LOG:  database system is ready to accept connections
2023-01-16 18:58:42.763 GMT [64083] ERROR:  function verify_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 18:58:42.763 GMT [64083] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 18:58:42.763 GMT [64083] QUERY:  SELECT * FROM verify_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 18:58:42.763 GMT [64083] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 18:58:42.763 GMT [64083] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 18:59:23.269 GMT [64057] LOG:  received fast shutdown request
2023-01-16 18:59:23.271 GMT [64057] LOG:  aborting any active transactions
2023-01-16 18:59:23.276 GMT [64057] LOG:  background worker "logical replication launcher" (PID 64064) exited with exit code 1
2023-01-16 18:59:23.278 GMT [64059] LOG:  shutting down
2023-01-16 18:59:23.324 GMT [64057] LOG:  database system is shut down
2023-01-16 18:59:24.451 GMT [64280] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 18:59:24.452 GMT [64280] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 18:59:24.453 GMT [64280] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 18:59:24.458 GMT [64281] LOG:  database system was shut down at 2023-01-16 18:59:24 GMT
2023-01-16 18:59:24.463 GMT [64280] LOG:  database system is ready to accept connections
2023-01-16 18:59:25.280 GMT [64309] ERROR:  subquery must return only one column at character 32
2023-01-16 18:59:25.280 GMT [64309] QUERY:  SELECT * FROM get_account_type((SELECT  FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 18:59:25.280 GMT [64309] CONTEXT:  PL/pgSQL function verify_transaction_amounts(integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM bank.verify_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 18:59:25.280 GMT [64309] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 19:00:25.479 GMT [64280] LOG:  received fast shutdown request
2023-01-16 19:00:25.481 GMT [64280] LOG:  aborting any active transactions
2023-01-16 19:00:25.486 GMT [64280] LOG:  background worker "logical replication launcher" (PID 64287) exited with exit code 1
2023-01-16 19:00:25.486 GMT [64282] LOG:  shutting down
2023-01-16 19:00:25.533 GMT [64280] LOG:  database system is shut down
2023-01-16 19:00:26.621 GMT [64559] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:00:26.622 GMT [64559] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:00:26.623 GMT [64559] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:00:26.628 GMT [64560] LOG:  database system was shut down at 2023-01-16 19:00:26 GMT
2023-01-16 19:00:26.633 GMT [64559] LOG:  database system is ready to accept connections
2023-01-16 19:00:27.454 GMT [64585] ERROR:  column "account_number" does not exist at character 40
2023-01-16 19:00:27.454 GMT [64585] QUERY:  SELECT * FROM get_account_type((SELECT account_number FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 19:00:27.454 GMT [64585] CONTEXT:  PL/pgSQL function verify_transaction_amounts(integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM bank.verify_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 19:00:27.454 GMT [64585] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 19:01:10.384 GMT [64559] LOG:  received fast shutdown request
2023-01-16 19:01:10.386 GMT [64559] LOG:  aborting any active transactions
2023-01-16 19:01:10.392 GMT [64559] LOG:  background worker "logical replication launcher" (PID 64566) exited with exit code 1
2023-01-16 19:01:10.393 GMT [64561] LOG:  shutting down
2023-01-16 19:01:10.442 GMT [64559] LOG:  database system is shut down
2023-01-16 19:01:11.549 GMT [64786] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:01:11.549 GMT [64786] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:01:11.551 GMT [64786] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:01:11.555 GMT [64787] LOG:  database system was shut down at 2023-01-16 19:01:11 GMT
2023-01-16 19:01:11.561 GMT [64786] LOG:  database system is ready to accept connections
2023-01-16 19:01:12.382 GMT [64815] ERROR:  subquery must return only one column at character 32
2023-01-16 19:01:12.382 GMT [64815] QUERY:  SELECT * FROM get_account_type((SELECT  FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 19:01:12.382 GMT [64815] CONTEXT:  PL/pgSQL function verify_transaction_amounts(integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM bank.verify_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 19:01:12.382 GMT [64815] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 19:01:55.093 GMT [64786] LOG:  received fast shutdown request
2023-01-16 19:01:55.094 GMT [64786] LOG:  aborting any active transactions
2023-01-16 19:01:55.099 GMT [64786] LOG:  background worker "logical replication launcher" (PID 64793) exited with exit code 1
2023-01-16 19:01:55.100 GMT [64788] LOG:  shutting down
2023-01-16 19:01:55.148 GMT [64786] LOG:  database system is shut down
2023-01-16 19:01:56.282 GMT [65042] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:01:56.282 GMT [65042] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:01:56.284 GMT [65042] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:01:56.288 GMT [65043] LOG:  database system was shut down at 2023-01-16 19:01:56 GMT
2023-01-16 19:01:56.293 GMT [65042] LOG:  database system is ready to accept connections
2023-01-16 19:01:57.103 GMT [65068] ERROR:  column "account_id" does not exist at character 40
2023-01-16 19:01:57.103 GMT [65068] QUERY:  SELECT * FROM get_account_type((SELECT account_id FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 19:01:57.103 GMT [65068] CONTEXT:  PL/pgSQL function verify_transaction_amounts(integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM bank.verify_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 19:01:57.103 GMT [65068] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 19:02:55.466 GMT [65042] LOG:  received fast shutdown request
2023-01-16 19:02:55.467 GMT [65042] LOG:  aborting any active transactions
2023-01-16 19:02:55.474 GMT [65042] LOG:  background worker "logical replication launcher" (PID 65049) exited with exit code 1
2023-01-16 19:02:55.475 GMT [65044] LOG:  shutting down
2023-01-16 19:02:55.523 GMT [65042] LOG:  database system is shut down
2023-01-16 19:02:56.647 GMT [65315] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:02:56.647 GMT [65315] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:02:56.649 GMT [65315] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:02:56.653 GMT [65316] LOG:  database system was shut down at 2023-01-16 19:02:56 GMT
2023-01-16 19:02:56.657 GMT [65315] LOG:  database system is ready to accept connections
2023-01-16 19:02:57.465 GMT [65341] ERROR:  column "balance" does not exist at character 163
2023-01-16 19:02:57.465 GMT [65341] QUERY:  EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 19:02:57.465 GMT [65341] CONTEXT:  PL/pgSQL function verify_transaction_amounts(integer,boolean) line 44 at IF
	SQL statement "SELECT * FROM bank.verify_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 19:02:57.465 GMT [65341] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 19:03:21.360 GMT [65315] LOG:  received fast shutdown request
2023-01-16 19:03:21.362 GMT [65315] LOG:  aborting any active transactions
2023-01-16 19:03:21.366 GMT [65315] LOG:  background worker "logical replication launcher" (PID 65322) exited with exit code 1
2023-01-16 19:03:21.366 GMT [65317] LOG:  shutting down
2023-01-16 19:03:21.417 GMT [65315] LOG:  database system is shut down
2023-01-16 19:03:22.562 GMT [65493] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:03:22.562 GMT [65493] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:03:22.564 GMT [65493] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:03:22.569 GMT [65494] LOG:  database system was shut down at 2023-01-16 19:03:22 GMT
2023-01-16 19:03:22.576 GMT [65493] LOG:  database system is ready to accept connections
2023-01-16 19:05:05.814 GMT [65493] LOG:  received fast shutdown request
2023-01-16 19:05:05.815 GMT [65493] LOG:  aborting any active transactions
2023-01-16 19:05:05.821 GMT [65493] LOG:  background worker "logical replication launcher" (PID 65500) exited with exit code 1
2023-01-16 19:05:05.821 GMT [65495] LOG:  shutting down
2023-01-16 19:05:05.867 GMT [65493] LOG:  database system is shut down
2023-01-16 19:05:06.961 GMT [65916] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:05:06.961 GMT [65916] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:05:06.963 GMT [65916] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:05:06.967 GMT [65917] LOG:  database system was shut down at 2023-01-16 19:05:06 GMT
2023-01-16 19:05:06.974 GMT [65916] LOG:  database system is ready to accept connections
2023-01-16 19:58:03.890 GMT [65916] LOG:  received fast shutdown request
2023-01-16 19:58:03.892 GMT [65916] LOG:  aborting any active transactions
2023-01-16 19:58:03.897 GMT [65916] LOG:  background worker "logical replication launcher" (PID 65923) exited with exit code 1
2023-01-16 19:58:03.897 GMT [65918] LOG:  shutting down
2023-01-16 19:58:03.914 GMT [65916] LOG:  database system is shut down
2023-01-16 19:58:14.346 GMT [74446] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 19:58:14.347 GMT [74446] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 19:58:14.348 GMT [74446] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 19:58:14.354 GMT [74450] LOG:  database system was shut down at 2023-01-16 19:58:14 GMT
2023-01-16 19:58:14.359 GMT [74446] LOG:  database system is ready to accept connections
2023-01-16 20:27:41.951 GMT [74446] LOG:  received fast shutdown request
2023-01-16 20:27:41.953 GMT [74446] LOG:  aborting any active transactions
2023-01-16 20:27:41.956 GMT [74446] LOG:  background worker "logical replication launcher" (PID 74456) exited with exit code 1
2023-01-16 20:27:41.959 GMT [74451] LOG:  shutting down
2023-01-16 20:27:41.975 GMT [74446] LOG:  database system is shut down
2023-01-16 20:27:46.913 GMT [80003] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:27:46.913 GMT [80003] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:27:46.914 GMT [80003] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:27:46.918 GMT [80007] LOG:  database system was shut down at 2023-01-16 20:27:46 GMT
2023-01-16 20:27:46.925 GMT [80003] LOG:  database system is ready to accept connections
2023-01-16 20:27:47.605 GMT [80032] ERROR:  type account_number_identifier does not exist
2023-01-16 20:27:47.605 GMT [80032] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier, amount)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number) INTO account_type;
	    IF account_type = 'DEBIT' THEN 
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS'
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit)
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET credit_usage = credit_usage + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:27:47.606 GMT [80032] ERROR:  syntax error at or near "update_balance_amounts" at character 804
2023-01-16 20:27:47.606 GMT [80032] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:27:47.727 GMT [80032] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:27:47.727 GMT [80032] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:27:47.727 GMT [80032] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:27:47.727 GMT [80032] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:27:47.727 GMT [80032] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:28:46.526 GMT [80003] LOG:  received fast shutdown request
2023-01-16 20:28:46.528 GMT [80003] LOG:  aborting any active transactions
2023-01-16 20:28:46.532 GMT [80003] LOG:  background worker "logical replication launcher" (PID 80013) exited with exit code 1
2023-01-16 20:28:46.532 GMT [80008] LOG:  shutting down
2023-01-16 20:28:46.578 GMT [80003] LOG:  database system is shut down
2023-01-16 20:28:47.755 GMT [80297] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:28:47.756 GMT [80297] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:28:47.757 GMT [80297] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:28:47.762 GMT [80298] LOG:  database system was shut down at 2023-01-16 20:28:47 GMT
2023-01-16 20:28:47.767 GMT [80297] LOG:  database system is ready to accept connections
2023-01-16 20:28:48.473 GMT [80326] ERROR:  syntax error at or near "UPDATE" at character 583
2023-01-16 20:28:48.473 GMT [80326] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number) INTO account_type;
	    IF account_type = 'DEBIT' THEN 
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS'
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit)
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET credit_usage = credit_usage + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:28:48.475 GMT [80326] ERROR:  syntax error at or near "update_balance_amounts" at character 804
2023-01-16 20:28:48.475 GMT [80326] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:28:48.615 GMT [80326] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:28:48.615 GMT [80326] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:28:48.615 GMT [80326] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:28:48.615 GMT [80326] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:28:48.615 GMT [80326] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:29:08.442 GMT [80297] LOG:  received fast shutdown request
2023-01-16 20:29:08.444 GMT [80297] LOG:  aborting any active transactions
2023-01-16 20:29:08.449 GMT [80297] LOG:  background worker "logical replication launcher" (PID 80304) exited with exit code 1
2023-01-16 20:29:08.449 GMT [80299] LOG:  shutting down
2023-01-16 20:29:08.501 GMT [80297] LOG:  database system is shut down
2023-01-16 20:29:09.557 GMT [80466] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:29:09.558 GMT [80466] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:29:09.559 GMT [80466] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:29:09.564 GMT [80467] LOG:  database system was shut down at 2023-01-16 20:29:09 GMT
2023-01-16 20:29:09.569 GMT [80466] LOG:  database system is ready to accept connections
2023-01-16 20:29:10.258 GMT [80495] ERROR:  missing "THEN" at end of SQL expression at character 949
2023-01-16 20:29:10.258 GMT [80495] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number) INTO account_type;
	    IF account_type = 'DEBIT' THEN 
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit)
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET credit_usage = credit_usage + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:29:10.259 GMT [80495] ERROR:  syntax error at or near "update_balance_amounts" at character 804
2023-01-16 20:29:10.259 GMT [80495] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:29:10.374 GMT [80495] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:29:10.374 GMT [80495] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:29:10.374 GMT [80495] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:29:10.374 GMT [80495] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:29:10.374 GMT [80495] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:29:34.723 GMT [80466] LOG:  received fast shutdown request
2023-01-16 20:29:34.725 GMT [80466] LOG:  aborting any active transactions
2023-01-16 20:29:34.731 GMT [80466] LOG:  background worker "logical replication launcher" (PID 80473) exited with exit code 1
2023-01-16 20:29:34.734 GMT [80468] LOG:  shutting down
2023-01-16 20:29:34.780 GMT [80466] LOG:  database system is shut down
2023-01-16 20:29:35.865 GMT [80643] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:29:35.866 GMT [80643] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:29:35.867 GMT [80643] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:29:35.871 GMT [80644] LOG:  database system was shut down at 2023-01-16 20:29:35 GMT
2023-01-16 20:29:35.875 GMT [80643] LOG:  database system is ready to accept connections
2023-01-16 20:29:36.616 GMT [80669] ERROR:  syntax error at or near "update_balance_amounts" at character 804
2023-01-16 20:29:36.616 GMT [80669] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:29:36.732 GMT [80669] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:29:36.732 GMT [80669] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:29:36.732 GMT [80669] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:29:36.732 GMT [80669] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:29:36.732 GMT [80669] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:33:12.138 GMT [80643] LOG:  received fast shutdown request
2023-01-16 20:33:12.140 GMT [80643] LOG:  aborting any active transactions
2023-01-16 20:33:12.146 GMT [80643] LOG:  background worker "logical replication launcher" (PID 80650) exited with exit code 1
2023-01-16 20:33:12.146 GMT [80645] LOG:  shutting down
2023-01-16 20:33:12.208 GMT [80643] LOG:  database system is shut down
2023-01-16 20:33:13.218 GMT [81384] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:33:13.218 GMT [81384] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:33:13.219 GMT [81384] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:33:13.223 GMT [81385] LOG:  database system was shut down at 2023-01-16 20:33:12 GMT
2023-01-16 20:33:13.228 GMT [81384] LOG:  database system is ready to accept connections
2023-01-16 20:33:13.917 GMT [81413] ERROR:  syntax error at or near "update_balance_amounts" at character 811
2023-01-16 20:33:13.917 GMT [81413] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:33:14.038 GMT [81413] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:33:14.038 GMT [81413] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:33:14.038 GMT [81413] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:33:14.038 GMT [81413] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:33:14.038 GMT [81413] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:36:27.197 GMT [81384] LOG:  received fast shutdown request
2023-01-16 20:36:27.200 GMT [81384] LOG:  aborting any active transactions
2023-01-16 20:36:27.204 GMT [81384] LOG:  background worker "logical replication launcher" (PID 81391) exited with exit code 1
2023-01-16 20:36:27.205 GMT [81386] LOG:  shutting down
2023-01-16 20:36:27.267 GMT [81384] LOG:  database system is shut down
2023-01-16 20:36:28.400 GMT [82077] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:36:28.401 GMT [82077] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:36:28.403 GMT [82077] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:36:28.408 GMT [82078] LOG:  database system was shut down at 2023-01-16 20:36:28 GMT
2023-01-16 20:36:28.415 GMT [82077] LOG:  database system is ready to accept connections
2023-01-16 20:36:29.153 GMT [82103] ERROR:  syntax error at or near "update_balance_amounts" at character 811
2023-01-16 20:36:29.153 GMT [82103] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	            END IF;
	        ELSE;
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	            END IF;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:36:29.286 GMT [82103] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:36:29.286 GMT [82103] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:36:29.286 GMT [82103] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:36:29.286 GMT [82103] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:36:29.286 GMT [82103] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:37:03.063 GMT [82077] LOG:  received fast shutdown request
2023-01-16 20:37:03.065 GMT [82077] LOG:  aborting any active transactions
2023-01-16 20:37:03.070 GMT [82077] LOG:  background worker "logical replication launcher" (PID 82084) exited with exit code 1
2023-01-16 20:37:03.073 GMT [82079] LOG:  shutting down
2023-01-16 20:37:03.125 GMT [82077] LOG:  database system is shut down
2023-01-16 20:37:04.275 GMT [82283] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:37:04.275 GMT [82283] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:37:04.276 GMT [82283] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:37:04.282 GMT [82284] LOG:  database system was shut down at 2023-01-16 20:37:04 GMT
2023-01-16 20:37:04.288 GMT [82283] LOG:  database system is ready to accept connections
2023-01-16 20:37:04.994 GMT [82312] ERROR:  syntax error at or near "update_balance_amounts" at character 811
2023-01-16 20:37:04.994 GMT [82312] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	            END IF;
	        ELSE;
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	            END IF;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:37:05.157 GMT [82312] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:37:05.157 GMT [82312] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:37:05.157 GMT [82312] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:37:05.157 GMT [82312] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:37:05.157 GMT [82312] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:38:37.702 GMT [82283] LOG:  received fast shutdown request
2023-01-16 20:38:37.704 GMT [82283] LOG:  aborting any active transactions
2023-01-16 20:38:37.709 GMT [82283] LOG:  background worker "logical replication launcher" (PID 82290) exited with exit code 1
2023-01-16 20:38:37.710 GMT [82285] LOG:  shutting down
2023-01-16 20:38:37.758 GMT [82283] LOG:  database system is shut down
2023-01-16 20:38:38.843 GMT [82673] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:38:38.843 GMT [82673] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:38:38.846 GMT [82673] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:38:38.851 GMT [82674] LOG:  database system was shut down at 2023-01-16 20:38:38 GMT
2023-01-16 20:38:38.856 GMT [82673] LOG:  database system is ready to accept connections
2023-01-16 20:38:39.545 GMT [82699] ERROR:  syntax error at or near ";" at character 1229
2023-01-16 20:38:39.545 GMT [82699] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                --update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        ELSE;
	            IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:38:39.674 GMT [82699] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:38:39.674 GMT [82699] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:38:39.674 GMT [82699] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:38:39.674 GMT [82699] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:38:39.674 GMT [82699] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:39:30.628 GMT [82673] LOG:  received fast shutdown request
2023-01-16 20:39:30.630 GMT [82673] LOG:  aborting any active transactions
2023-01-16 20:39:30.637 GMT [82673] LOG:  background worker "logical replication launcher" (PID 82680) exited with exit code 1
2023-01-16 20:39:30.637 GMT [82675] LOG:  shutting down
2023-01-16 20:39:30.681 GMT [82673] LOG:  database system is shut down
2023-01-16 20:39:31.777 GMT [82946] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:39:31.777 GMT [82946] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:39:31.779 GMT [82946] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:39:31.784 GMT [82947] LOG:  database system was shut down at 2023-01-16 20:39:31 GMT
2023-01-16 20:39:31.791 GMT [82946] LOG:  database system is ready to accept connections
2023-01-16 20:39:32.616 GMT [82975] ERROR:  column "transaction_account_id" does not exist at character 68
2023-01-16 20:39:32.616 GMT [82975] QUERY:  EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:39:32.616 GMT [82975] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 7 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:39:32.616 GMT [82975] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:40:56.984 GMT [82946] LOG:  received fast shutdown request
2023-01-16 20:40:56.986 GMT [82946] LOG:  aborting any active transactions
2023-01-16 20:40:56.991 GMT [82946] LOG:  background worker "logical replication launcher" (PID 82953) exited with exit code 1
2023-01-16 20:40:56.992 GMT [82948] LOG:  shutting down
2023-01-16 20:40:57.040 GMT [82946] LOG:  database system is shut down
2023-01-16 20:40:58.094 GMT [83290] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:40:58.095 GMT [83290] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:40:58.096 GMT [83290] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:40:58.101 GMT [83291] LOG:  database system was shut down at 2023-01-16 20:40:57 GMT
2023-01-16 20:40:58.107 GMT [83290] LOG:  database system is ready to accept connections
2023-01-16 20:40:58.964 GMT [83319] ERROR:  column "orig_account_number" does not exist at character 32
2023-01-16 20:40:58.964 GMT [83319] QUERY:  update_balance_amounts((SELECT orig_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:40:58.964 GMT [83319] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 30 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:40:58.964 GMT [83319] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:42:10.468 GMT [83290] LOG:  received fast shutdown request
2023-01-16 20:42:10.470 GMT [83290] LOG:  aborting any active transactions
2023-01-16 20:42:10.472 GMT [83290] LOG:  background worker "logical replication launcher" (PID 83297) exited with exit code 1
2023-01-16 20:42:10.475 GMT [83292] LOG:  shutting down
2023-01-16 20:42:10.526 GMT [83290] LOG:  database system is shut down
2023-01-16 20:42:11.552 GMT [83604] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:42:11.552 GMT [83604] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:42:11.553 GMT [83604] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:42:11.559 GMT [83605] LOG:  database system was shut down at 2023-01-16 20:42:11 GMT
2023-01-16 20:42:11.565 GMT [83604] LOG:  database system is ready to accept connections
2023-01-16 20:42:12.374 GMT [83630] ERROR:  column "orig_account_number" does not exist at character 32
2023-01-16 20:42:12.374 GMT [83630] QUERY:  update_balance_amounts((SELECT orig_account_number FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:42:12.374 GMT [83630] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 30 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:42:12.374 GMT [83630] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:44:23.114 GMT [83604] LOG:  received fast shutdown request
2023-01-16 20:44:23.116 GMT [83604] LOG:  aborting any active transactions
2023-01-16 20:44:23.121 GMT [83604] LOG:  background worker "logical replication launcher" (PID 83611) exited with exit code 1
2023-01-16 20:44:23.121 GMT [83606] LOG:  shutting down
2023-01-16 20:44:23.167 GMT [83604] LOG:  database system is shut down
2023-01-16 20:44:24.349 GMT [84096] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:44:24.350 GMT [84096] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:44:24.351 GMT [84096] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:44:24.357 GMT [84097] LOG:  database system was shut down at 2023-01-16 20:44:24 GMT
2023-01-16 20:44:24.364 GMT [84096] LOG:  database system is ready to accept connections
2023-01-16 20:44:25.170 GMT [84122] ERROR:  column "orig_account_number" does not exist at character 32
2023-01-16 20:44:25.170 GMT [84122] QUERY:  update_balance_amounts((SELECT orig_account_number FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-16 20:44:25.170 GMT [84122] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:44:25.170 GMT [84122] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:44:36.206 GMT [84096] LOG:  received fast shutdown request
2023-01-16 20:44:36.208 GMT [84096] LOG:  aborting any active transactions
2023-01-16 20:44:36.212 GMT [84096] LOG:  background worker "logical replication launcher" (PID 84103) exited with exit code 1
2023-01-16 20:44:36.213 GMT [84098] LOG:  shutting down
2023-01-16 20:44:36.264 GMT [84096] LOG:  database system is shut down
2023-01-16 20:44:37.337 GMT [84241] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:44:37.338 GMT [84241] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:44:37.340 GMT [84241] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:44:37.345 GMT [84242] LOG:  database system was shut down at 2023-01-16 20:44:37 GMT
2023-01-16 20:44:37.351 GMT [84241] LOG:  database system is ready to accept connections
2023-01-16 20:44:38.260 GMT [84270] ERROR:  column "orig_account_id" does not exist at character 68
2023-01-16 20:44:38.260 GMT [84270] HINT:  Perhaps you meant to reference the column "pending_transactions.origin_account_id".
2023-01-16 20:44:38.260 GMT [84270] QUERY:  EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT orig_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:44:38.260 GMT [84270] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 7 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:44:38.260 GMT [84270] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:44:55.580 GMT [84241] LOG:  received fast shutdown request
2023-01-16 20:44:55.583 GMT [84241] LOG:  aborting any active transactions
2023-01-16 20:44:55.588 GMT [84241] LOG:  background worker "logical replication launcher" (PID 84248) exited with exit code 1
2023-01-16 20:44:55.588 GMT [84243] LOG:  shutting down
2023-01-16 20:44:55.638 GMT [84241] LOG:  database system is shut down
2023-01-16 20:44:56.824 GMT [84411] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:44:56.824 GMT [84411] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:44:56.826 GMT [84411] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:44:56.830 GMT [84412] LOG:  database system was shut down at 2023-01-16 20:44:56 GMT
2023-01-16 20:44:56.837 GMT [84411] LOG:  database system is ready to accept connections
2023-01-16 20:44:57.708 GMT [84437] ERROR:  column "orig_account_number" does not exist at character 32
2023-01-16 20:44:57.708 GMT [84437] QUERY:  update_balance_amounts((SELECT orig_account_number FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-16 20:44:57.708 GMT [84437] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:44:57.708 GMT [84437] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:45:35.371 GMT [84411] LOG:  received fast shutdown request
2023-01-16 20:45:35.373 GMT [84411] LOG:  aborting any active transactions
2023-01-16 20:45:35.375 GMT [84411] LOG:  background worker "logical replication launcher" (PID 84418) exited with exit code 1
2023-01-16 20:45:35.378 GMT [84413] LOG:  shutting down
2023-01-16 20:45:35.423 GMT [84411] LOG:  database system is shut down
2023-01-16 20:45:36.549 GMT [84647] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:45:36.549 GMT [84647] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:45:36.550 GMT [84647] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:45:36.558 GMT [84648] LOG:  database system was shut down at 2023-01-16 20:45:36 GMT
2023-01-16 20:45:36.563 GMT [84647] LOG:  database system is ready to accept connections
2023-01-16 20:45:37.451 GMT [84676] ERROR:  column "origin_account_number" does not exist at character 32
2023-01-16 20:45:37.451 GMT [84676] QUERY:  update_balance_amounts((SELECT origin_account_number FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-16 20:45:37.451 GMT [84676] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:45:37.451 GMT [84676] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:47:30.941 GMT [84647] LOG:  received fast shutdown request
2023-01-16 20:47:30.943 GMT [84647] LOG:  aborting any active transactions
2023-01-16 20:47:30.947 GMT [84647] LOG:  background worker "logical replication launcher" (PID 84654) exited with exit code 1
2023-01-16 20:47:30.949 GMT [84649] LOG:  shutting down
2023-01-16 20:47:30.996 GMT [84647] LOG:  database system is shut down
2023-01-16 20:47:32.031 GMT [85079] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:47:32.031 GMT [85079] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:47:32.033 GMT [85079] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:47:32.037 GMT [85080] LOG:  database system was shut down at 2023-01-16 20:47:31 GMT
2023-01-16 20:47:32.042 GMT [85079] LOG:  database system is ready to accept connections
2023-01-16 20:47:32.878 GMT [85105] ERROR:  function update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-16 20:47:32.878 GMT [85105] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:47:32.878 GMT [85105] QUERY:  update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-16 20:47:32.878 GMT [85105] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:47:32.878 GMT [85105] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:48:58.591 GMT [85079] LOG:  received fast shutdown request
2023-01-16 20:48:58.593 GMT [85079] LOG:  aborting any active transactions
2023-01-16 20:48:58.599 GMT [85079] LOG:  background worker "logical replication launcher" (PID 85086) exited with exit code 1
2023-01-16 20:48:58.600 GMT [85081] LOG:  shutting down
2023-01-16 20:48:58.645 GMT [85079] LOG:  database system is shut down
2023-01-16 20:48:59.736 GMT [85433] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:48:59.736 GMT [85433] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:48:59.738 GMT [85433] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:48:59.743 GMT [85434] LOG:  database system was shut down at 2023-01-16 20:48:59 GMT
2023-01-16 20:48:59.748 GMT [85433] LOG:  database system is ready to accept connections
2023-01-16 20:49:00.641 GMT [85459] ERROR:  column "account_number" does not exist at character 25
2023-01-16 20:49:00.641 GMT [85459] QUERY:  SELECT get_account_type(account_number)
2023-01-16 20:49:00.641 GMT [85459] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 5 at SQL statement
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:49:00.641 GMT [85459] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:49:25.493 GMT [85433] LOG:  received fast shutdown request
2023-01-16 20:49:25.495 GMT [85433] LOG:  aborting any active transactions
2023-01-16 20:49:25.500 GMT [85433] LOG:  background worker "logical replication launcher" (PID 85440) exited with exit code 1
2023-01-16 20:49:25.501 GMT [85435] LOG:  shutting down
2023-01-16 20:49:25.560 GMT [85433] LOG:  database system is shut down
2023-01-16 20:49:31.566 GMT [85651] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:49:31.566 GMT [85651] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:49:31.568 GMT [85651] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:49:31.572 GMT [85652] LOG:  database system was shut down at 2023-01-16 20:49:31 GMT
2023-01-16 20:49:31.576 GMT [85651] LOG:  database system is ready to accept connections
2023-01-16 20:49:32.394 GMT [85677] ERROR:  column "balance" does not exist at character 92
2023-01-16 20:49:32.394 GMT [85677] QUERY:  EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND balance - amount < 0)
2023-01-16 20:49:32.394 GMT [85677] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at IF
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:49:32.394 GMT [85677] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:50:14.050 GMT [85651] LOG:  received fast shutdown request
2023-01-16 20:50:14.053 GMT [85651] LOG:  aborting any active transactions
2023-01-16 20:50:14.058 GMT [85651] LOG:  background worker "logical replication launcher" (PID 85658) exited with exit code 1
2023-01-16 20:50:14.058 GMT [85653] LOG:  shutting down
2023-01-16 20:50:14.108 GMT [85651] LOG:  database system is shut down
2023-01-16 20:50:15.165 GMT [85879] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:50:15.165 GMT [85879] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:50:15.168 GMT [85879] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:50:15.172 GMT [85880] LOG:  database system was shut down at 2023-01-16 20:50:14 GMT
2023-01-16 20:50:15.179 GMT [85879] LOG:  database system is ready to accept connections
2023-01-16 20:50:16.020 GMT [85905] ERROR:  column "balance" of relation "savings_account" does not exist at character 28
2023-01-16 20:50:16.020 GMT [85905] QUERY:  UPDATE savings_account SET balance = current_balance - amount WHERE account_number = account_number_identifier
2023-01-16 20:50:16.020 GMT [85905] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 30 at SQL statement
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 10 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:50:16.020 GMT [85905] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:50:35.135 GMT [85879] LOG:  received fast shutdown request
2023-01-16 20:50:35.136 GMT [85879] LOG:  aborting any active transactions
2023-01-16 20:50:35.140 GMT [85879] LOG:  background worker "logical replication launcher" (PID 85886) exited with exit code 1
2023-01-16 20:50:35.140 GMT [85881] LOG:  shutting down
2023-01-16 20:50:35.192 GMT [85879] LOG:  database system is shut down
2023-01-16 20:50:36.267 GMT [86045] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:50:36.267 GMT [86045] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:50:36.269 GMT [86045] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:50:36.273 GMT [86046] LOG:  database system was shut down at 2023-01-16 20:50:36 GMT
2023-01-16 20:50:36.278 GMT [86045] LOG:  database system is ready to accept connections
2023-01-16 20:51:10.521 GMT [86045] LOG:  received fast shutdown request
2023-01-16 20:51:10.525 GMT [86045] LOG:  aborting any active transactions
2023-01-16 20:51:10.530 GMT [86045] LOG:  background worker "logical replication launcher" (PID 86052) exited with exit code 1
2023-01-16 20:51:10.530 GMT [86047] LOG:  shutting down
2023-01-16 20:51:10.575 GMT [86045] LOG:  database system is shut down
2023-01-16 20:51:11.639 GMT [86259] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:51:11.640 GMT [86259] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:51:11.642 GMT [86259] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:51:11.647 GMT [86260] LOG:  database system was shut down at 2023-01-16 20:51:11 GMT
2023-01-16 20:51:11.655 GMT [86259] LOG:  database system is ready to accept connections
2023-01-16 20:51:12.393 GMT [86285] ERROR:  syntax error at or near "bank" at character 799
2023-01-16 20:51:12.393 GMT [86285] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT dest_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                bank.update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        ELSE
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:51:12.547 GMT [86285] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:51:12.547 GMT [86285] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:51:12.547 GMT [86285] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:51:12.547 GMT [86285] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:51:12.547 GMT [86285] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:51:37.150 GMT [86259] LOG:  received fast shutdown request
2023-01-16 20:51:37.152 GMT [86259] LOG:  aborting any active transactions
2023-01-16 20:51:37.156 GMT [86259] LOG:  background worker "logical replication launcher" (PID 86266) exited with exit code 1
2023-01-16 20:51:37.157 GMT [86261] LOG:  shutting down
2023-01-16 20:51:37.211 GMT [86259] LOG:  database system is shut down
2023-01-16 20:51:38.281 GMT [86464] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:51:38.282 GMT [86464] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:51:38.284 GMT [86464] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:51:38.288 GMT [86465] LOG:  database system was shut down at 2023-01-16 20:51:38 GMT
2023-01-16 20:51:38.294 GMT [86464] LOG:  database system is ready to accept connections
2023-01-16 20:51:39.015 GMT [86490] ERROR:  syntax error at or near "bank" at character 861
2023-01-16 20:51:39.015 GMT [86490] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT dest_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	        IF is_transfer = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                
	                transaction_approved = TRUE;
	                bank.update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id));
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        ELSE
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	        
	    -- SELECT * FROM get_account_type((SELECT origin_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id)) INTO account_type;
	    --     IF account_type = 'DEBIT' THEN
	    --         RAISE NOTICE 'DEBIT ACCOUNT';
	    --         --check balance of debit account
	    --         IF EXISTS (SELECT * FROM debit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE debit_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'CREDIT' THEN
	    --         RAISE NOTICE 'CREDIT ACCOUNT';
	    --         --check credit limit compared to credit usage of credit account
	    --         IF EXISTS (SELECT * FROM credit_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND credit_limit >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT CREDIT';
	    --             UPDATE credit_account SET credit_usage = credit_usage + (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT CREDIT';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSIF account_type = 'SAVINGS' THEN
	    --         RAISE NOTICE 'SAVINGS ACCOUNT';
	    --         --check balance of savings account
	    --         IF EXISTS (SELECT * FROM savings_account WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND current_balance >= (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	    --             RAISE NOTICE 'SUFFICIENT FUNDS';
	    --             UPDATE savings_account SET current_balance = current_balance - (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id) WHERE account_number = (SELECT transaction_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id);
	    --             DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	    --             transaction_approved = TRUE;
	    --         ELSE
	    --             RAISE NOTICE 'INSUFFICIENT FUNDS';
	    --             transaction_approved = FALSE;
	    --         END IF;
	    --     ELSE
	    --         RAISE NOTICE 'UNKNOWN ACCOUNT TYPE';
	    --         transaction_approved = FALSE;
	    --     END IF;
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 20:51:39.139 GMT [86490] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean) does not exist at character 15
2023-01-16 20:51:39.139 GMT [86490] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 20:51:39.139 GMT [86490] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)
2023-01-16 20:51:39.139 GMT [86490] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:51:39.139 GMT [86490] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:53:27.923 GMT [86464] LOG:  received fast shutdown request
2023-01-16 20:53:27.924 GMT [86464] LOG:  aborting any active transactions
2023-01-16 20:53:27.928 GMT [86464] LOG:  background worker "logical replication launcher" (PID 86471) exited with exit code 1
2023-01-16 20:53:27.928 GMT [86466] LOG:  shutting down
2023-01-16 20:53:27.974 GMT [86464] LOG:  database system is shut down
2023-01-16 20:53:29.078 GMT [86888] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:53:29.079 GMT [86888] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:53:29.081 GMT [86888] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:53:29.086 GMT [86889] LOG:  database system was shut down at 2023-01-16 20:53:28 GMT
2023-01-16 20:53:29.092 GMT [86888] LOG:  database system is ready to accept connections
2023-01-16 20:53:29.909 GMT [86917] ERROR:  column "dest_account_number" does not exist at character 37
2023-01-16 20:53:29.909 GMT [86917] QUERY:  bank.update_balance_amounts((SELECT dest_account_number FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:53:29.909 GMT [86917] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 11 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:53:29.909 GMT [86917] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:53:50.621 GMT [86888] LOG:  received fast shutdown request
2023-01-16 20:53:50.622 GMT [86888] LOG:  aborting any active transactions
2023-01-16 20:53:50.626 GMT [86888] LOG:  background worker "logical replication launcher" (PID 86895) exited with exit code 1
2023-01-16 20:53:50.629 GMT [86890] LOG:  shutting down
2023-01-16 20:53:50.674 GMT [86888] LOG:  database system is shut down
2023-01-16 20:53:51.659 GMT [87062] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:53:51.659 GMT [87062] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:53:51.661 GMT [87062] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:53:51.665 GMT [87063] LOG:  database system was shut down at 2023-01-16 20:53:51 GMT
2023-01-16 20:53:51.671 GMT [87062] LOG:  database system is ready to accept connections
2023-01-16 20:53:52.546 GMT [87088] ERROR:  column "dest_account_id" does not exist at character 37
2023-01-16 20:53:52.546 GMT [87088] QUERY:  bank.update_balance_amounts((SELECT dest_account_id FROM pending_transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))
2023-01-16 20:53:52.546 GMT [87088] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean) line 11 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
2023-01-16 20:53:52.546 GMT [87088] STATEMENT:  SELECT * FROM bank.verify_transaction(1);
2023-01-16 20:54:04.263 GMT [87062] LOG:  received fast shutdown request
2023-01-16 20:54:04.264 GMT [87062] LOG:  aborting any active transactions
2023-01-16 20:54:04.268 GMT [87062] LOG:  background worker "logical replication launcher" (PID 87069) exited with exit code 1
2023-01-16 20:54:04.269 GMT [87064] LOG:  shutting down
2023-01-16 20:54:04.316 GMT [87062] LOG:  database system is shut down
2023-01-16 20:54:05.370 GMT [87206] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:54:05.370 GMT [87206] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:54:05.372 GMT [87206] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:54:05.377 GMT [87207] LOG:  database system was shut down at 2023-01-16 20:54:05 GMT
2023-01-16 20:54:05.382 GMT [87206] LOG:  database system is ready to accept connections
2023-01-16 20:54:28.296 GMT [87206] LOG:  received fast shutdown request
2023-01-16 20:54:28.297 GMT [87206] LOG:  aborting any active transactions
2023-01-16 20:54:28.302 GMT [87206] LOG:  background worker "logical replication launcher" (PID 87213) exited with exit code 1
2023-01-16 20:54:28.303 GMT [87208] LOG:  shutting down
2023-01-16 20:54:28.355 GMT [87206] LOG:  database system is shut down
2023-01-16 20:54:29.454 GMT [87385] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:54:29.454 GMT [87385] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:54:29.456 GMT [87385] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:54:29.459 GMT [87386] LOG:  database system was shut down at 2023-01-16 20:54:29 GMT
2023-01-16 20:54:29.464 GMT [87385] LOG:  database system is ready to accept connections
2023-01-16 20:55:12.454 GMT [87385] LOG:  received fast shutdown request
2023-01-16 20:55:12.456 GMT [87385] LOG:  aborting any active transactions
2023-01-16 20:55:12.458 GMT [87385] LOG:  background worker "logical replication launcher" (PID 87392) exited with exit code 1
2023-01-16 20:55:12.460 GMT [87387] LOG:  shutting down
2023-01-16 20:55:12.516 GMT [87385] LOG:  database system is shut down
2023-01-16 20:55:13.543 GMT [87642] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:55:13.543 GMT [87642] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:55:13.544 GMT [87642] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:55:13.549 GMT [87643] LOG:  database system was shut down at 2023-01-16 20:55:13 GMT
2023-01-16 20:55:13.555 GMT [87642] LOG:  database system is ready to accept connections
2023-01-16 20:55:45.893 GMT [87642] LOG:  received fast shutdown request
2023-01-16 20:55:45.894 GMT [87642] LOG:  aborting any active transactions
2023-01-16 20:55:45.900 GMT [87642] LOG:  background worker "logical replication launcher" (PID 87649) exited with exit code 1
2023-01-16 20:55:45.901 GMT [87644] LOG:  shutting down
2023-01-16 20:55:45.951 GMT [87642] LOG:  database system is shut down
2023-01-16 20:55:47.007 GMT [87834] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:55:47.007 GMT [87834] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:55:47.009 GMT [87834] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:55:47.014 GMT [87835] LOG:  database system was shut down at 2023-01-16 20:55:46 GMT
2023-01-16 20:55:47.019 GMT [87834] LOG:  database system is ready to accept connections
2023-01-16 20:56:02.508 GMT [87834] LOG:  received fast shutdown request
2023-01-16 20:56:02.510 GMT [87834] LOG:  aborting any active transactions
2023-01-16 20:56:02.516 GMT [87834] LOG:  background worker "logical replication launcher" (PID 87841) exited with exit code 1
2023-01-16 20:56:02.516 GMT [87836] LOG:  shutting down
2023-01-16 20:56:02.573 GMT [87834] LOG:  database system is shut down
2023-01-16 20:56:03.781 GMT [87987] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:56:03.781 GMT [87987] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:56:03.783 GMT [87987] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:56:03.789 GMT [87988] LOG:  database system was shut down at 2023-01-16 20:56:03 GMT
2023-01-16 20:56:03.794 GMT [87987] LOG:  database system is ready to accept connections
2023-01-16 20:57:21.160 GMT [87987] LOG:  received fast shutdown request
2023-01-16 20:57:21.162 GMT [87987] LOG:  aborting any active transactions
2023-01-16 20:57:21.167 GMT [87987] LOG:  background worker "logical replication launcher" (PID 87994) exited with exit code 1
2023-01-16 20:57:21.169 GMT [87989] LOG:  shutting down
2023-01-16 20:57:21.220 GMT [87987] LOG:  database system is shut down
2023-01-16 20:57:22.258 GMT [88305] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:57:22.258 GMT [88305] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:57:22.260 GMT [88305] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:57:22.264 GMT [88306] LOG:  database system was shut down at 2023-01-16 20:57:22 GMT
2023-01-16 20:57:22.269 GMT [88305] LOG:  database system is ready to accept connections
2023-01-16 20:57:54.798 GMT [88305] LOG:  received fast shutdown request
2023-01-16 20:57:54.800 GMT [88305] LOG:  aborting any active transactions
2023-01-16 20:57:54.802 GMT [88305] LOG:  background worker "logical replication launcher" (PID 88312) exited with exit code 1
2023-01-16 20:57:54.806 GMT [88307] LOG:  shutting down
2023-01-16 20:57:54.850 GMT [88305] LOG:  database system is shut down
2023-01-16 20:57:55.987 GMT [88534] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:57:55.987 GMT [88534] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:57:55.988 GMT [88534] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:57:55.993 GMT [88535] LOG:  database system was shut down at 2023-01-16 20:57:55 GMT
2023-01-16 20:57:55.999 GMT [88534] LOG:  database system is ready to accept connections
2023-01-16 20:58:12.461 GMT [88534] LOG:  received fast shutdown request
2023-01-16 20:58:12.462 GMT [88534] LOG:  aborting any active transactions
2023-01-16 20:58:12.469 GMT [88534] LOG:  background worker "logical replication launcher" (PID 88541) exited with exit code 1
2023-01-16 20:58:12.469 GMT [88536] LOG:  shutting down
2023-01-16 20:58:12.516 GMT [88534] LOG:  database system is shut down
2023-01-16 20:58:13.629 GMT [88694] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:58:13.629 GMT [88694] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:58:13.630 GMT [88694] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:58:13.636 GMT [88695] LOG:  database system was shut down at 2023-01-16 20:58:13 GMT
2023-01-16 20:58:13.642 GMT [88694] LOG:  database system is ready to accept connections
2023-01-16 20:59:03.535 GMT [88694] LOG:  received fast shutdown request
2023-01-16 20:59:03.537 GMT [88694] LOG:  aborting any active transactions
2023-01-16 20:59:03.540 GMT [88694] LOG:  background worker "logical replication launcher" (PID 88701) exited with exit code 1
2023-01-16 20:59:03.542 GMT [88696] LOG:  shutting down
2023-01-16 20:59:03.593 GMT [88694] LOG:  database system is shut down
2023-01-16 20:59:04.722 GMT [88946] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:59:04.722 GMT [88946] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:59:04.724 GMT [88946] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:59:04.728 GMT [88947] LOG:  database system was shut down at 2023-01-16 20:59:04 GMT
2023-01-16 20:59:04.735 GMT [88946] LOG:  database system is ready to accept connections
2023-01-16 20:59:13.153 GMT [88946] LOG:  received fast shutdown request
2023-01-16 20:59:13.155 GMT [88946] LOG:  aborting any active transactions
2023-01-16 20:59:13.164 GMT [88946] LOG:  background worker "logical replication launcher" (PID 88953) exited with exit code 1
2023-01-16 20:59:13.164 GMT [88948] LOG:  shutting down
2023-01-16 20:59:13.222 GMT [88946] LOG:  database system is shut down
2023-01-16 20:59:14.213 GMT [89067] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:59:14.213 GMT [89067] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:59:14.215 GMT [89067] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:59:14.221 GMT [89068] LOG:  database system was shut down at 2023-01-16 20:59:13 GMT
2023-01-16 20:59:14.226 GMT [89067] LOG:  database system is ready to accept connections
2023-01-16 20:59:24.900 GMT [89067] LOG:  received fast shutdown request
2023-01-16 20:59:24.902 GMT [89067] LOG:  aborting any active transactions
2023-01-16 20:59:24.907 GMT [89067] LOG:  background worker "logical replication launcher" (PID 89074) exited with exit code 1
2023-01-16 20:59:24.908 GMT [89069] LOG:  shutting down
2023-01-16 20:59:24.955 GMT [89067] LOG:  database system is shut down
2023-01-16 20:59:26.061 GMT [89224] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:59:26.062 GMT [89224] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:59:26.063 GMT [89224] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:59:26.067 GMT [89225] LOG:  database system was shut down at 2023-01-16 20:59:25 GMT
2023-01-16 20:59:26.073 GMT [89224] LOG:  database system is ready to accept connections
2023-01-16 20:59:53.575 GMT [89224] LOG:  received fast shutdown request
2023-01-16 20:59:53.577 GMT [89224] LOG:  aborting any active transactions
2023-01-16 20:59:53.581 GMT [89224] LOG:  background worker "logical replication launcher" (PID 89231) exited with exit code 1
2023-01-16 20:59:53.581 GMT [89226] LOG:  shutting down
2023-01-16 20:59:53.634 GMT [89224] LOG:  database system is shut down
2023-01-16 20:59:54.690 GMT [89411] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 20:59:54.690 GMT [89411] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 20:59:54.693 GMT [89411] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 20:59:54.698 GMT [89412] LOG:  database system was shut down at 2023-01-16 20:59:54 GMT
2023-01-16 20:59:54.703 GMT [89411] LOG:  database system is ready to accept connections
2023-01-16 21:00:05.504 GMT [89411] LOG:  received fast shutdown request
2023-01-16 21:00:05.506 GMT [89411] LOG:  aborting any active transactions
2023-01-16 21:00:05.510 GMT [89411] LOG:  background worker "logical replication launcher" (PID 89418) exited with exit code 1
2023-01-16 21:00:05.512 GMT [89413] LOG:  shutting down
2023-01-16 21:00:05.562 GMT [89411] LOG:  database system is shut down
2023-01-16 21:00:06.682 GMT [89548] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:00:06.683 GMT [89548] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:00:06.684 GMT [89548] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:00:06.688 GMT [89549] LOG:  database system was shut down at 2023-01-16 21:00:06 GMT
2023-01-16 21:00:06.693 GMT [89548] LOG:  database system is ready to accept connections
2023-01-16 21:00:37.919 GMT [89548] LOG:  received fast shutdown request
2023-01-16 21:00:37.921 GMT [89548] LOG:  aborting any active transactions
2023-01-16 21:00:37.923 GMT [89548] LOG:  background worker "logical replication launcher" (PID 89555) exited with exit code 1
2023-01-16 21:00:37.927 GMT [89550] LOG:  shutting down
2023-01-16 21:00:37.978 GMT [89548] LOG:  database system is shut down
2023-01-16 21:00:39.089 GMT [89760] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:00:39.089 GMT [89760] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:00:39.091 GMT [89760] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:00:39.095 GMT [89761] LOG:  database system was shut down at 2023-01-16 21:00:38 GMT
2023-01-16 21:00:39.102 GMT [89760] LOG:  database system is ready to accept connections
2023-01-16 21:01:17.986 GMT [89760] LOG:  received fast shutdown request
2023-01-16 21:01:17.988 GMT [89760] LOG:  aborting any active transactions
2023-01-16 21:01:17.991 GMT [89760] LOG:  background worker "logical replication launcher" (PID 89767) exited with exit code 1
2023-01-16 21:01:17.997 GMT [89762] LOG:  shutting down
2023-01-16 21:01:18.041 GMT [89760] LOG:  database system is shut down
2023-01-16 21:01:19.170 GMT [89975] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:01:19.171 GMT [89975] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:01:19.173 GMT [89975] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:01:19.179 GMT [89976] LOG:  database system was shut down at 2023-01-16 21:01:18 GMT
2023-01-16 21:01:19.184 GMT [89975] LOG:  database system is ready to accept connections
2023-01-16 21:01:30.216 GMT [89975] LOG:  received fast shutdown request
2023-01-16 21:01:30.217 GMT [89975] LOG:  aborting any active transactions
2023-01-16 21:01:30.224 GMT [89975] LOG:  background worker "logical replication launcher" (PID 89982) exited with exit code 1
2023-01-16 21:01:30.224 GMT [89977] LOG:  shutting down
2023-01-16 21:01:30.271 GMT [89975] LOG:  database system is shut down
2023-01-16 21:01:31.327 GMT [90119] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:01:31.327 GMT [90119] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:01:31.329 GMT [90119] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:01:31.333 GMT [90120] LOG:  database system was shut down at 2023-01-16 21:01:31 GMT
2023-01-16 21:01:31.339 GMT [90119] LOG:  database system is ready to accept connections
2023-01-16 21:02:51.364 GMT [90119] LOG:  received fast shutdown request
2023-01-16 21:02:51.366 GMT [90119] LOG:  aborting any active transactions
2023-01-16 21:02:51.372 GMT [90119] LOG:  background worker "logical replication launcher" (PID 90126) exited with exit code 1
2023-01-16 21:02:51.372 GMT [90121] LOG:  shutting down
2023-01-16 21:02:51.419 GMT [90119] LOG:  database system is shut down
2023-01-16 21:02:52.530 GMT [90445] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:02:52.530 GMT [90445] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:02:52.532 GMT [90445] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:02:52.536 GMT [90446] LOG:  database system was shut down at 2023-01-16 21:02:52 GMT
2023-01-16 21:02:52.542 GMT [90445] LOG:  database system is ready to accept connections
2023-01-16 21:02:53.325 GMT [90474] ERROR:  syntax error at or near "client" at character 437
2023-01-16 21:02:53.325 GMT [90474] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code);
	
	    -- SELECT account_id INTO internal_account_id FROM client.accounts
	    -- WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    -- IF internal_account_id IS NULL THEN
	    --    RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
	       
	    -- ELSE
	    --     RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	    --     SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code) INTO passed;
	    --     --SELECT * FROM client.place_transaction_out_of_account(account_identifier, transfer_account_number, orig_account_number, transfer_amount) INTO passed;
	    --     GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    --     passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    END IF;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:02:53.373 GMT [90474] ERROR:  function client.initiate_transfer(integer, integer, numeric, integer, integer) does not exist at character 15
2023-01-16 21:02:53.373 GMT [90474] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:02:53.373 GMT [90474] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:03:13.955 GMT [90445] LOG:  received fast shutdown request
2023-01-16 21:03:13.957 GMT [90445] LOG:  aborting any active transactions
2023-01-16 21:03:13.960 GMT [90445] LOG:  background worker "logical replication launcher" (PID 90452) exited with exit code 1
2023-01-16 21:03:13.960 GMT [90447] LOG:  shutting down
2023-01-16 21:03:14.011 GMT [90445] LOG:  database system is shut down
2023-01-16 21:03:15.121 GMT [90618] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:03:15.122 GMT [90618] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:03:15.123 GMT [90618] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:03:15.127 GMT [90619] LOG:  database system was shut down at 2023-01-16 21:03:14 GMT
2023-01-16 21:03:15.132 GMT [90618] LOG:  database system is ready to accept connections
2023-01-16 21:03:15.975 GMT [90644] ERROR:  syntax error at or near "client" at character 437
2023-01-16 21:03:15.975 GMT [90644] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code);
	
	    -- SELECT account_id INTO internal_account_id FROM client.accounts
	    -- WHERE account_number = transfer_account_number AND sort_code = transfer_account_sort_code;
	
	    -- IF internal_account_id IS NULL THEN
	    --    RAISE NOTICE 'EXTERNAL TRANSFER TO LOCAL ACCOUNT %', transfer_account_number;
	       
	    -- ELSE
	    --     RAISE NOTICE 'INTERNAL TRANSFER TO ACCOUNT %', transfer_account_number;
	    --     SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code) INTO passed;
	    --     --SELECT * FROM client.place_transaction_out_of_account(account_identifier, transfer_account_number, orig_account_number, transfer_amount) INTO passed;
	    --     GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    --     passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    --END IF;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:03:16.040 GMT [90644] ERROR:  function client.initiate_transfer(integer, integer, numeric, integer, integer) does not exist at character 15
2023-01-16 21:03:16.040 GMT [90644] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:03:16.040 GMT [90644] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:03:35.243 GMT [90618] LOG:  received fast shutdown request
2023-01-16 21:03:35.246 GMT [90618] LOG:  aborting any active transactions
2023-01-16 21:03:35.252 GMT [90618] LOG:  background worker "logical replication launcher" (PID 90625) exited with exit code 1
2023-01-16 21:03:35.253 GMT [90620] LOG:  shutting down
2023-01-16 21:03:35.301 GMT [90618] LOG:  database system is shut down
2023-01-16 21:03:36.407 GMT [90805] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:03:36.407 GMT [90805] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:03:36.408 GMT [90805] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:03:36.415 GMT [90807] LOG:  database system was shut down at 2023-01-16 21:03:36 GMT
2023-01-16 21:03:36.422 GMT [90805] LOG:  database system is ready to accept connections
2023-01-16 21:03:37.208 GMT [90832] ERROR:  query has no destination for result data
2023-01-16 21:03:37.208 GMT [90832] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-16 21:03:37.208 GMT [90832] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:03:37.208 GMT [90832] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:04:05.387 GMT [90805] LOG:  received fast shutdown request
2023-01-16 21:04:05.388 GMT [90805] LOG:  aborting any active transactions
2023-01-16 21:04:05.392 GMT [90805] LOG:  background worker "logical replication launcher" (PID 90813) exited with exit code 1
2023-01-16 21:04:05.395 GMT [90808] LOG:  shutting down
2023-01-16 21:04:05.441 GMT [90805] LOG:  database system is shut down
2023-01-16 21:04:06.589 GMT [90995] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:04:06.589 GMT [90995] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:04:06.591 GMT [90995] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:04:06.596 GMT [90996] LOG:  database system was shut down at 2023-01-16 21:04:06 GMT
2023-01-16 21:04:06.601 GMT [90995] LOG:  database system is ready to accept connections
2023-01-16 21:09:09.201 GMT [90995] LOG:  received fast shutdown request
2023-01-16 21:09:09.202 GMT [90995] LOG:  aborting any active transactions
2023-01-16 21:09:09.207 GMT [90995] LOG:  background worker "logical replication launcher" (PID 91002) exited with exit code 1
2023-01-16 21:09:09.245 GMT [90997] LOG:  shutting down
2023-01-16 21:09:09.257 GMT [90995] LOG:  database system is shut down
2023-01-16 21:09:10.390 GMT [92024] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:09:10.390 GMT [92024] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:09:10.392 GMT [92024] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:09:10.396 GMT [92028] LOG:  database system was shut down at 2023-01-16 21:09:10 GMT
2023-01-16 21:09:10.401 GMT [92024] LOG:  database system is ready to accept connections
2023-01-16 21:09:11.239 GMT [92053] ERROR:  query has no destination for result data
2023-01-16 21:09:11.239 GMT [92053] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-16 21:09:11.239 GMT [92053] CONTEXT:  PL/pgSQL function transaction_verification() line 4 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:09:11.239 GMT [92053] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:10:32.304 GMT [92024] LOG:  received fast shutdown request
2023-01-16 21:10:32.306 GMT [92024] LOG:  aborting any active transactions
2023-01-16 21:10:32.308 GMT [92024] LOG:  background worker "logical replication launcher" (PID 92034) exited with exit code 1
2023-01-16 21:10:32.312 GMT [92029] LOG:  shutting down
2023-01-16 21:10:32.359 GMT [92024] LOG:  database system is shut down
2023-01-16 21:10:33.503 GMT [92377] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:10:33.503 GMT [92377] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:10:33.504 GMT [92377] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:10:33.509 GMT [92378] LOG:  database system was shut down at 2023-01-16 21:10:33 GMT
2023-01-16 21:10:33.515 GMT [92377] LOG:  database system is ready to accept connections
2023-01-16 21:29:55.064 GMT [92377] LOG:  received fast shutdown request
2023-01-16 21:29:55.066 GMT [92377] LOG:  aborting any active transactions
2023-01-16 21:29:55.071 GMT [92377] LOG:  background worker "logical replication launcher" (PID 92384) exited with exit code 1
2023-01-16 21:29:55.071 GMT [92379] LOG:  shutting down
2023-01-16 21:29:55.089 GMT [92377] LOG:  database system is shut down
2023-01-16 21:29:59.754 GMT [95715] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:29:59.754 GMT [95715] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:29:59.757 GMT [95715] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:29:59.764 GMT [95716] LOG:  database system was shut down at 2023-01-16 21:29:59 GMT
2023-01-16 21:29:59.773 GMT [95715] LOG:  database system is ready to accept connections
2023-01-16 21:30:00.799 GMT [95744] ERROR:  no language specified
2023-01-16 21:30:00.799 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION staff.view_personal_information(first_name, last_name);
2023-01-16 21:30:00.799 GMT [95744] ERROR:  syntax error at or near "RETURNS" at character 1
2023-01-16 21:30:00.799 GMT [95744] STATEMENT:  RETURNS TABLE(first_name TEXT, last_name TEXT, )
	CREATE SCHEMA IF NOT EXISTS client;
2023-01-16 21:30:00.801 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.801 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
2023-01-16 21:30:00.802 GMT [95744] ERROR:  relation "client.accounts" does not exist at character 298
2023-01-16 21:30:00.802 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON accounts.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON accounts.account_number = debit_overdraft.account_number;
2023-01-16 21:30:00.802 GMT [95744] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-16 21:30:00.802 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-16 21:30:00.802 GMT [95744] ERROR:  relation "debit_accounts_statements" does not exist at character 413
2023-01-16 21:30:00.802 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-16 21:30:00.803 GMT [95744] ERROR:  relation "client.accounts" does not exist at character 257
2023-01-16 21:30:00.803 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON accounts.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON accounts.account_number = credit_account_application.account_number;
2023-01-16 21:30:00.803 GMT [95744] ERROR:  relation "credit_accounts" does not exist at character 322
2023-01-16 21:30:00.803 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
2023-01-16 21:30:00.804 GMT [95744] ERROR:  relation "credit_accounts_statements" does not exist at character 517
2023-01-16 21:30:00.804 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
2023-01-16 21:30:00.804 GMT [95744] ERROR:  relation "client.accounts" does not exist at character 180
2023-01-16 21:30:00.804 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT accounts.account_id, accounts.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON accounts.account_number = savings_account.account_number;
2023-01-16 21:30:00.804 GMT [95744] ERROR:  relation "savings_accounts" does not exist at character 252
2023-01-16 21:30:00.804 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
2023-01-16 21:30:00.805 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.805 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
2023-01-16 21:30:00.805 GMT [95744] ERROR:  relation "client.loans" does not exist at character 185
2023-01-16 21:30:00.805 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-16 21:30:00.805 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.805 GMT [95744] STATEMENT:  CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
2023-01-16 21:30:00.806 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.806 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.806 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.806 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.806 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.806 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE ROW_COUNT INT;
	BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.806 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.806 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE debit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
	    INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.807 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.807 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE credit_account_number INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
	    INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    return PASSED;
	END
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.807 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.807 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE savings_account_id INT;
	DECLARE next_account_number INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    SELECT get_next_account_number() INTO next_account_number;
	
	    INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number INTO savings_account_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.807 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.807 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE loan_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
	    INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.807 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.807 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.807 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.807 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	
	BEGIN
	
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.808 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.808 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.809 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.809 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.809 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.809 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.810 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.810 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.810 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.810 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.810 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.810 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
	BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            RETURN statement_id;
	        ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            RETURN statement_id;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        END IF;
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
	            return statement_id;
	        END IF;
	    END CASE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.811 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.811 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE statement_id INT;
	DECLARE transaction_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
	
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE debit_account SET current_balance = current_balance - transaction_amount WHERE debit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true);
	
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE credit_account SET outstanding_balance = outstanding_balance - transaction_amount WHERE credit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true);
	
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE savings_account SET current_balance = current_balance - transaction_amount WHERE savings_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true);
	    ELSE
	        RAISE NOTICE 'Account does not exist';
	        RETURN FALSE;
	    END CASE;
	    RETURN TRUE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.811 GMT [95744] ERROR:  schema "client" does not exist
2023-01-16 21:30:00.811 GMT [95744] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code) INTO passed;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:30:00.834 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.834 GMT [95744] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-16 21:30:00.834 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.834 GMT [95744] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-16 21:30:00.834 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.834 GMT [95744] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-16 21:30:00.835 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.835 GMT [95744] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-16 21:30:00.836 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.836 GMT [95744] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 21:30:00.836 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.836 GMT [95744] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:30:00.837 GMT [95744] ERROR:  schema "client" does not exist at character 15
2023-01-16 21:30:00.837 GMT [95744] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-16 21:30:32.382 GMT [95715] LOG:  received fast shutdown request
2023-01-16 21:30:32.384 GMT [95715] LOG:  aborting any active transactions
2023-01-16 21:30:32.389 GMT [95715] LOG:  background worker "logical replication launcher" (PID 95722) exited with exit code 1
2023-01-16 21:30:32.390 GMT [95717] LOG:  shutting down
2023-01-16 21:30:32.451 GMT [95715] LOG:  database system is shut down
2023-01-16 21:30:33.758 GMT [95939] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:30:33.758 GMT [95939] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:30:33.760 GMT [95939] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:30:33.763 GMT [95940] LOG:  database system was shut down at 2023-01-16 21:30:33 GMT
2023-01-16 21:30:33.770 GMT [95939] LOG:  database system is ready to accept connections
2023-01-16 21:44:37.499 GMT [95939] LOG:  received fast shutdown request
2023-01-16 21:44:37.502 GMT [95939] LOG:  aborting any active transactions
2023-01-16 21:44:37.509 GMT [95939] LOG:  background worker "logical replication launcher" (PID 95946) exited with exit code 1
2023-01-16 21:44:37.512 GMT [95941] LOG:  shutting down
2023-01-16 21:44:37.530 GMT [95939] LOG:  database system is shut down
2023-01-16 21:44:38.746 GMT [98528] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:44:38.747 GMT [98528] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:44:38.748 GMT [98528] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:44:38.754 GMT [98529] LOG:  database system was shut down at 2023-01-16 21:44:38 GMT
2023-01-16 21:44:38.761 GMT [98528] LOG:  database system is ready to accept connections
2023-01-16 21:44:39.606 GMT [98554] ERROR:  syntax error at or near "DECLARE" at character 601
2023-01-16 21:44:39.606 GMT [98554] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_loan_amounts(loan_id INT, payment_amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE loan_updated BOOLEAN;
	BEGIN
	    IF EXISTS (SELECT * FROM loan WHERE id = loan_id AND amount - payment_amount < 0) THEN
	        RAISE EXCEPTION 'LOAN OVERPAID';
	        loan_updated = FALSE;
	    ELSE
	        UPDATE loan SET current_balance = amount - payment_amount WHERE id = loan_id;
	        loan_updated = TRUE;
	    END IF;
	    RETURN loan_updated;
	END;
	
	CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
2023-01-16 21:44:39.606 GMT [98554] ERROR:  syntax error at or near "TEXT" at character 22
2023-01-16 21:44:39.606 GMT [98554] STATEMENT:  DECLARE account_type TEXT;
2023-01-16 21:44:39.606 GMT [98554] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 21:44:39.606 GMT [98554] STATEMENT:  BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
2023-01-16 21:44:39.606 GMT [98554] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 21:44:39.606 GMT [98554] STATEMENT:  IF account_type = 'DEBIT' THEN 
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
2023-01-16 21:44:39.606 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.606 GMT [98554] STATEMENT:  balances_updated = FALSE;
2023-01-16 21:44:39.607 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.607 GMT [98554] STATEMENT:  ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
2023-01-16 21:44:39.607 GMT [98554] ERROR:  column "account_number_identifier" does not exist at character 92
2023-01-16 21:44:39.607 GMT [98554] STATEMENT:  UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
2023-01-16 21:44:39.607 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.607 GMT [98554] STATEMENT:  balances_updated = TRUE;
2023-01-16 21:44:39.607 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.607 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.608 GMT [98554] ERROR:  syntax error at or near "ELSIF" at character 1
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit) THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
2023-01-16 21:44:39.608 GMT [98554] ERROR:  column "account_number_identifier" does not exist at character 87
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  UPDATE credit_account SET credit_usage = credit_usage + amount WHERE account_number = account_number_identifier;
2023-01-16 21:44:39.608 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  balances_updated = TRUE;
2023-01-16 21:44:39.608 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
2023-01-16 21:44:39.608 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  balances_updated = FALSE;
2023-01-16 21:44:39.608 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.608 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.609 GMT [98554] ERROR:  syntax error at or near "ELSIF" at character 1
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
2023-01-16 21:44:39.609 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  balances_updated = FALSE;
2023-01-16 21:44:39.609 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
2023-01-16 21:44:39.609 GMT [98554] ERROR:  column "account_number_identifier" does not exist at character 94
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  UPDATE savings_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
2023-01-16 21:44:39.609 GMT [98554] ERROR:  syntax error at or near "balances_updated" at character 1
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  balances_updated = TRUE;
2023-01-16 21:44:39.609 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.609 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.610 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.610 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.610 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.610 GMT [98554] STATEMENT:  RETURN balances_updated;
2023-01-16 21:44:39.610 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.610 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.610 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "TEXT" at character 22
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  DECLARE account_type TEXT;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "IF" at character 16
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  BEGIN
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT dest_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  IF is_loan_payment = TRUE THEN
	            IF bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                    transaction_approved = TRUE;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  ELSE
	                    transaction_approved = FALSE;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  ELSE
	                transaction_approved = FALSE;
2023-01-16 21:44:39.611 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.611 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  column "pending_transaction_id" does not exist at character 44
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  DELETE FROM pending_transaction WHERE id = pending_transaction_id;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  IF is_transfer = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_balance_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                    transaction_approved = TRUE;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  ELSE
	                transaction_approved = FALSE;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  column "pending_transaction_id" does not exist at character 44
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  DELETE FROM pending_transaction WHERE id = pending_transaction_id;
2023-01-16 21:44:39.612 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.612 GMT [98554] STATEMENT:  ELSE
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
2023-01-16 21:44:39.613 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.613 GMT [98554] STATEMENT:  ELSE
	                transaction_approved = FALSE;
2023-01-16 21:44:39.613 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.613 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.613 GMT [98554] ERROR:  column "pending_transaction_id" does not exist at character 44
2023-01-16 21:44:39.613 GMT [98554] STATEMENT:  DELETE FROM pending_transaction WHERE id = pending_transaction_id;
2023-01-16 21:44:39.613 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.613 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.614 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.614 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
2023-01-16 21:44:39.614 GMT [98554] ERROR:  syntax error at or near "IF" at character 1
2023-01-16 21:44:39.614 GMT [98554] STATEMENT:  IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
2023-01-16 21:44:39.614 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.614 GMT [98554] STATEMENT:  ELSE
	            transaction_approved = FALSE;
2023-01-16 21:44:39.614 GMT [98554] ERROR:  column "pending_transaction_id" does not exist at character 44
2023-01-16 21:44:39.614 GMT [98554] STATEMENT:  DELETE FROM pending_transaction WHERE id = pending_transaction_id;
2023-01-16 21:44:39.614 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.614 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  RETURN transaction_approved;
2023-01-16 21:44:39.615 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	    
	CREATE OR REPLACE FUNCTION bank.verify_transaction_type(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	    
	CREATE OR REPLACE FUNCTION bank.verify_transaction_type(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "IF" at character 16
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  BEGIN
	    
	    IF EXISTS (SELECT * FROM bank.pending_transactions) THEN
	        
	        IF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE) THEN
	            RAISE NOTICE 'Transfer transaction';
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "INTO" at character 95
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE) INTO transaction_approved;
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "ELSIF" at character 1
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  ELSIF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_loan_payment = TRUE) THEN
	            RAISE NOTICE 'Loan payment transaction';
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "INTO" at character 95
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, FALSE, TRUE) INTO transaction_approved;
2023-01-16 21:44:39.615 GMT [98554] ERROR:  syntax error at or near "ELSIF" at character 1
2023-01-16 21:44:39.615 GMT [98554] STATEMENT:  ELSIF EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = FALSE) THEN
	            RAISE NOTICE 'Payment transaction';
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "INTO" at character 96
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, FALSE, FALSE) INTO transaction_approved;
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  ELSE
	            RAISE NOTICE 'Unknown transaction type';
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "transaction_approved" at character 1
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  transaction_approved = FALSE;
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'Transaction does not exist';
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "transaction_approved" at character 1
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  transaction_approved = FALSE;
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.616 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.616 GMT [98554] STATEMENT:  RETURN transaction_approved;
2023-01-16 21:44:39.617 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.617 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.617 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION bank.verify_transaction(pending_transaction_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
2023-01-16 21:44:39.617 GMT [98554] ERROR:  syntax error at or near "TEXT" at character 22
2023-01-16 21:44:39.617 GMT [98554] STATEMENT:  DECLARE account_type TEXT;
2023-01-16 21:44:39.617 GMT [98554] ERROR:  syntax error at or near "IF" at character 16
2023-01-16 21:44:39.617 GMT [98554] STATEMENT:  BEGIN
	    
	    IF bank.verify_transaction_type(pending_transaction_id) = TRUE THEN
	        RAISE NOTICE 'Transaction approved';
2023-01-16 21:44:39.617 GMT [98554] ERROR:  syntax error at or near "transaction_approved" at character 1
2023-01-16 21:44:39.617 GMT [98554] STATEMENT:  transaction_approved = TRUE;
2023-01-16 21:44:39.618 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.618 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'Transaction not approved';
2023-01-16 21:44:39.618 GMT [98554] ERROR:  syntax error at or near "transaction_approved" at character 1
2023-01-16 21:44:39.618 GMT [98554] STATEMENT:  transaction_approved = FALSE;
2023-01-16 21:44:39.618 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.618 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.618 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.618 GMT [98554] STATEMENT:  RETURN transaction_approved;
2023-01-16 21:44:39.619 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.619 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	--CREATE OR REPLACE FUNCTION bank.approve_loan_payment(loan_payment_id INT)
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$" at character 1
2023-01-16 21:44:39.619 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	--CREATE OR REPLACE FUNCTION bank.approve_loan_payment(loan_payment_id INT)
	
	CREATE SCHEMA IF NOT EXISTS staff;
	SET search_path TO public, staff, client;
	
	CREATE OR REPLACE VIEW staff.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code
	    FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW staff.credit_account_applications AS
	    SELECT credit_account_application.id, credit_account_application.application_status, credit_account.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate
	    FROM credit_account_application
	    INNER JOIN credit_account ON credit_account_application.account_number = credit_account.account_number;
	
	CREATE OR REPLACE VIEW staff.loan_applications AS
	    SELECT loan_application.id, loan_application.application_status, loan.id as loan_id, loan.amount, loan.end_date, loan.loan_type, loan.interest_rate, loan.account_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE VIEW staff.customers AS
	    SELECT online_account.id as account_id, customer.first_name, customer.last_name
	    FROM online_account
	    INNER JOIN customer ON customer.id = online_account.customer_id;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_credit_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, account_number INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, credit_account_applications.account_number
	    FROM staff.customers
	    INNER JOIN staff.accounts ON customers.account_id = accounts.account_id
	    INNER JOIN staff.credit_card_applications ON accounts.account_number = credit_card_applications.account_number
	    WHERE credit_card_applications.application_status = 'PENDING';
2023-01-16 21:44:39.619 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.619 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$" at character 1
2023-01-16 21:44:39.619 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION staff.view_outstanding_loan_applications()
	RETURNS TABLE(first_name TEXT, last_name TEXT, loan_id INT) AS $$
	BEGIN
	    RETURN QUERY SELECT customers.first_name, customers.last_name, loan_applications.id
	    FROM staff.customers
	    INNER JOIN staff.loan_applications ON loan_applications.account_id = customers.account_id
	    WHERE loan_applications.application_status = 'PENDING';
2023-01-16 21:44:39.620 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.620 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- CREATE OR REPLACE FUNCTION staff.view_personal_information(first_name, last_name);
	-- RETURNS TABLE(first_name TEXT, last_name TEXT, )
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON accounts.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON accounts.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON accounts.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON accounts.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT accounts.account_id, accounts.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON accounts.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.620 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- CREATE OR REPLACE FUNCTION staff.view_personal_information(first_name, last_name);
	-- RETURNS TABLE(first_name TEXT, last_name TEXT, )
	
	
	CREATE SCHEMA IF NOT EXISTS client;
	SET search_path TO public, client;
	
	
	CREATE OR REPLACE VIEW client.accounts AS
	    SELECT account.account_number, account.account_id, online_account.sort_code FROM account
	    INNER JOIN online_account ON account.account_id = online_account.id;
	
	CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, debit_account.current_balance, debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate
	    FROM client.accounts
	    INNER JOIN debit_account ON accounts.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON accounts.account_number = debit_overdraft.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
	
	CREATE OR REPLACE VIEW client.credit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, credit_account.outstanding_balance, credit_account.credit_limit, credit_account.interest_rate, credit_account_application.application_status
	    FROM client.accounts
	    INNER JOIN credit_account ON accounts.account_number = credit_account.account_number
	    INNER JOIN credit_account_application ON accounts.account_number = credit_account_application.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statements AS
	    SELECT credit_accounts.account_id, credit_accounts.account_number, credit_statement.id, credit_statement.starting_date, credit_statement.end_date, credit_statement.amount, credit_statement.minimum_payment, credit_statement.minimum_payment_due_date
	    FROM credit_accounts
	    INNER JOIN credit_statement ON credit_accounts.account_number = credit_statement.account_number;
	
	CREATE OR REPLACE VIEW client.credit_accounts_statement AS
	    SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.id, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount AS total_amount, credit_accounts_statements.minimum_payment, credit_accounts_statements.minimum_payment_due_date, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM credit_accounts_statements
	    INNER JOIN transaction ON credit_accounts_statements.id = transaction.credit_statement_id;
	
	CREATE OR REPLACE VIEW client.savings_accounts AS
	    SELECT accounts.account_id, accounts.account_number, savings_account.current_balance, savings_account.interest_rate
	    FROM client.accounts
	    INNER JOIN savings_account ON accounts.account_number = savings_account.account_number;
	
	CREATE OR REPLACE VIEW client.savings_accounts_statements AS
	    SELECT savings_accounts.account_id, savings_accounts.account_number, savings_statement.id, savings_statement.starting_date, savings_statement.end_date, savings_statement.amount
	    FROM savings_accounts
	    INNER JOIN savings_statement ON savings_accounts.account_number = savings_statement.account_number;
	
	CREATE OR REPLACE VIEW client.loans AS
	    SELECT loan.account_id, loan.id, loan.amount, loan.interest_rate, loan.loan_type, loan.end_date, loan_application.application_status
	    FROM loan
	    INNER JOIN loan_application ON loan.id = loan_application.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
	
	CREATE OR REPLACE VIEW client.loan_applications AS
	    SELECT loan.account_id, loan_application.id, loan_application.application_status, loan_application.loan_id
	    FROM loan_application
	    INNER JOIN loan ON loan_application.loan_id = loan.id;
	
	CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT, first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT, account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  BEGIN
	    UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.621 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_password(account_identifier INT, new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  BEGIN
	    UPDATE user_login SET password = md5(new_password)
	    WHERE account_id = account_identifier;
2023-01-16 21:44:39.621 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.621 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.622 GMT [98554] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 21:44:39.622 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
2023-01-16 21:44:39.622 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.622 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.622 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.622 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.622 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.622 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.622 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.update_email(account_identifier INT, new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.622 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.622 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.623 GMT [98554] ERROR:  syntax error at or near "UPDATE" at character 11
2023-01-16 21:44:39.623 GMT [98554] STATEMENT:  BEGIN
	    UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier;
2023-01-16 21:44:39.623 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.623 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.623 GMT [98554] ERROR:  column "account_identifier" does not exist at character 76
2023-01-16 21:44:39.623 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
2023-01-16 21:44:39.623 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.623 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.624 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.624 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.624 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.625 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.625 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.open_debit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.625 GMT [98554] ERROR:  syntax error at or near "INT" at character 30
2023-01-16 21:44:39.625 GMT [98554] STATEMENT:  DECLARE debit_account_number INT;
2023-01-16 21:44:39.625 GMT [98554] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 21:44:39.625 GMT [98554] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 21:44:39.625 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.625 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.625 GMT [98554] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 21:44:39.625 GMT [98554] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 21:44:39.626 GMT [98554] ERROR:  syntax error at or near "INTO" at character 163
2023-01-16 21:44:39.626 GMT [98554] STATEMENT:  INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number INTO debit_account_number;
2023-01-16 21:44:39.626 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.626 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.626 GMT [98554] ERROR:  column "debit_account_number" does not exist at character 189
2023-01-16 21:44:39.626 GMT [98554] STATEMENT:  INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number);
2023-01-16 21:44:39.627 GMT [98554] ERROR:  column "debit_account_number" does not exist at character 115
2023-01-16 21:44:39.627 GMT [98554] STATEMENT:  INSERT INTO debit_overdraft (overdraft_usage, overdraft_limit, interest_rate, account_number) VALUES (0, 0, 0.01, debit_account_number);
2023-01-16 21:44:39.627 GMT [98554] ERROR:  column "account_id" does not exist at character 76
2023-01-16 21:44:39.627 GMT [98554] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.627 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened debit account', CURRENT_DATE);
2023-01-16 21:44:39.627 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.627 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.627 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.627 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.627 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.628 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.628 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_credit_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.628 GMT [98554] ERROR:  syntax error at or near "INT" at character 31
2023-01-16 21:44:39.628 GMT [98554] STATEMENT:  DECLARE credit_account_number INT;
2023-01-16 21:44:39.628 GMT [98554] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 21:44:39.628 GMT [98554] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 21:44:39.628 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.628 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.629 GMT [98554] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 21:44:39.629 GMT [98554] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 21:44:39.629 GMT [98554] ERROR:  syntax error at or near "INTO" at character 185
2023-01-16 21:44:39.629 GMT [98554] STATEMENT:  INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number INTO credit_account_number;
2023-01-16 21:44:39.629 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.629 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.629 GMT [98554] ERROR:  column "credit_account_number" does not exist at character 250
2023-01-16 21:44:39.629 GMT [98554] STATEMENT:  INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number);
2023-01-16 21:44:39.630 GMT [98554] ERROR:  column "credit_account_number" does not exist at character 85
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  INSERT INTO credit_account_application (account_number, application_status) VALUES (credit_account_number, 'PENDING');
2023-01-16 21:44:39.630 GMT [98554] ERROR:  column "account_id" does not exist at character 76
2023-01-16 21:44:39.630 GMT [98554] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened credit account', CURRENT_DATE);
2023-01-16 21:44:39.630 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.630 GMT [98554] ERROR:  syntax error at or near "return" at character 1
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  return PASSED;
2023-01-16 21:44:39.630 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$" at character 5
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  END
	$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_savings_account(account_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.630 GMT [98554] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 21:44:39.630 GMT [98554] STATEMENT:  DECLARE savings_account_id INT;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  DECLARE next_account_number INT;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  syntax error at or near "SELECT" at character 11
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  BEGIN
	    SELECT get_next_account_number() INTO next_account_number;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  syntax error at or near "INTO" at character 169
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number INTO savings_account_id;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.631 GMT [98554] ERROR:  column "savings_account_id" does not exist at character 191
2023-01-16 21:44:39.631 GMT [98554] STATEMENT:  INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id);
2023-01-16 21:44:39.632 GMT [98554] ERROR:  column "account_id" does not exist at character 76
2023-01-16 21:44:39.632 GMT [98554] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened savings account', CURRENT_DATE);
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.632 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.open_loan(account_id INT, loan_amount INT, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "INT" at character 17
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  DECLARE loan_id INT;
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  BEGIN
	    INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id INTO loan_id;
2023-01-16 21:44:39.632 GMT [98554] ERROR:  syntax error at or near "GET" at character 1
2023-01-16 21:44:39.632 GMT [98554] STATEMENT:  GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
2023-01-16 21:44:39.633 GMT [98554] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 21:44:39.633 GMT [98554] STATEMENT:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id);
2023-01-16 21:44:39.633 GMT [98554] ERROR:  column "loan_id" does not exist at character 68
2023-01-16 21:44:39.633 GMT [98554] HINT:  There is a column named "loan_id" in table "loan_application", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.633 GMT [98554] STATEMENT:  INSERT INTO loan_application (loan_id, application_status) VALUES (loan_id, 'PENDING');
2023-01-16 21:44:39.633 GMT [98554] ERROR:  column "account_id" does not exist at character 76
2023-01-16 21:44:39.633 GMT [98554] HINT:  There is a column named "account_id" in table "management_log", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.633 GMT [98554] STATEMENT:  INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Opened loan', CURRENT_DATE);
2023-01-16 21:44:39.633 GMT [98554] ERROR:  syntax error at or near "passed" at character 1
2023-01-16 21:44:39.633 GMT [98554] STATEMENT:  passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
2023-01-16 21:44:39.633 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.633 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.633 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.634 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$" at character 1
2023-01-16 21:44:39.634 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_personal_information(account_id INT)
	RETURNS TABLE (first_name TEXT, last_name TEXT, email TEXT, phone_number TEXT, address TEXT, city TEXT, country TEXT, postal_code TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT first_name, last_name, email, phone_number, address, city, country, postal_code
	            FROM customer
	        INNER JOIN account ON account.customer_id = customer.id
	        WHERE account.id = account_id;
2023-01-16 21:44:39.634 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.634 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$" at character 1
2023-01-16 21:44:39.634 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_accounts(account_identifier INT)
	RETURNS TABLE (account_number INT, account_id INT, balance NUMERIC, interest_rate NUMERIC, account_type TEXT) AS $$
	BEGIN
	    RETURN QUERY
	        SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier;
2023-01-16 21:44:39.634 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.634 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 21:44:39.634 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, overdraft_limit NUMERIC, overdraft_usage NUMERIC, overdraft_interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed debit accounts', CURRENT_DATE);
2023-01-16 21:44:39.634 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.634 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.debit_accounts WHERE account_id = account_id;
2023-01-16 21:44:39.634 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.635 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 21:44:39.635 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_accounts(account_id INT)
	RETURNS TABLE (id INT, outstanding_balance NUMERIC, credit_limit NUMERIC, interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit accounts', CURRENT_DATE);
2023-01-16 21:44:39.635 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.635 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.credit_accounts WHERE account_id = account_id;
2023-01-16 21:44:39.635 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.635 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$" at character 1
2023-01-16 21:44:39.635 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_accounts(account_id INT)
	RETURNS TABLE (id INT, current_balance NUMERIC, interest_rate NUMERIC, external_account_number INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings accounts', CURRENT_DATE);
2023-01-16 21:44:39.635 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.635 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.savings_accounts WHERE account_id = account_id;
2023-01-16 21:44:39.636 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.636 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$" at character 1
2023-01-16 21:44:39.636 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_loans(account_id INT)
	RETURNS TABLE (id INT, loan_amount NUMERIC, loan_end_date DATE, loan_type TEXT, loan_interest_rate NUMERIC, application_status TEXT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed loans', CURRENT_DATE);
2023-01-16 21:44:39.636 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.636 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT * FROM client.loans WHERE account_id = account_id;
2023-01-16 21:44:39.636 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.636 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.636 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statements(account_identifier INT, orig_account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
2023-01-16 21:44:39.637 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.637 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = orig_account_number
	        AND savings_accounts_statements.account_id = account_identifier;
2023-01-16 21:44:39.637 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.637 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.637 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
2023-01-16 21:44:39.638 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.638 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number
	        AND debit_accounts_statements.account_id = account_identifier;
2023-01-16 21:44:39.638 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.639 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.639 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statements(account_identifier INT, account_number INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
2023-01-16 21:44:39.639 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.639 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number
	        AND credit_accounts_statements.account_id = account_identifier;
2023-01-16 21:44:39.639 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.639 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.639 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_debit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statement', CURRENT_DATE);
2023-01-16 21:44:39.639 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.639 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT debit_accounts_statement.account_id, debit_accounts_statement.account_number, debit_accounts_statement.starting_date, debit_accounts_statement.end_date, debit_accounts_statement.amount
	        FROM client.debit_accounts_statement
	        WHERE debit_accounts_statement.account_id = account_identifier
	        AND debit_accounts_statement.account_number = account_number
	        AND debit_accounts_statement.statement_id = statement_id;
2023-01-16 21:44:39.640 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.640 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.640 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_credit_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed credit statement', CURRENT_DATE);
2023-01-16 21:44:39.640 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.640 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id;
2023-01-16 21:44:39.640 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.640 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$" at character 1
2023-01-16 21:44:39.640 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.view_savings_statement(account_identifier INT, account_number INT, statement_id INT)
	RETURNS TABLE (starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
2023-01-16 21:44:39.640 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.640 GMT [98554] STATEMENT:  RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id;
2023-01-16 21:44:39.641 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.641 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$" at character 1
2023-01-16 21:44:39.641 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.get_or_create_statement(account_identifier INT, orig_account_number INT)
	RETURNS INT AS $$
	DECLARE statement_id INT;
2023-01-16 21:44:39.641 GMT [98554] ERROR:  syntax error at or near "CASE" at character 11
2023-01-16 21:44:39.641 GMT [98554] STATEMENT:  BEGIN
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.641 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.641 GMT [98554] STATEMENT:  RETURN statement_id;
2023-01-16 21:44:39.641 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.641 GMT [98554] STATEMENT:  ELSE 
	            INSERT INTO debit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 21:44:39.643 GMT [98554] ERROR:  column "orig_account_number" does not exist at character 73
2023-01-16 21:44:39.643 GMT [98554] STATEMENT:  SELECT id INTO statement_id FROM debit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.644 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.644 GMT [98554] STATEMENT:  RETURN statement_id;
2023-01-16 21:44:39.644 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.644 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.644 GMT [98554] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 21:44:39.644 GMT [98554] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.644 GMT [98554] ERROR:  syntax error at or near "return" at character 1
2023-01-16 21:44:39.644 GMT [98554] STATEMENT:  return statement_id;
2023-01-16 21:44:39.644 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.644 GMT [98554] STATEMENT:  ELSE 
	            INSERT INTO credit_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 21:44:39.645 GMT [98554] ERROR:  column "orig_account_number" does not exist at character 74
2023-01-16 21:44:39.645 GMT [98554] STATEMENT:  SELECT id INTO statement_id FROM credit_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.645 GMT [98554] ERROR:  syntax error at or near "return" at character 1
2023-01-16 21:44:39.645 GMT [98554] STATEMENT:  return statement_id;
2023-01-16 21:44:39.645 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.645 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.645 GMT [98554] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 21:44:39.645 GMT [98554] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        IF EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date) THEN
	            SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "return" at character 1
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  return statement_id;
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  ELSE
	            INSERT INTO savings_statement (account_number, starting_date, end_date, amount) VALUES (orig_account_number, date_trunc('month', now()::date), now()::date + 30, 0);
2023-01-16 21:44:39.646 GMT [98554] ERROR:  column "orig_account_number" does not exist at character 75
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  SELECT id INTO statement_id FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date;
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "return" at character 1
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  return statement_id;
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  END CASE;
2023-01-16 21:44:39.646 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.646 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC, transfer_account_sort_code INT, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.646 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC, transfer_account_sort_code INT, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "INT" at character 22
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  DECLARE statement_id INT;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "INT" at character 24
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  DECLARE transaction_id INT;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "CASE" at character 1
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "INTO" at character 284
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  column "transaction_id" does not exist at character 71
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true, is_loan_payment);
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  syntax error at or near "INTO" at character 285
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
2023-01-16 21:44:39.647 GMT [98554] ERROR:  column "transaction_id" does not exist at character 71
2023-01-16 21:44:39.647 GMT [98554] STATEMENT:  INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true, is_loan_payment);
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "WHEN" at character 1
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "INTO" at character 286
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
2023-01-16 21:44:39.648 GMT [98554] ERROR:  column "transaction_id" does not exist at character 71
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true, is_loan_payment);
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'Account does not exist';
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  RETURN FALSE;
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "CASE" at character 5
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  END CASE;
2023-01-16 21:44:39.648 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.648 GMT [98554] STATEMENT:  RETURN TRUE;
2023-01-16 21:44:39.648 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.649 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.649 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.649 GMT [98554] ERROR:  syntax error at or near "INT" at character 29
2023-01-16 21:44:39.649 GMT [98554] STATEMENT:  DECLARE internal_account_id INT;
2023-01-16 21:44:39.649 GMT [98554] ERROR:  syntax error at or near "INT" at character 19
2023-01-16 21:44:39.649 GMT [98554] STATEMENT:  DECLARE ROW_COUNT INT;
2023-01-16 21:44:39.649 GMT [98554] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 21:44:39.649 GMT [98554] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "INTO" at character 164
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code) INTO passed;
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.650 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.initiate_loan_payment(account_identifier INT, orig_account_number INT, payment_amount NUMERIC, loan_id INT)
	RETURNS BOOLEAN AS $$" at character 1
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	CREATE OR REPLACE FUNCTION client.initiate_loan_payment(account_identifier INT, orig_account_number INT, payment_amount NUMERIC, loan_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "INSERT" at character 11
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated loan payment', CURRENT_DATE);
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "INTO" at character 128
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE) INTO passed;
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  RETURN passed;
2023-01-16 21:44:39.650 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.650 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	 
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$" at character 1
2023-01-16 21:44:39.650 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	 
	
	CREATE SCHEMA IF NOT EXISTS unauthenticated;
	SET search_path TO unauthenticated, public;
	
	-- Allows an unauthenticated user to match hashes to hashes of personal information contained in the customer table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_personal_information AS
	SELECT id, md5(first_name) AS first_name, md5(last_name) AS last_name, md5(email_address) AS email_address
	FROM customer;
	
	-- Allows an unauthenticated user to view hashes of usernames contained in the user_login table
	CREATE OR REPLACE VIEW unauthenticated.unauthenticated_login AS
	SELECT md5(username) AS username FROM user_login;
	
	-- Allows a user to insert personal information into the online banking system
	CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name TEXT, last_name TEXT, date_of_birth DATE, phone_number TEXT, email_address TEXT, address_street TEXT, address_city TEXT, address_county TEXT, address_postcode TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
2023-01-16 21:44:39.651 GMT [98554] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 21:44:39.651 GMT [98554] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	        RETURNING id INTO customer_id;
2023-01-16 21:44:39.653 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.653 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
2023-01-16 21:44:39.654 GMT [98554] ERROR:  relation "unauthenticated.unauthenticated_personal_information" does not exist at character 33
2023-01-16 21:44:39.654 GMT [98554] STATEMENT:  SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address;
2023-01-16 21:44:39.654 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.654 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.654 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.654 GMT [98554] STATEMENT:  RETURN customer_id;
2023-01-16 21:44:39.654 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.654 GMT [98554] ERROR:  syntax error at or near "$$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$" at character 1
2023-01-16 21:44:39.654 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	-- Allows an unauthenticated user to create an online account
	CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(customer_id INT, first_name TEXT, last_name TEXT, email_address TEXT, question_choice_ids INT[], question_answers TEXT[])
	RETURNS INT AS $$
	DECLARE account_id INT;
2023-01-16 21:44:39.654 GMT [98554] ERROR:  syntax error at or near "INT" at character 27
2023-01-16 21:44:39.654 GMT [98554] STATEMENT:  DECLARE online_account_id INT;
2023-01-16 21:44:39.655 GMT [98554] ERROR:  syntax error at or near "INT" at character 28
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  DECLARE question_choice_id INT;
2023-01-16 21:44:39.655 GMT [98554] ERROR:  syntax error at or near "IF" at character 11
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  BEGIN
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id)
	        RETURNING id INTO account_id;
2023-01-16 21:44:39.655 GMT [98554] ERROR:  syntax error at or near "INTO" at character 131
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username, md5(password))
	        RETURNING id INTO online_account_id;
2023-01-16 21:44:39.655 GMT [98554] ERROR:  syntax error at or near "FOR" at character 1
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids[i], online_account_id)
	            RETURNING id INTO question_choice_id;
2023-01-16 21:44:39.655 GMT [98554] ERROR:  column "answer" of relation "security_question_answer" does not exist at character 39
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers[i], question_choice_id);
2023-01-16 21:44:39.655 GMT [98554] ERROR:  syntax error at or near "LOOP" at character 5
2023-01-16 21:44:39.655 GMT [98554] STATEMENT:  END LOOP;
2023-01-16 21:44:39.656 GMT [98554] ERROR:  column "account_id" does not exist at character 117
2023-01-16 21:44:39.656 GMT [98554] HINT:  There is a column named "account_id" in table "authentication_log", but it cannot be referenced from this part of the query.
2023-01-16 21:44:39.656 GMT [98554] STATEMENT:  INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
2023-01-16 21:44:39.656 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.656 GMT [98554] STATEMENT:  RETURN account_id;
2023-01-16 21:44:39.656 GMT [98554] ERROR:  syntax error at or near "ELSE" at character 1
2023-01-16 21:44:39.656 GMT [98554] STATEMENT:  ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
2023-01-16 21:44:39.657 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.657 GMT [98554] STATEMENT:  RETURN NULL;
2023-01-16 21:44:39.657 GMT [98554] ERROR:  syntax error at or near "IF" at character 5
2023-01-16 21:44:39.657 GMT [98554] STATEMENT:  END IF;
2023-01-16 21:44:39.657 GMT [98554] ERROR:  syntax error at or near "RETURN" at character 1
2023-01-16 21:44:39.657 GMT [98554] STATEMENT:  RETURN success;
2023-01-16 21:44:39.657 GMT [98554] WARNING:  there is no transaction in progress
2023-01-16 21:44:39.658 GMT [98554] ERROR:  unterminated dollar-quoted string at or near "$$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM transaction;
	
	SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
	
	SELECT * FROM pending_transaction;
	
	
	--SELECT * FROM bank.verify_transaction(1);
	
	
	SELECT * FROM client.view_accounts(1);
	
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;" at character 1
2023-01-16 21:44:39.658 GMT [98554] STATEMENT:  $$ LANGUAGE plpgsql;
	
	
	
	
	
	-- sample data for customers
	INSERT INTO customer (first_name, last_name, date_of_birth, phone_number, email_address, address_street, address_city, address_county, address_postcode)
	VALUES ('John', 'Smith', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('Jane', 'Doe', '1990-01-01', '01234567890', 'test@gmail.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Bloggs', '1990-01-01', '01234567890', 'example@gmail.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX'),
	('John', 'Bloggs', '1990-01-01', '01234567890', 'hello@yahoo.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('Jane', 'Bloggs', '1990-01-01', '01234567890', 'test@outlook.com', '1 Test Street', 'Test City', 'Test County', 'TE1 1ST'),
	('Joe', 'Doe', '1990-01-01', '01234567890', 'hello@outlook.com', '1 Hello Street', 'Hello City', 'Hello County', 'HE1 1LO'),
	('John', 'Doe', '1990-01-01', '01234567890', 'mybankemail@icloud.com', '1 My Bank Street', 'My Bank City', 'My Bank County', 'MB1 1NK'),
	('Jane', 'Smith', '1990-01-01', '01234567890', 'bankemail@outlook.com', '1 Bank Street', 'Bank City', 'Bank County', 'BA1 1NK'),
	('Joe', 'Smith', '1990-01-01', '01234567890', 'example@icloud.com', '1 Example Street', 'Example City', 'Example County', 'EX1 1EX');
	
	-- sample data for online account
	INSERT INTO online_account (date_opened, sort_code, customer_id)
	VALUES ('2020-01-01', '123456', 1),
	('2019-01-01', '126485', 2),
	('2018-01-01', '128475', 3),
	('2017-01-01', '129476', 4),
	('2016-01-01', '120386', 5),
	('2017-02-03', '127385', 6),
	('2018-02-04', '128256', 7),
	('2020-01-01', '129386', 8),
	('2020-01-01', '120386', 9);
	
	-- sample data for user login
	INSERT INTO user_login (account_id, username, password)
	VALUES (1, 'johnsmith', 'b29af57c2b3bba21e9df0cece40952c6'),
	(2, 'janedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(3, 'joebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(4, 'johnbloggs', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(5, 'janebloggs', 'b29af57c2b3bba21e9df0cece40952c6'),
	(6, 'joedoe', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(7, 'johndoe', 'b29af57c2b3bba21e9df0cece40952c6'),
	(8, 'joesmith', 'ee02f771bbeb15b28ccd7bbd68faf193'),
	(9, 'janesmith', 'b29af57c2b3bba21e9df0cece40952c6');
	
	-- sample data for security question option
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
	
	--sample data for user login security question
	INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
	
	-- sample data for security question answer
	INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
	
	SELECT * FROM savings_statement;
	
	
	SELECT * FROM client.open_savings_account(1);
	
	--sample data for savings account
	SELECT * FROM client.open_savings_account(1);
	SELECT * FROM client.open_savings_account(2);
	SELECT * FROM client.open_savings_account(3);
	SELECT * FROM client.open_savings_account(4);
	
	SELECT * FROM client.open_debit_account(1);
	SELECT * FROM client.open_debit_account(2);
	SELECT * FROM client.open_debit_account(3);
	SELECT * FROM client.open_debit_account(4);
	
	SELECT * FROM client.open_credit_account(1);
	SELECT * FROM client.open_credit_account(2);
	SELECT * FROM client.open_credit_account(3);
	SELECT * FROM client.open_credit_account(4);
	
	SELECT * FROM client.view_accounts(1);
	
	SELECT * FROM transaction;
	
	SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
	
	SELECT * FROM pending_transaction;
	
	
	--SELECT * FROM bank.verify_transaction(1);
	
	
	SELECT * FROM client.view_accounts(1);
	
	
	SELECT * FROM savings_statement;
	
	-- -- sample data for savings account
	-- INSERT INTO savings_account (current_balance, interest_rate, account_id)
	-- VALUES (2000.00, 2.05, 1),
	-- (1000.00, 2.05, 2),
	-- (5000.00, 2.05, 3),
	-- (10000.00, 2.05, 4),
	-- (20000.00, 2.05, 5),
	-- (50000.00, 2.05, 6),
	-- (100000.00, 2.05, 7),
	-- (200000.00, 2.05, 8);
	
	-- -- sample data for credit account
	-- INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	-- VALUES (55.43, 2000.00, 4.22, 1),
	-- (100.00, 1000.00, 4.22, 2),
	-- (200.00, 5000.00, 4.22, 3),
	-- (300.00, 10000.00, 4.22, 4),
	-- (400.00, 20000.00, 4.22, 5),
	-- (500.00, 50000.00, 4.22, 6),
	-- (600.00, 100000.00, 4.22, 7),
	-- (700.00, 200000.00, 4.22, 8);
	
	-- -- sample data for debit account
	-- INSERT INTO debit_account (current_balance, interest_rate, account_id)
	-- VALUES (3465.43, 0.05, 1),
	-- (1000.00, 0.05, 1),
	-- (5000.00, 0.05, 2),
	-- (10000.00, 0.05, 3),
	-- (20000.00, 0.05, 4),
	-- (50000.00, 0.05, 5),
	-- (100000.00, 0.05, 6),
	-- (200000.00, 0.05, 9);
	
	-- -- sample data for loan
	-- INSERT INTO loan (loan_end_date, loan_amount, loan_type, account_id)
	-- VALUES ('2024-01-01', 10000, 'vehicle', 8),
	-- ('2023-03-04', 300000, 'mortgage', 8),
	-- ('2035-03-03', 400000, 'mortgage', 1),
	-- ('2025-04-05', 25000, 'vehicle', 1),
	-- ('2026-05-05', 34000, 'vehicle', 1),
	-- ('2023-06-07', 500000, 'mortgage', 2),
	-- ('2026-04-04', 60000, 'vehicle', 2),
	-- ('2024-03-03', 70000, 'vehicle', 2),
	-- ('2023-02-02', 800000, 'mortgage', 3),
	-- ('2022-01-01', 90000, 'vehicle', 3),
	-- ('2021-01-01', 100000, 'vehicle', 3),
	-- ('2020-01-01', 110000, 'mortgage', 4),
	-- ('2020-01-01', 12000, 'vehicle', 4),
	-- ('2020-01-01', 13000, 'vehicle', 4),
	-- ('2020-01-01', 140000, 'mortgage', 5),
	-- ('2020-01-01', 15000, 'vehicle', 5),
	-- ('2020-01-01', 16000, 'vehicle', 5),
	-- ('2020-01-01', 170000, 'mortgage', 6),
	-- ('2020-01-01', 18000, 'vehicle', 6),
	-- ('2020-01-01', 19000, 'vehicle', 6),
	-- ('2020-01-01', 200000, 'mortgage', 7),
	-- ('2020-01-01', 21000, 'vehicle', 7),
	-- ('2020-01-01', 22000, 'vehicle', 7);
	
	-- CREATE SCHEMA IF NOT EXISTS staff;
	
	-- SET search_path TO public, staff;
2023-01-16 21:46:04.532 GMT [98528] LOG:  received fast shutdown request
2023-01-16 21:46:04.534 GMT [98528] LOG:  aborting any active transactions
2023-01-16 21:46:04.541 GMT [98528] LOG:  background worker "logical replication launcher" (PID 98535) exited with exit code 1
2023-01-16 21:46:04.544 GMT [98530] LOG:  shutting down
2023-01-16 21:46:04.590 GMT [98528] LOG:  database system is shut down
2023-01-16 21:46:05.872 GMT [98877] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:46:05.873 GMT [98877] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:46:05.875 GMT [98877] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:46:05.880 GMT [98878] LOG:  database system was shut down at 2023-01-16 21:46:05 GMT
2023-01-16 21:46:05.887 GMT [98877] LOG:  database system is ready to accept connections
2023-01-16 21:46:06.758 GMT [98903] ERROR:  syntax error at or near ";" at character 3006
2023-01-16 21:46:06.758 GMT [98903] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT dest_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	
	        IF is_loan_payment = TRUE THEN
	            IF bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                    transaction_approved = TRUE;
	                ELSE
	                    transaction_approved = FALSE;
	                END IF;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        IF is_transfer = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_balance_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                    transaction_approved = TRUE;
	                END IF;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        ELSE
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:46:06.914 GMT [98903] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer) does not exist at character 15
2023-01-16 21:46:06.914 GMT [98903] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:46:06.914 GMT [98903] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code)
2023-01-16 21:46:06.914 GMT [98903] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:46:06.914 GMT [98903] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:48:36.574 GMT [98877] LOG:  received fast shutdown request
2023-01-16 21:48:36.577 GMT [98877] LOG:  aborting any active transactions
2023-01-16 21:48:36.581 GMT [98877] LOG:  background worker "logical replication launcher" (PID 98884) exited with exit code 1
2023-01-16 21:48:36.581 GMT [98879] LOG:  shutting down
2023-01-16 21:48:36.630 GMT [98877] LOG:  database system is shut down
2023-01-16 21:48:37.915 GMT [99404] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:48:37.916 GMT [99404] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:48:37.918 GMT [99404] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:48:37.923 GMT [99405] LOG:  database system was shut down at 2023-01-16 21:48:37 GMT
2023-01-16 21:48:37.929 GMT [99404] LOG:  database system is ready to accept connections
2023-01-16 21:48:39.007 GMT [99443] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer) does not exist at character 15
2023-01-16 21:48:39.007 GMT [99443] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:48:39.007 GMT [99443] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code)
2023-01-16 21:48:39.007 GMT [99443] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:48:39.007 GMT [99443] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:50:30.462 GMT [99404] LOG:  received fast shutdown request
2023-01-16 21:50:30.465 GMT [99404] LOG:  aborting any active transactions
2023-01-16 21:50:30.470 GMT [99404] LOG:  background worker "logical replication launcher" (PID 99411) exited with exit code 1
2023-01-16 21:50:30.473 GMT [99406] LOG:  shutting down
2023-01-16 21:50:30.523 GMT [99404] LOG:  database system is shut down
2023-01-16 21:50:31.894 GMT [99840] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:50:31.894 GMT [99840] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:50:31.896 GMT [99840] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:50:31.900 GMT [99843] LOG:  database system was shut down at 2023-01-16 21:50:31 GMT
2023-01-16 21:50:31.907 GMT [99840] LOG:  database system is ready to accept connections
2023-01-16 21:50:33.055 GMT [99891] ERROR:  INSERT has more expressions than target columns at character 114
2023-01-16 21:50:33.055 GMT [99891] QUERY:  INSERT INTO pending_transaction (id, account_id, is_transfer) VALUES (transaction_id, orig_account_number, true, is_loan_payment)
2023-01-16 21:50:33.055 GMT [99891] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:50:33.055 GMT [99891] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:52:18.555 GMT [99840] LOG:  received fast shutdown request
2023-01-16 21:52:18.559 GMT [99840] LOG:  aborting any active transactions
2023-01-16 21:52:18.564 GMT [99840] LOG:  background worker "logical replication launcher" (PID 99849) exited with exit code 1
2023-01-16 21:52:18.564 GMT [99844] LOG:  shutting down
2023-01-16 21:52:18.620 GMT [99840] LOG:  database system is shut down
2023-01-16 21:52:19.965 GMT [100291] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:52:19.966 GMT [100291] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:52:19.968 GMT [100291] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:52:19.975 GMT [100295] LOG:  database system was shut down at 2023-01-16 21:52:19 GMT
2023-01-16 21:52:19.981 GMT [100291] LOG:  database system is ready to accept connections
2023-01-16 21:52:20.949 GMT [100330] ERROR:  syntax error at or near "," at character 3037
2023-01-16 21:52:20.949 GMT [100330] STATEMENT:  CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC, transfer_account_sort_code INT, loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE statement_id INT;
	DECLARE transaction_id INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
	
	    CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE debit_account SET current_balance = current_balance - transaction_amount WHERE debit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment);
	
	    WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE credit_account SET outstanding_balance = outstanding_balance - transaction_amount WHERE credit_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment);
	
	    WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	        --UPDATE savings_account SET current_balance = current_balance - transaction_amount WHERE savings_account.account_number = orig_account_number;
	        SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	        INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	        INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment), VALUES (transaction_id, orig_account_number, true, loan_payment);
	    ELSE
	        RAISE NOTICE 'Account does not exist';
	        RETURN FALSE;
	    END CASE;
	    RETURN TRUE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:52:21.021 GMT [100330] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-16 21:52:21.021 GMT [100330] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:52:21.021 GMT [100330] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)
2023-01-16 21:52:21.021 GMT [100330] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:52:21.021 GMT [100330] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:52:45.167 GMT [100291] LOG:  received fast shutdown request
2023-01-16 21:52:45.169 GMT [100291] LOG:  aborting any active transactions
2023-01-16 21:52:45.171 GMT [100291] LOG:  background worker "logical replication launcher" (PID 100301) exited with exit code 1
2023-01-16 21:52:45.178 GMT [100296] LOG:  shutting down
2023-01-16 21:52:45.234 GMT [100291] LOG:  database system is shut down
2023-01-16 21:52:46.710 GMT [100481] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:52:46.710 GMT [100481] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:52:46.712 GMT [100481] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:52:46.717 GMT [100482] LOG:  database system was shut down at 2023-01-16 21:52:46 GMT
2023-01-16 21:52:46.726 GMT [100481] LOG:  database system is ready to accept connections
2023-01-16 21:55:32.532 GMT [100481] LOG:  received fast shutdown request
2023-01-16 21:55:32.533 GMT [100481] LOG:  aborting any active transactions
2023-01-16 21:55:32.537 GMT [100481] LOG:  background worker "logical replication launcher" (PID 100488) exited with exit code 1
2023-01-16 21:55:32.542 GMT [100483] LOG:  shutting down
2023-01-16 21:55:32.602 GMT [100481] LOG:  database system is shut down
2023-01-16 21:55:33.887 GMT [101089] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:55:33.887 GMT [101089] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:55:33.889 GMT [101089] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:55:33.895 GMT [101090] LOG:  database system was shut down at 2023-01-16 21:55:33 GMT
2023-01-16 21:55:33.902 GMT [101089] LOG:  database system is ready to accept connections
2023-01-16 21:55:34.778 GMT [101117] ERROR:  syntax error at or near ";" at character 2928
2023-01-16 21:55:34.778 GMT [101117] STATEMENT:  CREATE OR REPLACE FUNCTION bank.verify_and_update_transaction_amounts(pending_transaction_id INT, is_transfer BOOLEAN, is_loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE transaction_approved BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	
	    
	    IF EXISTS (SELECT * FROM bank.accounts WHERE account_number = (SELECT dest_account_id FROM bank.pending_transactions WHERE id = pending_transaction_id) AND sort_code = (SELECT sort_code FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	        RAISE NOTICE 'INTERNAL TRANSFER OCCURING';
	
	        IF is_loan_payment = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                    transaction_approved = TRUE;
	                END IF;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        IF is_transfer = TRUE THEN
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                IF bank.update_balance_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	                    transaction_approved = TRUE;
	                END IF;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	
	        ELSE
	            IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE THEN
	                transaction_approved = TRUE;
	            ELSE
	                transaction_approved = FALSE;
	            END IF;
	
	            DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    ELSE
	        RAISE NOTICE 'EXTERNAL TRANSFER OCCURING';
	        IF bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) THEN
	            transaction_approved = TRUE;
	        ELSE
	            transaction_approved = FALSE;
	        DELETE FROM pending_transaction WHERE id = pending_transaction_id;
	        END IF;
	    END IF;
	
	
	    RETURN transaction_approved;
	END;
	$$ LANGUAGE plpgsql;
2023-01-16 21:55:34.947 GMT [101117] ERROR:  function bank.verify_and_update_transaction_amounts(integer, boolean, boolean) does not exist at character 15
2023-01-16 21:55:34.947 GMT [101117] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 21:55:34.947 GMT [101117] QUERY:  SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)
2023-01-16 21:55:34.947 GMT [101117] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 9 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 21:55:34.947 GMT [101117] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 21:55:53.578 GMT [101089] LOG:  received fast shutdown request
2023-01-16 21:55:53.580 GMT [101089] LOG:  aborting any active transactions
2023-01-16 21:55:53.586 GMT [101089] LOG:  background worker "logical replication launcher" (PID 101096) exited with exit code 1
2023-01-16 21:55:53.587 GMT [101091] LOG:  shutting down
2023-01-16 21:55:53.648 GMT [101089] LOG:  database system is shut down
2023-01-16 21:55:54.995 GMT [101257] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 21:55:54.995 GMT [101257] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 21:55:55.004 GMT [101257] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 21:55:55.038 GMT [101258] LOG:  database system was shut down at 2023-01-16 21:55:54 GMT
2023-01-16 21:55:55.044 GMT [101257] LOG:  database system is ready to accept connections
2023-01-16 22:00:21.317 GMT [101257] LOG:  received fast shutdown request
2023-01-16 22:00:21.320 GMT [101257] LOG:  aborting any active transactions
2023-01-16 22:00:21.326 GMT [101257] LOG:  background worker "logical replication launcher" (PID 101264) exited with exit code 1
2023-01-16 22:00:21.327 GMT [101259] LOG:  shutting down
2023-01-16 22:00:21.382 GMT [101257] LOG:  database system is shut down
2023-01-16 22:00:22.701 GMT [102165] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:00:22.701 GMT [102165] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:00:22.702 GMT [102165] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:00:22.708 GMT [102166] LOG:  database system was shut down at 2023-01-16 22:00:22 GMT
2023-01-16 22:00:22.714 GMT [102165] LOG:  database system is ready to accept connections
2023-01-16 22:00:23.711 GMT [102195] ERROR:  function client.open_loan(integer, numeric, integer, numeric) does not exist at character 15
2023-01-16 22:00:23.711 GMT [102195] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 22:00:23.711 GMT [102195] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, 22-12-2025, 5.00);
2023-01-16 22:01:01.055 GMT [102165] LOG:  received fast shutdown request
2023-01-16 22:01:01.057 GMT [102165] LOG:  aborting any active transactions
2023-01-16 22:01:01.064 GMT [102165] LOG:  background worker "logical replication launcher" (PID 102172) exited with exit code 1
2023-01-16 22:01:01.066 GMT [102167] LOG:  shutting down
2023-01-16 22:01:01.119 GMT [102165] LOG:  database system is shut down
2023-01-16 22:01:02.320 GMT [102387] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:01:02.320 GMT [102387] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:01:02.322 GMT [102387] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:01:02.327 GMT [102388] LOG:  database system was shut down at 2023-01-16 22:01:02 GMT
2023-01-16 22:01:02.333 GMT [102387] LOG:  database system is ready to accept connections
2023-01-16 22:01:03.360 GMT [102416] ERROR:  function client.open_loan(integer, numeric, integer, unknown, numeric) does not exist at character 15
2023-01-16 22:01:03.360 GMT [102416] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 22:01:03.360 GMT [102416] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, 22-12-2025, 'vehicle', 5.00);
2023-01-16 22:01:29.384 GMT [102387] LOG:  received fast shutdown request
2023-01-16 22:01:29.386 GMT [102387] LOG:  aborting any active transactions
2023-01-16 22:01:29.391 GMT [102387] LOG:  background worker "logical replication launcher" (PID 102394) exited with exit code 1
2023-01-16 22:01:29.394 GMT [102389] LOG:  shutting down
2023-01-16 22:01:29.452 GMT [102387] LOG:  database system is shut down
2023-01-16 22:01:30.705 GMT [102577] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:01:30.705 GMT [102577] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:01:30.707 GMT [102577] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:01:30.714 GMT [102578] LOG:  database system was shut down at 2023-01-16 22:01:30 GMT
2023-01-16 22:01:30.720 GMT [102577] LOG:  database system is ready to accept connections
2023-01-16 22:01:31.656 GMT [102607] ERROR:  function client.open_loan(integer, numeric, integer, text, numeric) does not exist at character 15
2023-01-16 22:01:31.656 GMT [102607] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 22:01:31.656 GMT [102607] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, 22-12-2025, 'vehicle'::TEXT, 5.00);
2023-01-16 22:01:56.797 GMT [102577] LOG:  received fast shutdown request
2023-01-16 22:01:56.800 GMT [102577] LOG:  aborting any active transactions
2023-01-16 22:01:56.804 GMT [102577] LOG:  background worker "logical replication launcher" (PID 102584) exited with exit code 1
2023-01-16 22:01:56.804 GMT [102579] LOG:  shutting down
2023-01-16 22:01:56.869 GMT [102577] LOG:  database system is shut down
2023-01-16 22:01:58.128 GMT [102768] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:01:58.129 GMT [102768] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:01:58.130 GMT [102768] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:01:58.135 GMT [102769] LOG:  database system was shut down at 2023-01-16 22:01:57 GMT
2023-01-16 22:01:58.142 GMT [102768] LOG:  database system is ready to accept connections
2023-01-16 22:01:59.131 GMT [102797] ERROR:  function client.open_loan(integer, numeric, integer, text, numeric) does not exist at character 15
2023-01-16 22:01:59.131 GMT [102797] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-16 22:01:59.131 GMT [102797] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, 22-12-2025, 'vehicle'::TEXT, 5.00);
2023-01-16 22:02:26.687 GMT [102768] LOG:  received fast shutdown request
2023-01-16 22:02:26.689 GMT [102768] LOG:  aborting any active transactions
2023-01-16 22:02:26.696 GMT [102768] LOG:  background worker "logical replication launcher" (PID 102775) exited with exit code 1
2023-01-16 22:02:26.697 GMT [102770] LOG:  shutting down
2023-01-16 22:02:26.761 GMT [102768] LOG:  database system is shut down
2023-01-16 22:02:28.170 GMT [102964] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:02:28.170 GMT [102964] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:02:28.172 GMT [102964] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:02:28.177 GMT [102965] LOG:  database system was shut down at 2023-01-16 22:02:27 GMT
2023-01-16 22:02:28.184 GMT [102964] LOG:  database system is ready to accept connections
2023-01-16 22:02:29.163 GMT [103000] ERROR:  cannot cast type integer to date at character 55
2023-01-16 22:02:29.163 GMT [103000] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, 22-12-2025::DATE, 'vehicle'::TEXT, 5.00);
2023-01-16 22:02:40.760 GMT [102964] LOG:  received fast shutdown request
2023-01-16 22:02:40.761 GMT [102964] LOG:  aborting any active transactions
2023-01-16 22:02:40.768 GMT [102964] LOG:  background worker "logical replication launcher" (PID 102971) exited with exit code 1
2023-01-16 22:02:40.769 GMT [102966] LOG:  shutting down
2023-01-16 22:02:40.838 GMT [102964] LOG:  database system is shut down
2023-01-16 22:02:42.057 GMT [103131] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:02:42.057 GMT [103131] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:02:42.074 GMT [103131] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:02:42.082 GMT [103135] LOG:  database system was shut down at 2023-01-16 22:02:41 GMT
2023-01-16 22:02:42.089 GMT [103131] LOG:  database system is ready to accept connections
2023-01-16 22:02:43.031 GMT [103160] ERROR:  column "loan_amount" of relation "loan" does not exist at character 31
2023-01-16 22:02:43.031 GMT [103160] QUERY:  INSERT INTO loan (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) VALUES (account_id, loan_amount, loan_end_date, loan_type, loan_interest_rate) RETURNING id
2023-01-16 22:02:43.031 GMT [103160] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-16 22:02:43.031 GMT [103160] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-16 22:03:34.597 GMT [103131] LOG:  received fast shutdown request
2023-01-16 22:03:34.601 GMT [103131] LOG:  aborting any active transactions
2023-01-16 22:03:34.607 GMT [103131] LOG:  background worker "logical replication launcher" (PID 103141) exited with exit code 1
2023-01-16 22:03:34.607 GMT [103136] LOG:  shutting down
2023-01-16 22:03:34.663 GMT [103131] LOG:  database system is shut down
2023-01-16 22:03:36.127 GMT [103407] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:03:36.127 GMT [103407] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:03:36.147 GMT [103407] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:03:36.154 GMT [103408] LOG:  database system was shut down at 2023-01-16 22:03:35 GMT
2023-01-16 22:03:36.164 GMT [103407] LOG:  database system is ready to accept connections
2023-01-16 22:03:37.212 GMT [103443] ERROR:  column "end_date" of relation "loan_statement" does not exist at character 44
2023-01-16 22:03:37.212 GMT [103443] QUERY:  INSERT INTO loan_statement (starting_date, end_date, amount, account_id) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, loan_id)
2023-01-16 22:03:37.212 GMT [103443] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-16 22:03:37.212 GMT [103443] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-16 22:04:11.234 GMT [103407] LOG:  received fast shutdown request
2023-01-16 22:04:11.238 GMT [103407] LOG:  aborting any active transactions
2023-01-16 22:04:11.242 GMT [103407] LOG:  background worker "logical replication launcher" (PID 103414) exited with exit code 1
2023-01-16 22:04:11.245 GMT [103409] LOG:  shutting down
2023-01-16 22:04:11.301 GMT [103407] LOG:  database system is shut down
2023-01-16 22:04:12.601 GMT [103630] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:04:12.601 GMT [103630] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:04:12.603 GMT [103630] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:04:12.608 GMT [103631] LOG:  database system was shut down at 2023-01-16 22:04:12 GMT
2023-01-16 22:04:12.614 GMT [103630] LOG:  database system is ready to accept connections
2023-01-16 22:04:13.776 GMT [103656] ERROR:  column "account_id" of relation "loan_statement" does not exist at character 52
2023-01-16 22:04:13.776 GMT [103656] QUERY:  INSERT INTO loan_statement (starting_date, amount, account_id) VALUES (date_trunc('month', now()::date), 0, loan_id)
2023-01-16 22:04:13.776 GMT [103656] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-16 22:04:13.776 GMT [103656] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-16 22:04:27.100 GMT [103630] LOG:  received fast shutdown request
2023-01-16 22:04:27.102 GMT [103630] LOG:  aborting any active transactions
2023-01-16 22:04:27.107 GMT [103630] LOG:  background worker "logical replication launcher" (PID 103637) exited with exit code 1
2023-01-16 22:04:27.110 GMT [103632] LOG:  shutting down
2023-01-16 22:04:27.170 GMT [103630] LOG:  database system is shut down
2023-01-16 22:04:28.354 GMT [103790] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:04:28.355 GMT [103790] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:04:28.357 GMT [103790] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:04:28.362 GMT [103791] LOG:  database system was shut down at 2023-01-16 22:04:28 GMT
2023-01-16 22:04:28.369 GMT [103790] LOG:  database system is ready to accept connections
2023-01-16 22:04:29.364 GMT [103816] ERROR:  column "starting_date" is of type integer but expression is of type timestamp with time zone at character 69
2023-01-16 22:04:29.364 GMT [103816] HINT:  You will need to rewrite or cast the expression.
2023-01-16 22:04:29.364 GMT [103816] QUERY:  INSERT INTO loan_statement (starting_date, amount, loan_id) VALUES (date_trunc('month', now()::date), 0, loan_id)
2023-01-16 22:04:29.364 GMT [103816] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-16 22:04:29.364 GMT [103816] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-16 22:04:48.544 GMT [103790] LOG:  received fast shutdown request
2023-01-16 22:04:48.546 GMT [103790] LOG:  aborting any active transactions
2023-01-16 22:04:48.552 GMT [103790] LOG:  background worker "logical replication launcher" (PID 103797) exited with exit code 1
2023-01-16 22:04:48.558 GMT [103792] LOG:  shutting down
2023-01-16 22:04:48.614 GMT [103790] LOG:  database system is shut down
2023-01-16 22:04:49.993 GMT [103961] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:04:49.993 GMT [103961] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:04:49.994 GMT [103961] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:04:50.000 GMT [103962] LOG:  database system was shut down at 2023-01-16 22:04:49 GMT
2023-01-16 22:04:50.008 GMT [103961] LOG:  database system is ready to accept connections
2023-01-16 22:05:19.953 GMT [103961] LOG:  received fast shutdown request
2023-01-16 22:05:19.957 GMT [103961] LOG:  aborting any active transactions
2023-01-16 22:05:19.960 GMT [103961] LOG:  background worker "logical replication launcher" (PID 103968) exited with exit code 1
2023-01-16 22:05:19.963 GMT [103963] LOG:  shutting down
2023-01-16 22:05:20.021 GMT [103961] LOG:  database system is shut down
2023-01-16 22:05:21.259 GMT [104163] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:05:21.259 GMT [104163] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:05:21.261 GMT [104163] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:05:21.266 GMT [104164] LOG:  database system was shut down at 2023-01-16 22:05:20 GMT
2023-01-16 22:05:21.273 GMT [104163] LOG:  database system is ready to accept connections
2023-01-16 22:07:13.458 GMT [104163] LOG:  received fast shutdown request
2023-01-16 22:07:13.462 GMT [104163] LOG:  aborting any active transactions
2023-01-16 22:07:13.467 GMT [104163] LOG:  background worker "logical replication launcher" (PID 104170) exited with exit code 1
2023-01-16 22:07:13.467 GMT [104165] LOG:  shutting down
2023-01-16 22:07:13.526 GMT [104163] LOG:  database system is shut down
2023-01-16 22:07:14.755 GMT [104624] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:07:14.755 GMT [104624] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:07:14.757 GMT [104624] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:07:14.762 GMT [104625] LOG:  database system was shut down at 2023-01-16 22:07:14 GMT
2023-01-16 22:07:14.768 GMT [104624] LOG:  database system is ready to accept connections
2023-01-16 22:08:02.182 GMT [104624] LOG:  received fast shutdown request
2023-01-16 22:08:02.185 GMT [104624] LOG:  aborting any active transactions
2023-01-16 22:08:02.190 GMT [104624] LOG:  background worker "logical replication launcher" (PID 104631) exited with exit code 1
2023-01-16 22:08:02.191 GMT [104626] LOG:  shutting down
2023-01-16 22:08:02.251 GMT [104624] LOG:  database system is shut down
2023-01-16 22:08:03.402 GMT [104864] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:08:03.402 GMT [104864] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:08:03.403 GMT [104864] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:08:03.412 GMT [104865] LOG:  database system was shut down at 2023-01-16 22:08:03 GMT
2023-01-16 22:08:03.417 GMT [104864] LOG:  database system is ready to accept connections
2023-01-16 22:09:58.207 GMT [104864] LOG:  received fast shutdown request
2023-01-16 22:09:58.209 GMT [104864] LOG:  aborting any active transactions
2023-01-16 22:09:58.215 GMT [104864] LOG:  background worker "logical replication launcher" (PID 104871) exited with exit code 1
2023-01-16 22:09:58.215 GMT [104866] LOG:  shutting down
2023-01-16 22:09:58.269 GMT [104864] LOG:  database system is shut down
2023-01-16 22:09:59.644 GMT [105301] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:09:59.645 GMT [105301] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:09:59.648 GMT [105301] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:09:59.656 GMT [105302] LOG:  database system was shut down at 2023-01-16 22:09:59 GMT
2023-01-16 22:09:59.663 GMT [105301] LOG:  database system is ready to accept connections
2023-01-16 22:10:00.726 GMT [105344] ERROR:  column "loan_payment" does not exist at character 110
2023-01-16 22:10:00.726 GMT [105344] QUERY:  EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE AND loan_payment = FALSE)
2023-01-16 22:10:00.726 GMT [105344] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 8 at IF
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)"
	PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 6 at SQL statement
2023-01-16 22:10:00.726 GMT [105344] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-16 22:10:00.736 GMT [105344] ERROR:  column "loan_payment" does not exist at character 110
2023-01-16 22:10:00.736 GMT [105344] QUERY:  EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE AND loan_payment = FALSE)
2023-01-16 22:10:00.736 GMT [105344] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 8 at IF
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 22:10:00.736 GMT [105344] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 22:10:24.839 GMT [105301] LOG:  received fast shutdown request
2023-01-16 22:10:24.840 GMT [105301] LOG:  aborting any active transactions
2023-01-16 22:10:24.845 GMT [105301] LOG:  background worker "logical replication launcher" (PID 105308) exited with exit code 1
2023-01-16 22:10:24.845 GMT [105303] LOG:  shutting down
2023-01-16 22:10:24.911 GMT [105301] LOG:  database system is shut down
2023-01-16 22:10:26.169 GMT [105516] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:10:26.170 GMT [105516] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:10:26.171 GMT [105516] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:10:26.176 GMT [105517] LOG:  database system was shut down at 2023-01-16 22:10:25 GMT
2023-01-16 22:10:26.183 GMT [105516] LOG:  database system is ready to accept connections
2023-01-16 22:10:27.144 GMT [105545] ERROR:  column "is_loan_payment" does not exist at character 110
2023-01-16 22:10:27.144 GMT [105545] QUERY:  EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE AND is_loan_payment = FALSE)
2023-01-16 22:10:27.144 GMT [105545] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 8 at IF
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)"
	PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 6 at SQL statement
2023-01-16 22:10:27.144 GMT [105545] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-16 22:10:27.155 GMT [105545] ERROR:  column "is_loan_payment" does not exist at character 110
2023-01-16 22:10:27.155 GMT [105545] QUERY:  EXISTS (SELECT * FROM bank.pending_transactions WHERE id = pending_transaction_id AND is_transfer = TRUE AND is_loan_payment = FALSE)
2023-01-16 22:10:27.155 GMT [105545] CONTEXT:  PL/pgSQL function verify_transaction_type(integer) line 8 at IF
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-16 22:10:27.155 GMT [105545] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 20000000, 123456);
2023-01-16 22:10:50.198 GMT [105516] LOG:  received fast shutdown request
2023-01-16 22:10:50.200 GMT [105516] LOG:  aborting any active transactions
2023-01-16 22:10:50.206 GMT [105516] LOG:  background worker "logical replication launcher" (PID 105523) exited with exit code 1
2023-01-16 22:10:50.209 GMT [105518] LOG:  shutting down
2023-01-16 22:10:50.265 GMT [105516] LOG:  database system is shut down
2023-01-16 22:10:51.636 GMT [105712] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:10:51.637 GMT [105712] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:10:51.639 GMT [105712] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:10:51.644 GMT [105713] LOG:  database system was shut down at 2023-01-16 22:10:51 GMT
2023-01-16 22:10:51.651 GMT [105712] LOG:  database system is ready to accept connections
2023-01-16 22:12:26.282 GMT [105712] LOG:  received fast shutdown request
2023-01-16 22:12:26.284 GMT [105712] LOG:  aborting any active transactions
2023-01-16 22:12:26.288 GMT [105712] LOG:  background worker "logical replication launcher" (PID 105719) exited with exit code 1
2023-01-16 22:12:26.289 GMT [105714] LOG:  shutting down
2023-01-16 22:12:26.347 GMT [105712] LOG:  database system is shut down
2023-01-16 22:12:27.556 GMT [106111] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:12:27.556 GMT [106111] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:12:27.558 GMT [106111] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:12:27.563 GMT [106112] LOG:  database system was shut down at 2023-01-16 22:12:27 GMT
2023-01-16 22:12:27.569 GMT [106111] LOG:  database system is ready to accept connections
2023-01-16 22:12:28.603 GMT [106140] ERROR:  column "current_balance" of relation "loan" does not exist at character 17
2023-01-16 22:12:28.603 GMT [106140] QUERY:  UPDATE loan SET current_balance = amount - payment_amount WHERE id = loan_id
2023-01-16 22:12:28.603 GMT [106140] CONTEXT:  PL/pgSQL function update_loan_amounts(integer,numeric) line 8 at SQL statement
	SQL expression "bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id))"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 12 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, FALSE, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 13 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)"
	PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 6 at SQL statement
2023-01-16 22:12:28.603 GMT [106140] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-16 22:12:59.292 GMT [106111] LOG:  received fast shutdown request
2023-01-16 22:12:59.295 GMT [106111] LOG:  aborting any active transactions
2023-01-16 22:12:59.300 GMT [106111] LOG:  background worker "logical replication launcher" (PID 106118) exited with exit code 1
2023-01-16 22:12:59.300 GMT [106113] LOG:  shutting down
2023-01-16 22:12:59.360 GMT [106111] LOG:  database system is shut down
2023-01-16 22:13:00.640 GMT [106317] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:13:00.640 GMT [106317] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:13:00.642 GMT [106317] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:13:00.648 GMT [106318] LOG:  database system was shut down at 2023-01-16 22:13:00 GMT
2023-01-16 22:13:00.654 GMT [106317] LOG:  database system is ready to accept connections
2023-01-16 22:13:32.475 GMT [106317] LOG:  received fast shutdown request
2023-01-16 22:13:32.479 GMT [106317] LOG:  aborting any active transactions
2023-01-16 22:13:32.486 GMT [106317] LOG:  background worker "logical replication launcher" (PID 106324) exited with exit code 1
2023-01-16 22:13:32.486 GMT [106319] LOG:  shutting down
2023-01-16 22:13:32.542 GMT [106317] LOG:  database system is shut down
2023-01-16 22:13:33.891 GMT [106523] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-16 22:13:33.891 GMT [106523] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-16 22:13:33.895 GMT [106523] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-16 22:13:33.900 GMT [106524] LOG:  database system was shut down at 2023-01-16 22:13:33 GMT
2023-01-16 22:13:33.906 GMT [106523] LOG:  database system is ready to accept connections
2023-01-17 07:57:08.917 GMT [106523] LOG:  received fast shutdown request
2023-01-17 07:57:08.921 GMT [106523] LOG:  aborting any active transactions
2023-01-17 07:57:08.925 GMT [106523] LOG:  background worker "logical replication launcher" (PID 106530) exited with exit code 1
2023-01-17 07:57:08.930 GMT [106525] LOG:  shutting down
2023-01-17 07:57:08.954 GMT [106523] LOG:  database system is shut down
2023-01-17 07:57:13.460 GMT [112950] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 07:57:13.461 GMT [112950] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 07:57:13.463 GMT [112950] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 07:57:13.468 GMT [112951] LOG:  database system was shut down at 2023-01-17 07:57:13 GMT
2023-01-17 07:57:13.473 GMT [112950] LOG:  database system is ready to accept connections
2023-01-17 07:59:29.219 GMT [112950] LOG:  received fast shutdown request
2023-01-17 07:59:29.221 GMT [112950] LOG:  aborting any active transactions
2023-01-17 07:59:29.227 GMT [112950] LOG:  background worker "logical replication launcher" (PID 112957) exited with exit code 1
2023-01-17 07:59:29.228 GMT [112952] LOG:  shutting down
2023-01-17 07:59:29.277 GMT [112950] LOG:  database system is shut down
2023-01-17 07:59:30.337 GMT [113436] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 07:59:30.338 GMT [113436] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 07:59:30.339 GMT [113436] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 07:59:30.344 GMT [113437] LOG:  database system was shut down at 2023-01-17 07:59:30 GMT
2023-01-17 07:59:30.349 GMT [113436] LOG:  database system is ready to accept connections
2023-01-17 08:18:52.823 GMT [113436] LOG:  received fast shutdown request
2023-01-17 08:18:52.825 GMT [113436] LOG:  aborting any active transactions
2023-01-17 08:18:52.830 GMT [113436] LOG:  background worker "logical replication launcher" (PID 113443) exited with exit code 1
2023-01-17 08:18:52.831 GMT [113438] LOG:  shutting down
2023-01-17 08:18:52.855 GMT [113436] LOG:  database system is shut down
2023-01-17 08:18:59.495 GMT [116914] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:18:59.496 GMT [116914] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:18:59.500 GMT [116914] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:18:59.505 GMT [116915] LOG:  database system was shut down at 2023-01-17 08:18:59 GMT
2023-01-17 08:18:59.512 GMT [116914] LOG:  database system is ready to accept connections
2023-01-17 08:19:00.552 GMT [116943] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:19:00.552 GMT [116943] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:19:00.753 GMT [116943] ERROR:  LOAN OVERPAID
2023-01-17 08:19:00.753 GMT [116943] CONTEXT:  PL/pgSQL function update_loan_amounts(integer,numeric) line 5 at RAISE
	SQL expression "bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 12 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, FALSE, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 13 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)"
	PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 6 at SQL statement
2023-01-17 08:19:00.753 GMT [116943] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:23:22.717 GMT [116914] LOG:  received fast shutdown request
2023-01-17 08:23:22.719 GMT [116914] LOG:  aborting any active transactions
2023-01-17 08:23:22.721 GMT [116914] LOG:  background worker "logical replication launcher" (PID 116921) exited with exit code 1
2023-01-17 08:23:22.724 GMT [116916] LOG:  shutting down
2023-01-17 08:23:22.784 GMT [116914] LOG:  database system is shut down
2023-01-17 08:23:24.104 GMT [117828] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:23:24.105 GMT [117828] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:23:24.106 GMT [117828] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:23:24.114 GMT [117829] LOG:  database system was shut down at 2023-01-17 08:23:23 GMT
2023-01-17 08:23:24.122 GMT [117828] LOG:  database system is ready to accept connections
2023-01-17 08:23:25.030 GMT [117867] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:23:25.030 GMT [117867] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:23:25.104 GMT [117867] ERROR:  syntax error at or near "." at character 356
2023-01-17 08:23:25.104 GMT [117867] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_loan_payment(account_identifier INT, orig_account_number INT, payment_amount NUMERIC, loan_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated loan payment', CURRENT_DATE);
	
	    IF EXISTS client.view_loans(account_identifier) WHERE id = loan_id AND application_status = 'PENDING' THEN
	        RAISE NOTICE 'Loan does not exist';
	        RETURN FALSE;
	    END IF
	
	    SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE) INTO passed;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:23:25.172 GMT [117867] ERROR:  function client.initiate_loan_payment(integer, integer, numeric, integer) does not exist at character 15
2023-01-17 08:23:25.172 GMT [117867] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 08:23:25.172 GMT [117867] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:24:05.548 GMT [117828] LOG:  received fast shutdown request
2023-01-17 08:24:05.551 GMT [117828] LOG:  aborting any active transactions
2023-01-17 08:24:05.563 GMT [117828] LOG:  background worker "logical replication launcher" (PID 117838) exited with exit code 1
2023-01-17 08:24:05.563 GMT [117833] LOG:  shutting down
2023-01-17 08:24:05.625 GMT [117828] LOG:  database system is shut down
2023-01-17 08:24:07.066 GMT [118071] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:24:07.067 GMT [118071] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:24:07.069 GMT [118071] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:24:07.078 GMT [118072] LOG:  database system was shut down at 2023-01-17 08:24:06 GMT
2023-01-17 08:24:07.085 GMT [118071] LOG:  database system is ready to accept connections
2023-01-17 08:24:07.933 GMT [118108] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:24:07.933 GMT [118108] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:24:08.002 GMT [118108] ERROR:  syntax error at or near "client" at character 351
2023-01-17 08:24:08.002 GMT [118108] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_loan_payment(account_identifier INT, orig_account_number INT, payment_amount NUMERIC, loan_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated loan payment', CURRENT_DATE);
	
	    IF EXISTS (client.view_loans(account_identifier) WHERE id = loan_id AND application_status = 'PENDING') THEN
	        RAISE NOTICE 'Loan does not exist';
	        RETURN FALSE;
	    END IF
	
	    SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE) INTO passed;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:24:08.063 GMT [118108] ERROR:  function client.initiate_loan_payment(integer, integer, numeric, integer) does not exist at character 15
2023-01-17 08:24:08.063 GMT [118108] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 08:24:08.063 GMT [118108] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:24:31.387 GMT [118071] LOG:  received fast shutdown request
2023-01-17 08:24:31.390 GMT [118071] LOG:  aborting any active transactions
2023-01-17 08:24:31.397 GMT [118071] LOG:  background worker "logical replication launcher" (PID 118078) exited with exit code 1
2023-01-17 08:24:31.397 GMT [118073] LOG:  shutting down
2023-01-17 08:24:31.456 GMT [118071] LOG:  database system is shut down
2023-01-17 08:24:32.775 GMT [118277] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:24:32.775 GMT [118277] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:24:32.777 GMT [118277] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:24:32.783 GMT [118278] LOG:  database system was shut down at 2023-01-17 08:24:32 GMT
2023-01-17 08:24:32.791 GMT [118277] LOG:  database system is ready to accept connections
2023-01-17 08:24:33.630 GMT [118306] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:24:33.630 GMT [118306] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:24:33.697 GMT [118306] ERROR:  syntax error at or near "SELECT" at character 545
2023-01-17 08:24:33.697 GMT [118306] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_loan_payment(account_identifier INT, orig_account_number INT, payment_amount NUMERIC, loan_id INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated loan payment', CURRENT_DATE);
	
	    IF EXISTS (SELECT * FROM client.view_loans(account_identifier) WHERE id = loan_id AND application_status = 'PENDING') THEN
	        RAISE NOTICE 'Loan does not exist';
	        RETURN FALSE;
	    END IF
	
	    SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE) INTO passed;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:24:33.763 GMT [118306] ERROR:  function client.initiate_loan_payment(integer, integer, numeric, integer) does not exist at character 15
2023-01-17 08:24:33.763 GMT [118306] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 08:24:33.763 GMT [118306] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:26:05.572 GMT [118277] LOG:  received fast shutdown request
2023-01-17 08:26:05.574 GMT [118277] LOG:  aborting any active transactions
2023-01-17 08:26:05.580 GMT [118277] LOG:  background worker "logical replication launcher" (PID 118284) exited with exit code 1
2023-01-17 08:26:05.581 GMT [118279] LOG:  shutting down
2023-01-17 08:26:05.639 GMT [118277] LOG:  database system is shut down
2023-01-17 08:26:06.828 GMT [118653] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:26:06.828 GMT [118653] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:26:06.830 GMT [118653] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:26:06.835 GMT [118654] LOG:  database system was shut down at 2023-01-17 08:26:06 GMT
2023-01-17 08:26:06.841 GMT [118653] LOG:  database system is ready to accept connections
2023-01-17 08:26:07.671 GMT [118682] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:26:07.671 GMT [118682] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:26:07.812 GMT [118682] ERROR:  LOAN OVERPAID
2023-01-17 08:26:07.812 GMT [118682] CONTEXT:  PL/pgSQL function update_loan_amounts(integer,numeric) line 5 at RAISE
	SQL expression "bank.update_loan_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id))"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 12 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, FALSE, TRUE)"
	PL/pgSQL function verify_transaction_type(integer) line 13 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)"
	PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 11 at SQL statement
2023-01-17 08:26:07.812 GMT [118682] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:26:40.737 GMT [118653] LOG:  received fast shutdown request
2023-01-17 08:26:40.739 GMT [118653] LOG:  aborting any active transactions
2023-01-17 08:26:40.741 GMT [118653] LOG:  background worker "logical replication launcher" (PID 118660) exited with exit code 1
2023-01-17 08:26:40.743 GMT [118655] LOG:  shutting down
2023-01-17 08:26:40.798 GMT [118653] LOG:  database system is shut down
2023-01-17 08:26:42.070 GMT [118877] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:26:42.070 GMT [118877] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:26:42.072 GMT [118877] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:26:42.077 GMT [118878] LOG:  database system was shut down at 2023-01-17 08:26:41 GMT
2023-01-17 08:26:42.083 GMT [118877] LOG:  database system is ready to accept connections
2023-01-17 08:26:42.923 GMT [118906] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:26:42.923 GMT [118906] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:26:43.075 GMT [118906] ERROR:  function client.loans(integer) does not exist at character 23
2023-01-17 08:26:43.075 GMT [118906] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 08:26:43.075 GMT [118906] QUERY:  EXISTS (SELECT * FROM client.loans(account_identifier) WHERE id = loan_id AND application_status = 'PENDING')
2023-01-17 08:26:43.075 GMT [118906] CONTEXT:  PL/pgSQL function initiate_loan_payment(integer,integer,numeric,integer) line 11 at IF
2023-01-17 08:26:43.075 GMT [118906] STATEMENT:  SELECT * FROM client.initiate_loan_payment(1, 10000001, 50.00, 1);
2023-01-17 08:27:03.864 GMT [118877] LOG:  received fast shutdown request
2023-01-17 08:27:03.866 GMT [118877] LOG:  aborting any active transactions
2023-01-17 08:27:03.870 GMT [118877] LOG:  background worker "logical replication launcher" (PID 118884) exited with exit code 1
2023-01-17 08:27:03.870 GMT [118879] LOG:  shutting down
2023-01-17 08:27:03.933 GMT [118877] LOG:  database system is shut down
2023-01-17 08:27:05.400 GMT [119058] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:27:05.400 GMT [119058] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:27:05.403 GMT [119058] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:27:05.408 GMT [119059] LOG:  database system was shut down at 2023-01-17 08:27:05 GMT
2023-01-17 08:27:05.416 GMT [119058] LOG:  database system is ready to accept connections
2023-01-17 08:27:06.289 GMT [119094] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:27:06.289 GMT [119094] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:41:19.301 GMT [119058] LOG:  received fast shutdown request
2023-01-17 08:41:19.302 GMT [119058] LOG:  aborting any active transactions
2023-01-17 08:41:19.307 GMT [119058] LOG:  background worker "logical replication launcher" (PID 119065) exited with exit code 1
2023-01-17 08:41:19.308 GMT [119060] LOG:  shutting down
2023-01-17 08:41:19.330 GMT [119058] LOG:  database system is shut down
2023-01-17 08:41:20.714 GMT [121703] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:41:20.714 GMT [121703] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:41:20.716 GMT [121703] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:41:20.720 GMT [121704] LOG:  database system was shut down at 2023-01-17 08:41:20 GMT
2023-01-17 08:41:20.726 GMT [121703] LOG:  database system is ready to accept connections
2023-01-17 08:41:21.660 GMT [121742] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:41:21.660 GMT [121742] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:43:34.475 GMT [121703] LOG:  received fast shutdown request
2023-01-17 08:43:34.477 GMT [121703] LOG:  aborting any active transactions
2023-01-17 08:43:34.481 GMT [121703] LOG:  background worker "logical replication launcher" (PID 121710) exited with exit code 1
2023-01-17 08:43:34.482 GMT [121705] LOG:  shutting down
2023-01-17 08:43:34.535 GMT [121703] LOG:  database system is shut down
2023-01-17 08:43:35.825 GMT [122180] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:43:35.825 GMT [122180] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:43:35.826 GMT [122180] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:43:35.832 GMT [122181] LOG:  database system was shut down at 2023-01-17 08:43:35 GMT
2023-01-17 08:43:35.838 GMT [122180] LOG:  database system is ready to accept connections
2023-01-17 08:43:36.750 GMT [122210] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:43:36.750 GMT [122210] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:43:36.868 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.868 GMT [122210] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:43:36.868 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.868 GMT [122210] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:43:36.868 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.868 GMT [122210] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:43:36.868 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.868 GMT [122210] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:43:36.868 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.868 GMT [122210] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:43:36.869 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.869 GMT [122210] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:43:36.869 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.869 GMT [122210] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:43:36.869 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.869 GMT [122210] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:43:36.869 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.869 GMT [122210] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:43:36.869 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.869 GMT [122210] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:43:36.870 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.870 GMT [122210] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:43:36.870 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.870 GMT [122210] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:43:36.870 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.870 GMT [122210] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:43:36.871 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.871 GMT [122210] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:43:36.871 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.871 GMT [122210] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:43:36.871 GMT [122210] ERROR:  permission denied for schema client at character 15
2023-01-17 08:43:36.871 GMT [122210] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:44:11.614 GMT [122180] LOG:  received fast shutdown request
2023-01-17 08:44:11.616 GMT [122180] LOG:  aborting any active transactions
2023-01-17 08:44:11.622 GMT [122180] LOG:  background worker "logical replication launcher" (PID 122187) exited with exit code 1
2023-01-17 08:44:11.622 GMT [122182] LOG:  shutting down
2023-01-17 08:44:11.673 GMT [122180] LOG:  database system is shut down
2023-01-17 08:44:12.945 GMT [122409] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:44:12.945 GMT [122409] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:44:12.946 GMT [122409] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:44:12.951 GMT [122410] LOG:  database system was shut down at 2023-01-17 08:44:12 GMT
2023-01-17 08:44:12.958 GMT [122409] LOG:  database system is ready to accept connections
2023-01-17 08:44:13.789 GMT [122438] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:44:13.789 GMT [122438] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:44:13.927 GMT [122438] ERROR:  permission denied for schema client
2023-01-17 08:44:13.927 GMT [122438] STATEMENT:  GRANT USAGE ON SCHEMA client TO l2;
2023-01-17 08:44:13.927 GMT [122438] ERROR:  permission denied for schema client
2023-01-17 08:44:13.927 GMT [122438] STATEMENT:  GRANT ALL ON ALL TABLES IN SCHEMA client TO l2;
2023-01-17 08:44:13.927 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.927 GMT [122438] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:44:13.928 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.928 GMT [122438] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:44:13.929 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.929 GMT [122438] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:44:13.930 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.930 GMT [122438] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:44:13.930 GMT [122438] ERROR:  permission denied for schema client at character 15
2023-01-17 08:44:13.930 GMT [122438] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:44:30.129 GMT [122409] LOG:  received fast shutdown request
2023-01-17 08:44:30.131 GMT [122409] LOG:  aborting any active transactions
2023-01-17 08:44:30.134 GMT [122409] LOG:  background worker "logical replication launcher" (PID 122416) exited with exit code 1
2023-01-17 08:44:30.137 GMT [122411] LOG:  shutting down
2023-01-17 08:44:30.188 GMT [122409] LOG:  database system is shut down
2023-01-17 08:44:31.404 GMT [122574] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:44:31.404 GMT [122574] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:44:31.406 GMT [122574] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:44:31.412 GMT [122575] LOG:  database system was shut down at 2023-01-17 08:44:31 GMT
2023-01-17 08:44:31.417 GMT [122574] LOG:  database system is ready to accept connections
2023-01-17 08:44:32.248 GMT [122604] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:44:32.248 GMT [122604] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:44:32.348 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.348 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.348 GMT [122604] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:44:32.348 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.348 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.348 GMT [122604] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:44:32.348 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.348 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.348 GMT [122604] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:44:32.349 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.349 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.349 GMT [122604] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:44:32.350 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.350 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.350 GMT [122604] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:44:32.350 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.350 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.350 GMT [122604] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:44:32.350 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.350 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.350 GMT [122604] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:44:32.350 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.350 GMT [122604] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:44:32.350 GMT [122604] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:44:32.351 GMT [122604] ERROR:  permission denied for table loan
2023-01-17 08:44:32.351 GMT [122604] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:44:32.351 GMT [122604] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:44:32.352 GMT [122604] ERROR:  permission denied for table management_log
2023-01-17 08:44:32.352 GMT [122604] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:44:32.352 GMT [122604] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:44:32.355 GMT [122604] ERROR:  permission denied for table account
2023-01-17 08:44:32.355 GMT [122604] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:44:32.355 GMT [122604] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:46:28.482 GMT [122574] LOG:  received fast shutdown request
2023-01-17 08:46:28.484 GMT [122574] LOG:  aborting any active transactions
2023-01-17 08:46:28.486 GMT [122574] LOG:  background worker "logical replication launcher" (PID 122581) exited with exit code 1
2023-01-17 08:46:28.488 GMT [122576] LOG:  shutting down
2023-01-17 08:46:28.533 GMT [122574] LOG:  database system is shut down
2023-01-17 08:46:29.677 GMT [123030] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:46:29.678 GMT [123030] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:46:29.679 GMT [123030] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:46:29.683 GMT [123031] LOG:  database system was shut down at 2023-01-17 08:46:29 GMT
2023-01-17 08:46:29.692 GMT [123030] LOG:  database system is ready to accept connections
2023-01-17 08:46:30.432 GMT [123056] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:46:30.432 GMT [123056] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:46:30.554 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.554 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.554 GMT [123056] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:46:30.554 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.554 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.554 GMT [123056] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:46:30.555 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.555 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.555 GMT [123056] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:46:30.556 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.556 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.556 GMT [123056] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:46:30.557 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.557 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_savings_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.557 GMT [123056] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:46:30.558 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.558 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.558 GMT [123056] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:46:30.559 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.559 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.559 GMT [123056] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:46:30.559 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.559 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.559 GMT [123056] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:46:30.560 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.560 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_debit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.560 GMT [123056] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:46:30.561 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.561 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.561 GMT [123056] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:46:30.562 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.562 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.562 GMT [123056] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:46:30.562 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.562 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.562 GMT [123056] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:46:30.563 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.563 GMT [123056] CONTEXT:  SQL statement "SELECT MAX(account_number)                          FROM account"
	PL/pgSQL function get_next_account_number() line 4 at SQL statement
	SQL statement "SELECT get_next_account_number()"
	PL/pgSQL function open_credit_account(integer) line 8 at SQL statement
2023-01-17 08:46:30.563 GMT [123056] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:46:30.564 GMT [123056] ERROR:  permission denied for table loan
2023-01-17 08:46:30.564 GMT [123056] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:46:30.564 GMT [123056] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:46:30.565 GMT [123056] ERROR:  permission denied for table management_log
2023-01-17 08:46:30.565 GMT [123056] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:46:30.565 GMT [123056] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:46:30.568 GMT [123056] ERROR:  permission denied for table account
2023-01-17 08:46:30.568 GMT [123056] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:46:30.568 GMT [123056] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:48:41.959 GMT [123030] LOG:  received fast shutdown request
2023-01-17 08:48:41.962 GMT [123030] LOG:  aborting any active transactions
2023-01-17 08:48:41.964 GMT [123030] LOG:  background worker "logical replication launcher" (PID 123037) exited with exit code 1
2023-01-17 08:48:41.969 GMT [123032] LOG:  shutting down
2023-01-17 08:48:42.016 GMT [123030] LOG:  database system is shut down
2023-01-17 08:48:43.244 GMT [123511] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:48:43.245 GMT [123511] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:48:43.246 GMT [123511] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:48:43.250 GMT [123512] LOG:  database system was shut down at 2023-01-17 08:48:42 GMT
2023-01-17 08:48:43.255 GMT [123511] LOG:  database system is ready to accept connections
2023-01-17 08:48:43.990 GMT [123540] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:48:43.990 GMT [123540] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:48:44.089 GMT [123540] ERROR:  permission denied for table savings_account
2023-01-17 08:48:44.089 GMT [123540] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.089 GMT [123540] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:48:44.090 GMT [123540] ERROR:  permission denied for table savings_account
2023-01-17 08:48:44.090 GMT [123540] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.090 GMT [123540] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:48:44.091 GMT [123540] ERROR:  permission denied for table savings_account
2023-01-17 08:48:44.091 GMT [123540] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.091 GMT [123540] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:48:44.091 GMT [123540] ERROR:  permission denied for table savings_account
2023-01-17 08:48:44.091 GMT [123540] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.091 GMT [123540] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:48:44.092 GMT [123540] ERROR:  permission denied for table savings_account
2023-01-17 08:48:44.092 GMT [123540] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.092 GMT [123540] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:48:44.093 GMT [123540] ERROR:  permission denied for table debit_account
2023-01-17 08:48:44.093 GMT [123540] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.093 GMT [123540] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:48:44.094 GMT [123540] ERROR:  permission denied for table debit_account
2023-01-17 08:48:44.094 GMT [123540] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.094 GMT [123540] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:48:44.095 GMT [123540] ERROR:  permission denied for table debit_account
2023-01-17 08:48:44.095 GMT [123540] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.095 GMT [123540] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:48:44.096 GMT [123540] ERROR:  permission denied for table debit_account
2023-01-17 08:48:44.096 GMT [123540] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.096 GMT [123540] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:48:44.097 GMT [123540] ERROR:  permission denied for table credit_account
2023-01-17 08:48:44.097 GMT [123540] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.097 GMT [123540] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:48:44.098 GMT [123540] ERROR:  permission denied for table credit_account
2023-01-17 08:48:44.098 GMT [123540] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.098 GMT [123540] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:48:44.099 GMT [123540] ERROR:  permission denied for table credit_account
2023-01-17 08:48:44.099 GMT [123540] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.099 GMT [123540] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:48:44.100 GMT [123540] ERROR:  permission denied for table credit_account
2023-01-17 08:48:44.100 GMT [123540] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:48:44.100 GMT [123540] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:48:44.102 GMT [123540] ERROR:  permission denied for table loan
2023-01-17 08:48:44.102 GMT [123540] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:48:44.102 GMT [123540] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:48:44.103 GMT [123540] ERROR:  permission denied for table management_log
2023-01-17 08:48:44.103 GMT [123540] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:48:44.103 GMT [123540] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:48:44.108 GMT [123540] ERROR:  permission denied for table account
2023-01-17 08:48:44.108 GMT [123540] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:48:44.108 GMT [123540] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:49:59.002 GMT [123511] LOG:  received fast shutdown request
2023-01-17 08:49:59.004 GMT [123511] LOG:  aborting any active transactions
2023-01-17 08:49:59.010 GMT [123511] LOG:  background worker "logical replication launcher" (PID 123518) exited with exit code 1
2023-01-17 08:49:59.010 GMT [123513] LOG:  shutting down
2023-01-17 08:49:59.052 GMT [123511] LOG:  database system is shut down
2023-01-17 08:50:00.122 GMT [123863] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:50:00.122 GMT [123863] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:50:00.124 GMT [123863] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:50:00.130 GMT [123864] LOG:  database system was shut down at 2023-01-17 08:49:59 GMT
2023-01-17 08:50:00.137 GMT [123863] LOG:  database system is ready to accept connections
2023-01-17 08:50:00.834 GMT [123889] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:50:00.834 GMT [123889] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:50:00.912 GMT [123889] ERROR:  permission denied for table savings_statement
2023-01-17 08:50:00.912 GMT [123889] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:50:00.912 GMT [123889] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:50:00.913 GMT [123889] ERROR:  permission denied for table savings_statement
2023-01-17 08:50:00.913 GMT [123889] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:50:00.913 GMT [123889] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:50:00.913 GMT [123889] ERROR:  permission denied for table savings_statement
2023-01-17 08:50:00.913 GMT [123889] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:50:00.913 GMT [123889] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:50:00.914 GMT [123889] ERROR:  permission denied for table savings_statement
2023-01-17 08:50:00.914 GMT [123889] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:50:00.914 GMT [123889] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:50:00.914 GMT [123889] ERROR:  permission denied for table savings_statement
2023-01-17 08:50:00.914 GMT [123889] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:50:00.914 GMT [123889] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:50:00.914 GMT [123889] ERROR:  permission denied for table debit_account
2023-01-17 08:50:00.914 GMT [123889] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.914 GMT [123889] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:50:00.915 GMT [123889] ERROR:  permission denied for table debit_account
2023-01-17 08:50:00.915 GMT [123889] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.915 GMT [123889] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:50:00.915 GMT [123889] ERROR:  permission denied for table debit_account
2023-01-17 08:50:00.915 GMT [123889] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.915 GMT [123889] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:50:00.915 GMT [123889] ERROR:  permission denied for table debit_account
2023-01-17 08:50:00.915 GMT [123889] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.915 GMT [123889] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:50:00.916 GMT [123889] ERROR:  permission denied for table credit_account
2023-01-17 08:50:00.916 GMT [123889] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.916 GMT [123889] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:50:00.917 GMT [123889] ERROR:  permission denied for table credit_account
2023-01-17 08:50:00.917 GMT [123889] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.917 GMT [123889] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:50:00.917 GMT [123889] ERROR:  permission denied for table credit_account
2023-01-17 08:50:00.917 GMT [123889] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.917 GMT [123889] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:50:00.917 GMT [123889] ERROR:  permission denied for table credit_account
2023-01-17 08:50:00.917 GMT [123889] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:00.917 GMT [123889] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:50:00.917 GMT [123889] ERROR:  permission denied for table loan
2023-01-17 08:50:00.917 GMT [123889] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:50:00.917 GMT [123889] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:50:00.918 GMT [123889] ERROR:  permission denied for table management_log
2023-01-17 08:50:00.918 GMT [123889] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:50:00.918 GMT [123889] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:50:00.921 GMT [123889] ERROR:  permission denied for table account
2023-01-17 08:50:00.921 GMT [123889] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:50:00.921 GMT [123889] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:50:49.682 GMT [123863] LOG:  received fast shutdown request
2023-01-17 08:50:49.684 GMT [123863] LOG:  aborting any active transactions
2023-01-17 08:50:49.686 GMT [123863] LOG:  background worker "logical replication launcher" (PID 123870) exited with exit code 1
2023-01-17 08:50:49.689 GMT [123865] LOG:  shutting down
2023-01-17 08:50:49.732 GMT [123863] LOG:  database system is shut down
2023-01-17 08:50:50.993 GMT [124123] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:50:50.994 GMT [124123] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:50:50.995 GMT [124123] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:50:51.000 GMT [124124] LOG:  database system was shut down at 2023-01-17 08:50:50 GMT
2023-01-17 08:50:51.006 GMT [124123] LOG:  database system is ready to accept connections
2023-01-17 08:50:51.803 GMT [124152] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:50:51.803 GMT [124152] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:50:51.900 GMT [124152] ERROR:  syntax error at or near "TO" at character 27
2023-01-17 08:50:51.900 GMT [124152] STATEMENT:  GRANT WRITE ON ALL TABLES TO l2;
2023-01-17 08:50:51.901 GMT [124152] ERROR:  permission denied for table savings_account
2023-01-17 08:50:51.901 GMT [124152] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.901 GMT [124152] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:50:51.901 GMT [124152] ERROR:  permission denied for table savings_account
2023-01-17 08:50:51.901 GMT [124152] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.901 GMT [124152] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:50:51.902 GMT [124152] ERROR:  permission denied for table savings_account
2023-01-17 08:50:51.902 GMT [124152] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.902 GMT [124152] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:50:51.902 GMT [124152] ERROR:  permission denied for table savings_account
2023-01-17 08:50:51.902 GMT [124152] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.902 GMT [124152] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:50:51.902 GMT [124152] ERROR:  permission denied for table savings_account
2023-01-17 08:50:51.902 GMT [124152] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.902 GMT [124152] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:50:51.903 GMT [124152] ERROR:  permission denied for table debit_account
2023-01-17 08:50:51.903 GMT [124152] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.903 GMT [124152] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:50:51.903 GMT [124152] ERROR:  permission denied for table debit_account
2023-01-17 08:50:51.903 GMT [124152] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.903 GMT [124152] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:50:51.903 GMT [124152] ERROR:  permission denied for table debit_account
2023-01-17 08:50:51.903 GMT [124152] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.903 GMT [124152] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:50:51.904 GMT [124152] ERROR:  permission denied for table debit_account
2023-01-17 08:50:51.904 GMT [124152] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.904 GMT [124152] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:50:51.905 GMT [124152] ERROR:  permission denied for table credit_account
2023-01-17 08:50:51.905 GMT [124152] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.905 GMT [124152] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:50:51.906 GMT [124152] ERROR:  permission denied for table credit_account
2023-01-17 08:50:51.906 GMT [124152] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.906 GMT [124152] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:50:51.906 GMT [124152] ERROR:  permission denied for table credit_account
2023-01-17 08:50:51.906 GMT [124152] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.906 GMT [124152] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:50:51.906 GMT [124152] ERROR:  permission denied for table credit_account
2023-01-17 08:50:51.906 GMT [124152] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:50:51.906 GMT [124152] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:50:51.907 GMT [124152] ERROR:  permission denied for table loan
2023-01-17 08:50:51.907 GMT [124152] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:50:51.907 GMT [124152] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:50:51.907 GMT [124152] ERROR:  permission denied for table management_log
2023-01-17 08:50:51.907 GMT [124152] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:50:51.907 GMT [124152] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:50:51.913 GMT [124152] ERROR:  permission denied for table account
2023-01-17 08:50:51.913 GMT [124152] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:50:51.913 GMT [124152] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:51:19.012 GMT [124123] LOG:  received fast shutdown request
2023-01-17 08:51:19.014 GMT [124123] LOG:  aborting any active transactions
2023-01-17 08:51:19.018 GMT [124123] LOG:  background worker "logical replication launcher" (PID 124130) exited with exit code 1
2023-01-17 08:51:19.021 GMT [124125] LOG:  shutting down
2023-01-17 08:51:19.072 GMT [124123] LOG:  database system is shut down
2023-01-17 08:51:20.103 GMT [124318] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:51:20.104 GMT [124318] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:51:20.106 GMT [124318] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:51:20.110 GMT [124319] LOG:  database system was shut down at 2023-01-17 08:51:19 GMT
2023-01-17 08:51:20.116 GMT [124318] LOG:  database system is ready to accept connections
2023-01-17 08:51:20.881 GMT [124347] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:51:20.881 GMT [124347] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:51:20.971 GMT [124347] ERROR:  unrecognized privilege type "write"
2023-01-17 08:51:20.971 GMT [124347] STATEMENT:  GRANT WRITE ON ALL TABLES IN SCHEMA public TO l2;
2023-01-17 08:51:20.974 GMT [124347] ERROR:  permission denied for table savings_account
2023-01-17 08:51:20.974 GMT [124347] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.974 GMT [124347] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:51:20.975 GMT [124347] ERROR:  permission denied for table savings_account
2023-01-17 08:51:20.975 GMT [124347] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.975 GMT [124347] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:51:20.975 GMT [124347] ERROR:  permission denied for table savings_account
2023-01-17 08:51:20.975 GMT [124347] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.975 GMT [124347] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:51:20.975 GMT [124347] ERROR:  permission denied for table savings_account
2023-01-17 08:51:20.975 GMT [124347] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.975 GMT [124347] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:51:20.975 GMT [124347] ERROR:  permission denied for table savings_account
2023-01-17 08:51:20.975 GMT [124347] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.975 GMT [124347] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:51:20.976 GMT [124347] ERROR:  permission denied for table debit_account
2023-01-17 08:51:20.976 GMT [124347] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.976 GMT [124347] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:51:20.976 GMT [124347] ERROR:  permission denied for table debit_account
2023-01-17 08:51:20.976 GMT [124347] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.976 GMT [124347] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:51:20.976 GMT [124347] ERROR:  permission denied for table debit_account
2023-01-17 08:51:20.976 GMT [124347] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.976 GMT [124347] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:51:20.977 GMT [124347] ERROR:  permission denied for table debit_account
2023-01-17 08:51:20.977 GMT [124347] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.977 GMT [124347] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:51:20.977 GMT [124347] ERROR:  permission denied for table credit_account
2023-01-17 08:51:20.977 GMT [124347] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.977 GMT [124347] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:51:20.977 GMT [124347] ERROR:  permission denied for table credit_account
2023-01-17 08:51:20.977 GMT [124347] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.977 GMT [124347] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:51:20.978 GMT [124347] ERROR:  permission denied for table credit_account
2023-01-17 08:51:20.978 GMT [124347] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.978 GMT [124347] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:51:20.978 GMT [124347] ERROR:  permission denied for table credit_account
2023-01-17 08:51:20.978 GMT [124347] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:20.978 GMT [124347] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:51:20.978 GMT [124347] ERROR:  permission denied for table loan
2023-01-17 08:51:20.978 GMT [124347] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:51:20.978 GMT [124347] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:51:20.978 GMT [124347] ERROR:  permission denied for table management_log
2023-01-17 08:51:20.978 GMT [124347] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:51:20.978 GMT [124347] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:51:20.985 GMT [124347] ERROR:  permission denied for table account
2023-01-17 08:51:20.985 GMT [124347] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:51:20.985 GMT [124347] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:51:47.232 GMT [124318] LOG:  received fast shutdown request
2023-01-17 08:51:47.234 GMT [124318] LOG:  aborting any active transactions
2023-01-17 08:51:47.239 GMT [124318] LOG:  background worker "logical replication launcher" (PID 124325) exited with exit code 1
2023-01-17 08:51:47.239 GMT [124320] LOG:  shutting down
2023-01-17 08:51:47.286 GMT [124318] LOG:  database system is shut down
2023-01-17 08:51:48.394 GMT [124505] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:51:48.395 GMT [124505] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:51:48.397 GMT [124505] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:51:48.401 GMT [124506] LOG:  database system was shut down at 2023-01-17 08:51:48 GMT
2023-01-17 08:51:48.407 GMT [124505] LOG:  database system is ready to accept connections
2023-01-17 08:51:49.090 GMT [124531] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:51:49.090 GMT [124531] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:51:49.176 GMT [124531] ERROR:  permission denied for table savings_account
2023-01-17 08:51:49.176 GMT [124531] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.176 GMT [124531] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:51:49.177 GMT [124531] ERROR:  permission denied for table savings_account
2023-01-17 08:51:49.177 GMT [124531] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.177 GMT [124531] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:51:49.177 GMT [124531] ERROR:  permission denied for table savings_account
2023-01-17 08:51:49.177 GMT [124531] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.177 GMT [124531] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:51:49.178 GMT [124531] ERROR:  permission denied for table savings_account
2023-01-17 08:51:49.178 GMT [124531] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.178 GMT [124531] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:51:49.179 GMT [124531] ERROR:  permission denied for table savings_account
2023-01-17 08:51:49.179 GMT [124531] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.179 GMT [124531] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:51:49.179 GMT [124531] ERROR:  permission denied for table debit_account
2023-01-17 08:51:49.179 GMT [124531] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.179 GMT [124531] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:51:49.180 GMT [124531] ERROR:  permission denied for table debit_account
2023-01-17 08:51:49.180 GMT [124531] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.180 GMT [124531] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:51:49.180 GMT [124531] ERROR:  permission denied for table debit_account
2023-01-17 08:51:49.180 GMT [124531] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.180 GMT [124531] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:51:49.180 GMT [124531] ERROR:  permission denied for table debit_account
2023-01-17 08:51:49.180 GMT [124531] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.180 GMT [124531] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:51:49.181 GMT [124531] ERROR:  permission denied for table credit_account
2023-01-17 08:51:49.181 GMT [124531] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.181 GMT [124531] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:51:49.181 GMT [124531] ERROR:  permission denied for table credit_account
2023-01-17 08:51:49.181 GMT [124531] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.181 GMT [124531] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:51:49.181 GMT [124531] ERROR:  permission denied for table credit_account
2023-01-17 08:51:49.181 GMT [124531] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.181 GMT [124531] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:51:49.181 GMT [124531] ERROR:  permission denied for table credit_account
2023-01-17 08:51:49.181 GMT [124531] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 08:51:49.181 GMT [124531] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:51:49.182 GMT [124531] ERROR:  permission denied for table loan
2023-01-17 08:51:49.182 GMT [124531] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:51:49.182 GMT [124531] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:51:49.182 GMT [124531] ERROR:  permission denied for sequence management_log_id_seq
2023-01-17 08:51:49.182 GMT [124531] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:51:49.182 GMT [124531] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:51:49.185 GMT [124531] ERROR:  permission denied for table account
2023-01-17 08:51:49.185 GMT [124531] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 08:51:49.185 GMT [124531] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 08:54:03.670 GMT [124505] LOG:  received fast shutdown request
2023-01-17 08:54:03.671 GMT [124505] LOG:  aborting any active transactions
2023-01-17 08:54:03.675 GMT [124505] LOG:  background worker "logical replication launcher" (PID 124512) exited with exit code 1
2023-01-17 08:54:03.675 GMT [124507] LOG:  shutting down
2023-01-17 08:54:03.727 GMT [124505] LOG:  database system is shut down
2023-01-17 08:54:04.890 GMT [125004] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:54:04.890 GMT [125004] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:54:04.892 GMT [125004] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:54:04.897 GMT [125005] LOG:  database system was shut down at 2023-01-17 08:54:04 GMT
2023-01-17 08:54:04.903 GMT [125004] LOG:  database system is ready to accept connections
2023-01-17 08:54:05.656 GMT [125030] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:54:05.656 GMT [125030] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:54:05.755 GMT [125030] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:54:05.755 GMT [125030] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.755 GMT [125030] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:54:05.756 GMT [125030] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:54:05.756 GMT [125030] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.756 GMT [125030] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:54:05.756 GMT [125030] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:54:05.756 GMT [125030] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.756 GMT [125030] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:54:05.756 GMT [125030] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:54:05.756 GMT [125030] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.756 GMT [125030] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:54:05.757 GMT [125030] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:54:05.757 GMT [125030] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.757 GMT [125030] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:54:05.757 GMT [125030] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:54:05.757 GMT [125030] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.757 GMT [125030] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:54:05.758 GMT [125030] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:54:05.758 GMT [125030] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.758 GMT [125030] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:54:05.759 GMT [125030] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:54:05.759 GMT [125030] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.759 GMT [125030] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:54:05.760 GMT [125030] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:54:05.760 GMT [125030] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.760 GMT [125030] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:54:05.761 GMT [125030] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:54:05.761 GMT [125030] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.761 GMT [125030] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:54:05.762 GMT [125030] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:54:05.762 GMT [125030] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.762 GMT [125030] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:54:05.764 GMT [125030] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:54:05.764 GMT [125030] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.764 GMT [125030] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:54:05.765 GMT [125030] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:54:05.765 GMT [125030] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:54:05.765 GMT [125030] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:54:05.766 GMT [125030] ERROR:  permission denied for sequence loan_id_seq
2023-01-17 08:54:05.766 GMT [125030] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:54:05.766 GMT [125030] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:54:05.767 GMT [125030] ERROR:  permission denied for sequence management_log_id_seq
2023-01-17 08:54:05.767 GMT [125030] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:54:05.767 GMT [125030] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:55:10.200 GMT [125004] LOG:  received fast shutdown request
2023-01-17 08:55:10.201 GMT [125004] LOG:  aborting any active transactions
2023-01-17 08:55:10.205 GMT [125004] LOG:  background worker "logical replication launcher" (PID 125011) exited with exit code 1
2023-01-17 08:55:10.208 GMT [125006] LOG:  shutting down
2023-01-17 08:55:10.266 GMT [125004] LOG:  database system is shut down
2023-01-17 08:55:11.425 GMT [125324] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:55:11.425 GMT [125324] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:55:11.427 GMT [125324] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:55:11.432 GMT [125325] LOG:  database system was shut down at 2023-01-17 08:55:11 GMT
2023-01-17 08:55:11.440 GMT [125324] LOG:  database system is ready to accept connections
2023-01-17 08:55:12.354 GMT [125354] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:55:12.354 GMT [125354] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:55:12.470 GMT [125354] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:55:12.470 GMT [125354] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.470 GMT [125354] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:55:12.471 GMT [125354] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:55:12.471 GMT [125354] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.471 GMT [125354] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 08:55:12.472 GMT [125354] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:55:12.472 GMT [125354] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.472 GMT [125354] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 08:55:12.473 GMT [125354] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:55:12.473 GMT [125354] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.473 GMT [125354] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 08:55:12.475 GMT [125354] ERROR:  permission denied for sequence savings_statement_id_seq
2023-01-17 08:55:12.475 GMT [125354] CONTEXT:  SQL statement "INSERT INTO savings_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, savings_account_id)"
	PL/pgSQL function open_savings_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.475 GMT [125354] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 08:55:12.477 GMT [125354] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:55:12.477 GMT [125354] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.477 GMT [125354] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 08:55:12.479 GMT [125354] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:55:12.479 GMT [125354] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.479 GMT [125354] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 08:55:12.480 GMT [125354] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:55:12.480 GMT [125354] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.480 GMT [125354] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 08:55:12.481 GMT [125354] ERROR:  permission denied for sequence debit_statement_id_seq
2023-01-17 08:55:12.481 GMT [125354] CONTEXT:  SQL statement "INSERT INTO debit_statement (starting_date, end_date, amount, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, debit_account_number)"
	PL/pgSQL function open_debit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.481 GMT [125354] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 08:55:12.484 GMT [125354] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:55:12.484 GMT [125354] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.484 GMT [125354] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 08:55:12.485 GMT [125354] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:55:12.485 GMT [125354] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.485 GMT [125354] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 08:55:12.486 GMT [125354] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:55:12.486 GMT [125354] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.486 GMT [125354] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 08:55:12.487 GMT [125354] ERROR:  permission denied for sequence credit_statement_id_seq
2023-01-17 08:55:12.487 GMT [125354] CONTEXT:  SQL statement "INSERT INTO credit_statement (starting_date, end_date, amount, minimum_payment, minimum_payment_due_date, account_number) VALUES (date_trunc('month', now()::date), (date_trunc('month', now()::date)) + interval '1 month - 1 day', 0, 0, CURRENT_DATE, credit_account_number)"
	PL/pgSQL function open_credit_account(integer) line 12 at SQL statement
2023-01-17 08:55:12.487 GMT [125354] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 08:55:12.489 GMT [125354] ERROR:  permission denied for sequence loan_id_seq
2023-01-17 08:55:12.489 GMT [125354] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 08:55:12.489 GMT [125354] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 08:55:12.490 GMT [125354] ERROR:  permission denied for sequence management_log_id_seq
2023-01-17 08:55:12.490 GMT [125354] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 08:55:12.490 GMT [125354] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 08:55:35.773 GMT [125324] LOG:  received fast shutdown request
2023-01-17 08:55:35.774 GMT [125324] LOG:  aborting any active transactions
2023-01-17 08:55:35.781 GMT [125324] LOG:  background worker "logical replication launcher" (PID 125331) exited with exit code 1
2023-01-17 08:55:35.783 GMT [125326] LOG:  shutting down
2023-01-17 08:55:35.840 GMT [125324] LOG:  database system is shut down
2023-01-17 08:55:37.207 GMT [125515] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 08:55:37.207 GMT [125515] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 08:55:37.209 GMT [125515] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 08:55:37.214 GMT [125516] LOG:  database system was shut down at 2023-01-17 08:55:36 GMT
2023-01-17 08:55:37.221 GMT [125515] LOG:  database system is ready to accept connections
2023-01-17 08:55:38.099 GMT [125554] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 08:55:38.099 GMT [125554] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 08:55:38.249 GMT [125554] ERROR:  permission denied for schema bank at character 15
2023-01-17 08:55:38.249 GMT [125554] QUERY:  SELECT * FROM bank.verify_transaction(NEW.id)
2023-01-17 08:55:38.249 GMT [125554] CONTEXT:  PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 27 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 08:55:38.249 GMT [125554] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 09:02:42.781 GMT [125515] LOG:  received fast shutdown request
2023-01-17 09:02:42.783 GMT [125515] LOG:  aborting any active transactions
2023-01-17 09:02:42.787 GMT [125515] LOG:  background worker "logical replication launcher" (PID 125522) exited with exit code 1
2023-01-17 09:02:42.787 GMT [125517] LOG:  shutting down
2023-01-17 09:02:42.800 GMT [125515] LOG:  database system is shut down
2023-01-17 09:02:43.947 GMT [126758] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 09:02:43.947 GMT [126758] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 09:02:43.949 GMT [126758] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 09:02:43.953 GMT [126759] LOG:  database system was shut down at 2023-01-17 09:02:43 GMT
2023-01-17 09:02:43.959 GMT [126758] LOG:  database system is ready to accept connections
2023-01-17 09:02:44.670 GMT [126784] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 09:02:44.670 GMT [126784] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 09:04:14.442 GMT [126758] LOG:  received fast shutdown request
2023-01-17 09:04:14.444 GMT [126758] LOG:  aborting any active transactions
2023-01-17 09:04:14.448 GMT [126758] LOG:  background worker "logical replication launcher" (PID 126765) exited with exit code 1
2023-01-17 09:04:14.448 GMT [126760] LOG:  shutting down
2023-01-17 09:04:14.498 GMT [126758] LOG:  database system is shut down
2023-01-17 09:04:15.647 GMT [127136] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 09:04:15.647 GMT [127136] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 09:04:15.654 GMT [127136] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 09:04:15.660 GMT [127137] LOG:  database system was shut down at 2023-01-17 09:04:15 GMT
2023-01-17 09:04:15.668 GMT [127136] LOG:  database system is ready to accept connections
2023-01-17 09:04:16.380 GMT [127165] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 09:04:16.380 GMT [127165] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 09:04:16.472 GMT [127165] ERROR:  invalid privilege type INSERT for sequence
2023-01-17 09:04:16.472 GMT [127165] STATEMENT:  GRANT INSERT ON ALL SEQUENCES IN SCHEMA public TO l2;
2023-01-17 09:04:16.474 GMT [127165] ERROR:  permission denied for table savings_account
2023-01-17 09:04:16.474 GMT [127165] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.474 GMT [127165] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 09:04:16.474 GMT [127165] ERROR:  permission denied for table savings_account
2023-01-17 09:04:16.474 GMT [127165] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.474 GMT [127165] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 09:04:16.475 GMT [127165] ERROR:  permission denied for table savings_account
2023-01-17 09:04:16.475 GMT [127165] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.475 GMT [127165] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 09:04:16.475 GMT [127165] ERROR:  permission denied for table savings_account
2023-01-17 09:04:16.475 GMT [127165] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.475 GMT [127165] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 09:04:16.475 GMT [127165] ERROR:  permission denied for table savings_account
2023-01-17 09:04:16.475 GMT [127165] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.475 GMT [127165] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 09:04:16.476 GMT [127165] ERROR:  permission denied for table debit_account
2023-01-17 09:04:16.476 GMT [127165] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.476 GMT [127165] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 09:04:16.477 GMT [127165] ERROR:  permission denied for table debit_account
2023-01-17 09:04:16.477 GMT [127165] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.477 GMT [127165] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 09:04:16.478 GMT [127165] ERROR:  permission denied for table debit_account
2023-01-17 09:04:16.478 GMT [127165] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.478 GMT [127165] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 09:04:16.479 GMT [127165] ERROR:  permission denied for table debit_account
2023-01-17 09:04:16.479 GMT [127165] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.479 GMT [127165] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 09:04:16.481 GMT [127165] ERROR:  permission denied for table credit_account
2023-01-17 09:04:16.481 GMT [127165] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.481 GMT [127165] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 09:04:16.482 GMT [127165] ERROR:  permission denied for table credit_account
2023-01-17 09:04:16.482 GMT [127165] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.482 GMT [127165] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 09:04:16.483 GMT [127165] ERROR:  permission denied for table credit_account
2023-01-17 09:04:16.483 GMT [127165] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.483 GMT [127165] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 09:04:16.484 GMT [127165] ERROR:  permission denied for table credit_account
2023-01-17 09:04:16.484 GMT [127165] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 09:04:16.484 GMT [127165] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 09:04:16.484 GMT [127165] ERROR:  permission denied for table loan
2023-01-17 09:04:16.484 GMT [127165] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 09:04:16.484 GMT [127165] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 09:04:16.485 GMT [127165] ERROR:  permission denied for sequence management_log_id_seq
2023-01-17 09:04:16.485 GMT [127165] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 09:04:16.485 GMT [127165] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 09:04:16.490 GMT [127165] ERROR:  permission denied for table account
2023-01-17 09:04:16.490 GMT [127165] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 09:04:16.490 GMT [127165] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 12:07:23.940 GMT [127136] LOG:  received smart shutdown request
2023-01-17 12:07:23.952 GMT [127136] LOG:  background worker "logical replication launcher" (PID 127143) exited with exit code 1
2023-01-17 12:07:23.953 GMT [127136] LOG:  received SIGHUP, reloading configuration files
2023-01-17 12:07:23.972 GMT [127138] LOG:  shutting down
2023-01-17 12:07:24.011 GMT [127136] LOG:  database system is shut down
2023-01-17 17:51:18.707 GMT [96046] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 17:51:18.710 GMT [96046] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 17:51:18.712 GMT [96046] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 17:51:18.717 GMT [96047] LOG:  database system was shut down at 2023-01-17 17:51:18 GMT
2023-01-17 17:51:18.723 GMT [96046] LOG:  database system is ready to accept connections
2023-01-17 17:51:19.518 GMT [96075] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 17:51:19.518 GMT [96075] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 17:51:19.691 GMT [96075] ERROR:  syntax error at or near "INSERT" at character 79
2023-01-17 17:51:19.691 GMT [96075] STATEMENT:  CREATE ROLE janesmith WITH LOGIN PASSWORD '155f25da0ecfab1f56f21310490daaa7'
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-17 17:51:19.693 GMT [96075] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-17 17:51:19.693 GMT [96075] DETAIL:  Key (question_choice_id)=(1) is not present in table "security_question_option".
2023-01-17 17:51:19.693 GMT [96075] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
2023-01-17 17:51:19.695 GMT [96075] ERROR:  insert or update on table "security_question_answer" violates foreign key constraint "security_question_answer_question_id_fkey"
2023-01-17 17:51:19.695 GMT [96075] DETAIL:  Key (question_id)=(1) is not present in table "user_login_security_question".
2023-01-17 17:51:19.695 GMT [96075] STATEMENT:  INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-17 17:54:43.350 GMT [96046] LOG:  received fast shutdown request
2023-01-17 17:54:43.352 GMT [96046] LOG:  aborting any active transactions
2023-01-17 17:54:43.355 GMT [96046] LOG:  background worker "logical replication launcher" (PID 96053) exited with exit code 1
2023-01-17 17:54:43.357 GMT [96048] LOG:  shutting down
2023-01-17 17:54:43.410 GMT [96046] LOG:  database system is shut down
2023-01-17 17:54:44.535 GMT [102830] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 17:54:44.535 GMT [102830] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 17:54:44.536 GMT [102830] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 17:54:44.542 GMT [102831] LOG:  database system was shut down at 2023-01-17 17:54:44 GMT
2023-01-17 17:54:44.548 GMT [102830] LOG:  database system is ready to accept connections
2023-01-17 17:54:45.328 GMT [102899] ERROR:  syntax error at or near "TABLE" at character 91
2023-01-17 17:54:45.328 GMT [102899] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURN TABLE(first_name TEXT, last_name TEXT, date_of_birth DATE, address TEXT, email TEXT, phone_number TEXT) AS $$
	BEGIN
	    RETURN QUERY SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 17:54:45.487 GMT [102899] ERROR:  syntax error at or near "INSERT" at character 79
2023-01-17 17:54:45.487 GMT [102899] STATEMENT:  CREATE ROLE janesmith WITH LOGIN PASSWORD '155f25da0ecfab1f56f21310490daaa7'
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-17 17:54:45.488 GMT [102899] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-17 17:54:45.488 GMT [102899] DETAIL:  Key (question_choice_id)=(1) is not present in table "security_question_option".
2023-01-17 17:54:45.488 GMT [102899] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
2023-01-17 17:54:45.489 GMT [102899] ERROR:  insert or update on table "security_question_answer" violates foreign key constraint "security_question_answer_question_id_fkey"
2023-01-17 17:54:45.489 GMT [102899] DETAIL:  Key (question_id)=(1) is not present in table "user_login_security_question".
2023-01-17 17:54:45.489 GMT [102899] STATEMENT:  INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-17 17:55:17.225 GMT [102830] LOG:  received fast shutdown request
2023-01-17 17:55:17.230 GMT [102830] LOG:  aborting any active transactions
2023-01-17 17:55:17.235 GMT [102830] LOG:  background worker "logical replication launcher" (PID 102837) exited with exit code 1
2023-01-17 17:55:17.235 GMT [102832] LOG:  shutting down
2023-01-17 17:55:17.302 GMT [102830] LOG:  database system is shut down
2023-01-17 17:55:18.419 GMT [104036] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 17:55:18.420 GMT [104036] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 17:55:18.421 GMT [104036] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 17:55:18.427 GMT [104037] LOG:  database system was shut down at 2023-01-17 17:55:18 GMT
2023-01-17 17:55:18.432 GMT [104036] LOG:  database system is ready to accept connections
2023-01-17 17:55:19.558 GMT [104128] ERROR:  syntax error at or near "INSERT" at character 79
2023-01-17 17:55:19.558 GMT [104128] STATEMENT:  CREATE ROLE janesmith WITH LOGIN PASSWORD '155f25da0ecfab1f56f21310490daaa7'
	
	INSERT INTO security_question_option (question_description)
	VALUES ('What is your favourite colour?'),
	('What is your favourite food?'),
	('What is your favourite animal?'),
	('What is your favourite sport?'),
	('What is your favourite movie?'),
	('What is your favourite book?'),
	('What is your favourite song?'),
	('What is your favourite band?'),
	('What is your favourite game?'),
	('What is your favourite TV show?');
2023-01-17 17:55:19.559 GMT [104128] ERROR:  insert or update on table "user_login_security_question" violates foreign key constraint "user_login_security_question_question_choice_id_fkey"
2023-01-17 17:55:19.559 GMT [104128] DETAIL:  Key (question_choice_id)=(1) is not present in table "security_question_option".
2023-01-17 17:55:19.559 GMT [104128] STATEMENT:  INSERT INTO user_login_security_question (question_choice_id, login_id)
	VALUES (1, 1),
	(2, 2),
	(3, 3),
	(4, 4),
	(5, 5),
	(6, 6),
	(7, 7),
	(8, 8),
	(9, 9);
2023-01-17 17:55:19.561 GMT [104128] ERROR:  insert or update on table "security_question_answer" violates foreign key constraint "security_question_answer_question_id_fkey"
2023-01-17 17:55:19.561 GMT [104128] DETAIL:  Key (question_id)=(1) is not present in table "user_login_security_question".
2023-01-17 17:55:19.561 GMT [104128] STATEMENT:  INSERT INTO security_question_answer (question_answer, question_id)
	VALUES ('Red', 1),
	('Blue', 2),
	('Green', 3),
	('Yellow', 4),
	('Orange', 5),
	('Purple', 6),
	('Pink', 7),
	('Black', 8),
	('White', 9);
2023-01-17 17:58:35.578 GMT [104036] LOG:  received fast shutdown request
2023-01-17 17:58:35.581 GMT [104036] LOG:  aborting any active transactions
2023-01-17 17:58:35.583 GMT [104036] LOG:  background worker "logical replication launcher" (PID 104043) exited with exit code 1
2023-01-17 17:58:35.587 GMT [104038] LOG:  shutting down
2023-01-17 17:58:35.641 GMT [104036] LOG:  database system is shut down
2023-01-17 17:58:36.695 GMT [110581] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 17:58:36.696 GMT [110581] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 17:58:36.698 GMT [110581] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 17:58:36.702 GMT [110582] LOG:  database system was shut down at 2023-01-17 17:58:36 GMT
2023-01-17 17:58:36.708 GMT [110581] LOG:  database system is ready to accept connections
2023-01-17 18:01:50.877 GMT [110581] LOG:  received fast shutdown request
2023-01-17 18:01:50.879 GMT [110581] LOG:  aborting any active transactions
2023-01-17 18:01:50.884 GMT [110581] LOG:  background worker "logical replication launcher" (PID 110588) exited with exit code 1
2023-01-17 18:01:50.884 GMT [110583] LOG:  shutting down
2023-01-17 18:01:50.939 GMT [110581] LOG:  database system is shut down
2023-01-17 18:01:52.172 GMT [117079] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:01:52.172 GMT [117079] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:01:52.174 GMT [117079] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:01:52.179 GMT [117080] LOG:  database system was shut down at 2023-01-17 18:01:51 GMT
2023-01-17 18:01:52.187 GMT [117079] LOG:  database system is ready to accept connections
2023-01-17 18:01:53.123 GMT [117105] ERROR:  syntax error at or near "." at character 103
2023-01-17 18:01:53.123 GMT [117105] STATEMENT:  GRANT user_banking TO johnsmith, janedoe, joebloggs, johnbloggs, janebloggs, joedoe, johndoe, joesmith. janesmith;
2023-01-17 18:02:04.255 GMT [117079] LOG:  received fast shutdown request
2023-01-17 18:02:04.257 GMT [117079] LOG:  aborting any active transactions
2023-01-17 18:02:04.261 GMT [117079] LOG:  background worker "logical replication launcher" (PID 117086) exited with exit code 1
2023-01-17 18:02:04.262 GMT [117081] LOG:  shutting down
2023-01-17 18:02:04.316 GMT [117079] LOG:  database system is shut down
2023-01-17 18:02:05.537 GMT [117626] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:02:05.537 GMT [117626] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:02:05.538 GMT [117626] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:02:05.542 GMT [117627] LOG:  database system was shut down at 2023-01-17 18:02:05 GMT
2023-01-17 18:02:05.547 GMT [117626] LOG:  database system is ready to accept connections
2023-01-17 18:11:58.385 GMT [117626] LOG:  received fast shutdown request
2023-01-17 18:11:58.387 GMT [117626] LOG:  aborting any active transactions
2023-01-17 18:11:58.390 GMT [117626] LOG:  background worker "logical replication launcher" (PID 117633) exited with exit code 1
2023-01-17 18:11:58.393 GMT [117628] LOG:  shutting down
2023-01-17 18:11:58.410 GMT [117626] LOG:  database system is shut down
2023-01-17 18:11:59.549 GMT [137125] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:11:59.550 GMT [137125] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:11:59.551 GMT [137125] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:11:59.555 GMT [137126] LOG:  database system was shut down at 2023-01-17 18:11:59 GMT
2023-01-17 18:11:59.560 GMT [137125] LOG:  database system is ready to accept connections
2023-01-17 18:12:00.496 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.496 GMT [137205] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 18:12:00.496 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.496 GMT [137205] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 18:12:00.496 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.496 GMT [137205] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 18:12:00.496 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.496 GMT [137205] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 18:12:00.496 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.496 GMT [137205] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 18:12:00.497 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.497 GMT [137205] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 18:12:00.498 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.498 GMT [137205] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 18:12:00.498 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.498 GMT [137205] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 18:12:00.498 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.498 GMT [137205] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 18:12:00.498 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.498 GMT [137205] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:12:00.498 GMT [137205] ERROR:  permission denied for schema client at character 15
2023-01-17 18:12:00.498 GMT [137205] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:14:34.501 GMT [137125] LOG:  received fast shutdown request
2023-01-17 18:14:34.503 GMT [137125] LOG:  aborting any active transactions
2023-01-17 18:14:34.508 GMT [137125] LOG:  background worker "logical replication launcher" (PID 137132) exited with exit code 1
2023-01-17 18:14:34.510 GMT [137127] LOG:  shutting down
2023-01-17 18:14:34.556 GMT [137125] LOG:  database system is shut down
2023-01-17 18:14:39.202 GMT [142772] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:14:39.202 GMT [142772] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:14:39.203 GMT [142772] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:14:39.208 GMT [142773] LOG:  database system was shut down at 2023-01-17 18:14:38 GMT
2023-01-17 18:14:39.217 GMT [142772] LOG:  database system is ready to accept connections
2023-01-17 18:14:40.204 GMT [142816] ERROR:  permission denied for table savings_account
2023-01-17 18:14:40.204 GMT [142816] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.204 GMT [142816] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 18:14:40.204 GMT [142816] ERROR:  permission denied for table savings_account
2023-01-17 18:14:40.204 GMT [142816] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.204 GMT [142816] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-17 18:14:40.204 GMT [142816] ERROR:  permission denied for table savings_account
2023-01-17 18:14:40.204 GMT [142816] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.204 GMT [142816] STATEMENT:  SELECT * FROM client.open_savings_account(2);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table savings_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_savings_account(3);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table savings_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO savings_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 10000, 0.01) RETURNING account_number"
	PL/pgSQL function open_savings_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_savings_account(4);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table debit_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table debit_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_debit_account(2);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table debit_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_debit_account(3);
2023-01-17 18:14:40.205 GMT [142816] ERROR:  permission denied for table debit_account
2023-01-17 18:14:40.205 GMT [142816] CONTEXT:  SQL statement "INSERT INTO debit_account (account_number, account_id, current_balance, interest_rate) VALUES (next_account_number ,account_id, 0, 0.01) RETURNING account_number"
	PL/pgSQL function open_debit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.205 GMT [142816] STATEMENT:  SELECT * FROM client.open_debit_account(4);
2023-01-17 18:14:40.206 GMT [142816] ERROR:  permission denied for table credit_account
2023-01-17 18:14:40.206 GMT [142816] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.206 GMT [142816] STATEMENT:  SELECT * FROM client.open_credit_account(1);
2023-01-17 18:14:40.206 GMT [142816] ERROR:  permission denied for table credit_account
2023-01-17 18:14:40.206 GMT [142816] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.206 GMT [142816] STATEMENT:  SELECT * FROM client.open_credit_account(2);
2023-01-17 18:14:40.206 GMT [142816] ERROR:  permission denied for table credit_account
2023-01-17 18:14:40.206 GMT [142816] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.206 GMT [142816] STATEMENT:  SELECT * FROM client.open_credit_account(3);
2023-01-17 18:14:40.206 GMT [142816] ERROR:  permission denied for table credit_account
2023-01-17 18:14:40.206 GMT [142816] CONTEXT:  SQL statement "INSERT INTO credit_account (account_number, outstanding_balance, credit_limit, interest_rate, account_id) VALUES (next_account_number ,0, 0, 24.9, account_id) RETURNING account_number"
	PL/pgSQL function open_credit_account(integer) line 10 at SQL statement
2023-01-17 18:14:40.206 GMT [142816] STATEMENT:  SELECT * FROM client.open_credit_account(4);
2023-01-17 18:14:40.207 GMT [142816] ERROR:  permission denied for table loan
2023-01-17 18:14:40.207 GMT [142816] CONTEXT:  SQL statement "INSERT INTO loan (account_id, amount, end_date, loan_type, interest_rate) VALUES (account_id, 0, loan_end_date, loan_type, loan_interest_rate) RETURNING id"
	PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 6 at SQL statement
2023-01-17 18:14:40.207 GMT [142816] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-17 18:14:40.207 GMT [142816] ERROR:  permission denied for table management_log
2023-01-17 18:14:40.207 GMT [142816] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 18:14:40.207 GMT [142816] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:14:40.210 GMT [142816] ERROR:  permission denied for table account
2023-01-17 18:14:40.210 GMT [142816] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:14:40.210 GMT [142816] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:15:43.767 GMT [142772] LOG:  received fast shutdown request
2023-01-17 18:15:43.769 GMT [142772] LOG:  aborting any active transactions
2023-01-17 18:15:43.776 GMT [142772] LOG:  background worker "logical replication launcher" (PID 142779) exited with exit code 1
2023-01-17 18:15:43.777 GMT [142774] LOG:  shutting down
2023-01-17 18:15:43.829 GMT [142772] LOG:  database system is shut down
2023-01-17 18:15:45.035 GMT [145041] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:15:45.035 GMT [145041] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:15:45.037 GMT [145041] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:15:45.040 GMT [145042] LOG:  database system was shut down at 2023-01-17 18:15:44 GMT
2023-01-17 18:15:45.046 GMT [145041] LOG:  database system is ready to accept connections
2023-01-17 18:15:46.030 GMT [145067] ERROR:  permission denied for table management_log
2023-01-17 18:15:46.030 GMT [145067] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 18:15:46.030 GMT [145067] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:15:46.034 GMT [145067] ERROR:  permission denied for table account
2023-01-17 18:15:46.034 GMT [145067] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:15:46.034 GMT [145067] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:16:44.312 GMT [145041] LOG:  received fast shutdown request
2023-01-17 18:16:44.314 GMT [145041] LOG:  aborting any active transactions
2023-01-17 18:16:44.319 GMT [145041] LOG:  background worker "logical replication launcher" (PID 145048) exited with exit code 1
2023-01-17 18:16:44.321 GMT [145043] LOG:  shutting down
2023-01-17 18:16:44.368 GMT [145041] LOG:  database system is shut down
2023-01-17 18:16:45.464 GMT [147150] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:16:45.464 GMT [147150] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:16:45.466 GMT [147150] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:16:45.471 GMT [147151] LOG:  database system was shut down at 2023-01-17 18:16:45 GMT
2023-01-17 18:16:45.475 GMT [147150] LOG:  database system is ready to accept connections
2023-01-17 18:16:46.486 GMT [147179] ERROR:  permission denied for sequence management_log_id_seq
2023-01-17 18:16:46.486 GMT [147179] CONTEXT:  SQL statement "INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 6 at SQL statement
2023-01-17 18:16:46.486 GMT [147179] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:16:46.490 GMT [147179] ERROR:  permission denied for table account
2023-01-17 18:16:46.490 GMT [147179] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:16:46.490 GMT [147179] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:17:16.357 GMT [147150] LOG:  received fast shutdown request
2023-01-17 18:17:16.359 GMT [147150] LOG:  aborting any active transactions
2023-01-17 18:17:16.363 GMT [147150] LOG:  background worker "logical replication launcher" (PID 147157) exited with exit code 1
2023-01-17 18:17:16.366 GMT [147152] LOG:  shutting down
2023-01-17 18:17:16.415 GMT [147150] LOG:  database system is shut down
2023-01-17 18:17:17.456 GMT [148288] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:17:17.457 GMT [148288] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:17:17.458 GMT [148288] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:17:17.464 GMT [148289] LOG:  database system was shut down at 2023-01-17 18:17:17 GMT
2023-01-17 18:17:17.469 GMT [148288] LOG:  database system is ready to accept connections
2023-01-17 18:17:18.422 GMT [148317] ERROR:  permission denied for view debit_accounts
2023-01-17 18:17:18.422 GMT [148317] CONTEXT:  SQL expression "EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 8 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 18:17:18.422 GMT [148317] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:17:18.426 GMT [148317] ERROR:  permission denied for table account
2023-01-17 18:17:18.426 GMT [148317] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:17:18.426 GMT [148317] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:20:00.702 GMT [148288] LOG:  received fast shutdown request
2023-01-17 18:20:00.704 GMT [148288] LOG:  aborting any active transactions
2023-01-17 18:20:00.709 GMT [148288] LOG:  background worker "logical replication launcher" (PID 148295) exited with exit code 1
2023-01-17 18:20:00.709 GMT [148290] LOG:  shutting down
2023-01-17 18:20:00.753 GMT [148288] LOG:  database system is shut down
2023-01-17 18:20:01.873 GMT [153706] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:20:01.873 GMT [153706] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:20:01.876 GMT [153706] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:20:01.881 GMT [153707] LOG:  database system was shut down at 2023-01-17 18:20:01 GMT
2023-01-17 18:20:01.890 GMT [153706] LOG:  database system is ready to accept connections
2023-01-17 18:20:02.791 GMT [153732] ERROR:  permission denied for table savings_statement
2023-01-17 18:20:02.791 GMT [153732] CONTEXT:  SQL expression "EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date)"
	PL/pgSQL function get_or_create_statement(integer,integer) line 23 at IF
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 18:20:02.791 GMT [153732] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:20:02.794 GMT [153732] ERROR:  permission denied for table account
2023-01-17 18:20:02.794 GMT [153732] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:20:02.794 GMT [153732] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:20:19.961 GMT [153706] LOG:  received fast shutdown request
2023-01-17 18:20:19.963 GMT [153706] LOG:  aborting any active transactions
2023-01-17 18:20:19.969 GMT [153706] LOG:  background worker "logical replication launcher" (PID 153713) exited with exit code 1
2023-01-17 18:20:19.970 GMT [153708] LOG:  shutting down
2023-01-17 18:20:20.028 GMT [153706] LOG:  database system is shut down
2023-01-17 18:20:21.099 GMT [154392] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:20:21.099 GMT [154392] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:20:21.103 GMT [154392] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:20:21.108 GMT [154393] LOG:  database system was shut down at 2023-01-17 18:20:20 GMT
2023-01-17 18:20:21.115 GMT [154392] LOG:  database system is ready to accept connections
2023-01-17 18:20:22.094 GMT [154484] ERROR:  permission denied for view debit_accounts
2023-01-17 18:20:22.094 GMT [154484] CONTEXT:  SQL expression "EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 8 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 18:20:22.094 GMT [154484] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:20:22.097 GMT [154484] ERROR:  permission denied for table account
2023-01-17 18:20:22.097 GMT [154484] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:20:22.097 GMT [154484] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:20:28.589 GMT [154392] LOG:  received fast shutdown request
2023-01-17 18:20:28.590 GMT [154392] LOG:  aborting any active transactions
2023-01-17 18:20:28.595 GMT [154392] LOG:  background worker "logical replication launcher" (PID 154399) exited with exit code 1
2023-01-17 18:20:28.596 GMT [154394] LOG:  shutting down
2023-01-17 18:20:28.644 GMT [154392] LOG:  database system is shut down
2023-01-17 18:20:29.779 GMT [154784] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:20:29.780 GMT [154784] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:20:29.781 GMT [154784] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:20:29.784 GMT [154785] LOG:  database system was shut down at 2023-01-17 18:20:29 GMT
2023-01-17 18:20:29.790 GMT [154784] LOG:  database system is ready to accept connections
2023-01-17 18:20:30.818 GMT [154813] ERROR:  permission denied for table savings_statement
2023-01-17 18:20:30.818 GMT [154813] CONTEXT:  SQL expression "EXISTS (SELECT * FROM savings_statement WHERE account_number = orig_account_number AND starting_date <= now()::date AND end_date >= now()::date)"
	PL/pgSQL function get_or_create_statement(integer,integer) line 23 at IF
	SQL statement "SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 18:20:30.818 GMT [154813] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:20:30.820 GMT [154813] ERROR:  permission denied for table account
2023-01-17 18:20:30.820 GMT [154813] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:20:30.820 GMT [154813] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:24:44.904 GMT [154784] LOG:  received fast shutdown request
2023-01-17 18:24:44.906 GMT [154784] LOG:  aborting any active transactions
2023-01-17 18:24:44.910 GMT [154784] LOG:  background worker "logical replication launcher" (PID 154791) exited with exit code 1
2023-01-17 18:24:44.911 GMT [154786] LOG:  shutting down
2023-01-17 18:24:44.961 GMT [154784] LOG:  database system is shut down
2023-01-17 18:24:46.010 GMT [163157] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:24:46.010 GMT [163157] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:24:46.012 GMT [163157] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:24:46.016 GMT [163158] LOG:  database system was shut down at 2023-01-17 18:24:45 GMT
2023-01-17 18:24:46.023 GMT [163157] LOG:  database system is ready to accept connections
2023-01-17 18:24:46.936 GMT [163183] ERROR:  permission denied for table transaction
2023-01-17 18:24:46.936 GMT [163183] CONTEXT:  SQL statement "INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	        VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 25 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 18:24:46.936 GMT [163183] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 18:24:46.938 GMT [163183] ERROR:  permission denied for table account
2023-01-17 18:24:46.938 GMT [163183] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:24:46.938 GMT [163183] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:25:52.263 GMT [163157] LOG:  received fast shutdown request
2023-01-17 18:25:52.265 GMT [163157] LOG:  aborting any active transactions
2023-01-17 18:25:52.271 GMT [163157] LOG:  background worker "logical replication launcher" (PID 163164) exited with exit code 1
2023-01-17 18:25:52.271 GMT [163159] LOG:  shutting down
2023-01-17 18:25:52.322 GMT [163157] LOG:  database system is shut down
2023-01-17 18:25:53.472 GMT [165443] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:25:53.472 GMT [165443] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:25:53.475 GMT [165443] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:25:53.479 GMT [165444] LOG:  database system was shut down at 2023-01-17 18:25:53 GMT
2023-01-17 18:25:53.485 GMT [165443] LOG:  database system is ready to accept connections
2023-01-17 18:25:54.445 GMT [165472] ERROR:  permission denied for table account
2023-01-17 18:25:54.445 GMT [165472] CONTEXT:  SQL statement "SELECT account.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:25:54.445 GMT [165472] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:29:08.189 GMT [165443] LOG:  received fast shutdown request
2023-01-17 18:29:08.191 GMT [165443] LOG:  aborting any active transactions
2023-01-17 18:29:08.196 GMT [165443] LOG:  background worker "logical replication launcher" (PID 165450) exited with exit code 1
2023-01-17 18:29:08.197 GMT [165445] LOG:  shutting down
2023-01-17 18:29:08.255 GMT [165443] LOG:  database system is shut down
2023-01-17 18:29:09.292 GMT [171859] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:29:09.292 GMT [171859] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:29:09.294 GMT [171859] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:29:09.297 GMT [171860] LOG:  database system was shut down at 2023-01-17 18:29:09 GMT
2023-01-17 18:29:09.302 GMT [171859] LOG:  database system is ready to accept connections
2023-01-17 18:29:10.246 GMT [171885] ERROR:  missing FROM-clause entry for table "accounts" at character 8
2023-01-17 18:29:10.246 GMT [171885] QUERY:  SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM account
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-17 18:29:10.246 GMT [171885] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:29:10.246 GMT [171885] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:29:29.688 GMT [171859] LOG:  received fast shutdown request
2023-01-17 18:29:29.689 GMT [171859] LOG:  aborting any active transactions
2023-01-17 18:29:29.691 GMT [171859] LOG:  background worker "logical replication launcher" (PID 171866) exited with exit code 1
2023-01-17 18:29:29.694 GMT [171861] LOG:  shutting down
2023-01-17 18:29:29.743 GMT [171859] LOG:  database system is shut down
2023-01-17 18:29:30.884 GMT [172681] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:29:30.884 GMT [172681] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:29:30.886 GMT [172681] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:29:30.891 GMT [172685] LOG:  database system was shut down at 2023-01-17 18:29:30 GMT
2023-01-17 18:29:30.897 GMT [172681] LOG:  database system is ready to accept connections
2023-01-17 18:29:31.809 GMT [172711] ERROR:  missing FROM-clause entry for table "account" at character 433
2023-01-17 18:29:31.809 GMT [172711] QUERY:  SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(account.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON account.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON account.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON account.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-17 18:29:31.809 GMT [172711] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:29:31.809 GMT [172711] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:29:56.254 GMT [172681] LOG:  received fast shutdown request
2023-01-17 18:29:56.255 GMT [172681] LOG:  aborting any active transactions
2023-01-17 18:29:56.260 GMT [172681] LOG:  background worker "logical replication launcher" (PID 172691) exited with exit code 1
2023-01-17 18:29:56.260 GMT [172686] LOG:  shutting down
2023-01-17 18:29:56.307 GMT [172681] LOG:  database system is shut down
2023-01-17 18:29:57.368 GMT [173586] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:29:57.369 GMT [173586] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:29:57.370 GMT [173586] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:29:57.375 GMT [173587] LOG:  database system was shut down at 2023-01-17 18:29:57 GMT
2023-01-17 18:29:57.380 GMT [173586] LOG:  database system is ready to accept connections
2023-01-17 18:29:58.404 GMT [173612] ERROR:  missing FROM-clause entry for table "account" at character 719
2023-01-17 18:29:58.404 GMT [173612] QUERY:  SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE account.account_id = account_identifier
2023-01-17 18:29:58.404 GMT [173612] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:29:58.404 GMT [173612] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:30:05.608 GMT [173586] LOG:  received fast shutdown request
2023-01-17 18:30:05.610 GMT [173586] LOG:  aborting any active transactions
2023-01-17 18:30:05.614 GMT [173586] LOG:  background worker "logical replication launcher" (PID 173593) exited with exit code 1
2023-01-17 18:30:05.614 GMT [173588] LOG:  shutting down
2023-01-17 18:30:05.668 GMT [173586] LOG:  database system is shut down
2023-01-17 18:30:07.100 GMT [173985] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:30:07.101 GMT [173985] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:30:07.103 GMT [173985] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:30:07.108 GMT [173986] LOG:  database system was shut down at 2023-01-17 18:30:06 GMT
2023-01-17 18:30:07.114 GMT [173985] LOG:  database system is ready to accept connections
2023-01-17 18:30:08.404 GMT [174080] ERROR:  structure of query does not match function result type
2023-01-17 18:30:08.404 GMT [174080] DETAIL:  Returned type integer does not match expected type numeric in column 3.
2023-01-17 18:30:08.404 GMT [174080] CONTEXT:  SQL statement "SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 18:30:08.404 GMT [174080] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 18:30:47.459 GMT [173985] LOG:  received fast shutdown request
2023-01-17 18:30:47.460 GMT [173985] LOG:  aborting any active transactions
2023-01-17 18:30:47.463 GMT [173985] LOG:  background worker "logical replication launcher" (PID 173992) exited with exit code 1
2023-01-17 18:30:47.465 GMT [173987] LOG:  shutting down
2023-01-17 18:30:47.515 GMT [173985] LOG:  database system is shut down
2023-01-17 18:30:48.624 GMT [175464] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:30:48.625 GMT [175464] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:30:48.627 GMT [175464] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:30:48.631 GMT [175465] LOG:  database system was shut down at 2023-01-17 18:30:48 GMT
2023-01-17 18:30:48.636 GMT [175464] LOG:  database system is ready to accept connections
2023-01-17 18:34:21.876 GMT [175464] LOG:  received fast shutdown request
2023-01-17 18:34:21.877 GMT [175464] LOG:  aborting any active transactions
2023-01-17 18:34:21.880 GMT [175464] LOG:  background worker "logical replication launcher" (PID 175471) exited with exit code 1
2023-01-17 18:34:21.882 GMT [175466] LOG:  shutting down
2023-01-17 18:34:21.931 GMT [175464] LOG:  database system is shut down
2023-01-17 18:34:23.085 GMT [182500] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:34:23.086 GMT [182500] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:34:23.087 GMT [182500] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:34:23.093 GMT [182501] LOG:  database system was shut down at 2023-01-17 18:34:22 GMT
2023-01-17 18:34:23.097 GMT [182500] LOG:  database system is ready to accept connections
2023-01-17 18:49:06.217 GMT [182500] LOG:  received fast shutdown request
2023-01-17 18:49:06.219 GMT [182500] LOG:  aborting any active transactions
2023-01-17 18:49:06.224 GMT [182500] LOG:  background worker "logical replication launcher" (PID 182507) exited with exit code 1
2023-01-17 18:49:06.224 GMT [182502] LOG:  shutting down
2023-01-17 18:49:06.241 GMT [182500] LOG:  database system is shut down
2023-01-17 18:49:07.310 GMT [211188] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:49:07.311 GMT [211188] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:49:07.312 GMT [211188] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:49:07.317 GMT [211189] LOG:  database system was shut down at 2023-01-17 18:49:07 GMT
2023-01-17 18:49:07.321 GMT [211188] LOG:  database system is ready to accept connections
2023-01-17 18:50:01.139 GMT [211188] LOG:  received fast shutdown request
2023-01-17 18:50:01.141 GMT [211188] LOG:  aborting any active transactions
2023-01-17 18:50:01.146 GMT [211188] LOG:  background worker "logical replication launcher" (PID 211195) exited with exit code 1
2023-01-17 18:50:01.148 GMT [211190] LOG:  shutting down
2023-01-17 18:50:01.194 GMT [211188] LOG:  database system is shut down
2023-01-17 18:50:02.351 GMT [213126] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:50:02.352 GMT [213126] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:50:02.353 GMT [213126] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:50:02.361 GMT [213139] LOG:  database system was shut down at 2023-01-17 18:50:02 GMT
2023-01-17 18:50:02.365 GMT [213126] LOG:  database system is ready to accept connections
2023-01-17 18:50:11.628 GMT [213126] LOG:  received fast shutdown request
2023-01-17 18:50:11.631 GMT [213126] LOG:  aborting any active transactions
2023-01-17 18:50:11.635 GMT [213126] LOG:  background worker "logical replication launcher" (PID 213146) exited with exit code 1
2023-01-17 18:50:11.637 GMT [213141] LOG:  shutting down
2023-01-17 18:50:11.692 GMT [213126] LOG:  database system is shut down
2023-01-17 18:50:12.857 GMT [213572] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:50:12.858 GMT [213572] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:50:12.859 GMT [213572] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:50:12.864 GMT [213573] LOG:  database system was shut down at 2023-01-17 18:50:12 GMT
2023-01-17 18:50:12.869 GMT [213572] LOG:  database system is ready to accept connections
2023-01-17 18:50:45.820 GMT [213572] LOG:  received fast shutdown request
2023-01-17 18:50:45.823 GMT [213572] LOG:  aborting any active transactions
2023-01-17 18:50:45.832 GMT [213572] LOG:  background worker "logical replication launcher" (PID 213579) exited with exit code 1
2023-01-17 18:50:45.832 GMT [213574] LOG:  shutting down
2023-01-17 18:50:45.892 GMT [213572] LOG:  database system is shut down
2023-01-17 18:50:46.937 GMT [214781] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:50:46.938 GMT [214781] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:50:46.939 GMT [214781] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:50:46.944 GMT [214782] LOG:  database system was shut down at 2023-01-17 18:50:46 GMT
2023-01-17 18:50:46.950 GMT [214781] LOG:  database system is ready to accept connections
2023-01-17 18:57:38.317 GMT [214781] LOG:  received fast shutdown request
2023-01-17 18:57:38.319 GMT [214781] LOG:  aborting any active transactions
2023-01-17 18:57:38.321 GMT [214781] LOG:  background worker "logical replication launcher" (PID 214788) exited with exit code 1
2023-01-17 18:57:38.327 GMT [214783] LOG:  shutting down
2023-01-17 18:57:38.340 GMT [214781] LOG:  database system is shut down
2023-01-17 18:57:39.560 GMT [228310] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:57:39.560 GMT [228310] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:57:39.562 GMT [228310] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:57:39.567 GMT [228311] LOG:  database system was shut down at 2023-01-17 18:57:39 GMT
2023-01-17 18:57:39.572 GMT [228310] LOG:  database system is ready to accept connections
2023-01-17 18:57:40.351 GMT [228336] ERROR:  relation "overdraft" does not exist at character 231
2023-01-17 18:57:40.351 GMT [228336] STATEMENT:  CREATE OR REPLACE VIEW staff.overdrafts AS
	    SELECT customers.first_name, customers.last_name, overdraft.id, overdraft.account_number, overdraft.amount, overdraft.interest_rate, overdraft.start_date, overdraft.end_date
	    FROM overdraft
	    INNER JOIN staff.accounts ON staff.accounts.account_number = overdraft.account_number
	    INNER JOIN staff.customers ON staff.customers.account_id = staff.accounts.account_id;
2023-01-17 18:58:07.192 GMT [228310] LOG:  received fast shutdown request
2023-01-17 18:58:07.194 GMT [228310] LOG:  aborting any active transactions
2023-01-17 18:58:07.199 GMT [228310] LOG:  background worker "logical replication launcher" (PID 228317) exited with exit code 1
2023-01-17 18:58:07.199 GMT [228312] LOG:  shutting down
2023-01-17 18:58:07.254 GMT [228310] LOG:  database system is shut down
2023-01-17 18:58:08.378 GMT [229371] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:58:08.379 GMT [229371] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:58:08.380 GMT [229371] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:58:08.384 GMT [229372] LOG:  database system was shut down at 2023-01-17 18:58:08 GMT
2023-01-17 18:58:08.391 GMT [229371] LOG:  database system is ready to accept connections
2023-01-17 18:58:09.112 GMT [229397] ERROR:  missing FROM-clause entry for table "overdraft" at character 312
2023-01-17 18:58:09.112 GMT [229397] STATEMENT:  CREATE OR REPLACE VIEW staff.overdrafts AS
	    SELECT customers.first_name, customers.last_name, overdraft.id, overdraft.account_number, overdraft.amount, overdraft.interest_rate, overdraft.start_date, overdraft.end_date
	    FROM debit_overdraft
	    INNER JOIN staff.accounts ON staff.accounts.account_number = overdraft.account_number
	    INNER JOIN staff.customers ON staff.customers.account_id = staff.accounts.account_id;
2023-01-17 18:59:00.674 GMT [229371] LOG:  received fast shutdown request
2023-01-17 18:59:00.678 GMT [229371] LOG:  aborting any active transactions
2023-01-17 18:59:00.681 GMT [229371] LOG:  background worker "logical replication launcher" (PID 229378) exited with exit code 1
2023-01-17 18:59:00.682 GMT [229373] LOG:  shutting down
2023-01-17 18:59:00.733 GMT [229371] LOG:  database system is shut down
2023-01-17 18:59:01.891 GMT [231246] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:59:01.891 GMT [231246] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:59:01.892 GMT [231246] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:59:01.896 GMT [231247] LOG:  database system was shut down at 2023-01-17 18:59:01 GMT
2023-01-17 18:59:01.901 GMT [231246] LOG:  database system is ready to accept connections
2023-01-17 18:59:02.632 GMT [231275] ERROR:  column debit_overdraft.amount does not exist at character 150
2023-01-17 18:59:02.632 GMT [231275] STATEMENT:  CREATE OR REPLACE VIEW staff.overdrafts AS
	    SELECT customers.first_name, customers.last_name, debit_overdraft.id, debit_overdraft.account_number, debit_overdraft.amount, debit_overdraft.interest_rate
	    FROM debit_overdraft
	    INNER JOIN staff.accounts ON staff.accounts.account_number = debit_overdraft.account_number
	    INNER JOIN staff.customers ON staff.customers.account_id = staff.accounts.account_id;
2023-01-17 18:59:39.725 GMT [231246] LOG:  received fast shutdown request
2023-01-17 18:59:39.727 GMT [231246] LOG:  aborting any active transactions
2023-01-17 18:59:39.729 GMT [231246] LOG:  background worker "logical replication launcher" (PID 231253) exited with exit code 1
2023-01-17 18:59:39.731 GMT [231248] LOG:  shutting down
2023-01-17 18:59:39.783 GMT [231246] LOG:  database system is shut down
2023-01-17 18:59:40.910 GMT [232630] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 18:59:40.910 GMT [232630] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 18:59:40.912 GMT [232630] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 18:59:40.916 GMT [232631] LOG:  database system was shut down at 2023-01-17 18:59:40 GMT
2023-01-17 18:59:40.921 GMT [232630] LOG:  database system is ready to accept connections
2023-01-17 19:00:13.193 GMT [232630] LOG:  received fast shutdown request
2023-01-17 19:00:13.194 GMT [232630] LOG:  aborting any active transactions
2023-01-17 19:00:13.200 GMT [232630] LOG:  background worker "logical replication launcher" (PID 232637) exited with exit code 1
2023-01-17 19:00:13.202 GMT [232632] LOG:  shutting down
2023-01-17 19:00:13.253 GMT [232630] LOG:  database system is shut down
2023-01-17 19:00:14.352 GMT [233828] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 19:00:14.353 GMT [233828] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 19:00:14.354 GMT [233828] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 19:00:14.360 GMT [233829] LOG:  database system was shut down at 2023-01-17 19:00:14 GMT
2023-01-17 19:00:14.366 GMT [233828] LOG:  database system is ready to accept connections
2023-01-17 19:01:15.440 GMT [233828] LOG:  received fast shutdown request
2023-01-17 19:01:15.442 GMT [233828] LOG:  aborting any active transactions
2023-01-17 19:01:15.445 GMT [233828] LOG:  background worker "logical replication launcher" (PID 233835) exited with exit code 1
2023-01-17 19:01:15.448 GMT [233830] LOG:  shutting down
2023-01-17 19:01:15.502 GMT [233828] LOG:  database system is shut down
2023-01-17 19:01:16.646 GMT [235916] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 19:01:16.646 GMT [235916] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 19:01:16.648 GMT [235916] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 19:01:16.652 GMT [235917] LOG:  database system was shut down at 2023-01-17 19:01:16 GMT
2023-01-17 19:01:16.657 GMT [235916] LOG:  database system is ready to accept connections
2023-01-17 20:47:49.744 GMT [235916] LOG:  received fast shutdown request
2023-01-17 20:47:49.746 GMT [235916] LOG:  aborting any active transactions
2023-01-17 20:47:49.749 GMT [235916] LOG:  background worker "logical replication launcher" (PID 235923) exited with exit code 1
2023-01-17 20:47:49.755 GMT [235918] LOG:  shutting down
2023-01-17 20:47:49.777 GMT [235916] LOG:  database system is shut down
2023-01-17 20:47:59.033 GMT [442267] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:47:59.034 GMT [442267] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:47:59.035 GMT [442267] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:47:59.038 GMT [442268] LOG:  database system was shut down at 2023-01-17 20:47:58 GMT
2023-01-17 20:47:59.044 GMT [442267] LOG:  database system is ready to accept connections
2023-01-17 20:48:37.884 GMT [442267] LOG:  received fast shutdown request
2023-01-17 20:48:37.885 GMT [442267] LOG:  aborting any active transactions
2023-01-17 20:48:37.889 GMT [442267] LOG:  background worker "logical replication launcher" (PID 442274) exited with exit code 1
2023-01-17 20:48:37.889 GMT [442269] LOG:  shutting down
2023-01-17 20:48:37.941 GMT [442267] LOG:  database system is shut down
2023-01-17 20:48:39.073 GMT [443718] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:48:39.074 GMT [443718] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:48:39.075 GMT [443718] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:48:39.080 GMT [443719] LOG:  database system was shut down at 2023-01-17 20:48:38 GMT
2023-01-17 20:48:39.086 GMT [443718] LOG:  database system is ready to accept connections
2023-01-17 20:50:15.749 GMT [443718] LOG:  received fast shutdown request
2023-01-17 20:50:15.752 GMT [443718] LOG:  aborting any active transactions
2023-01-17 20:50:15.757 GMT [443718] LOG:  background worker "logical replication launcher" (PID 443725) exited with exit code 1
2023-01-17 20:50:15.757 GMT [443720] LOG:  shutting down
2023-01-17 20:50:15.809 GMT [443718] LOG:  database system is shut down
2023-01-17 20:50:16.862 GMT [446972] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:50:16.863 GMT [446972] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:50:16.864 GMT [446972] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:50:16.869 GMT [446973] LOG:  database system was shut down at 2023-01-17 20:50:16 GMT
2023-01-17 20:50:16.874 GMT [446972] LOG:  database system is ready to accept connections
2023-01-17 20:50:53.905 GMT [446972] LOG:  received fast shutdown request
2023-01-17 20:50:53.907 GMT [446972] LOG:  aborting any active transactions
2023-01-17 20:50:53.911 GMT [446972] LOG:  background worker "logical replication launcher" (PID 446979) exited with exit code 1
2023-01-17 20:50:53.912 GMT [446974] LOG:  shutting down
2023-01-17 20:50:53.959 GMT [446972] LOG:  database system is shut down
2023-01-17 20:50:55.104 GMT [448323] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:50:55.105 GMT [448323] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:50:55.106 GMT [448323] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:50:55.111 GMT [448324] LOG:  database system was shut down at 2023-01-17 20:50:54 GMT
2023-01-17 20:50:55.117 GMT [448323] LOG:  database system is ready to accept connections
2023-01-17 20:50:55.831 GMT [448352] ERROR:  mismatched parentheses at or near ")" at character 431
2023-01-17 20:50:55.831 GMT [448352] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
	    IF account_type = 'DEBIT' THEN 
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND current_balance - amount < 0)) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit) THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET credit_usage = credit_usage + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 20:50:56.096 GMT [448352] ERROR:  function bank.update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-17 20:50:56.096 GMT [448352] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 20:50:56.096 GMT [448352] QUERY:  bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-17 20:50:56.096 GMT [448352] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 20:50:56.096 GMT [448352] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 20:51:06.958 GMT [448323] LOG:  received fast shutdown request
2023-01-17 20:51:06.960 GMT [448323] LOG:  aborting any active transactions
2023-01-17 20:51:06.964 GMT [448323] LOG:  background worker "logical replication launcher" (PID 448330) exited with exit code 1
2023-01-17 20:51:06.964 GMT [448325] LOG:  shutting down
2023-01-17 20:51:07.025 GMT [448323] LOG:  database system is shut down
2023-01-17 20:51:08.146 GMT [448872] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:51:08.146 GMT [448872] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:51:08.147 GMT [448872] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:51:08.151 GMT [448873] LOG:  database system was shut down at 2023-01-17 20:51:07 GMT
2023-01-17 20:51:08.158 GMT [448872] LOG:  database system is ready to accept connections
2023-01-17 20:51:09.070 GMT [448898] ERROR:  INSUFFICIENT FUNDS
2023-01-17 20:51:09.070 GMT [448898] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 8 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 20:51:09.070 GMT [448898] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 20:52:45.313 GMT [448872] LOG:  received fast shutdown request
2023-01-17 20:52:45.314 GMT [448872] LOG:  aborting any active transactions
2023-01-17 20:52:45.318 GMT [448872] LOG:  background worker "logical replication launcher" (PID 448879) exited with exit code 1
2023-01-17 20:52:45.319 GMT [448874] LOG:  shutting down
2023-01-17 20:52:45.372 GMT [448872] LOG:  database system is shut down
2023-01-17 20:52:46.590 GMT [452231] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:52:46.590 GMT [452231] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:52:46.592 GMT [452231] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:52:46.598 GMT [452232] LOG:  database system was shut down at 2023-01-17 20:52:46 GMT
2023-01-17 20:52:46.604 GMT [452231] LOG:  database system is ready to accept connections
2023-01-17 20:52:47.555 GMT [452257] ERROR:  INSUFFICIENT FUNDS
2023-01-17 20:52:47.555 GMT [452257] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 8 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 20:52:47.555 GMT [452257] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 20:53:19.446 GMT [452231] LOG:  received fast shutdown request
2023-01-17 20:53:19.447 GMT [452231] LOG:  aborting any active transactions
2023-01-17 20:53:19.452 GMT [452231] LOG:  background worker "logical replication launcher" (PID 452238) exited with exit code 1
2023-01-17 20:53:19.452 GMT [452233] LOG:  shutting down
2023-01-17 20:53:19.505 GMT [452231] LOG:  database system is shut down
2023-01-17 20:53:20.579 GMT [453435] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:53:20.580 GMT [453435] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:53:20.587 GMT [453435] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:53:20.592 GMT [453436] LOG:  database system was shut down at 2023-01-17 20:53:20 GMT
2023-01-17 20:53:20.601 GMT [453435] LOG:  database system is ready to accept connections
2023-01-17 20:54:03.249 GMT [453435] LOG:  received fast shutdown request
2023-01-17 20:54:03.252 GMT [453435] LOG:  aborting any active transactions
2023-01-17 20:54:03.257 GMT [453435] LOG:  background worker "logical replication launcher" (PID 453442) exited with exit code 1
2023-01-17 20:54:03.257 GMT [453437] LOG:  shutting down
2023-01-17 20:54:03.312 GMT [453435] LOG:  database system is shut down
2023-01-17 20:54:04.440 GMT [454933] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:54:04.440 GMT [454933] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:54:04.442 GMT [454933] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:54:04.447 GMT [454934] LOG:  database system was shut down at 2023-01-17 20:54:04 GMT
2023-01-17 20:54:04.453 GMT [454933] LOG:  database system is ready to accept connections
2023-01-17 20:55:14.299 GMT [454933] LOG:  received fast shutdown request
2023-01-17 20:55:14.301 GMT [454933] LOG:  aborting any active transactions
2023-01-17 20:55:14.306 GMT [454933] LOG:  background worker "logical replication launcher" (PID 454940) exited with exit code 1
2023-01-17 20:55:14.308 GMT [454935] LOG:  shutting down
2023-01-17 20:55:14.357 GMT [454933] LOG:  database system is shut down
2023-01-17 20:55:15.488 GMT [457391] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:55:15.489 GMT [457391] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:55:15.490 GMT [457391] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:55:15.495 GMT [457392] LOG:  database system was shut down at 2023-01-17 20:55:15 GMT
2023-01-17 20:55:15.501 GMT [457391] LOG:  database system is ready to accept connections
2023-01-17 20:55:16.418 GMT [457420] ERROR:  INSUFFICIENT FUNDS
2023-01-17 20:55:16.418 GMT [457420] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 8 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 20:55:16.418 GMT [457420] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 20:56:09.790 GMT [457391] LOG:  received fast shutdown request
2023-01-17 20:56:09.792 GMT [457391] LOG:  aborting any active transactions
2023-01-17 20:56:09.797 GMT [457391] LOG:  background worker "logical replication launcher" (PID 457398) exited with exit code 1
2023-01-17 20:56:09.800 GMT [457393] LOG:  shutting down
2023-01-17 20:56:09.853 GMT [457391] LOG:  database system is shut down
2023-01-17 20:56:11.264 GMT [459258] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 20:56:11.265 GMT [459258] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 20:56:11.269 GMT [459258] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 20:56:11.273 GMT [459259] LOG:  database system was shut down at 2023-01-17 20:56:10 GMT
2023-01-17 20:56:11.278 GMT [459258] LOG:  database system is ready to accept connections
2023-01-17 21:02:46.882 GMT [459258] LOG:  received fast shutdown request
2023-01-17 21:02:46.884 GMT [459258] LOG:  aborting any active transactions
2023-01-17 21:02:46.890 GMT [459258] LOG:  background worker "logical replication launcher" (PID 459265) exited with exit code 1
2023-01-17 21:02:46.890 GMT [459260] LOG:  shutting down
2023-01-17 21:02:46.907 GMT [459258] LOG:  database system is shut down
2023-01-17 21:02:48.116 GMT [472273] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:02:48.116 GMT [472273] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:02:48.118 GMT [472273] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:02:48.122 GMT [472274] LOG:  database system was shut down at 2023-01-17 21:02:47 GMT
2023-01-17 21:02:48.129 GMT [472273] LOG:  database system is ready to accept connections
2023-01-17 21:02:49.076 GMT [472302] ERROR:  INSUFFICIENT FUNDS
2023-01-17 21:02:49.076 GMT [472302] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 13 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:02:49.076 GMT [472302] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 21:03:05.840 GMT [472273] LOG:  received fast shutdown request
2023-01-17 21:03:05.842 GMT [472273] LOG:  aborting any active transactions
2023-01-17 21:03:05.846 GMT [472273] LOG:  background worker "logical replication launcher" (PID 472280) exited with exit code 1
2023-01-17 21:03:05.846 GMT [472275] LOG:  shutting down
2023-01-17 21:03:05.895 GMT [472273] LOG:  database system is shut down
2023-01-17 21:03:07.023 GMT [472972] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:03:07.023 GMT [472972] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:03:07.025 GMT [472972] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:03:07.029 GMT [472973] LOG:  database system was shut down at 2023-01-17 21:03:06 GMT
2023-01-17 21:03:07.036 GMT [472972] LOG:  database system is ready to accept connections
2023-01-17 21:03:07.960 GMT [472998] ERROR:  INSUFFICIENT FUNDS
2023-01-17 21:03:07.960 GMT [472998] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 13 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:03:07.960 GMT [472998] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 21:07:16.219 GMT [472972] LOG:  received fast shutdown request
2023-01-17 21:07:16.220 GMT [472972] LOG:  aborting any active transactions
2023-01-17 21:07:16.224 GMT [472972] LOG:  background worker "logical replication launcher" (PID 472979) exited with exit code 1
2023-01-17 21:07:16.225 GMT [472974] LOG:  shutting down
2023-01-17 21:07:16.271 GMT [472972] LOG:  database system is shut down
2023-01-17 21:07:17.281 GMT [481255] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:07:17.281 GMT [481255] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:07:17.282 GMT [481255] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:07:17.286 GMT [481256] LOG:  database system was shut down at 2023-01-17 21:07:17 GMT
2023-01-17 21:07:17.292 GMT [481255] LOG:  database system is ready to accept connections
2023-01-17 21:10:25.694 GMT [481255] LOG:  received fast shutdown request
2023-01-17 21:10:25.696 GMT [481255] LOG:  aborting any active transactions
2023-01-17 21:10:25.702 GMT [481255] LOG:  background worker "logical replication launcher" (PID 481262) exited with exit code 1
2023-01-17 21:10:25.704 GMT [481257] LOG:  shutting down
2023-01-17 21:10:25.750 GMT [481255] LOG:  database system is shut down
2023-01-17 21:10:26.794 GMT [487531] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:10:26.795 GMT [487531] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:10:26.796 GMT [487531] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:10:26.801 GMT [487532] LOG:  database system was shut down at 2023-01-17 21:10:26 GMT
2023-01-17 21:10:26.807 GMT [487531] LOG:  database system is ready to accept connections
2023-01-17 21:10:27.808 GMT [487600] ERROR:  INSUFFICIENT FUNDS
2023-01-17 21:10:27.808 GMT [487600] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 15 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:10:27.808 GMT [487600] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 21:10:44.865 GMT [487531] LOG:  received fast shutdown request
2023-01-17 21:10:44.866 GMT [487531] LOG:  aborting any active transactions
2023-01-17 21:10:44.874 GMT [487531] LOG:  background worker "logical replication launcher" (PID 487538) exited with exit code 1
2023-01-17 21:10:44.877 GMT [487533] LOG:  shutting down
2023-01-17 21:10:44.928 GMT [487531] LOG:  database system is shut down
2023-01-17 21:10:46.044 GMT [488292] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:10:46.044 GMT [488292] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:10:46.046 GMT [488292] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:10:46.051 GMT [488293] LOG:  database system was shut down at 2023-01-17 21:10:45 GMT
2023-01-17 21:10:46.056 GMT [488292] LOG:  database system is ready to accept connections
2023-01-17 21:12:59.320 GMT [488292] LOG:  received fast shutdown request
2023-01-17 21:12:59.321 GMT [488292] LOG:  aborting any active transactions
2023-01-17 21:12:59.327 GMT [488292] LOG:  background worker "logical replication launcher" (PID 488299) exited with exit code 1
2023-01-17 21:12:59.328 GMT [488294] LOG:  shutting down
2023-01-17 21:12:59.377 GMT [488292] LOG:  database system is shut down
2023-01-17 21:13:00.437 GMT [492815] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:13:00.437 GMT [492815] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:13:00.439 GMT [492815] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:13:00.442 GMT [492816] LOG:  database system was shut down at 2023-01-17 21:13:00 GMT
2023-01-17 21:13:00.448 GMT [492815] LOG:  database system is ready to accept connections
2023-01-17 21:13:01.335 GMT [492844] ERROR:  column "accounts.account_number" must appear in the GROUP BY clause or be used in an aggregate function at character 8
2023-01-17 21:13:01.335 GMT [492844] QUERY:  SELECT client.accounts.*, COALESCE((debit_accounts.current_balance + SUM(debit_accounts.overdraft_usage*-1)), credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier
2023-01-17 21:13:01.335 GMT [492844] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 21:13:01.335 GMT [492844] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 21:15:30.730 GMT [492815] LOG:  received fast shutdown request
2023-01-17 21:15:30.732 GMT [492815] LOG:  aborting any active transactions
2023-01-17 21:15:30.737 GMT [492815] LOG:  background worker "logical replication launcher" (PID 492822) exited with exit code 1
2023-01-17 21:15:30.738 GMT [492817] LOG:  shutting down
2023-01-17 21:15:30.788 GMT [492815] LOG:  database system is shut down
2023-01-17 21:15:31.906 GMT [497821] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:15:31.907 GMT [497821] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:15:31.908 GMT [497821] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:15:31.914 GMT [497822] LOG:  database system was shut down at 2023-01-17 21:15:31 GMT
2023-01-17 21:15:31.919 GMT [497821] LOG:  database system is ready to accept connections
2023-01-17 21:15:32.682 GMT [497847] ERROR:  column "accounts.account_id" must appear in the GROUP BY clause or be used in an aggregate function at character 60
2023-01-17 21:15:32.682 GMT [497847] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts AS
	    SELECT accounts.account_id, accounts.account_number, (debit_account.current_balance + SUM(debit_overdraft.overdraft_usage*-1)), debit_account.interest_rate, debit_overdraft.overdraft_limit, debit_overdraft.overdraft_usage, debit_overdraft.interest_rate AS overdraft_interest_rate, debit_overdraft.approved as overdraft_approved
	    FROM client.accounts
	    INNER JOIN debit_account ON accounts.account_number = debit_account.account_number
	    INNER JOIN debit_overdraft ON accounts.account_number = debit_overdraft.account_number;
2023-01-17 21:15:32.683 GMT [497847] ERROR:  relation "debit_accounts" does not exist at character 238
2023-01-17 21:15:32.683 GMT [497847] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statements AS
	    SELECT debit_accounts.account_id, debit_accounts.account_number, debit_statement.id, debit_statement.starting_date, debit_statement.end_date, debit_statement.amount
	    FROM debit_accounts
	    INNER JOIN debit_statement ON debit_accounts.account_number = debit_statement.account_number;
2023-01-17 21:15:32.683 GMT [497847] ERROR:  relation "debit_accounts_statements" does not exist at character 413
2023-01-17 21:15:32.683 GMT [497847] STATEMENT:  CREATE OR REPLACE VIEW client.debit_accounts_statement AS
	    SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.id, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount AS total_amount, transaction.origin_account_id, transaction.dest_account_id, transaction.amount, transaction.date
	    FROM debit_accounts_statements
	    INNER JOIN transaction ON debit_accounts_statements.id = transaction.debit_statement_id;
2023-01-17 21:15:32.876 GMT [497847] ERROR:  relation "client.debit_accounts" does not exist at character 23
2023-01-17 21:15:32.876 GMT [497847] QUERY:  EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)
2023-01-17 21:15:32.876 GMT [497847] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 8 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:15:32.876 GMT [497847] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100.00, 10000000, 123456);
2023-01-17 21:15:32.877 GMT [497847] ERROR:  relation "client.debit_accounts" does not exist at character 513
2023-01-17 21:15:32.877 GMT [497847] QUERY:  SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier
2023-01-17 21:15:32.877 GMT [497847] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 21:15:32.877 GMT [497847] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 21:15:32.877 GMT [497847] ERROR:  relation "client.debit_accounts" does not exist at character 15
2023-01-17 21:15:32.877 GMT [497847] STATEMENT:  SELECT * FROM client.debit_accounts;
2023-01-17 21:16:13.353 GMT [497821] LOG:  received fast shutdown request
2023-01-17 21:16:13.356 GMT [497821] LOG:  aborting any active transactions
2023-01-17 21:16:13.360 GMT [497821] LOG:  background worker "logical replication launcher" (PID 497828) exited with exit code 1
2023-01-17 21:16:13.360 GMT [497823] LOG:  shutting down
2023-01-17 21:16:13.417 GMT [497821] LOG:  database system is shut down
2023-01-17 21:16:14.541 GMT [499329] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:16:14.541 GMT [499329] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:16:14.543 GMT [499329] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:16:14.548 GMT [499330] LOG:  database system was shut down at 2023-01-17 21:16:14 GMT
2023-01-17 21:16:14.554 GMT [499329] LOG:  database system is ready to accept connections
2023-01-17 21:16:15.511 GMT [499355] ERROR:  column debit_accounts.current_balance does not exist at character 36
2023-01-17 21:16:15.511 GMT [499355] QUERY:  SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier
2023-01-17 21:16:15.511 GMT [499355] CONTEXT:  PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-17 21:16:15.511 GMT [499355] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-17 21:16:34.256 GMT [499329] LOG:  received fast shutdown request
2023-01-17 21:16:34.257 GMT [499329] LOG:  aborting any active transactions
2023-01-17 21:16:34.262 GMT [499329] LOG:  background worker "logical replication launcher" (PID 499336) exited with exit code 1
2023-01-17 21:16:34.264 GMT [499331] LOG:  shutting down
2023-01-17 21:16:34.315 GMT [499329] LOG:  database system is shut down
2023-01-17 21:16:35.435 GMT [500096] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:16:35.435 GMT [500096] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:16:35.436 GMT [500096] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:16:35.441 GMT [500097] LOG:  database system was shut down at 2023-01-17 21:16:35 GMT
2023-01-17 21:16:35.447 GMT [500096] LOG:  database system is ready to accept connections
2023-01-17 21:17:03.378 GMT [500096] LOG:  received fast shutdown request
2023-01-17 21:17:03.379 GMT [500096] LOG:  aborting any active transactions
2023-01-17 21:17:03.384 GMT [500096] LOG:  background worker "logical replication launcher" (PID 500103) exited with exit code 1
2023-01-17 21:17:03.385 GMT [500098] LOG:  shutting down
2023-01-17 21:17:03.437 GMT [500096] LOG:  database system is shut down
2023-01-17 21:17:04.512 GMT [501159] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:17:04.512 GMT [501159] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:17:04.514 GMT [501159] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:17:04.518 GMT [501160] LOG:  database system was shut down at 2023-01-17 21:17:04 GMT
2023-01-17 21:17:04.523 GMT [501159] LOG:  database system is ready to accept connections
2023-01-17 21:17:05.472 GMT [501188] ERROR:  INSUFFICIENT FUNDS
2023-01-17 21:17:05.472 GMT [501188] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 15 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 13 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:17:05.472 GMT [501188] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000005, 100000.00, 10000000, 123456);
2023-01-17 21:17:16.601 GMT [501159] LOG:  received fast shutdown request
2023-01-17 21:17:16.603 GMT [501159] LOG:  aborting any active transactions
2023-01-17 21:17:16.607 GMT [501159] LOG:  background worker "logical replication launcher" (PID 501166) exited with exit code 1
2023-01-17 21:17:16.607 GMT [501161] LOG:  shutting down
2023-01-17 21:17:16.661 GMT [501159] LOG:  database system is shut down
2023-01-17 21:17:17.763 GMT [501705] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:17:17.764 GMT [501705] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:17:17.766 GMT [501705] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:17:17.771 GMT [501706] LOG:  database system was shut down at 2023-01-17 21:17:17 GMT
2023-01-17 21:17:17.776 GMT [501705] LOG:  database system is ready to accept connections
2023-01-17 21:23:40.524 GMT [501705] LOG:  received fast shutdown request
2023-01-17 21:23:40.526 GMT [501705] LOG:  aborting any active transactions
2023-01-17 21:23:40.530 GMT [501705] LOG:  background worker "logical replication launcher" (PID 501712) exited with exit code 1
2023-01-17 21:23:40.530 GMT [501707] LOG:  shutting down
2023-01-17 21:23:40.546 GMT [501705] LOG:  database system is shut down
2023-01-17 21:23:41.672 GMT [514303] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:23:41.673 GMT [514303] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:23:41.674 GMT [514303] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:23:41.679 GMT [514304] LOG:  database system was shut down at 2023-01-17 21:23:41 GMT
2023-01-17 21:23:41.686 GMT [514303] LOG:  database system is ready to accept connections
2023-01-17 21:23:42.596 GMT [514329] ERROR:  argument of AND must be type boolean, not type integer at character 44
2023-01-17 21:23:42.596 GMT [514329] QUERY:  EXISTS (SELECT * FROM credit_account WHERE account_number AND credit_usage + amount < credit_limit)
2023-01-17 21:23:42.596 GMT [514329] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 20 at IF
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:23:42.596 GMT [514329] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 1000.00, 10000000, 123456);
2023-01-17 21:25:24.914 GMT [514303] LOG:  received fast shutdown request
2023-01-17 21:25:24.916 GMT [514303] LOG:  aborting any active transactions
2023-01-17 21:25:24.918 GMT [514303] LOG:  background worker "logical replication launcher" (PID 514310) exited with exit code 1
2023-01-17 21:25:24.921 GMT [514305] LOG:  shutting down
2023-01-17 21:25:24.977 GMT [514303] LOG:  database system is shut down
2023-01-17 21:25:26.030 GMT [517788] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:25:26.030 GMT [517788] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:25:26.032 GMT [517788] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:25:26.037 GMT [517789] LOG:  database system was shut down at 2023-01-17 21:25:25 GMT
2023-01-17 21:25:26.041 GMT [517788] LOG:  database system is ready to accept connections
2023-01-17 21:25:26.978 GMT [517814] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-17 21:25:26.978 GMT [517814] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:25:26.978 GMT [517814] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 1000.00, 10000000, 123456);
2023-01-17 21:26:52.553 GMT [517788] LOG:  received fast shutdown request
2023-01-17 21:26:52.555 GMT [517788] LOG:  aborting any active transactions
2023-01-17 21:26:52.560 GMT [517788] LOG:  background worker "logical replication launcher" (PID 517795) exited with exit code 1
2023-01-17 21:26:52.563 GMT [517790] LOG:  shutting down
2023-01-17 21:26:52.612 GMT [517788] LOG:  database system is shut down
2023-01-17 21:26:53.697 GMT [520737] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:26:53.698 GMT [520737] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:26:53.699 GMT [520737] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:26:53.704 GMT [520738] LOG:  database system was shut down at 2023-01-17 21:26:53 GMT
2023-01-17 21:26:53.710 GMT [520737] LOG:  database system is ready to accept connections
2023-01-17 21:26:54.637 GMT [520766] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-17 21:26:54.637 GMT [520766] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:26:54.637 GMT [520766] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 1000.00, 10000000, 123456);
2023-01-17 21:27:51.187 GMT [520737] LOG:  received fast shutdown request
2023-01-17 21:27:51.189 GMT [520737] LOG:  aborting any active transactions
2023-01-17 21:27:51.194 GMT [520737] LOG:  background worker "logical replication launcher" (PID 520744) exited with exit code 1
2023-01-17 21:27:51.194 GMT [520739] LOG:  shutting down
2023-01-17 21:27:51.248 GMT [520737] LOG:  database system is shut down
2023-01-17 21:27:52.359 GMT [522755] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:27:52.359 GMT [522755] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:27:52.361 GMT [522755] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:27:52.365 GMT [522756] LOG:  database system was shut down at 2023-01-17 21:27:52 GMT
2023-01-17 21:27:52.369 GMT [522755] LOG:  database system is ready to accept connections
2023-01-17 21:27:53.355 GMT [522781] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-17 21:27:53.355 GMT [522781] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:27:53.355 GMT [522781] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 1000.00, 10000000, 123456);
2023-01-17 21:29:30.899 GMT [522755] LOG:  received fast shutdown request
2023-01-17 21:29:30.900 GMT [522755] LOG:  aborting any active transactions
2023-01-17 21:29:30.907 GMT [522755] LOG:  background worker "logical replication launcher" (PID 522762) exited with exit code 1
2023-01-17 21:29:30.907 GMT [522757] LOG:  shutting down
2023-01-17 21:29:30.958 GMT [522755] LOG:  database system is shut down
2023-01-17 21:29:32.003 GMT [526076] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:29:32.003 GMT [526076] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:29:32.005 GMT [526076] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:29:32.009 GMT [526077] LOG:  database system was shut down at 2023-01-17 21:29:31 GMT
2023-01-17 21:29:32.014 GMT [526076] LOG:  database system is ready to accept connections
2023-01-17 21:35:23.657 GMT [526076] LOG:  received fast shutdown request
2023-01-17 21:35:23.658 GMT [526076] LOG:  aborting any active transactions
2023-01-17 21:35:23.663 GMT [526076] LOG:  background worker "logical replication launcher" (PID 526083) exited with exit code 1
2023-01-17 21:35:23.665 GMT [526078] LOG:  shutting down
2023-01-17 21:35:23.680 GMT [526076] LOG:  database system is shut down
2023-01-17 21:35:24.991 GMT [537673] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:35:24.991 GMT [537673] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:35:24.993 GMT [537673] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:35:24.998 GMT [537674] LOG:  database system was shut down at 2023-01-17 21:35:24 GMT
2023-01-17 21:35:25.006 GMT [537673] LOG:  database system is ready to accept connections
2023-01-17 21:35:25.881 GMT [537702] ERROR:  syntax error at or near "INNER" at character 1590
2023-01-17 21:35:25.881 GMT [537702] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
	    IF account_type = 'DEBIT' THEN
	
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND (current_balance + (SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE)) - amount >= 0) THEN
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            UPDATE debit_overdraft SET overdraft_usage = overdraft_usage + (SELECT SUM(current_balance*-1) FROM debit_account WHERE account_number = account_number_identifier) WHERE account_number = account_number_identifier AND approved = TRUE;
	            UPDATE debit_account SET current_balance = 0 WHERE account_number = account_number_identifier AND current_balance < 0;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        END IF;
	
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT credit_account.* FROM credit_account WHERE credit_account.account_number = account_number_identifier AND credit_account.outstanding_balance + amount < credit_account.credit_limit AND credit_account_application.application_status == 'APPROVED' INNER JOIN credit_account_application ON credit_account.account_number = credit_account_application.account_number) THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET outstanding_balance = outstanding_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 21:35:26.189 GMT [537702] ERROR:  function bank.update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-17 21:35:26.189 GMT [537702] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 21:35:26.189 GMT [537702] QUERY:  bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-17 21:35:26.189 GMT [537702] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:35:26.189 GMT [537702] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 100.00, 10000000, 123456);
2023-01-17 21:35:46.225 GMT [537673] LOG:  received fast shutdown request
2023-01-17 21:35:46.227 GMT [537673] LOG:  aborting any active transactions
2023-01-17 21:35:46.232 GMT [537673] LOG:  background worker "logical replication launcher" (PID 537680) exited with exit code 1
2023-01-17 21:35:46.233 GMT [537675] LOG:  shutting down
2023-01-17 21:35:46.300 GMT [537673] LOG:  database system is shut down
2023-01-17 21:35:47.374 GMT [538519] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:35:47.374 GMT [538519] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:35:47.376 GMT [538519] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:35:47.381 GMT [538520] LOG:  database system was shut down at 2023-01-17 21:35:47 GMT
2023-01-17 21:35:47.395 GMT [538519] LOG:  database system is ready to accept connections
2023-01-17 21:35:48.102 GMT [538545] ERROR:  syntax error at or near "INNER" at character 1589
2023-01-17 21:35:48.102 GMT [538545] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
	    IF account_type = 'DEBIT' THEN
	
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND (current_balance + (SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE)) - amount >= 0) THEN
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            UPDATE debit_overdraft SET overdraft_usage = overdraft_usage + (SELECT SUM(current_balance*-1) FROM debit_account WHERE account_number = account_number_identifier) WHERE account_number = account_number_identifier AND approved = TRUE;
	            UPDATE debit_account SET current_balance = 0 WHERE account_number = account_number_identifier AND current_balance < 0;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        END IF;
	
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT credit_account.* FROM credit_account WHERE credit_account.account_number = account_number_identifier AND credit_account.outstanding_balance + amount < credit_account.credit_limit AND credit_account_application.application_status = 'APPROVED' INNER JOIN credit_account_application ON credit_account.account_number = credit_account_application.account_number) THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET outstanding_balance = outstanding_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE EXCEPTION 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE EXCEPTION 'INSUFFICIENT FUNDS';
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET current_balance = current_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-17 21:35:48.369 GMT [538545] ERROR:  function bank.update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-17 21:35:48.369 GMT [538545] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 21:35:48.369 GMT [538545] QUERY:  bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-17 21:35:48.369 GMT [538545] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:35:48.369 GMT [538545] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 100.00, 10000000, 123456);
2023-01-17 21:36:21.333 GMT [538519] LOG:  received fast shutdown request
2023-01-17 21:36:21.336 GMT [538519] LOG:  aborting any active transactions
2023-01-17 21:36:21.338 GMT [538519] LOG:  background worker "logical replication launcher" (PID 538526) exited with exit code 1
2023-01-17 21:36:21.341 GMT [538521] LOG:  shutting down
2023-01-17 21:36:21.406 GMT [538519] LOG:  database system is shut down
2023-01-17 21:36:22.502 GMT [539729] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:36:22.503 GMT [539729] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:36:22.504 GMT [539729] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:36:22.506 GMT [539730] LOG:  database system was shut down at 2023-01-17 21:36:22 GMT
2023-01-17 21:36:22.510 GMT [539729] LOG:  database system is ready to accept connections
2023-01-17 21:36:23.512 GMT [539779] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-17 21:36:23.512 GMT [539779] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:36:23.512 GMT [539779] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 100.00, 10000000, 123456);
2023-01-17 21:36:35.409 GMT [539729] LOG:  received fast shutdown request
2023-01-17 21:36:35.410 GMT [539729] LOG:  aborting any active transactions
2023-01-17 21:36:35.414 GMT [539729] LOG:  background worker "logical replication launcher" (PID 539736) exited with exit code 1
2023-01-17 21:36:35.415 GMT [539731] LOG:  shutting down
2023-01-17 21:36:35.471 GMT [539729] LOG:  database system is shut down
2023-01-17 21:36:36.597 GMT [540270] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:36:36.597 GMT [540270] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:36:36.599 GMT [540270] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:36:36.604 GMT [540271] LOG:  database system was shut down at 2023-01-17 21:36:36 GMT
2023-01-17 21:36:36.610 GMT [540270] LOG:  database system is ready to accept connections
2023-01-17 21:36:56.880 GMT [540270] LOG:  received fast shutdown request
2023-01-17 21:36:56.882 GMT [540270] LOG:  aborting any active transactions
2023-01-17 21:36:56.886 GMT [540270] LOG:  background worker "logical replication launcher" (PID 540277) exited with exit code 1
2023-01-17 21:36:56.886 GMT [540272] LOG:  shutting down
2023-01-17 21:36:56.937 GMT [540270] LOG:  database system is shut down
2023-01-17 21:36:58.056 GMT [541113] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:36:58.057 GMT [541113] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:36:58.059 GMT [541113] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:36:58.064 GMT [541114] LOG:  database system was shut down at 2023-01-17 21:36:57 GMT
2023-01-17 21:36:58.070 GMT [541113] LOG:  database system is ready to accept connections
2023-01-17 21:36:59.030 GMT [541139] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-17 21:36:59.030 GMT [541139] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 22 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 20 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 21:36:59.030 GMT [541139] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000009, 100.00, 10000000, 123456);
2023-01-17 21:44:06.813 GMT [541113] LOG:  received fast shutdown request
2023-01-17 21:44:06.815 GMT [541113] LOG:  aborting any active transactions
2023-01-17 21:44:06.817 GMT [541113] LOG:  background worker "logical replication launcher" (PID 541120) exited with exit code 1
2023-01-17 21:44:06.820 GMT [541115] LOG:  shutting down
2023-01-17 21:44:06.835 GMT [541113] LOG:  database system is shut down
2023-01-17 21:44:08.020 GMT [555296] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:44:08.020 GMT [555296] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:44:08.023 GMT [555296] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:44:08.027 GMT [555297] LOG:  database system was shut down at 2023-01-17 21:44:07 GMT
2023-01-17 21:44:08.035 GMT [555296] LOG:  database system is ready to accept connections
2023-01-17 21:44:08.787 GMT [555322] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:44:08.787 GMT [555322] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:44:09.022 GMT [555322] ERROR:  permission denied for table transaction
2023-01-17 21:44:09.022 GMT [555322] STATEMENT:  SELECT * FROM transaction;
2023-01-17 21:44:58.567 GMT [555296] LOG:  received fast shutdown request
2023-01-17 21:44:58.570 GMT [555296] LOG:  aborting any active transactions
2023-01-17 21:44:58.572 GMT [555296] LOG:  background worker "logical replication launcher" (PID 555303) exited with exit code 1
2023-01-17 21:44:58.577 GMT [555298] LOG:  shutting down
2023-01-17 21:44:58.625 GMT [555296] LOG:  database system is shut down
2023-01-17 21:44:59.651 GMT [557011] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:44:59.651 GMT [557011] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:44:59.653 GMT [557011] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:44:59.658 GMT [557012] LOG:  database system was shut down at 2023-01-17 21:44:59 GMT
2023-01-17 21:44:59.663 GMT [557011] LOG:  database system is ready to accept connections
2023-01-17 21:45:00.404 GMT [557107] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:45:00.404 GMT [557107] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:45:00.631 GMT [557107] ERROR:  function client.view_savings_statements(integer) does not exist at character 15
2023-01-17 21:45:00.631 GMT [557107] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 21:45:00.631 GMT [557107] STATEMENT:  SELECT * FROM client.view_savings_statements(1);
2023-01-17 21:45:29.039 GMT [557011] LOG:  received fast shutdown request
2023-01-17 21:45:29.041 GMT [557011] LOG:  aborting any active transactions
2023-01-17 21:45:29.045 GMT [557011] LOG:  background worker "logical replication launcher" (PID 557018) exited with exit code 1
2023-01-17 21:45:29.048 GMT [557013] LOG:  shutting down
2023-01-17 21:45:29.104 GMT [557011] LOG:  database system is shut down
2023-01-17 21:45:30.151 GMT [558141] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:45:30.151 GMT [558141] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:45:30.153 GMT [558141] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:45:30.159 GMT [558142] LOG:  database system was shut down at 2023-01-17 21:45:29 GMT
2023-01-17 21:45:30.165 GMT [558141] LOG:  database system is ready to accept connections
2023-01-17 21:45:30.880 GMT [558167] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:45:30.880 GMT [558167] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:46:19.219 GMT [558141] LOG:  received fast shutdown request
2023-01-17 21:46:19.241 GMT [558141] LOG:  aborting any active transactions
2023-01-17 21:46:19.244 GMT [558141] LOG:  background worker "logical replication launcher" (PID 558148) exited with exit code 1
2023-01-17 21:46:19.247 GMT [558143] LOG:  shutting down
2023-01-17 21:46:19.309 GMT [558141] LOG:  database system is shut down
2023-01-17 21:46:20.267 GMT [559871] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:46:20.268 GMT [559871] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:46:20.270 GMT [559871] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:46:20.274 GMT [559872] LOG:  database system was shut down at 2023-01-17 21:46:20 GMT
2023-01-17 21:46:20.280 GMT [559871] LOG:  database system is ready to accept connections
2023-01-17 21:46:21.075 GMT [559932] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:46:21.075 GMT [559932] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:46:21.304 GMT [559932] ERROR:  relation "client.savings_accounts_statement" does not exist at character 216
2023-01-17 21:46:21.304 GMT [559932] QUERY:  SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id
2023-01-17 21:46:21.304 GMT [559932] CONTEXT:  PL/pgSQL function view_savings_statement(integer,integer,integer) line 6 at RETURN QUERY
2023-01-17 21:46:21.304 GMT [559932] STATEMENT:  SELECT * FROM client.view_savings_statement(1, 10000001, 1);
2023-01-17 21:47:29.689 GMT [559871] LOG:  received fast shutdown request
2023-01-17 21:47:29.690 GMT [559871] LOG:  aborting any active transactions
2023-01-17 21:47:29.693 GMT [559871] LOG:  background worker "logical replication launcher" (PID 559878) exited with exit code 1
2023-01-17 21:47:29.695 GMT [559873] LOG:  shutting down
2023-01-17 21:47:29.740 GMT [559871] LOG:  database system is shut down
2023-01-17 21:47:30.820 GMT [562300] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:47:30.821 GMT [562300] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:47:30.822 GMT [562300] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:47:30.825 GMT [562301] LOG:  database system was shut down at 2023-01-17 21:47:30 GMT
2023-01-17 21:47:30.835 GMT [562300] LOG:  database system is ready to accept connections
2023-01-17 21:47:31.561 GMT [562329] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:47:31.561 GMT [562329] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:47:31.795 GMT [562329] ERROR:  column reference "account_number" is ambiguous at character 379
2023-01-17 21:47:31.795 GMT [562329] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-17 21:47:31.795 GMT [562329] QUERY:  SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number
	        AND savings_accounts_statement.statement_id = statement_id
2023-01-17 21:47:31.795 GMT [562329] CONTEXT:  PL/pgSQL function view_savings_statement(integer,integer,integer) line 6 at RETURN QUERY
2023-01-17 21:47:31.795 GMT [562329] STATEMENT:  SELECT * FROM client.view_savings_statement(1, 10000001, 1);
2023-01-17 21:51:19.334 GMT [562300] LOG:  received fast shutdown request
2023-01-17 21:51:19.336 GMT [562300] LOG:  aborting any active transactions
2023-01-17 21:51:19.342 GMT [562300] LOG:  background worker "logical replication launcher" (PID 562307) exited with exit code 1
2023-01-17 21:51:19.343 GMT [562302] LOG:  shutting down
2023-01-17 21:51:19.408 GMT [562300] LOG:  database system is shut down
2023-01-17 21:51:20.480 GMT [569839] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:51:20.480 GMT [569839] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:51:20.481 GMT [569839] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:51:20.485 GMT [569845] LOG:  database system was shut down at 2023-01-17 21:51:20 GMT
2023-01-17 21:51:20.489 GMT [569839] LOG:  database system is ready to accept connections
2023-01-17 21:51:21.274 GMT [569874] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:51:21.274 GMT [569874] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 21:51:21.497 GMT [569874] ERROR:  column savings_accounts_statement.statement_id does not exist at character 417
2023-01-17 21:51:21.497 GMT [569874] QUERY:  SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number_identifier
	        AND savings_accounts_statement.statement_id = statement_id
2023-01-17 21:51:21.497 GMT [569874] CONTEXT:  PL/pgSQL function view_savings_statement(integer,integer,integer) line 6 at RETURN QUERY
2023-01-17 21:51:21.497 GMT [569874] STATEMENT:  SELECT * FROM client.view_savings_statement(1, 10000001, 1);
2023-01-17 21:52:49.677 GMT [569839] LOG:  received fast shutdown request
2023-01-17 21:52:49.680 GMT [569839] LOG:  aborting any active transactions
2023-01-17 21:52:49.682 GMT [569839] LOG:  background worker "logical replication launcher" (PID 569851) exited with exit code 1
2023-01-17 21:52:49.687 GMT [569846] LOG:  shutting down
2023-01-17 21:52:49.749 GMT [569839] LOG:  database system is shut down
2023-01-17 21:52:50.983 GMT [572845] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 21:52:50.983 GMT [572845] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 21:52:50.984 GMT [572845] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 21:52:50.988 GMT [572846] LOG:  database system was shut down at 2023-01-17 21:52:50 GMT
2023-01-17 21:52:50.993 GMT [572845] LOG:  database system is ready to accept connections
2023-01-17 21:52:51.710 GMT [572871] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 21:52:51.710 GMT [572871] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 22:07:09.014 GMT [572845] LOG:  received fast shutdown request
2023-01-17 22:07:09.017 GMT [572845] LOG:  aborting any active transactions
2023-01-17 22:07:09.021 GMT [572845] LOG:  background worker "logical replication launcher" (PID 572852) exited with exit code 1
2023-01-17 22:07:09.024 GMT [572847] LOG:  shutting down
2023-01-17 22:07:09.039 GMT [572845] LOG:  database system is shut down
2023-01-17 22:07:10.227 GMT [600921] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:07:10.227 GMT [600921] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:07:10.229 GMT [600921] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:07:10.235 GMT [600922] LOG:  database system was shut down at 2023-01-17 22:07:09 GMT
2023-01-17 22:07:10.240 GMT [600921] LOG:  database system is ready to accept connections
2023-01-17 22:07:11.050 GMT [600955] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 22:07:11.050 GMT [600955] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 22:07:11.107 GMT [600955] ERROR:  loop variable of loop over rows must be a record variable or list of scalar variables at character 617
2023-01-17 22:07:11.107 GMT [600955] STATEMENT:  CREATE OR REPLACE FUNCTION client.place_transaction_into_account(account_identifier INT, orig_account_number INT, transaction_account_number INT, transaction_amount NUMERIC, transfer_account_sort_code INT, loan_payment BOOLEAN)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE statement_id INT;
	DECLARE transaction_id INT;
	DECLARE account_number_focus INT ARRAY;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Placed transaction into account', CURRENT_DATE);
	
	    account_number_focus = ARRAY[orig_account_number, transaction_account_number];
	
	    FOR account_number_choice IN SELECT * FROM UNNEST(account_number_focus) LOOP
	        CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = account_number_choice) THEN
	            SELECT * FROM client.get_or_create_statement(account_identifier, account_number_choice) INTO statement_id;
	
	            IF account_number_choice = orig_account_number THEN
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	                VALUES (account_number_choice, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	                INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, account_number_choice, true, loan_payment);
	            ELSE
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	                VALUES (transaction_account_number, account_number_choice, transaction_amount, now(), statement_id, transfer_account_sort_code, TRUE) RETURNING id INTO transaction_id;
	            END IF;
	
	        WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = account_number_choice) THEN
	            SELECT * FROM client.get_or_create_statement(account_identifier, account_number_choice) INTO statement_id;
	
	            IF account_number_choice = orig_account_number THEN
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	                VALUES (account_number_choice, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	                INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, account_number_choice, true, loan_payment);
	            ELSE
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	                VALUES (transaction_account_number, account_number_choice, transaction_amount, now(), statement_id, transfer_account_sort_code, TRUE) RETURNING id INTO transaction_id;
	            END IF;
	
	        WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = account_number_choice) THEN
	            SELECT * FROM client.get_or_create_statement(account_identifier, account_number) INTO statement_id;
	
	            IF account_number_choice = orig_account_number THEN
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	                VALUES (account_number_choice, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	                INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, account_number_choice, true, loan_payment);
	            ELSE
	                INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	                VALUES (transaction_account_number, account_number_choice, transaction_amount, now(), statement_id, transfer_account_sort_code, TRUE) RETURNING id INTO transaction_id;
	            END IF;
	        ELSE RAISE NOTICE 'Account number % does not exist', account_number_choice;
	        END CASE;
	        RETURN TRUE;
	    END LOOP;
	
	    -- CASE WHEN EXISTS (SELECT * FROM client.debit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	    --     --UPDATE debit_account SET current_balance = current_balance - transaction_amount WHERE debit_account.account_number = orig_account_number;
	    --     SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	    --     INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, debit_statement_id, dest_account_sort_code, approved)
	    --     VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	    --     INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment);
	
	    -- WHEN EXISTS (SELECT * FROM client.credit_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	    --     --UPDATE credit_account SET outstanding_balance = outstanding_balance - transaction_amount WHERE credit_account.account_number = orig_account_number;
	    --     SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	    --     INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, credit_statement_id, dest_account_sort_code, approved)
	    --     VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	    --     INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment);
	
	    -- WHEN EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number) THEN
	    --     --UPDATE savings_account SET current_balance = current_balance - transaction_amount WHERE savings_account.account_number = orig_account_number;
	    --     SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number) INTO statement_id;
	    --     INSERT INTO transaction (origin_account_id, dest_account_id, amount, date, savings_statement_id, dest_account_sort_code, approved)
	    --     VALUES (orig_account_number, transaction_account_number, transaction_amount, now(), statement_id, transfer_account_sort_code, FALSE) RETURNING id INTO transaction_id;
	    --     INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment);
	    -- ELSE
	    --     RAISE NOTICE 'Account does not exist';
	    --     RETURN FALSE;
	    -- END CASE;
	    -- RETURN TRUE;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-17 22:07:11.273 GMT [600955] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-17 22:07:11.273 GMT [600955] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-17 22:07:11.273 GMT [600955] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)
2023-01-17 22:07:11.273 GMT [600955] CONTEXT:  PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:07:11.273 GMT [600955] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:07:55.972 GMT [600921] LOG:  received fast shutdown request
2023-01-17 22:07:55.974 GMT [600921] LOG:  aborting any active transactions
2023-01-17 22:07:55.980 GMT [600921] LOG:  background worker "logical replication launcher" (PID 600928) exited with exit code 1
2023-01-17 22:07:55.981 GMT [600923] LOG:  shutting down
2023-01-17 22:07:56.030 GMT [600921] LOG:  database system is shut down
2023-01-17 22:07:57.091 GMT [602561] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:07:57.091 GMT [602561] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:07:57.092 GMT [602561] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:07:57.096 GMT [602562] LOG:  database system was shut down at 2023-01-17 22:07:56 GMT
2023-01-17 22:07:57.103 GMT [602561] LOG:  database system is ready to accept connections
2023-01-17 22:07:57.862 GMT [602587] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 22:07:57.862 GMT [602587] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 22:07:58.116 GMT [602587] ERROR:  column "account_number" does not exist at character 66
2023-01-17 22:07:58.116 GMT [602587] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, account_number)
2023-01-17 22:07:58.116 GMT [602587] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 38 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:07:58.116 GMT [602587] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:08:41.611 GMT [602561] LOG:  received fast shutdown request
2023-01-17 22:08:41.613 GMT [602561] LOG:  aborting any active transactions
2023-01-17 22:08:41.618 GMT [602561] LOG:  background worker "logical replication launcher" (PID 602568) exited with exit code 1
2023-01-17 22:08:41.620 GMT [602563] LOG:  shutting down
2023-01-17 22:08:41.668 GMT [602561] LOG:  database system is shut down
2023-01-17 22:08:42.764 GMT [604146] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:08:42.764 GMT [604146] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:08:42.766 GMT [604146] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:08:42.771 GMT [604147] LOG:  database system was shut down at 2023-01-17 22:08:42 GMT
2023-01-17 22:08:42.777 GMT [604146] LOG:  database system is ready to accept connections
2023-01-17 22:08:43.534 GMT [604238] ERROR:  column account.customer_id does not exist at character 276
2023-01-17 22:08:43.534 GMT [604238] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.id = account.customer_id;
2023-01-17 22:08:43.767 GMT [604238] ERROR:  column "account_number" does not exist at character 66
2023-01-17 22:08:43.767 GMT [604238] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, account_number)
2023-01-17 22:08:43.767 GMT [604238] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 38 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:08:43.767 GMT [604238] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:09:22.519 GMT [604146] LOG:  received fast shutdown request
2023-01-17 22:09:22.522 GMT [604146] LOG:  aborting any active transactions
2023-01-17 22:09:22.528 GMT [604146] LOG:  background worker "logical replication launcher" (PID 604153) exited with exit code 1
2023-01-17 22:09:22.528 GMT [604148] LOG:  shutting down
2023-01-17 22:09:22.577 GMT [604146] LOG:  database system is shut down
2023-01-17 22:09:23.778 GMT [605624] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:09:23.778 GMT [605624] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:09:23.780 GMT [605624] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:09:23.787 GMT [605625] LOG:  database system was shut down at 2023-01-17 22:09:23 GMT
2023-01-17 22:09:23.793 GMT [605624] LOG:  database system is ready to accept connections
2023-01-17 22:09:24.498 GMT [605650] ERROR:  column customer.address does not exist at character 144
2023-01-17 22:09:24.498 GMT [605650] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN online_account ON customer.id = online_account.customer_id;
2023-01-17 22:09:24.712 GMT [605650] ERROR:  column "account_number" does not exist at character 66
2023-01-17 22:09:24.712 GMT [605650] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, account_number)
2023-01-17 22:09:24.712 GMT [605650] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 38 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:09:24.712 GMT [605650] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:09:44.074 GMT [605624] LOG:  received fast shutdown request
2023-01-17 22:09:44.076 GMT [605624] LOG:  aborting any active transactions
2023-01-17 22:09:44.082 GMT [605624] LOG:  background worker "logical replication launcher" (PID 605631) exited with exit code 1
2023-01-17 22:09:44.082 GMT [605626] LOG:  shutting down
2023-01-17 22:09:44.134 GMT [605624] LOG:  database system is shut down
2023-01-17 22:09:45.369 GMT [606396] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:09:45.370 GMT [606396] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:09:45.371 GMT [606396] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:09:45.375 GMT [606397] LOG:  database system was shut down at 2023-01-17 22:09:45 GMT
2023-01-17 22:09:45.381 GMT [606396] LOG:  database system is ready to accept connections
2023-01-17 22:09:46.222 GMT [606422] ERROR:  column "id" specified more than once
2023-01-17 22:09:46.222 GMT [606422] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT * FROM customer
	    INNER JOIN online_account ON customer.id = online_account.customer_id;
2023-01-17 22:09:46.487 GMT [606422] ERROR:  column "account_number" does not exist at character 66
2023-01-17 22:09:46.487 GMT [606422] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, account_number)
2023-01-17 22:09:46.487 GMT [606422] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 38 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:09:46.487 GMT [606422] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:11:35.737 GMT [606396] LOG:  received fast shutdown request
2023-01-17 22:11:35.739 GMT [606396] LOG:  aborting any active transactions
2023-01-17 22:11:35.743 GMT [606396] LOG:  background worker "logical replication launcher" (PID 606403) exited with exit code 1
2023-01-17 22:11:35.745 GMT [606398] LOG:  shutting down
2023-01-17 22:11:35.796 GMT [606396] LOG:  database system is shut down
2023-01-17 22:11:36.860 GMT [610165] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:11:36.860 GMT [610165] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:11:36.862 GMT [610165] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:11:36.867 GMT [610166] LOG:  database system was shut down at 2023-01-17 22:11:36 GMT
2023-01-17 22:11:36.872 GMT [610165] LOG:  database system is ready to accept connections
2023-01-17 22:11:37.836 GMT [610195] ERROR:  column "account_number" does not exist at character 66
2023-01-17 22:11:37.836 GMT [610195] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, account_number)
2023-01-17 22:11:37.836 GMT [610195] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 38 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:11:37.836 GMT [610195] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:12:08.722 GMT [610165] LOG:  received fast shutdown request
2023-01-17 22:12:08.726 GMT [610165] LOG:  aborting any active transactions
2023-01-17 22:12:08.731 GMT [610165] LOG:  background worker "logical replication launcher" (PID 610172) exited with exit code 1
2023-01-17 22:12:08.731 GMT [610167] LOG:  shutting down
2023-01-17 22:12:08.786 GMT [610165] LOG:  database system is shut down
2023-01-17 22:12:09.890 GMT [611302] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:12:09.890 GMT [611302] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:12:09.892 GMT [611302] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:12:09.895 GMT [611303] LOG:  database system was shut down at 2023-01-17 22:12:09 GMT
2023-01-17 22:12:09.900 GMT [611302] LOG:  database system is ready to accept connections
2023-01-17 22:16:00.324 GMT [611302] LOG:  received fast shutdown request
2023-01-17 22:16:00.327 GMT [611302] LOG:  aborting any active transactions
2023-01-17 22:16:00.333 GMT [611302] LOG:  background worker "logical replication launcher" (PID 611309) exited with exit code 1
2023-01-17 22:16:00.333 GMT [611304] LOG:  shutting down
2023-01-17 22:16:00.380 GMT [611302] LOG:  database system is shut down
2023-01-17 22:16:01.497 GMT [618926] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:16:01.497 GMT [618926] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:16:01.499 GMT [618926] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:16:01.502 GMT [618927] LOG:  database system was shut down at 2023-01-17 22:16:01 GMT
2023-01-17 22:16:01.506 GMT [618926] LOG:  database system is ready to accept connections
2023-01-17 22:16:02.327 GMT [618992] ERROR:  column customer.account_id does not exist at character 262
2023-01-17 22:16:02.327 GMT [618992] STATEMENT:  CREATE OR REPLACE VIEW client.personal_information AS
	    SELECT customer.id, customer.first_name, customer.last_name, customer.date_of_birth, customer.address, customer.email, customer.phone_number, customer.is_verified FROM customer
	    INNER JOIN account ON customer.account_id = account.account_id;
2023-01-17 22:16:30.814 GMT [618926] LOG:  received fast shutdown request
2023-01-17 22:16:30.816 GMT [618926] LOG:  aborting any active transactions
2023-01-17 22:16:30.819 GMT [618926] LOG:  background worker "logical replication launcher" (PID 618933) exited with exit code 1
2023-01-17 22:16:30.821 GMT [618928] LOG:  shutting down
2023-01-17 22:16:30.875 GMT [618926] LOG:  database system is shut down
2023-01-17 22:16:31.957 GMT [620061] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:16:31.957 GMT [620061] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:16:31.959 GMT [620061] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:16:31.964 GMT [620062] LOG:  database system was shut down at 2023-01-17 22:16:31 GMT
2023-01-17 22:16:31.969 GMT [620061] LOG:  database system is ready to accept connections
2023-01-17 22:23:22.978 GMT [620061] LOG:  received fast shutdown request
2023-01-17 22:23:22.981 GMT [620061] LOG:  aborting any active transactions
2023-01-17 22:23:22.986 GMT [620061] LOG:  background worker "logical replication launcher" (PID 620068) exited with exit code 1
2023-01-17 22:23:22.987 GMT [620063] LOG:  shutting down
2023-01-17 22:23:23.002 GMT [620061] LOG:  database system is shut down
2023-01-17 22:23:24.108 GMT [633593] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:23:24.108 GMT [633593] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:23:24.110 GMT [633593] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:23:24.115 GMT [633594] LOG:  database system was shut down at 2023-01-17 22:23:23 GMT
2023-01-17 22:23:24.120 GMT [633593] LOG:  database system is ready to accept connections
2023-01-17 22:23:25.032 GMT [633622] ERROR:  column "dest_account_id" does not exist at character 187
2023-01-17 22:23:25.032 GMT [633622] QUERY:  SELECT * FROM client.get_or_create_statement((SELECT account_id FROM account WHERE account_number = (SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id)), (SELECT dest_account_id FROM pending_transaction WHERE id = pending_transaction_id))
2023-01-17 22:23:25.032 GMT [633622] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 25 at SQL statement
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 28 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-17 22:23:25.032 GMT [633622] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-17 22:25:11.518 GMT [633593] LOG:  received fast shutdown request
2023-01-17 22:25:11.520 GMT [633593] LOG:  aborting any active transactions
2023-01-17 22:25:11.529 GMT [633593] LOG:  background worker "logical replication launcher" (PID 633600) exited with exit code 1
2023-01-17 22:25:11.529 GMT [633595] LOG:  shutting down
2023-01-17 22:25:11.584 GMT [633593] LOG:  database system is shut down
2023-01-17 22:25:12.689 GMT [637217] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:25:12.689 GMT [637217] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:25:12.691 GMT [637217] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:25:12.696 GMT [637218] LOG:  database system was shut down at 2023-01-17 22:25:12 GMT
2023-01-17 22:25:12.708 GMT [637217] LOG:  database system is ready to accept connections
2023-01-17 22:25:34.749 GMT [637217] LOG:  received fast shutdown request
2023-01-17 22:25:34.750 GMT [637217] LOG:  aborting any active transactions
2023-01-17 22:25:34.756 GMT [637217] LOG:  background worker "logical replication launcher" (PID 637224) exited with exit code 1
2023-01-17 22:25:34.756 GMT [637219] LOG:  shutting down
2023-01-17 22:25:34.807 GMT [637217] LOG:  database system is shut down
2023-01-17 22:25:35.940 GMT [638055] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-17 22:25:35.940 GMT [638055] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-17 22:25:35.942 GMT [638055] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-17 22:25:35.947 GMT [638056] LOG:  database system was shut down at 2023-01-17 22:25:35 GMT
2023-01-17 22:25:35.953 GMT [638055] LOG:  database system is ready to accept connections
2023-01-18 11:30:27.129 GMT [148101] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-18 11:30:27.132 GMT [148101] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-18 11:30:27.133 GMT [148101] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-18 11:30:27.139 GMT [148102] LOG:  database system was shut down at 2023-01-18 11:30:26 GMT
2023-01-18 11:30:27.145 GMT [148101] LOG:  database system is ready to accept connections
2023-01-19 09:10:59.439 GMT [148101] LOG:  received smart shutdown request
2023-01-19 09:10:59.456 GMT [148101] LOG:  background worker "logical replication launcher" (PID 148108) exited with exit code 1
2023-01-19 09:10:59.462 GMT [148101] LOG:  received SIGHUP, reloading configuration files
2023-01-19 09:10:59.486 GMT [148103] LOG:  shutting down
2023-01-19 09:10:59.548 GMT [148101] LOG:  database system is shut down
2023-01-19 09:51:06.949 GMT [7022] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:51:06.953 GMT [7022] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:51:06.954 GMT [7022] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:51:06.958 GMT [7025] LOG:  database system was shut down at 2023-01-19 09:51:06 GMT
2023-01-19 09:51:06.964 GMT [7022] LOG:  database system is ready to accept connections
2023-01-19 09:52:14.294 GMT [7022] LOG:  received fast shutdown request
2023-01-19 09:52:14.296 GMT [7022] LOG:  aborting any active transactions
2023-01-19 09:52:14.299 GMT [7022] LOG:  background worker "logical replication launcher" (PID 7032) exited with exit code 1
2023-01-19 09:52:14.304 GMT [7027] LOG:  shutting down
2023-01-19 09:52:14.377 GMT [7022] LOG:  database system is shut down
2023-01-19 09:52:15.894 GMT [7375] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:52:15.895 GMT [7375] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:52:15.896 GMT [7375] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:52:15.901 GMT [7376] LOG:  database system was shut down at 2023-01-19 09:52:15 GMT
2023-01-19 09:52:15.907 GMT [7375] LOG:  database system is ready to accept connections
2023-01-19 09:52:57.698 GMT [7375] LOG:  received fast shutdown request
2023-01-19 09:52:57.700 GMT [7375] LOG:  aborting any active transactions
2023-01-19 09:52:57.705 GMT [7375] LOG:  background worker "logical replication launcher" (PID 7382) exited with exit code 1
2023-01-19 09:52:57.705 GMT [7377] LOG:  shutting down
2023-01-19 09:52:57.773 GMT [7375] LOG:  database system is shut down
2023-01-19 09:52:59.123 GMT [7603] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:52:59.123 GMT [7603] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:52:59.128 GMT [7603] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:52:59.132 GMT [7604] LOG:  database system was shut down at 2023-01-19 09:52:58 GMT
2023-01-19 09:52:59.138 GMT [7603] LOG:  database system is ready to accept connections
2023-01-19 09:53:27.354 GMT [7603] LOG:  received fast shutdown request
2023-01-19 09:53:27.358 GMT [7603] LOG:  aborting any active transactions
2023-01-19 09:53:27.360 GMT [7603] LOG:  background worker "logical replication launcher" (PID 7610) exited with exit code 1
2023-01-19 09:53:27.365 GMT [7605] LOG:  shutting down
2023-01-19 09:53:27.435 GMT [7603] LOG:  database system is shut down
2023-01-19 09:53:28.851 GMT [7812] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:53:28.852 GMT [7812] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:53:28.857 GMT [7812] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:53:28.864 GMT [7813] LOG:  database system was shut down at 2023-01-19 09:53:28 GMT
2023-01-19 09:53:28.871 GMT [7812] LOG:  database system is ready to accept connections
2023-01-19 09:54:18.810 GMT [7812] LOG:  received fast shutdown request
2023-01-19 09:54:18.813 GMT [7812] LOG:  aborting any active transactions
2023-01-19 09:54:18.820 GMT [7812] LOG:  background worker "logical replication launcher" (PID 7819) exited with exit code 1
2023-01-19 09:54:18.820 GMT [7814] LOG:  shutting down
2023-01-19 09:54:18.882 GMT [7812] LOG:  database system is shut down
2023-01-19 09:54:20.305 GMT [8068] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:54:20.305 GMT [8068] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:54:20.307 GMT [8068] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:54:20.312 GMT [8069] LOG:  database system was shut down at 2023-01-19 09:54:19 GMT
2023-01-19 09:54:20.320 GMT [8068] LOG:  database system is ready to accept connections
2023-01-19 09:54:29.574 GMT [8068] LOG:  received fast shutdown request
2023-01-19 09:54:29.576 GMT [8068] LOG:  aborting any active transactions
2023-01-19 09:54:29.578 GMT [8068] LOG:  background worker "logical replication launcher" (PID 8075) exited with exit code 1
2023-01-19 09:54:29.586 GMT [8070] LOG:  shutting down
2023-01-19 09:54:29.655 GMT [8068] LOG:  database system is shut down
2023-01-19 09:54:31.106 GMT [8213] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 09:54:31.106 GMT [8213] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 09:54:31.108 GMT [8213] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 09:54:31.114 GMT [8214] LOG:  database system was shut down at 2023-01-19 09:54:30 GMT
2023-01-19 09:54:31.127 GMT [8213] LOG:  database system is ready to accept connections
2023-01-19 10:03:54.226 GMT [8213] LOG:  received fast shutdown request
2023-01-19 10:03:54.229 GMT [8213] LOG:  aborting any active transactions
2023-01-19 10:03:54.236 GMT [8213] LOG:  background worker "logical replication launcher" (PID 8223) exited with exit code 1
2023-01-19 10:03:54.236 GMT [8218] LOG:  shutting down
2023-01-19 10:03:54.253 GMT [8213] LOG:  database system is shut down
2023-01-19 10:03:55.914 GMT [9940] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 10:03:55.915 GMT [9940] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 10:03:55.917 GMT [9940] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 10:03:55.922 GMT [9941] LOG:  database system was shut down at 2023-01-19 10:03:55 GMT
2023-01-19 10:03:55.930 GMT [9940] LOG:  database system is ready to accept connections
2023-01-19 10:04:08.080 GMT [9940] LOG:  received fast shutdown request
2023-01-19 10:04:08.082 GMT [9940] LOG:  aborting any active transactions
2023-01-19 10:04:08.089 GMT [9940] LOG:  background worker "logical replication launcher" (PID 9947) exited with exit code 1
2023-01-19 10:04:08.091 GMT [9942] LOG:  shutting down
2023-01-19 10:04:08.174 GMT [9940] LOG:  database system is shut down
2023-01-19 10:04:09.879 GMT [10096] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 10:04:09.880 GMT [10096] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 10:04:09.881 GMT [10096] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 10:04:09.886 GMT [10097] LOG:  database system was shut down at 2023-01-19 10:04:09 GMT
2023-01-19 10:04:09.893 GMT [10096] LOG:  database system is ready to accept connections
2023-01-19 10:04:26.248 GMT [10096] LOG:  received fast shutdown request
2023-01-19 10:04:26.250 GMT [10096] LOG:  aborting any active transactions
2023-01-19 10:04:26.254 GMT [10096] LOG:  background worker "logical replication launcher" (PID 10103) exited with exit code 1
2023-01-19 10:04:26.257 GMT [10098] LOG:  shutting down
2023-01-19 10:04:26.340 GMT [10096] LOG:  database system is shut down
2023-01-19 10:04:27.722 GMT [10253] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 10:04:27.723 GMT [10253] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 10:04:27.725 GMT [10253] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 10:04:27.731 GMT [10254] LOG:  database system was shut down at 2023-01-19 10:04:27 GMT
2023-01-19 10:04:27.739 GMT [10253] LOG:  database system is ready to accept connections
2023-01-19 10:55:20.171 GMT [10253] LOG:  received smart shutdown request
2023-01-19 10:55:20.434 GMT [10253] LOG:  background worker "logical replication launcher" (PID 10260) exited with exit code 1
2023-01-19 10:55:20.497 GMT [10255] LOG:  shutting down
2023-01-19 10:55:20.967 GMT [10253] LOG:  database system is shut down
2023-01-19 17:24:10.652 GMT [43026] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 17:24:10.652 GMT [43026] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 17:24:10.654 GMT [43026] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 17:24:10.659 GMT [43027] LOG:  database system was shut down at 2023-01-19 17:24:10 GMT
2023-01-19 17:24:10.664 GMT [43026] LOG:  database system is ready to accept connections
2023-01-19 17:24:11.371 GMT [43052] ERROR:  type "numeri" does not exist at character 107
2023-01-19 17:24:11.371 GMT [43052] STATEMENT:  CREATE TABLE IF NOT EXISTS loan_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    amount NUMERI(15,2),
	    loan_id INT REFERENCES loan(id)
	);
2023-01-19 17:24:11.503 GMT [43052] ERROR:  relation "loan_statement" does not exist at character 213
2023-01-19 17:24:11.503 GMT [43052] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-19 17:24:11.766 GMT [43052] ERROR:  relation "loan_statement" does not exist at character 13
2023-01-19 17:24:11.766 GMT [43052] QUERY:  INSERT INTO loan_statement (starting_date, amount, loan_id) VALUES (date_trunc('month', now()::date), 0, loan_id)
2023-01-19 17:24:11.766 GMT [43052] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-19 17:24:11.766 GMT [43052] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-19 17:27:33.592 GMT [43796] ERROR:  permission denied for schema unauthenticated at character 15
2023-01-19 17:27:33.592 GMT [43796] STATEMENT:  SELECT * FROM unauthenticated.unauthenticated_personal_information;
2023-01-19 17:29:04.775 GMT [44293] ERROR:  permission denied for schema unauthenticated at character 15
2023-01-19 17:29:04.775 GMT [44293] STATEMENT:  SELECT * FROM unauthenticated.unauthenticated_personal_information;
2023-01-19 17:32:48.030 GMT [43026] LOG:  received fast shutdown request
2023-01-19 17:32:48.032 GMT [43026] LOG:  aborting any active transactions
2023-01-19 17:32:48.034 GMT [43026] LOG:  background worker "logical replication launcher" (PID 43033) exited with exit code 1
2023-01-19 17:32:48.037 GMT [43028] LOG:  shutting down
2023-01-19 17:32:48.050 GMT [43026] LOG:  database system is shut down
2023-01-19 17:32:49.287 GMT [45507] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 17:32:49.287 GMT [45507] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 17:32:49.289 GMT [45507] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 17:32:49.296 GMT [45508] LOG:  database system was shut down at 2023-01-19 17:32:48 GMT
2023-01-19 17:32:49.301 GMT [45507] LOG:  database system is ready to accept connections
2023-01-19 17:32:50.021 GMT [45536] ERROR:  type "numeri" does not exist at character 107
2023-01-19 17:32:50.021 GMT [45536] STATEMENT:  CREATE TABLE IF NOT EXISTS loan_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    amount NUMERI(15,2),
	    loan_id INT REFERENCES loan(id)
	);
2023-01-19 17:32:50.146 GMT [45536] ERROR:  relation "loan_statement" does not exist at character 213
2023-01-19 17:32:50.146 GMT [45536] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-19 17:32:50.422 GMT [45536] ERROR:  relation "loan_statement" does not exist at character 13
2023-01-19 17:32:50.422 GMT [45536] QUERY:  INSERT INTO loan_statement (starting_date, amount, loan_id) VALUES (date_trunc('month', now()::date), 0, loan_id)
2023-01-19 17:32:50.422 GMT [45536] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-19 17:32:50.422 GMT [45536] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-19 17:36:49.979 GMT [45911] ERROR:  function unauthenticated.create_personal_info(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) does not exist at character 15
2023-01-19 17:36:49.979 GMT [45911] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 17:36:49.979 GMT [45911] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('alfie', 'dew', '22-12-2002', '0777777777777', 'alfie@example.com', 'street', 'city', 'postcode');
2023-01-19 17:38:08.629 GMT [45911] ERROR:  syntax error at or near ":" at character 59
2023-01-19 17:38:08.629 GMT [45911] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('alfie':TEXT, 'dew':TEXT, '22-12-2002':DATE, '0777777777777':TEXT, 'alfie@example.com':TEXT, 'street':TEXT, 'city':TEXT, 'postcode':TEXT);
2023-01-19 17:38:39.447 GMT [45911] ERROR:  function unauthenticated.create_personal_info(text, text, date, text, text, text, text, text) does not exist at character 15
2023-01-19 17:38:39.447 GMT [45911] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 17:38:39.447 GMT [45911] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('alfie'::TEXT, 'dew'::TEXT, '22-12-2002'::DATE, '0777777777777'::TEXT, 'alfie@example.com'::TEXT, 'street'::TEXT, 'city'::TEXT, 'postcode'::TEXT);
2023-01-19 17:39:39.779 GMT [45911] ERROR:  column reference "first_name" is ambiguous at character 88
2023-01-19 17:39:39.779 GMT [45911] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-19 17:39:39.779 GMT [45911] QUERY:  NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address)
2023-01-19 17:39:39.779 GMT [45911] CONTEXT:  PL/pgSQL function create_personal_info(text,text,date,text,text,text,text,text,text) line 4 at IF
2023-01-19 17:39:39.779 GMT [45911] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('alfie'::TEXT, 'dew'::TEXT, '22-12-2002'::DATE, '0777777777777'::TEXT, 'alfie@example.com'::TEXT, 'street'::TEXT, 'city'::TEXT, 'postcode'::TEXT, 'postcode'::TEXT);
2023-01-19 17:41:12.011 GMT [45911] ERROR:  column reference "first_name" is ambiguous at character 88
2023-01-19 17:41:12.011 GMT [45911] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-19 17:41:12.011 GMT [45911] QUERY:  NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_name AND md5(last_name) = last_name AND md5(email_address) = email_address)
2023-01-19 17:41:12.011 GMT [45911] CONTEXT:  PL/pgSQL function create_personal_info(text,text,date,text,text,text,text,text,text) line 4 at IF
2023-01-19 17:41:12.011 GMT [45911] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('alfie'::TEXT, 'dew'::TEXT, '22-12-2002'::DATE, '0777777777777'::TEXT, 'alfie@example.com'::TEXT, 'street'::TEXT, 'city'::TEXT, 'postcode'::TEXT, 'postcode'::TEXT);
2023-01-19 17:53:17.009 GMT [49941] FATAL:  database "johnsmith" does not exist
2023-01-19 19:52:06.367 GMT [45507] LOG:  received SIGHUP, reloading configuration files
2023-01-19 19:52:06.368 GMT [45507] LOG:  received smart shutdown request
2023-01-19 19:52:06.404 GMT [45507] LOG:  background worker "logical replication launcher" (PID 45514) exited with exit code 1
2023-01-19 19:52:06.406 GMT [45509] LOG:  shutting down
2023-01-19 19:52:06.470 GMT [45507] LOG:  database system is shut down
2023-01-19 19:56:06.014 GMT [8289] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 19:56:06.016 GMT [8289] LOG:  could not bind IPv4 address "127.0.0.1": Address already in use
2023-01-19 19:56:06.016 GMT [8289] HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.
2023-01-19 19:56:06.016 GMT [8289] WARNING:  could not create listen socket for "localhost"
2023-01-19 19:56:06.017 GMT [8289] FATAL:  could not create any TCP/IP sockets
2023-01-19 19:56:06.019 GMT [8289] LOG:  database system is shut down
2023-01-19 19:57:09.117 GMT [10502] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 19:57:09.117 GMT [10502] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 19:57:09.119 GMT [10502] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 19:57:09.125 GMT [10503] LOG:  database system was shut down at 2023-01-19 19:52:06 GMT
2023-01-19 19:57:09.132 GMT [10502] LOG:  database system is ready to accept connections
2023-01-19 19:57:20.527 GMT [10919] FATAL:  password authentication failed for user "parallels"
2023-01-19 19:57:20.527 GMT [10919] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-19 19:57:20.527 GMT [10919] LOG:  could not send data to client: Broken pipe
2023-01-19 19:57:35.182 GMT [11394] FATAL:  password authentication failed for user "parallels"
2023-01-19 19:57:35.182 GMT [11394] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-19 19:57:35.182 GMT [11394] LOG:  could not send data to client: Broken pipe
2023-01-19 19:57:35.866 GMT [11474] FATAL:  password authentication failed for user "postgres"
2023-01-19 19:57:35.866 GMT [11474] DETAIL:  User "postgres" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-19 19:57:35.866 GMT [11474] LOG:  could not send data to client: Broken pipe
2023-01-19 19:57:40.362 GMT [11637] FATAL:  password authentication failed for user "postgres"
2023-01-19 19:57:40.362 GMT [11637] DETAIL:  User "postgres" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-19 19:58:04.356 GMT [12405] FATAL:  password authentication failed for user "parallels"
2023-01-19 19:58:04.356 GMT [12405] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-19 19:58:04.356 GMT [12405] LOG:  could not send data to client: Broken pipe
2023-01-19 20:17:36.646 GMT [10502] LOG:  received fast shutdown request
2023-01-19 20:17:36.647 GMT [10502] LOG:  aborting any active transactions
2023-01-19 20:17:36.650 GMT [10502] LOG:  background worker "logical replication launcher" (PID 10509) exited with exit code 1
2023-01-19 20:17:36.653 GMT [10504] LOG:  shutting down
2023-01-19 20:17:36.669 GMT [10502] LOG:  database system is shut down
2023-01-19 20:17:40.556 GMT [50720] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:17:40.557 GMT [50720] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:17:40.559 GMT [50720] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:17:40.572 GMT [50721] LOG:  database system was shut down at 2023-01-19 20:17:40 GMT
2023-01-19 20:17:40.578 GMT [50720] LOG:  database system is ready to accept connections
2023-01-19 20:17:41.376 GMT [50749] ERROR:  type "numeri" does not exist at character 107
2023-01-19 20:17:41.376 GMT [50749] STATEMENT:  CREATE TABLE IF NOT EXISTS loan_statement (
	    id SERIAL PRIMARY KEY,
	    starting_date DATE,
	    amount NUMERI(15,2),
	    loan_id INT REFERENCES loan(id)
	);
2023-01-19 20:17:41.414 GMT [50749] ERROR:  syntax error at or near "username" at character 65
2023-01-19 20:17:41.414 GMT [50749] STATEMENT:  CREATE OR REPLACE FUNCTION policy_customer_client_check(VARCHAR username)
	RETURNS INT AS $$
	DECLARE
	    allowed_customer_id INT;
	BEGIN
	    SELECT customer_id INTO allowed_customer_id FROM customer
	    INNER JOIN online_account ON customer.id = online_account.customer_id
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = username;
	    RETURN allowed_customer_id;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-19 20:17:41.416 GMT [50749] ERROR:  function policy_customer_client_check(name) does not exist
2023-01-19 20:17:41.416 GMT [50749] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 20:17:41.416 GMT [50749] STATEMENT:  CREATE POLICY policy_customer_client ON customer
	    FOR SELECT TO l4 USING (id = policy_customer_client_check(current_user));
2023-01-19 20:17:41.510 GMT [50749] ERROR:  relation "loan_statement" does not exist at character 213
2023-01-19 20:17:41.510 GMT [50749] STATEMENT:  CREATE OR REPLACE VIEW client.loan_statements AS
	    SELECT loans.account_id, loans.id, loan_statement.id as statement_id, loan_statement.starting_date, loan_statement.amount
	    FROM client.loans
	    INNER JOIN loan_statement ON loans.id = loan_statement.loan_id;
2023-01-19 20:17:41.592 GMT [50749] ERROR:  role "johnsmith" does not exist
2023-01-19 20:17:41.592 GMT [50749] STATEMENT:  SET ROLE johnsmith;
2023-01-19 20:17:43.430 GMT [50749] ERROR:  relation "loan_statement" does not exist at character 13
2023-01-19 20:17:43.430 GMT [50749] QUERY:  INSERT INTO loan_statement (starting_date, amount, loan_id) VALUES (date_trunc('month', now()::date), 0, loan_id)
2023-01-19 20:17:43.430 GMT [50749] CONTEXT:  PL/pgSQL function client.open_loan(integer,numeric,date,text,numeric) line 8 at SQL statement
2023-01-19 20:17:43.430 GMT [50749] STATEMENT:  SELECT * FROM client.open_loan(1, 10000.00, '22-12-2025'::DATE, 'vehicle'::TEXT, 5.00);
2023-01-19 20:17:43.455 GMT [50749] ERROR:  syntax error at or near "ROLE" at character 58
2023-01-19 20:17:43.455 GMT [50749] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info()
	SET ROLE johnsmith;
2023-01-19 20:22:18.840 GMT [50720] LOG:  received fast shutdown request
2023-01-19 20:22:18.842 GMT [50720] LOG:  aborting any active transactions
2023-01-19 20:22:18.845 GMT [50720] LOG:  background worker "logical replication launcher" (PID 50727) exited with exit code 1
2023-01-19 20:22:18.847 GMT [50722] LOG:  shutting down
2023-01-19 20:22:18.903 GMT [50720] LOG:  database system is shut down
2023-01-19 20:22:20.125 GMT [59913] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:22:20.126 GMT [59913] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:22:20.127 GMT [59913] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:22:20.133 GMT [59914] LOG:  database system was shut down at 2023-01-19 20:22:19 GMT
2023-01-19 20:22:20.139 GMT [59913] LOG:  database system is ready to accept connections
2023-01-19 20:22:20.994 GMT [59939] ERROR:  syntax error at or near "username" at character 65
2023-01-19 20:22:20.994 GMT [59939] STATEMENT:  CREATE OR REPLACE FUNCTION policy_customer_client_check(VARCHAR username)
	RETURNS INT AS $$
	DECLARE
	    allowed_customer_id INT;
	BEGIN
	    SELECT customer_id INTO allowed_customer_id FROM customer
	    INNER JOIN online_account ON customer.id = online_account.customer_id
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = username;
	    RETURN allowed_customer_id;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-19 20:22:20.994 GMT [59939] ERROR:  function policy_customer_client_check(name) does not exist
2023-01-19 20:22:20.994 GMT [59939] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 20:22:20.994 GMT [59939] STATEMENT:  CREATE POLICY policy_customer_client ON customer
	    FOR SELECT TO l4 USING (id = policy_customer_client_check(current_user));
2023-01-19 20:22:21.044 GMT [59939] ERROR:  role "johnsmith" does not exist
2023-01-19 20:22:21.044 GMT [59939] STATEMENT:  SET ROLE johnsmith;
2023-01-19 20:22:21.374 GMT [59939] ERROR:  syntax error at or near "ROLE" at character 58
2023-01-19 20:22:21.374 GMT [59939] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info()
	SET ROLE johnsmith;
2023-01-19 20:25:33.181 GMT [59913] LOG:  received fast shutdown request
2023-01-19 20:25:33.182 GMT [59913] LOG:  aborting any active transactions
2023-01-19 20:25:33.187 GMT [59913] LOG:  background worker "logical replication launcher" (PID 59920) exited with exit code 1
2023-01-19 20:25:33.187 GMT [59915] LOG:  shutting down
2023-01-19 20:25:33.256 GMT [59913] LOG:  database system is shut down
2023-01-19 20:25:34.500 GMT [66361] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:25:34.501 GMT [66361] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:25:34.504 GMT [66361] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:25:34.513 GMT [66362] LOG:  database system was shut down at 2023-01-19 20:25:34 GMT
2023-01-19 20:25:34.520 GMT [66361] LOG:  database system is ready to accept connections
2023-01-19 20:25:35.409 GMT [66387] ERROR:  "personal_information" is not a table
2023-01-19 20:25:35.409 GMT [66387] STATEMENT:  CREATE POLICY policy_customer_client ON client.personal_information
	    FOR SELECT TO l4 USING (id = policy_customer_client_check(current_user));
2023-01-19 20:40:01.100 GMT [66361] LOG:  received fast shutdown request
2023-01-19 20:40:01.102 GMT [66361] LOG:  aborting any active transactions
2023-01-19 20:40:01.107 GMT [66361] LOG:  background worker "logical replication launcher" (PID 66368) exited with exit code 1
2023-01-19 20:40:01.107 GMT [66363] LOG:  shutting down
2023-01-19 20:40:01.122 GMT [66361] LOG:  database system is shut down
2023-01-19 20:40:02.245 GMT [94585] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:40:02.245 GMT [94585] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:40:02.246 GMT [94585] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:40:02.251 GMT [94586] LOG:  database system was shut down at 2023-01-19 20:40:01 GMT
2023-01-19 20:40:02.264 GMT [94585] LOG:  database system is ready to accept connections
2023-01-19 20:40:02.811 GMT [94683] ERROR:  syntax error at or near "CREATE" at character 37
2023-01-19 20:40:02.811 GMT [94683] STATEMENT:  CREATE ROLE user_banking_protection
	CREATE ROLE employee WITH LOGIN PASSWORD 'employee';
2023-01-19 20:40:02.822 GMT [94683] ERROR:  role "user_banking_protection" does not exist
2023-01-19 20:40:02.822 GMT [94683] STATEMENT:  GRANT l1 to user_banking_protection;
2023-01-19 20:40:02.823 GMT [94683] ERROR:  role "employee" does not exist
2023-01-19 20:40:02.823 GMT [94683] STATEMENT:  GRANT l3 TO employee;
2023-01-19 20:40:02.959 GMT [94683] ERROR:  role "user_banking_protection" does not exist
2023-01-19 20:40:02.959 GMT [94683] STATEMENT:  CREATE POLICY policy_customer_client ON customer
	    FOR SELECT TO user_banking_protection USING (id = policy_customer_client_check(current_user));
2023-01-19 20:40:03.080 GMT [94683] ERROR:  role "user_banking_protection" does not exist
2023-01-19 20:40:03.080 GMT [94683] STATEMENT:  ALTER VIEW IF EXISTS client.personal_information OWNER TO user_banking_protection;
2023-01-19 20:40:34.542 GMT [94585] LOG:  received fast shutdown request
2023-01-19 20:40:34.544 GMT [94585] LOG:  aborting any active transactions
2023-01-19 20:40:34.551 GMT [94585] LOG:  background worker "logical replication launcher" (PID 94592) exited with exit code 1
2023-01-19 20:40:34.552 GMT [94587] LOG:  shutting down
2023-01-19 20:40:34.607 GMT [94585] LOG:  database system is shut down
2023-01-19 20:40:35.869 GMT [95789] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:40:35.869 GMT [95789] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:40:35.870 GMT [95789] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:40:35.876 GMT [95790] LOG:  database system was shut down at 2023-01-19 20:40:35 GMT
2023-01-19 20:40:35.883 GMT [95789] LOG:  database system is ready to accept connections
2023-01-19 20:40:37.013 GMT [95815] ERROR:  permission denied for table customer
2023-01-19 20:40:37.013 GMT [95815] STATEMENT:  SELECT * FROM client.personal_information;
2023-01-19 20:41:43.287 GMT [95789] LOG:  received fast shutdown request
2023-01-19 20:41:43.289 GMT [95789] LOG:  aborting any active transactions
2023-01-19 20:41:43.294 GMT [95789] LOG:  background worker "logical replication launcher" (PID 95796) exited with exit code 1
2023-01-19 20:41:43.295 GMT [95791] LOG:  shutting down
2023-01-19 20:41:43.348 GMT [95789] LOG:  database system is shut down
2023-01-19 20:41:44.542 GMT [98078] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:41:44.543 GMT [98078] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:41:44.544 GMT [98078] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:41:44.548 GMT [98079] LOG:  database system was shut down at 2023-01-19 20:41:44 GMT
2023-01-19 20:41:44.553 GMT [98078] LOG:  database system is ready to accept connections
2023-01-19 20:42:47.797 GMT [98078] LOG:  received fast shutdown request
2023-01-19 20:42:47.798 GMT [98078] LOG:  aborting any active transactions
2023-01-19 20:42:47.801 GMT [98078] LOG:  background worker "logical replication launcher" (PID 98085) exited with exit code 1
2023-01-19 20:42:47.803 GMT [98080] LOG:  shutting down
2023-01-19 20:42:47.852 GMT [98078] LOG:  database system is shut down
2023-01-19 20:42:48.938 GMT [100368] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:42:48.938 GMT [100368] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:42:48.941 GMT [100368] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:42:48.948 GMT [100369] LOG:  database system was shut down at 2023-01-19 20:42:48 GMT
2023-01-19 20:42:48.953 GMT [100368] LOG:  database system is ready to accept connections
2023-01-19 20:43:48.457 GMT [100368] LOG:  received fast shutdown request
2023-01-19 20:43:48.459 GMT [100368] LOG:  aborting any active transactions
2023-01-19 20:43:48.461 GMT [100368] LOG:  background worker "logical replication launcher" (PID 100375) exited with exit code 1
2023-01-19 20:43:48.465 GMT [100370] LOG:  shutting down
2023-01-19 20:43:48.511 GMT [100368] LOG:  database system is shut down
2023-01-19 20:43:49.667 GMT [102431] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:43:49.668 GMT [102431] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:43:49.669 GMT [102431] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:43:49.674 GMT [102434] LOG:  database system was shut down at 2023-01-19 20:43:49 GMT
2023-01-19 20:43:49.689 GMT [102431] LOG:  database system is ready to accept connections
2023-01-19 20:45:05.459 GMT [102431] LOG:  received fast shutdown request
2023-01-19 20:45:05.461 GMT [102431] LOG:  aborting any active transactions
2023-01-19 20:45:05.465 GMT [102431] LOG:  background worker "logical replication launcher" (PID 102441) exited with exit code 1
2023-01-19 20:45:05.469 GMT [102436] LOG:  shutting down
2023-01-19 20:45:05.517 GMT [102431] LOG:  database system is shut down
2023-01-19 20:45:06.592 GMT [105058] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:45:06.592 GMT [105058] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:45:06.594 GMT [105058] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:45:06.600 GMT [105059] LOG:  database system was shut down at 2023-01-19 20:45:06 GMT
2023-01-19 20:45:06.606 GMT [105058] LOG:  database system is ready to accept connections
2023-01-19 20:47:15.429 GMT [105058] LOG:  received fast shutdown request
2023-01-19 20:47:15.430 GMT [105058] LOG:  aborting any active transactions
2023-01-19 20:47:15.436 GMT [105058] LOG:  background worker "logical replication launcher" (PID 105065) exited with exit code 1
2023-01-19 20:47:15.438 GMT [105060] LOG:  shutting down
2023-01-19 20:47:15.486 GMT [105058] LOG:  database system is shut down
2023-01-19 20:47:16.705 GMT [109418] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:47:16.706 GMT [109418] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:47:16.707 GMT [109418] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:47:16.712 GMT [109420] LOG:  database system was shut down at 2023-01-19 20:47:16 GMT
2023-01-19 20:47:16.719 GMT [109418] LOG:  database system is ready to accept connections
2023-01-19 20:47:17.307 GMT [109445] ERROR:  syntax error at or near "NO" at character 41
2023-01-19 20:47:17.307 GMT [109445] STATEMENT:  ALTER USER user_banking_protection WITH NO SUPERUSER;
2023-01-19 20:47:48.094 GMT [109418] LOG:  received fast shutdown request
2023-01-19 20:47:48.097 GMT [109418] LOG:  aborting any active transactions
2023-01-19 20:47:48.099 GMT [109418] LOG:  background worker "logical replication launcher" (PID 109426) exited with exit code 1
2023-01-19 20:47:48.104 GMT [109421] LOG:  shutting down
2023-01-19 20:47:48.167 GMT [109418] LOG:  database system is shut down
2023-01-19 20:47:49.241 GMT [110554] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:47:49.241 GMT [110554] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:47:49.243 GMT [110554] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:47:49.257 GMT [110558] LOG:  database system was shut down at 2023-01-19 20:47:48 GMT
2023-01-19 20:47:49.271 GMT [110554] LOG:  database system is ready to accept connections
2023-01-19 20:47:50.558 GMT [110583] ERROR:  permission denied for table customer
2023-01-19 20:47:50.558 GMT [110583] STATEMENT:  SELECT * FROM client.personal_information;
2023-01-19 20:48:42.751 GMT [110554] LOG:  received fast shutdown request
2023-01-19 20:48:42.752 GMT [110554] LOG:  aborting any active transactions
2023-01-19 20:48:42.755 GMT [110554] LOG:  background worker "logical replication launcher" (PID 110564) exited with exit code 1
2023-01-19 20:48:42.760 GMT [110559] LOG:  shutting down
2023-01-19 20:48:42.825 GMT [110554] LOG:  database system is shut down
2023-01-19 20:48:44.006 GMT [112443] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:48:44.006 GMT [112443] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:48:44.007 GMT [112443] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:48:44.014 GMT [112444] LOG:  database system was shut down at 2023-01-19 20:48:43 GMT
2023-01-19 20:48:44.020 GMT [112443] LOG:  database system is ready to accept connections
2023-01-19 20:48:45.359 GMT [112469] ERROR:  permission denied for table customer
2023-01-19 20:48:45.359 GMT [112469] STATEMENT:  SELECT * FROM client.personal_information;
2023-01-19 20:50:27.112 GMT [112443] LOG:  received fast shutdown request
2023-01-19 20:50:27.114 GMT [112443] LOG:  aborting any active transactions
2023-01-19 20:50:27.119 GMT [112443] LOG:  background worker "logical replication launcher" (PID 112450) exited with exit code 1
2023-01-19 20:50:27.119 GMT [112445] LOG:  shutting down
2023-01-19 20:50:27.166 GMT [112443] LOG:  database system is shut down
2023-01-19 20:50:28.282 GMT [115948] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:50:28.282 GMT [115948] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:50:28.288 GMT [115948] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:50:28.296 GMT [115949] LOG:  database system was shut down at 2023-01-19 20:50:28 GMT
2023-01-19 20:50:28.301 GMT [115948] LOG:  database system is ready to accept connections
2023-01-19 20:50:29.543 GMT [116043] ERROR:  column reference "username" is ambiguous at character 236
2023-01-19 20:50:29.543 GMT [116043] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-19 20:50:29.543 GMT [116043] QUERY:  SELECT customer_id                          FROM customer
	    INNER JOIN online_account ON customer.id = online_account.customer_id
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = username
2023-01-19 20:50:29.543 GMT [116043] CONTEXT:  PL/pgSQL function policy_customer_client_check(text) line 6 at SQL statement
2023-01-19 20:50:29.543 GMT [116043] STATEMENT:  SELECT * FROM client.personal_information;
2023-01-19 20:51:19.518 GMT [115948] LOG:  received fast shutdown request
2023-01-19 20:51:19.519 GMT [115948] LOG:  aborting any active transactions
2023-01-19 20:51:19.524 GMT [115948] LOG:  background worker "logical replication launcher" (PID 115955) exited with exit code 1
2023-01-19 20:51:19.524 GMT [115950] LOG:  shutting down
2023-01-19 20:51:19.571 GMT [115948] LOG:  database system is shut down
2023-01-19 20:51:20.852 GMT [117827] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:51:20.853 GMT [117827] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:51:20.854 GMT [117827] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:51:20.858 GMT [117828] LOG:  database system was shut down at 2023-01-19 20:51:20 GMT
2023-01-19 20:51:20.864 GMT [117827] LOG:  database system is ready to accept connections
2023-01-19 20:51:41.881 GMT [117827] LOG:  received fast shutdown request
2023-01-19 20:51:41.883 GMT [117827] LOG:  aborting any active transactions
2023-01-19 20:51:41.887 GMT [117827] LOG:  background worker "logical replication launcher" (PID 117834) exited with exit code 1
2023-01-19 20:51:41.887 GMT [117829] LOG:  shutting down
2023-01-19 20:51:41.942 GMT [117827] LOG:  database system is shut down
2023-01-19 20:51:42.992 GMT [118595] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 20:51:42.992 GMT [118595] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 20:51:42.994 GMT [118595] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 20:51:43.001 GMT [118596] LOG:  database system was shut down at 2023-01-19 20:51:42 GMT
2023-01-19 20:51:43.007 GMT [118595] LOG:  database system is ready to accept connections
2023-01-19 21:01:46.228 GMT [118595] LOG:  received fast shutdown request
2023-01-19 21:01:46.230 GMT [118595] LOG:  aborting any active transactions
2023-01-19 21:01:46.234 GMT [118595] LOG:  background worker "logical replication launcher" (PID 118602) exited with exit code 1
2023-01-19 21:01:46.234 GMT [118597] LOG:  shutting down
2023-01-19 21:01:46.253 GMT [118595] LOG:  database system is shut down
2023-01-19 21:01:47.367 GMT [138494] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:01:47.367 GMT [138494] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:01:47.369 GMT [138494] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:01:47.373 GMT [138495] LOG:  database system was shut down at 2023-01-19 21:01:47 GMT
2023-01-19 21:01:47.379 GMT [138494] LOG:  database system is ready to accept connections
2023-01-19 21:01:48.127 GMT [138524] ERROR:  relation "user_account" does not exist
2023-01-19 21:01:48.127 GMT [138524] STATEMENT:  CREATE POLICY policy_user_account_client ON user_account
	    FOR SELECT TO user_banking_protection USING (account_id = policy_account_client_check(current_user));
2023-01-19 21:01:48.128 GMT [138524] ERROR:  relation "user_account" does not exist
2023-01-19 21:01:48.128 GMT [138524] STATEMENT:  ALTER TABLE user_account ENABLE ROW LEVEL SECURITY;
2023-01-19 21:02:32.456 GMT [138494] LOG:  received fast shutdown request
2023-01-19 21:02:32.459 GMT [138494] LOG:  aborting any active transactions
2023-01-19 21:02:32.461 GMT [138494] LOG:  background worker "logical replication launcher" (PID 138501) exited with exit code 1
2023-01-19 21:02:32.463 GMT [138496] LOG:  shutting down
2023-01-19 21:02:32.509 GMT [138494] LOG:  database system is shut down
2023-01-19 21:02:33.650 GMT [140052] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:02:33.651 GMT [140052] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:02:33.655 GMT [140052] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:02:33.660 GMT [140053] LOG:  database system was shut down at 2023-01-19 21:02:33 GMT
2023-01-19 21:02:33.667 GMT [140052] LOG:  database system is ready to accept connections
2023-01-19 21:02:34.446 GMT [140081] ERROR:  relation "user_account" does not exist
2023-01-19 21:02:34.446 GMT [140081] STATEMENT:  CREATE POLICY policy_user_account_client ON user_account
	    FOR SELECT TO user_banking_protection USING (account_id = policy_account_client_check(current_user));
2023-01-19 21:02:34.446 GMT [140081] ERROR:  relation "user_account" does not exist
2023-01-19 21:02:34.446 GMT [140081] STATEMENT:  ALTER TABLE user_account ENABLE ROW LEVEL SECURITY;
2023-01-19 21:06:46.934 GMT [140052] LOG:  received fast shutdown request
2023-01-19 21:06:46.935 GMT [140052] LOG:  aborting any active transactions
2023-01-19 21:06:46.940 GMT [140052] LOG:  background worker "logical replication launcher" (PID 140059) exited with exit code 1
2023-01-19 21:06:46.940 GMT [140054] LOG:  shutting down
2023-01-19 21:06:46.992 GMT [140052] LOG:  database system is shut down
2023-01-19 21:06:48.138 GMT [148426] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:06:48.138 GMT [148426] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:06:48.141 GMT [148426] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:06:48.147 GMT [148427] LOG:  database system was shut down at 2023-01-19 21:06:47 GMT
2023-01-19 21:06:48.153 GMT [148426] LOG:  database system is ready to accept connections
2023-01-19 21:06:48.921 GMT [148455] ERROR:  syntax error at or near "END" at character 441
2023-01-19 21:06:48.921 GMT [148455] STATEMENT:  CREATE OR REPLACE FUNCTION policy_account_client_check(user_fullname TEXT)
	RETURNS INT AS $$
	DECLARE
	    allowed_account_id INT;
	BEGIN
	    SELECT account_number INTO allowed_account_id FROM account
	    INNER JOIN online_account ON account.account_number = online_account.account_number
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname;
	    RETURN allowed_account_id;
	END;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-19 21:06:48.922 GMT [148455] ERROR:  relation "user_account" does not exist
2023-01-19 21:06:48.922 GMT [148455] STATEMENT:  CREATE POLICY policy_user_account_client ON user_account
	    FOR SELECT TO user_banking_protection USING (account_id = policy_account_client_check(current_user));
2023-01-19 21:06:48.922 GMT [148455] ERROR:  relation "user_account" does not exist
2023-01-19 21:06:48.922 GMT [148455] STATEMENT:  ALTER TABLE user_account ENABLE ROW LEVEL SECURITY;
2023-01-19 21:06:48.922 GMT [148455] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:06:48.922 GMT [148455] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:06:48.922 GMT [148455] STATEMENT:  CREATE POLICY policy_savings_account_client ON savings_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:06:48.925 GMT [148455] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:06:48.925 GMT [148455] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:06:48.925 GMT [148455] STATEMENT:  CREATE POLICY policy_credit_account_client ON credit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:06:48.927 GMT [148455] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:06:48.927 GMT [148455] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:06:48.927 GMT [148455] STATEMENT:  CREATE POLICY policy_debit_account_client ON debit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:07:09.499 GMT [148426] LOG:  received fast shutdown request
2023-01-19 21:07:09.501 GMT [148426] LOG:  aborting any active transactions
2023-01-19 21:07:09.505 GMT [148426] LOG:  background worker "logical replication launcher" (PID 148433) exited with exit code 1
2023-01-19 21:07:09.505 GMT [148428] LOG:  shutting down
2023-01-19 21:07:09.555 GMT [148426] LOG:  database system is shut down
2023-01-19 21:07:10.713 GMT [149279] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:07:10.713 GMT [149279] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:07:10.715 GMT [149279] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:07:10.720 GMT [149280] LOG:  database system was shut down at 2023-01-19 21:07:10 GMT
2023-01-19 21:07:10.725 GMT [149279] LOG:  database system is ready to accept connections
2023-01-19 21:07:11.486 GMT [149305] ERROR:  syntax error at or near "END" at character 441
2023-01-19 21:07:11.486 GMT [149305] STATEMENT:  CREATE OR REPLACE FUNCTION policy_account_client_check(user_fullname TEXT)
	RETURNS INT AS $$
	DECLARE
	    allowed_account_id INT;
	BEGIN
	    SELECT account_number INTO allowed_account_id FROM account
	    INNER JOIN online_account ON account.account_number = online_account.account_number
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname;
	    RETURN allowed_account_id;
	END;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-19 21:07:11.487 GMT [149305] ERROR:  relation "user_account" does not exist
2023-01-19 21:07:11.487 GMT [149305] STATEMENT:  CREATE POLICY policy_user_account_client ON user_account
	    FOR SELECT TO user_banking_protection USING (account_id = policy_account_client_check(current_user));
2023-01-19 21:07:11.488 GMT [149305] ERROR:  relation "user_account" does not exist
2023-01-19 21:07:11.488 GMT [149305] STATEMENT:  ALTER TABLE user_account ENABLE ROW LEVEL SECURITY;
2023-01-19 21:07:11.488 GMT [149305] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:07:11.488 GMT [149305] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:07:11.488 GMT [149305] STATEMENT:  CREATE POLICY policy_savings_account_client ON savings_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:07:11.489 GMT [149305] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:07:11.489 GMT [149305] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:07:11.489 GMT [149305] STATEMENT:  CREATE POLICY policy_credit_account_client ON credit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:07:11.490 GMT [149305] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:07:11.490 GMT [149305] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:07:11.490 GMT [149305] STATEMENT:  CREATE POLICY policy_debit_account_client ON debit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:08:24.420 GMT [149279] LOG:  received fast shutdown request
2023-01-19 21:08:24.422 GMT [149279] LOG:  aborting any active transactions
2023-01-19 21:08:24.426 GMT [149279] LOG:  background worker "logical replication launcher" (PID 149286) exited with exit code 1
2023-01-19 21:08:24.426 GMT [149281] LOG:  shutting down
2023-01-19 21:08:24.479 GMT [149279] LOG:  database system is shut down
2023-01-19 21:08:25.642 GMT [151811] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:08:25.643 GMT [151811] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:08:25.644 GMT [151811] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:08:25.650 GMT [151812] LOG:  database system was shut down at 2023-01-19 21:08:25 GMT
2023-01-19 21:08:25.657 GMT [151811] LOG:  database system is ready to accept connections
2023-01-19 21:08:26.509 GMT [151840] ERROR:  relation "user_account" does not exist
2023-01-19 21:08:26.509 GMT [151840] STATEMENT:  ALTER TABLE user_account ENABLE ROW LEVEL SECURITY;
2023-01-19 21:08:41.750 GMT [151811] LOG:  received fast shutdown request
2023-01-19 21:08:41.751 GMT [151811] LOG:  aborting any active transactions
2023-01-19 21:08:41.757 GMT [151811] LOG:  background worker "logical replication launcher" (PID 151818) exited with exit code 1
2023-01-19 21:08:41.757 GMT [151813] LOG:  shutting down
2023-01-19 21:08:41.811 GMT [151811] LOG:  database system is shut down
2023-01-19 21:08:42.873 GMT [152505] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:08:42.873 GMT [152505] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:08:42.875 GMT [152505] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:08:42.880 GMT [152506] LOG:  database system was shut down at 2023-01-19 21:08:42 GMT
2023-01-19 21:08:42.886 GMT [152505] LOG:  database system is ready to accept connections
2023-01-19 21:09:05.989 GMT [152505] LOG:  received fast shutdown request
2023-01-19 21:09:05.991 GMT [152505] LOG:  aborting any active transactions
2023-01-19 21:09:05.996 GMT [152505] LOG:  background worker "logical replication launcher" (PID 152512) exited with exit code 1
2023-01-19 21:09:05.998 GMT [152507] LOG:  shutting down
2023-01-19 21:09:06.052 GMT [152505] LOG:  database system is shut down
2023-01-19 21:09:07.181 GMT [153354] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:09:07.181 GMT [153354] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:09:07.182 GMT [153354] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:09:07.214 GMT [153373] LOG:  database system was shut down at 2023-01-19 21:09:06 GMT
2023-01-19 21:09:07.225 GMT [153354] LOG:  database system is ready to accept connections
2023-01-19 21:09:23.940 GMT [153354] LOG:  received fast shutdown request
2023-01-19 21:09:23.942 GMT [153354] LOG:  aborting any active transactions
2023-01-19 21:09:23.946 GMT [153354] LOG:  background worker "logical replication launcher" (PID 153385) exited with exit code 1
2023-01-19 21:09:23.948 GMT [153379] LOG:  shutting down
2023-01-19 21:09:24.005 GMT [153354] LOG:  database system is shut down
2023-01-19 21:09:25.091 GMT [154064] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:09:25.091 GMT [154064] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:09:25.093 GMT [154064] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:09:25.098 GMT [154065] LOG:  database system was shut down at 2023-01-19 21:09:24 GMT
2023-01-19 21:09:25.106 GMT [154064] LOG:  database system is ready to accept connections
2023-01-19 21:10:22.430 GMT [154064] LOG:  received fast shutdown request
2023-01-19 21:10:22.432 GMT [154064] LOG:  aborting any active transactions
2023-01-19 21:10:22.439 GMT [154064] LOG:  background worker "logical replication launcher" (PID 154071) exited with exit code 1
2023-01-19 21:10:22.439 GMT [154066] LOG:  shutting down
2023-01-19 21:10:22.493 GMT [154064] LOG:  database system is shut down
2023-01-19 21:10:23.525 GMT [156074] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:10:23.526 GMT [156074] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:10:23.527 GMT [156074] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:10:23.532 GMT [156075] LOG:  database system was shut down at 2023-01-19 21:10:23 GMT
2023-01-19 21:10:23.539 GMT [156074] LOG:  database system is ready to accept connections
2023-01-19 21:10:24.644 GMT [156103] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:10:24.644 GMT [156103] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:10:24.644 GMT [156103] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL expression "EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 9 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-19 21:10:24.644 GMT [156103] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-19 21:10:24.651 GMT [156103] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:10:24.651 GMT [156103] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:10:24.651 GMT [156103] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL statement "SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-19 21:10:24.651 GMT [156103] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-19 21:11:29.846 GMT [156074] LOG:  received fast shutdown request
2023-01-19 21:11:29.848 GMT [156074] LOG:  aborting any active transactions
2023-01-19 21:11:29.854 GMT [156074] LOG:  background worker "logical replication launcher" (PID 156081) exited with exit code 1
2023-01-19 21:11:29.855 GMT [156076] LOG:  shutting down
2023-01-19 21:11:29.902 GMT [156074] LOG:  database system is shut down
2023-01-19 21:11:31.034 GMT [158364] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:11:31.034 GMT [158364] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:11:31.036 GMT [158364] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:11:31.042 GMT [158365] LOG:  database system was shut down at 2023-01-19 21:11:30 GMT
2023-01-19 21:11:31.049 GMT [158364] LOG:  database system is ready to accept connections
2023-01-19 21:11:32.286 GMT [158393] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:11:32.286 GMT [158393] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:11:32.286 GMT [158393] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL expression "EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 9 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-19 21:11:32.286 GMT [158393] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-19 21:11:32.299 GMT [158393] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:11:32.299 GMT [158393] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:11:32.299 GMT [158393] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL statement "SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-19 21:11:32.299 GMT [158393] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-19 21:11:32.309 GMT [158393] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:11:32.309 GMT [158393] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:11:32.309 GMT [158393] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
2023-01-19 21:11:32.309 GMT [158393] STATEMENT:  SELECT * FROM client.accounts;
2023-01-19 21:13:44.486 GMT [158364] LOG:  received fast shutdown request
2023-01-19 21:13:44.488 GMT [158364] LOG:  aborting any active transactions
2023-01-19 21:13:44.494 GMT [158364] LOG:  background worker "logical replication launcher" (PID 158371) exited with exit code 1
2023-01-19 21:13:44.494 GMT [158366] LOG:  shutting down
2023-01-19 21:13:44.544 GMT [158364] LOG:  database system is shut down
2023-01-19 21:13:45.684 GMT [162872] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:13:45.684 GMT [162872] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:13:45.685 GMT [162872] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:13:45.689 GMT [162873] LOG:  database system was shut down at 2023-01-19 21:13:45 GMT
2023-01-19 21:13:45.695 GMT [162872] LOG:  database system is ready to accept connections
2023-01-19 21:13:46.884 GMT [162898] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:13:46.884 GMT [162898] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:13:46.884 GMT [162898] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL expression "EXISTS (SELECT * FROM client.savings_accounts WHERE account_id = account_identifier AND account_number = orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,integer,numeric,integer,boolean) line 9 at CASE
	SQL statement "SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)"
	PL/pgSQL function initiate_transfer(integer,integer,numeric,integer,integer) line 8 at SQL statement
2023-01-19 21:13:46.884 GMT [162898] STATEMENT:  SELECT * FROM client.initiate_transfer(1, 10000001, 100.00, 10000000, 123456);
2023-01-19 21:13:46.891 GMT [162898] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:13:46.891 GMT [162898] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:13:46.891 GMT [162898] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
	SQL statement "SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-19 21:13:46.891 GMT [162898] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-19 21:13:46.906 GMT [162898] ERROR:  column reference "id" is ambiguous at character 8
2023-01-19 21:13:46.906 GMT [162898] QUERY:  SELECT id                                FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname
2023-01-19 21:13:46.906 GMT [162898] CONTEXT:  PL/pgSQL function policy_online_account_client_check(text) line 5 at SQL statement
2023-01-19 21:13:46.906 GMT [162898] STATEMENT:  SELECT * FROM client.accounts;
2023-01-19 21:15:28.144 GMT [162872] LOG:  received fast shutdown request
2023-01-19 21:15:28.146 GMT [162872] LOG:  aborting any active transactions
2023-01-19 21:15:28.148 GMT [162872] LOG:  background worker "logical replication launcher" (PID 162879) exited with exit code 1
2023-01-19 21:15:28.153 GMT [162874] LOG:  shutting down
2023-01-19 21:15:28.197 GMT [162872] LOG:  database system is shut down
2023-01-19 21:15:29.338 GMT [166366] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:15:29.338 GMT [166366] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:15:29.340 GMT [166366] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:15:29.347 GMT [166367] LOG:  database system was shut down at 2023-01-19 21:15:29 GMT
2023-01-19 21:15:29.355 GMT [166366] LOG:  database system is ready to accept connections
2023-01-19 21:17:35.897 GMT [166366] LOG:  received fast shutdown request
2023-01-19 21:17:35.899 GMT [166366] LOG:  aborting any active transactions
2023-01-19 21:17:35.905 GMT [166366] LOG:  background worker "logical replication launcher" (PID 166373) exited with exit code 1
2023-01-19 21:17:35.905 GMT [166368] LOG:  shutting down
2023-01-19 21:17:35.956 GMT [166366] LOG:  database system is shut down
2023-01-19 21:17:37.260 GMT [170643] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:17:37.261 GMT [170643] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:17:37.262 GMT [170643] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:17:37.266 GMT [170644] LOG:  database system was shut down at 2023-01-19 21:17:36 GMT
2023-01-19 21:17:37.271 GMT [170643] LOG:  database system is ready to accept connections
2023-01-19 21:19:37.756 GMT [170643] LOG:  received fast shutdown request
2023-01-19 21:19:37.757 GMT [170643] LOG:  aborting any active transactions
2023-01-19 21:19:37.762 GMT [170643] LOG:  background worker "logical replication launcher" (PID 170650) exited with exit code 1
2023-01-19 21:19:37.762 GMT [170645] LOG:  shutting down
2023-01-19 21:19:37.811 GMT [170643] LOG:  database system is shut down
2023-01-19 21:19:39.037 GMT [174711] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:19:39.037 GMT [174711] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:19:39.039 GMT [174711] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:19:39.043 GMT [174712] LOG:  database system was shut down at 2023-01-19 21:19:38 GMT
2023-01-19 21:19:39.047 GMT [174711] LOG:  database system is ready to accept connections
2023-01-19 21:20:55.669 GMT [174711] LOG:  received fast shutdown request
2023-01-19 21:20:55.671 GMT [174711] LOG:  aborting any active transactions
2023-01-19 21:20:55.677 GMT [174711] LOG:  background worker "logical replication launcher" (PID 174718) exited with exit code 1
2023-01-19 21:20:55.677 GMT [174713] LOG:  shutting down
2023-01-19 21:20:55.726 GMT [174711] LOG:  database system is shut down
2023-01-19 21:20:56.925 GMT [177295] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:20:56.926 GMT [177295] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:20:56.927 GMT [177295] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:20:56.933 GMT [177296] LOG:  database system was shut down at 2023-01-19 21:20:56 GMT
2023-01-19 21:20:56.938 GMT [177295] LOG:  database system is ready to accept connections
2023-01-19 21:21:17.989 GMT [177295] LOG:  received fast shutdown request
2023-01-19 21:21:17.991 GMT [177295] LOG:  aborting any active transactions
2023-01-19 21:21:17.997 GMT [177295] LOG:  background worker "logical replication launcher" (PID 177302) exited with exit code 1
2023-01-19 21:21:17.997 GMT [177297] LOG:  shutting down
2023-01-19 21:21:18.051 GMT [177295] LOG:  database system is shut down
2023-01-19 21:21:19.496 GMT [178162] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:21:19.496 GMT [178162] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:21:19.498 GMT [178162] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:21:19.502 GMT [178163] LOG:  database system was shut down at 2023-01-19 21:21:19 GMT
2023-01-19 21:21:19.510 GMT [178162] LOG:  database system is ready to accept connections
2023-01-19 21:22:12.336 GMT [178162] LOG:  received fast shutdown request
2023-01-19 21:22:12.338 GMT [178162] LOG:  aborting any active transactions
2023-01-19 21:22:12.343 GMT [178162] LOG:  background worker "logical replication launcher" (PID 178169) exited with exit code 1
2023-01-19 21:22:12.343 GMT [178164] LOG:  shutting down
2023-01-19 21:22:12.399 GMT [178162] LOG:  database system is shut down
2023-01-19 21:22:13.572 GMT [180025] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:22:13.573 GMT [180025] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:22:13.575 GMT [180025] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:22:13.581 GMT [180026] LOG:  database system was shut down at 2023-01-19 21:22:13 GMT
2023-01-19 21:22:13.590 GMT [180025] LOG:  database system is ready to accept connections
2023-01-19 21:24:37.788 GMT [180025] LOG:  received fast shutdown request
2023-01-19 21:24:37.792 GMT [180025] LOG:  aborting any active transactions
2023-01-19 21:24:37.795 GMT [180025] LOG:  background worker "logical replication launcher" (PID 180032) exited with exit code 1
2023-01-19 21:24:37.796 GMT [180027] LOG:  shutting down
2023-01-19 21:24:37.844 GMT [180025] LOG:  database system is shut down
2023-01-19 21:24:39.093 GMT [184889] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:24:39.093 GMT [184889] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:24:39.095 GMT [184889] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:24:39.100 GMT [184890] LOG:  database system was shut down at 2023-01-19 21:24:38 GMT
2023-01-19 21:24:39.105 GMT [184889] LOG:  database system is ready to accept connections
2023-01-19 21:25:49.351 GMT [184889] LOG:  received fast shutdown request
2023-01-19 21:25:49.353 GMT [184889] LOG:  aborting any active transactions
2023-01-19 21:25:49.357 GMT [184889] LOG:  background worker "logical replication launcher" (PID 184896) exited with exit code 1
2023-01-19 21:25:49.357 GMT [184891] LOG:  shutting down
2023-01-19 21:25:49.406 GMT [184889] LOG:  database system is shut down
2023-01-19 21:25:50.550 GMT [187346] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:25:50.552 GMT [187346] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:25:50.557 GMT [187346] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:25:50.561 GMT [187347] LOG:  database system was shut down at 2023-01-19 21:25:50 GMT
2023-01-19 21:25:50.569 GMT [187346] LOG:  database system is ready to accept connections
2023-01-19 21:25:51.152 GMT [187372] ERROR:  role "l0" does not exist
2023-01-19 21:25:51.152 GMT [187372] STATEMENT:  GRANT l0 TO postgres;
2023-01-19 21:31:49.807 GMT [187346] LOG:  received fast shutdown request
2023-01-19 21:31:49.809 GMT [187346] LOG:  aborting any active transactions
2023-01-19 21:31:49.815 GMT [187346] LOG:  background worker "logical replication launcher" (PID 187353) exited with exit code 1
2023-01-19 21:31:49.816 GMT [187348] LOG:  shutting down
2023-01-19 21:31:49.831 GMT [187346] LOG:  database system is shut down
2023-01-19 21:31:51.144 GMT [199208] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:31:51.145 GMT [199208] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:31:51.146 GMT [199208] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:31:51.152 GMT [199209] LOG:  database system was shut down at 2023-01-19 21:31:50 GMT
2023-01-19 21:31:51.159 GMT [199208] LOG:  database system is ready to accept connections
2023-01-19 21:32:53.304 GMT [199208] LOG:  received fast shutdown request
2023-01-19 21:32:53.306 GMT [199208] LOG:  aborting any active transactions
2023-01-19 21:32:53.311 GMT [199208] LOG:  background worker "logical replication launcher" (PID 199215) exited with exit code 1
2023-01-19 21:32:53.311 GMT [199210] LOG:  shutting down
2023-01-19 21:32:53.363 GMT [199208] LOG:  database system is shut down
2023-01-19 21:32:54.425 GMT [201369] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:32:54.425 GMT [201369] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:32:54.426 GMT [201369] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:32:54.431 GMT [201370] LOG:  database system was shut down at 2023-01-19 21:32:54 GMT
2023-01-19 21:32:54.436 GMT [201369] LOG:  database system is ready to accept connections
2023-01-19 21:32:55.619 GMT [201395] ERROR:  permission denied for schema staff at character 15
2023-01-19 21:32:55.619 GMT [201395] STATEMENT:  SELECT * FROM staff.accounts;
2023-01-19 21:37:47.873 GMT [201369] LOG:  received fast shutdown request
2023-01-19 21:37:47.875 GMT [201369] LOG:  aborting any active transactions
2023-01-19 21:37:47.877 GMT [201369] LOG:  background worker "logical replication launcher" (PID 201376) exited with exit code 1
2023-01-19 21:37:47.882 GMT [201371] LOG:  shutting down
2023-01-19 21:37:47.932 GMT [201369] LOG:  database system is shut down
2023-01-19 21:37:49.135 GMT [211052] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:37:49.136 GMT [211052] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:37:49.137 GMT [211052] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:37:49.141 GMT [211053] LOG:  database system was shut down at 2023-01-19 21:37:48 GMT
2023-01-19 21:37:49.146 GMT [211052] LOG:  database system is ready to accept connections
2023-01-19 21:37:49.907 GMT [211078] ERROR:  syntax error at or near "FROM" at character 163
2023-01-19 21:37:49.907 GMT [211078] STATEMENT:  CREATE OR REPLACE FUNCTION policy_account_client_check(user_fullname TEXT)
	RETURNS INT AS $$
	DECLARE
	    allowed_account_id INT;
	BEGIN
	    SELECT account_id INTO FROM online_account
	    INNER JOIN user_login ON online_account.id = user_login.account_id
	    WHERE user_login.username = user_fullname;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-19 21:37:49.910 GMT [211078] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:37:49.910 GMT [211078] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:37:49.910 GMT [211078] STATEMENT:  CREATE POLICY policy_account_client ON account
	    FOR SELECT TO user_banking_protection USING (account_id = policy_account_client_check(current_user));
2023-01-19 21:37:49.913 GMT [211078] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:37:49.913 GMT [211078] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:37:49.913 GMT [211078] STATEMENT:  CREATE POLICY policy_savings_account_client ON savings_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:37:49.913 GMT [211078] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:37:49.913 GMT [211078] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:37:49.913 GMT [211078] STATEMENT:  CREATE POLICY policy_credit_account_client ON credit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:37:49.914 GMT [211078] ERROR:  function policy_account_client_check(name) does not exist
2023-01-19 21:37:49.914 GMT [211078] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-19 21:37:49.914 GMT [211078] STATEMENT:  CREATE POLICY policy_debit_account_client ON debit_account
	    FOR SELECT TO user_banking_protection USING (account_number = policy_account_client_check(current_user));
2023-01-19 21:38:18.257 GMT [211052] LOG:  received fast shutdown request
2023-01-19 21:38:18.259 GMT [211052] LOG:  aborting any active transactions
2023-01-19 21:38:18.267 GMT [211052] LOG:  background worker "logical replication launcher" (PID 211059) exited with exit code 1
2023-01-19 21:38:18.267 GMT [211054] LOG:  shutting down
2023-01-19 21:38:18.338 GMT [211052] LOG:  database system is shut down
2023-01-19 21:38:19.575 GMT [212110] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:38:19.576 GMT [212110] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:38:19.577 GMT [212110] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:38:19.584 GMT [212111] LOG:  database system was shut down at 2023-01-19 21:38:19 GMT
2023-01-19 21:38:19.590 GMT [212110] LOG:  database system is ready to accept connections
2023-01-19 21:38:20.905 GMT [212136] ERROR:  control reached end of function without RETURN
2023-01-19 21:38:20.905 GMT [212136] CONTEXT:  PL/pgSQL function policy_account_client_check(text)
2023-01-19 21:38:20.905 GMT [212136] STATEMENT:  SELECT * FROM client.accounts;
2023-01-19 21:38:20.907 GMT [212136] ERROR:  control reached end of function without RETURN
2023-01-19 21:38:20.907 GMT [212136] CONTEXT:  PL/pgSQL function policy_account_client_check(text)
2023-01-19 21:38:20.907 GMT [212136] STATEMENT:  SELECT * FROM client.savings_accounts_statement;
2023-01-19 21:38:20.912 GMT [212136] ERROR:  control reached end of function without RETURN
2023-01-19 21:38:20.912 GMT [212136] CONTEXT:  PL/pgSQL function policy_account_client_check(text)
	SQL statement "SELECT client.accounts.*, COALESCE(debit_accounts.current_balance, credit_accounts.outstanding_balance, savings_accounts.current_balance) AS balance,
	            COALESCE(debit_accounts.interest_rate, credit_accounts.interest_rate, savings_accounts.interest_rate) AS interest_rate,
	            get_account_type(accounts.account_number) AS account_type
	            FROM client.accounts
	            LEFT JOIN client.credit_accounts ON accounts.account_number = credit_accounts.account_number
	            LEFT JOIN client.debit_accounts ON accounts.account_number = debit_accounts.account_number
	            LEFT JOIN client.savings_accounts ON accounts.account_number = savings_accounts.account_number
	            WHERE accounts.account_id = account_identifier"
	PL/pgSQL function view_accounts(integer) line 5 at RETURN QUERY
2023-01-19 21:38:20.912 GMT [212136] STATEMENT:  SELECT * FROM client.view_accounts(1);
2023-01-19 21:38:20.913 GMT [212136] ERROR:  control reached end of function without RETURN
2023-01-19 21:38:20.913 GMT [212136] CONTEXT:  PL/pgSQL function policy_account_client_check(text)
2023-01-19 21:38:20.913 GMT [212136] STATEMENT:  SELECT * FROM client.debit_accounts;
2023-01-19 21:38:20.915 GMT [212136] ERROR:  control reached end of function without RETURN
2023-01-19 21:38:20.915 GMT [212136] CONTEXT:  PL/pgSQL function policy_account_client_check(text)
2023-01-19 21:38:20.915 GMT [212136] STATEMENT:  SELECT * FROM client.credit_accounts;
2023-01-19 21:38:35.481 GMT [212110] LOG:  received fast shutdown request
2023-01-19 21:38:35.483 GMT [212110] LOG:  aborting any active transactions
2023-01-19 21:38:35.487 GMT [212110] LOG:  background worker "logical replication launcher" (PID 212117) exited with exit code 1
2023-01-19 21:38:35.487 GMT [212112] LOG:  shutting down
2023-01-19 21:38:35.541 GMT [212110] LOG:  database system is shut down
2023-01-19 21:38:36.742 GMT [212770] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:38:36.742 GMT [212770] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:38:36.745 GMT [212770] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:38:36.750 GMT [212785] LOG:  database system was shut down at 2023-01-19 21:38:36 GMT
2023-01-19 21:38:36.757 GMT [212770] LOG:  database system is ready to accept connections
2023-01-19 21:39:26.671 GMT [212770] LOG:  received fast shutdown request
2023-01-19 21:39:26.673 GMT [212770] LOG:  aborting any active transactions
2023-01-19 21:39:26.676 GMT [212770] LOG:  background worker "logical replication launcher" (PID 212793) exited with exit code 1
2023-01-19 21:39:26.677 GMT [212788] LOG:  shutting down
2023-01-19 21:39:26.729 GMT [212770] LOG:  database system is shut down
2023-01-19 21:39:27.909 GMT [214534] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:39:27.909 GMT [214534] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:39:27.910 GMT [214534] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:39:27.915 GMT [214535] LOG:  database system was shut down at 2023-01-19 21:39:27 GMT
2023-01-19 21:39:27.921 GMT [214534] LOG:  database system is ready to accept connections
2023-01-19 21:39:59.801 GMT [214534] LOG:  received fast shutdown request
2023-01-19 21:39:59.803 GMT [214534] LOG:  aborting any active transactions
2023-01-19 21:39:59.807 GMT [214534] LOG:  background worker "logical replication launcher" (PID 214541) exited with exit code 1
2023-01-19 21:39:59.808 GMT [214536] LOG:  shutting down
2023-01-19 21:39:59.858 GMT [214534] LOG:  database system is shut down
2023-01-19 21:40:00.996 GMT [215730] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:40:00.997 GMT [215730] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:40:00.998 GMT [215730] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:40:01.003 GMT [215734] LOG:  database system was shut down at 2023-01-19 21:40:00 GMT
2023-01-19 21:40:01.015 GMT [215730] LOG:  database system is ready to accept connections
2023-01-19 21:40:47.715 GMT [215730] LOG:  received fast shutdown request
2023-01-19 21:40:47.717 GMT [215730] LOG:  aborting any active transactions
2023-01-19 21:40:47.720 GMT [215730] LOG:  background worker "logical replication launcher" (PID 215740) exited with exit code 1
2023-01-19 21:40:47.722 GMT [215735] LOG:  shutting down
2023-01-19 21:40:47.772 GMT [215730] LOG:  database system is shut down
2023-01-19 21:40:49.000 GMT [217384] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:40:49.001 GMT [217384] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:40:49.007 GMT [217384] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:40:49.013 GMT [217385] LOG:  database system was shut down at 2023-01-19 21:40:48 GMT
2023-01-19 21:40:49.021 GMT [217384] LOG:  database system is ready to accept connections
2023-01-19 21:41:05.770 GMT [217384] LOG:  received fast shutdown request
2023-01-19 21:41:05.771 GMT [217384] LOG:  aborting any active transactions
2023-01-19 21:41:05.776 GMT [217384] LOG:  background worker "logical replication launcher" (PID 217391) exited with exit code 1
2023-01-19 21:41:05.776 GMT [217386] LOG:  shutting down
2023-01-19 21:41:05.833 GMT [217384] LOG:  database system is shut down
2023-01-19 21:41:07.034 GMT [218081] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:41:07.034 GMT [218081] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:41:07.035 GMT [218081] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:41:07.041 GMT [218082] LOG:  database system was shut down at 2023-01-19 21:41:06 GMT
2023-01-19 21:41:07.047 GMT [218081] LOG:  database system is ready to accept connections
2023-01-19 21:42:10.724 GMT [218081] LOG:  received fast shutdown request
2023-01-19 21:42:10.726 GMT [218081] LOG:  aborting any active transactions
2023-01-19 21:42:10.729 GMT [218081] LOG:  background worker "logical replication launcher" (PID 218088) exited with exit code 1
2023-01-19 21:42:10.731 GMT [218083] LOG:  shutting down
2023-01-19 21:42:10.795 GMT [218081] LOG:  database system is shut down
2023-01-19 21:42:11.887 GMT [220349] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:42:11.888 GMT [220349] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:42:11.889 GMT [220349] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:42:11.895 GMT [220350] LOG:  database system was shut down at 2023-01-19 21:42:11 GMT
2023-01-19 21:42:11.901 GMT [220349] LOG:  database system is ready to accept connections
2023-01-19 21:42:50.497 GMT [220349] LOG:  received fast shutdown request
2023-01-19 21:42:50.499 GMT [220349] LOG:  aborting any active transactions
2023-01-19 21:42:50.503 GMT [220349] LOG:  background worker "logical replication launcher" (PID 220356) exited with exit code 1
2023-01-19 21:42:50.503 GMT [220351] LOG:  shutting down
2023-01-19 21:42:50.555 GMT [220349] LOG:  database system is shut down
2023-01-19 21:42:51.617 GMT [221713] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:42:51.618 GMT [221713] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:42:51.619 GMT [221713] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:42:51.625 GMT [221714] LOG:  database system was shut down at 2023-01-19 21:42:51 GMT
2023-01-19 21:42:51.631 GMT [221713] LOG:  database system is ready to accept connections
2023-01-19 21:43:45.320 GMT [221713] LOG:  received fast shutdown request
2023-01-19 21:43:45.322 GMT [221713] LOG:  aborting any active transactions
2023-01-19 21:43:45.327 GMT [221713] LOG:  background worker "logical replication launcher" (PID 221720) exited with exit code 1
2023-01-19 21:43:45.327 GMT [221715] LOG:  shutting down
2023-01-19 21:43:45.379 GMT [221713] LOG:  database system is shut down
2023-01-19 21:43:46.438 GMT [223629] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:43:46.438 GMT [223629] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:43:46.440 GMT [223629] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:43:46.445 GMT [223630] LOG:  database system was shut down at 2023-01-19 21:43:46 GMT
2023-01-19 21:43:46.451 GMT [223629] LOG:  database system is ready to accept connections
2023-01-19 21:44:37.996 GMT [223629] LOG:  received fast shutdown request
2023-01-19 21:44:37.997 GMT [223629] LOG:  aborting any active transactions
2023-01-19 21:44:38.002 GMT [223629] LOG:  background worker "logical replication launcher" (PID 223636) exited with exit code 1
2023-01-19 21:44:38.002 GMT [223631] LOG:  shutting down
2023-01-19 21:44:38.053 GMT [223629] LOG:  database system is shut down
2023-01-19 21:44:39.125 GMT [225412] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:44:39.125 GMT [225412] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:44:39.126 GMT [225412] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:44:39.137 GMT [225413] LOG:  database system was shut down at 2023-01-19 21:44:38 GMT
2023-01-19 21:44:39.149 GMT [225412] LOG:  database system is ready to accept connections
2023-01-19 21:44:52.515 GMT [225412] LOG:  received fast shutdown request
2023-01-19 21:44:52.516 GMT [225412] LOG:  aborting any active transactions
2023-01-19 21:44:52.520 GMT [225412] LOG:  background worker "logical replication launcher" (PID 225419) exited with exit code 1
2023-01-19 21:44:52.522 GMT [225414] LOG:  shutting down
2023-01-19 21:44:52.577 GMT [225412] LOG:  database system is shut down
2023-01-19 21:44:53.733 GMT [225990] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:44:53.744 GMT [225990] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:44:53.747 GMT [225990] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:44:53.754 GMT [226002] LOG:  database system was shut down at 2023-01-19 21:44:53 GMT
2023-01-19 21:44:53.771 GMT [225990] LOG:  database system is ready to accept connections
2023-01-19 21:45:16.682 GMT [225990] LOG:  received fast shutdown request
2023-01-19 21:45:16.683 GMT [225990] LOG:  aborting any active transactions
2023-01-19 21:45:16.690 GMT [225990] LOG:  background worker "logical replication launcher" (PID 226013) exited with exit code 1
2023-01-19 21:45:16.690 GMT [226007] LOG:  shutting down
2023-01-19 21:45:16.746 GMT [225990] LOG:  database system is shut down
2023-01-19 21:45:18.015 GMT [226880] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-19 21:45:18.015 GMT [226880] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-19 21:45:18.022 GMT [226880] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-19 21:45:18.027 GMT [226881] LOG:  database system was shut down at 2023-01-19 21:45:17 GMT
2023-01-19 21:45:18.032 GMT [226880] LOG:  database system is ready to accept connections
2023-01-20 12:03:42.253 GMT [87596] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 12:03:42.255 GMT [87596] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 12:03:42.257 GMT [87596] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 12:03:42.263 GMT [87599] LOG:  database system was shut down at 2023-01-20 12:03:42 GMT
2023-01-20 12:03:42.270 GMT [87596] LOG:  database system is ready to accept connections
2023-01-20 13:35:29.535 GMT [87596] LOG:  received fast shutdown request
2023-01-20 13:35:29.537 GMT [87596] LOG:  aborting any active transactions
2023-01-20 13:35:29.541 GMT [87596] LOG:  background worker "logical replication launcher" (PID 87605) exited with exit code 1
2023-01-20 13:35:29.544 GMT [87600] LOG:  shutting down
2023-01-20 13:35:29.563 GMT [87596] LOG:  database system is shut down
2023-01-20 13:35:38.220 GMT [203792] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:35:38.220 GMT [203792] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:35:38.222 GMT [203792] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:35:38.229 GMT [203793] LOG:  database system was shut down at 2023-01-20 13:35:37 GMT
2023-01-20 13:35:38.238 GMT [203792] LOG:  database system is ready to accept connections
2023-01-20 13:37:07.732 GMT [203792] LOG:  received fast shutdown request
2023-01-20 13:37:07.735 GMT [203792] LOG:  aborting any active transactions
2023-01-20 13:37:07.742 GMT [203792] LOG:  background worker "logical replication launcher" (PID 203799) exited with exit code 1
2023-01-20 13:37:07.743 GMT [203794] LOG:  shutting down
2023-01-20 13:37:07.821 GMT [203792] LOG:  database system is shut down
2023-01-20 13:37:11.303 GMT [207037] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:37:11.303 GMT [207037] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:37:11.305 GMT [207037] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:37:11.311 GMT [207038] LOG:  database system was shut down at 2023-01-20 13:37:07 GMT
2023-01-20 13:37:11.318 GMT [207037] LOG:  database system is ready to accept connections
2023-01-20 13:37:15.442 GMT [207214] FATAL:  password authentication failed for user "parallels"
2023-01-20 13:37:15.442 GMT [207214] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:37:15.443 GMT [207214] LOG:  could not send data to client: Broken pipe
2023-01-20 13:37:16.972 GMT [207292] FATAL:  password authentication failed for user "parallels"
2023-01-20 13:37:16.972 GMT [207292] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:37:16.972 GMT [207292] LOG:  could not send data to client: Broken pipe
2023-01-20 13:38:03.235 GMT [208803] FATAL:  password authentication failed for user "joebloggs"
2023-01-20 13:38:03.235 GMT [208803] DETAIL:  Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:40:45.173 GMT [214156] FATAL:  password authentication failed for user "johnsmith"
2023-01-20 13:40:45.173 GMT [214156] DETAIL:  Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:42:03.269 GMT [216679] FATAL:  password authentication failed for user "parallels"
2023-01-20 13:42:03.269 GMT [216679] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:42:03.269 GMT [216679] LOG:  could not send data to client: Broken pipe
2023-01-20 13:42:09.845 GMT [216912] FATAL:  password authentication failed for user "postgres"
2023-01-20 13:42:09.845 GMT [216912] DETAIL:  User "postgres" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:42:09.845 GMT [216912] LOG:  could not send data to client: Broken pipe
2023-01-20 13:42:12.072 GMT [217005] FATAL:  password authentication failed for user "postgres"
2023-01-20 13:42:12.072 GMT [217005] DETAIL:  User "postgres" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-20 13:43:43.859 GMT [207037] LOG:  received fast shutdown request
2023-01-20 13:43:43.863 GMT [207037] LOG:  aborting any active transactions
2023-01-20 13:43:43.871 GMT [207037] LOG:  background worker "logical replication launcher" (PID 207044) exited with exit code 1
2023-01-20 13:43:43.871 GMT [207039] LOG:  shutting down
2023-01-20 13:43:43.896 GMT [207037] LOG:  database system is shut down
2023-01-20 13:43:46.901 GMT [220203] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:43:46.901 GMT [220203] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:43:46.903 GMT [220203] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:43:46.908 GMT [220204] LOG:  database system was shut down at 2023-01-20 13:43:43 GMT
2023-01-20 13:43:46.916 GMT [220203] LOG:  database system is ready to accept connections
2023-01-20 13:44:24.549 GMT [221524] LOG:  provided user name (postgres) and authenticated user name (parallels) do not match
2023-01-20 13:44:24.549 GMT [221524] FATAL:  Peer authentication failed for user "postgres"
2023-01-20 13:44:24.549 GMT [221524] DETAIL:  Connection matched pg_hba.conf line 89: "local   all             postgres                                peer"
2023-01-20 13:44:29.512 GMT [221718] FATAL:  password authentication failed for user "postgres"
2023-01-20 13:44:29.512 GMT [221718] DETAIL:  User "postgres" has no password assigned.
	Connection matched pg_hba.conf line 92: "host    all             all             127.0.0.1/32            md5"
2023-01-20 13:45:06.984 GMT [220203] LOG:  received fast shutdown request
2023-01-20 13:45:06.986 GMT [220203] LOG:  aborting any active transactions
2023-01-20 13:45:06.992 GMT [220203] LOG:  background worker "logical replication launcher" (PID 220210) exited with exit code 1
2023-01-20 13:45:06.994 GMT [220205] LOG:  shutting down
2023-01-20 13:45:07.015 GMT [220203] LOG:  database system is shut down
2023-01-20 13:45:10.938 GMT [223124] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:45:10.938 GMT [223124] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:45:10.940 GMT [223124] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:45:10.945 GMT [223125] LOG:  database system was shut down at 2023-01-20 13:45:06 GMT
2023-01-20 13:45:10.952 GMT [223124] LOG:  database system is ready to accept connections
2023-01-20 13:46:05.077 GMT [225050] FATAL:  password authentication failed for user "johnsmith"
2023-01-20 13:46:05.077 GMT [225050] DETAIL:  Connection matched pg_hba.conf line 90: "local   all             all                                     md5"
2023-01-20 13:46:23.896 GMT [225760] FATAL:  password authentication failed for user "johnsmith"
2023-01-20 13:46:23.896 GMT [225760] DETAIL:  Connection matched pg_hba.conf line 90: "local   all             all                                     md5"
2023-01-20 13:46:49.743 GMT [223124] LOG:  received fast shutdown request
2023-01-20 13:46:49.745 GMT [223124] LOG:  aborting any active transactions
2023-01-20 13:46:49.752 GMT [223124] LOG:  background worker "logical replication launcher" (PID 223131) exited with exit code 1
2023-01-20 13:46:49.753 GMT [223126] LOG:  shutting down
2023-01-20 13:46:49.774 GMT [223124] LOG:  database system is shut down
2023-01-20 13:46:51.168 GMT [226674] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:46:51.168 GMT [226674] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:46:51.170 GMT [226674] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:46:51.175 GMT [226675] LOG:  database system was shut down at 2023-01-20 13:46:50 GMT
2023-01-20 13:46:51.181 GMT [226674] LOG:  database system is ready to accept connections
2023-01-20 13:47:50.901 GMT [226674] LOG:  received fast shutdown request
2023-01-20 13:47:50.903 GMT [226674] LOG:  aborting any active transactions
2023-01-20 13:47:50.905 GMT [226674] LOG:  background worker "logical replication launcher" (PID 226681) exited with exit code 1
2023-01-20 13:47:50.910 GMT [226676] LOG:  shutting down
2023-01-20 13:47:50.977 GMT [226674] LOG:  database system is shut down
2023-01-20 13:47:53.339 GMT [228769] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 13:47:53.339 GMT [228769] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 13:47:53.341 GMT [228769] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 13:47:53.347 GMT [228781] LOG:  database system was shut down at 2023-01-20 13:47:50 GMT
2023-01-20 13:47:53.355 GMT [228769] LOG:  database system is ready to accept connections
2023-01-20 13:48:14.632 GMT [229492] FATAL:  password authentication failed for user "parallels"
2023-01-20 13:48:14.632 GMT [229492] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 90: "local   all             all                                     md5"
2023-01-20 13:48:14.632 GMT [229492] LOG:  could not send data to client: Broken pipe
2023-01-20 13:48:40.558 GMT [230443] FATAL:  password authentication failed for user "johnsmith"
2023-01-20 13:48:40.558 GMT [230443] DETAIL:  Connection matched pg_hba.conf line 90: "local   all             all                                     md5"
2023-01-20 13:49:05.367 GMT [231286] FATAL:  password authentication failed for user "parallels"
2023-01-20 13:49:05.367 GMT [231286] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 90: "local   all             all                                     md5"
2023-01-20 13:49:05.367 GMT [231286] LOG:  could not send data to client: Broken pipe
2023-01-20 14:14:31.909 GMT [228769] LOG:  received fast shutdown request
2023-01-20 14:14:31.911 GMT [228769] LOG:  aborting any active transactions
2023-01-20 14:14:31.915 GMT [228769] LOG:  background worker "logical replication launcher" (PID 228795) exited with exit code 1
2023-01-20 14:14:31.920 GMT [228790] LOG:  shutting down
2023-01-20 14:14:31.937 GMT [228769] LOG:  database system is shut down
2023-01-20 14:14:36.248 GMT [281186] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:14:36.248 GMT [281186] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:14:36.250 GMT [281186] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:14:36.255 GMT [281196] LOG:  database system was shut down at 2023-01-20 14:14:35 GMT
2023-01-20 14:14:36.261 GMT [281186] LOG:  database system is ready to accept connections
2023-01-20 14:15:11.643 GMT [281186] LOG:  received fast shutdown request
2023-01-20 14:15:11.645 GMT [281186] LOG:  aborting any active transactions
2023-01-20 14:15:11.649 GMT [281186] LOG:  background worker "logical replication launcher" (PID 281204) exited with exit code 1
2023-01-20 14:15:11.653 GMT [281199] LOG:  shutting down
2023-01-20 14:15:11.722 GMT [281186] LOG:  database system is shut down
2023-01-20 14:15:14.735 GMT [282594] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:15:14.735 GMT [282594] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:15:14.738 GMT [282594] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:15:14.745 GMT [282609] LOG:  database system was shut down at 2023-01-20 14:15:11 GMT
2023-01-20 14:15:14.753 GMT [282594] LOG:  database system is ready to accept connections
2023-01-20 14:32:02.660 GMT [282594] LOG:  received fast shutdown request
2023-01-20 14:32:02.662 GMT [282594] LOG:  aborting any active transactions
2023-01-20 14:32:02.666 GMT [282594] LOG:  background worker "logical replication launcher" (PID 282618) exited with exit code 1
2023-01-20 14:32:02.670 GMT [282613] LOG:  shutting down
2023-01-20 14:32:02.686 GMT [282594] LOG:  database system is shut down
2023-01-20 14:32:06.954 GMT [315453] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:32:06.954 GMT [315453] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:32:06.955 GMT [315453] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:32:06.961 GMT [315454] LOG:  database system was shut down at 2023-01-20 14:32:06 GMT
2023-01-20 14:32:06.967 GMT [315453] LOG:  database system is ready to accept connections
2023-01-20 14:51:50.834 GMT [315453] LOG:  received fast shutdown request
2023-01-20 14:51:50.836 GMT [315453] LOG:  aborting any active transactions
2023-01-20 14:51:50.840 GMT [315453] LOG:  background worker "logical replication launcher" (PID 315460) exited with exit code 1
2023-01-20 14:51:50.842 GMT [315455] LOG:  shutting down
2023-01-20 14:51:50.860 GMT [315453] LOG:  database system is shut down
2023-01-20 14:51:57.600 GMT [354263] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:51:57.600 GMT [354263] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:51:57.602 GMT [354263] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:51:57.607 GMT [354264] LOG:  database system was shut down at 2023-01-20 14:51:57 GMT
2023-01-20 14:51:57.612 GMT [354263] LOG:  database system is ready to accept connections
2023-01-20 14:52:05.631 GMT [354263] LOG:  received fast shutdown request
2023-01-20 14:52:05.633 GMT [354263] LOG:  aborting any active transactions
2023-01-20 14:52:05.639 GMT [354263] LOG:  background worker "logical replication launcher" (PID 354270) exited with exit code 1
2023-01-20 14:52:05.639 GMT [354265] LOG:  shutting down
2023-01-20 14:52:05.721 GMT [354263] LOG:  database system is shut down
2023-01-20 14:52:08.618 GMT [354761] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:52:08.618 GMT [354761] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:52:08.620 GMT [354761] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:52:08.625 GMT [354770] LOG:  database system was shut down at 2023-01-20 14:52:08 GMT
2023-01-20 14:52:08.631 GMT [354761] LOG:  database system is ready to accept connections
2023-01-20 14:52:14.631 GMT [354761] LOG:  received fast shutdown request
2023-01-20 14:52:14.633 GMT [354761] LOG:  aborting any active transactions
2023-01-20 14:52:14.638 GMT [354761] LOG:  background worker "logical replication launcher" (PID 354776) exited with exit code 1
2023-01-20 14:52:14.640 GMT [354771] LOG:  shutting down
2023-01-20 14:52:14.706 GMT [354761] LOG:  database system is shut down
2023-01-20 14:52:18.951 GMT [355259] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-20 14:52:18.951 GMT [355259] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-20 14:52:18.953 GMT [355259] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-20 14:52:18.958 GMT [355260] LOG:  database system was shut down at 2023-01-20 14:52:18 GMT
2023-01-20 14:52:18.964 GMT [355259] LOG:  database system is ready to accept connections
2023-01-20 15:06:43.849 GMT [355259] LOG:  received smart shutdown request
2023-01-20 15:06:43.932 GMT [355259] LOG:  received SIGHUP, reloading configuration files
2023-01-20 15:06:43.936 GMT [355259] LOG:  background worker "logical replication launcher" (PID 355266) exited with exit code 1
2023-01-20 15:06:44.004 GMT [355261] LOG:  shutting down
2023-01-20 15:06:44.103 GMT [355259] LOG:  database system is shut down
2023-01-21 18:37:34.965 GMT [6353] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:37:34.967 GMT [6353] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:37:34.968 GMT [6353] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:37:34.975 GMT [6354] LOG:  database system was shut down at 2023-01-21 18:37:34 GMT
2023-01-21 18:37:34.980 GMT [6353] LOG:  database system is ready to accept connections
2023-01-21 18:37:36.111 GMT [6386] ERROR:  function unauthenticated.create_personal_info(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) does not exist at character 15
2023-01-21 18:37:36.111 GMT [6386] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 18:37:36.111 GMT [6386] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('John', 'Smith', '1990-01-01', '01234567890', 'example street', 'example city', 'example county', 'EX1 1EX');
2023-01-21 18:38:39.826 GMT [6353] LOG:  received fast shutdown request
2023-01-21 18:38:39.827 GMT [6353] LOG:  aborting any active transactions
2023-01-21 18:38:39.831 GMT [6353] LOG:  background worker "logical replication launcher" (PID 6360) exited with exit code 1
2023-01-21 18:38:39.831 GMT [6355] LOG:  shutting down
2023-01-21 18:38:39.879 GMT [6353] LOG:  database system is shut down
2023-01-21 18:38:41.008 GMT [6690] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:38:41.008 GMT [6690] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:38:41.010 GMT [6690] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:38:41.014 GMT [6691] LOG:  database system was shut down at 2023-01-21 18:38:40 GMT
2023-01-21 18:38:41.021 GMT [6690] LOG:  database system is ready to accept connections
2023-01-21 18:38:42.062 GMT [6719] ERROR:  function unauthenticated.create_personal_info(text, text, date, text, text, text, text, text) does not exist at character 15
2023-01-21 18:38:42.062 GMT [6719] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 18:38:42.062 GMT [6719] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text, 'example street'::text, 'example city'::text, 'example county'::text, 'EX1 1EX'::text);
2023-01-21 18:39:52.166 GMT [6690] LOG:  received fast shutdown request
2023-01-21 18:39:52.168 GMT [6690] LOG:  aborting any active transactions
2023-01-21 18:39:52.172 GMT [6690] LOG:  background worker "logical replication launcher" (PID 6697) exited with exit code 1
2023-01-21 18:39:52.174 GMT [6692] LOG:  shutting down
2023-01-21 18:39:52.220 GMT [6690] LOG:  database system is shut down
2023-01-21 18:39:53.375 GMT [7001] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:39:53.375 GMT [7001] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:39:53.377 GMT [7001] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:39:53.381 GMT [7002] LOG:  database system was shut down at 2023-01-21 18:39:53 GMT
2023-01-21 18:39:53.389 GMT [7001] LOG:  database system is ready to accept connections
2023-01-21 18:39:54.415 GMT [7027] ERROR:  column reference "first_name" is ambiguous at character 88
2023-01-21 18:39:54.415 GMT [7027] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-21 18:39:54.415 GMT [7027] QUERY:  NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE md5(first_name) = first_naming AND md5(last_name) = last_naming AND md5(email_address) = email_addressing)
2023-01-21 18:39:54.415 GMT [7027] CONTEXT:  PL/pgSQL function create_personal_info(text,text,date,text,text,text,text,text,text) line 4 at IF
2023-01-21 18:39:54.415 GMT [7027] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text, 'example@email.com'::text, 'example street'::text, 'example city'::text, 'example county'::text, 'EX1 1EX'::text);
2023-01-21 18:43:13.054 GMT [7001] LOG:  received fast shutdown request
2023-01-21 18:43:13.055 GMT [7001] LOG:  aborting any active transactions
2023-01-21 18:43:13.060 GMT [7001] LOG:  background worker "logical replication launcher" (PID 7008) exited with exit code 1
2023-01-21 18:43:13.061 GMT [7003] LOG:  shutting down
2023-01-21 18:43:13.109 GMT [7001] LOG:  database system is shut down
2023-01-21 18:43:14.285 GMT [7776] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:43:14.285 GMT [7776] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:43:14.286 GMT [7776] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:43:14.291 GMT [7777] LOG:  database system was shut down at 2023-01-21 18:43:13 GMT
2023-01-21 18:43:14.296 GMT [7776] LOG:  database system is ready to accept connections
2023-01-21 18:43:15.131 GMT [7805] ERROR:  mismatched parentheses at or near ";" at character 737
2023-01-21 18:43:15.131 GMT [7805] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_personal_info(first_name_p TEXT, last_name_p TEXT, date_of_birth_p DATE, phone_number_p TEXT, email_address_p TEXT, address_street_p TEXT, address_city_p TEXT, address_county_p TEXT, address_postcode_p TEXT)
	RETURNS INT AS $$
	DECLARE customer_id INT;
	BEGIN
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE first_name = md5(first_name_p) AND last_name = md5(last_name_p) AND email_address = md5(email_address) THEN
	        INSERT INTO customer
	        VALUES (first_name_p, last_name_p, date_of_birth_p, phone_number_p, email_address_p, address_street_p, address_city_p, address_county_p, address_postcode_p)
	        RETURNING id INTO customer_id;
	
	        INSERT INTO management_log (log_description, log_date) VALUES ('New customer created', now());
	    ELSE
	        RAISE NOTICE 'CUSTOMER INFORMATION ALREADY PRESENT';
	        SELECT id INTO customer_id FROM unauthenticated.unauthenticated_personal_information WHERE first_name = md5(first_name_p) AND last_name = md5(last_name_p) AND email_address = md5(email_address_p);
	    END IF;
	    RETURN customer_id;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-21 18:43:15.300 GMT [7805] ERROR:  function unauthenticated.create_personal_info(text, text, date, text, text, text, text, text, text) does not exist at character 15
2023-01-21 18:43:15.300 GMT [7805] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 18:43:15.300 GMT [7805] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text, 'example@email.com'::text, 'example street'::text, 'example city'::text, 'example county'::text, 'EX1 1EX'::text);
2023-01-21 18:44:09.058 GMT [7776] LOG:  received fast shutdown request
2023-01-21 18:44:09.059 GMT [7776] LOG:  aborting any active transactions
2023-01-21 18:44:09.062 GMT [7776] LOG:  background worker "logical replication launcher" (PID 7783) exited with exit code 1
2023-01-21 18:44:09.065 GMT [7778] LOG:  shutting down
2023-01-21 18:44:09.113 GMT [7776] LOG:  database system is shut down
2023-01-21 18:44:10.221 GMT [8066] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:44:10.222 GMT [8066] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:44:10.223 GMT [8066] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:44:10.229 GMT [8067] LOG:  database system was shut down at 2023-01-21 18:44:09 GMT
2023-01-21 18:44:10.234 GMT [8066] LOG:  database system is ready to accept connections
2023-01-21 18:44:11.180 GMT [8092] ERROR:  column "id" is of type integer but expression is of type text at character 38
2023-01-21 18:44:11.180 GMT [8092] HINT:  You will need to rewrite or cast the expression.
2023-01-21 18:44:11.180 GMT [8092] QUERY:  INSERT INTO customer
	        VALUES (first_name_p, last_name_p, date_of_birth_p, phone_number_p, email_address_p, address_street_p, address_city_p, address_county_p, address_postcode_p)
	        RETURNING id
2023-01-21 18:44:11.180 GMT [8092] CONTEXT:  PL/pgSQL function create_personal_info(text,text,date,text,text,text,text,text,text) line 5 at SQL statement
2023-01-21 18:44:11.180 GMT [8092] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info('John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text, 'example@email.com'::text, 'example street'::text, 'example city'::text, 'example county'::text, 'EX1 1EX'::text);
2023-01-21 18:44:41.232 GMT [8066] LOG:  received fast shutdown request
2023-01-21 18:44:41.234 GMT [8066] LOG:  aborting any active transactions
2023-01-21 18:44:41.238 GMT [8066] LOG:  background worker "logical replication launcher" (PID 8073) exited with exit code 1
2023-01-21 18:44:41.238 GMT [8068] LOG:  shutting down
2023-01-21 18:44:41.286 GMT [8066] LOG:  database system is shut down
2023-01-21 18:44:42.352 GMT [8265] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:44:42.352 GMT [8265] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:44:42.353 GMT [8265] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:44:42.360 GMT [8266] LOG:  database system was shut down at 2023-01-21 18:44:42 GMT
2023-01-21 18:44:42.365 GMT [8265] LOG:  database system is ready to accept connections
2023-01-21 18:46:27.592 GMT [8265] LOG:  received fast shutdown request
2023-01-21 18:46:27.593 GMT [8265] LOG:  aborting any active transactions
2023-01-21 18:46:27.598 GMT [8265] LOG:  background worker "logical replication launcher" (PID 8272) exited with exit code 1
2023-01-21 18:46:27.598 GMT [8267] LOG:  shutting down
2023-01-21 18:46:27.643 GMT [8265] LOG:  database system is shut down
2023-01-21 18:46:28.723 GMT [8672] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:46:28.724 GMT [8672] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:46:28.725 GMT [8672] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:46:28.731 GMT [8673] LOG:  database system was shut down at 2023-01-21 18:46:28 GMT
2023-01-21 18:46:28.737 GMT [8672] LOG:  database system is ready to accept connections
2023-01-21 18:49:38.622 GMT [8672] LOG:  received fast shutdown request
2023-01-21 18:49:38.624 GMT [8672] LOG:  aborting any active transactions
2023-01-21 18:49:38.628 GMT [8672] LOG:  background worker "logical replication launcher" (PID 8679) exited with exit code 1
2023-01-21 18:49:38.628 GMT [8674] LOG:  shutting down
2023-01-21 18:49:38.684 GMT [8672] LOG:  database system is shut down
2023-01-21 18:49:39.876 GMT [9384] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:49:39.876 GMT [9384] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:49:39.878 GMT [9384] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:49:39.883 GMT [9385] LOG:  database system was shut down at 2023-01-21 18:49:39 GMT
2023-01-21 18:49:39.889 GMT [9384] LOG:  database system is ready to accept connections
2023-01-21 18:50:27.391 GMT [9384] LOG:  received fast shutdown request
2023-01-21 18:50:27.393 GMT [9384] LOG:  aborting any active transactions
2023-01-21 18:50:27.396 GMT [9384] LOG:  background worker "logical replication launcher" (PID 9391) exited with exit code 1
2023-01-21 18:50:27.399 GMT [9386] LOG:  shutting down
2023-01-21 18:50:27.456 GMT [9384] LOG:  database system is shut down
2023-01-21 18:50:28.495 GMT [9640] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 18:50:28.496 GMT [9640] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 18:50:28.497 GMT [9640] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 18:50:28.503 GMT [9641] LOG:  database system was shut down at 2023-01-21 18:50:28 GMT
2023-01-21 18:50:28.509 GMT [9640] LOG:  database system is ready to accept connections
2023-01-21 20:15:05.108 GMT [9640] LOG:  received fast shutdown request
2023-01-21 20:15:05.110 GMT [9640] LOG:  aborting any active transactions
2023-01-21 20:15:05.113 GMT [9640] LOG:  background worker "logical replication launcher" (PID 9647) exited with exit code 1
2023-01-21 20:15:05.115 GMT [9642] LOG:  shutting down
2023-01-21 20:15:05.132 GMT [9640] LOG:  database system is shut down
2023-01-21 20:15:11.205 GMT [23727] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:15:11.206 GMT [23727] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:15:11.207 GMT [23727] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:15:11.212 GMT [23728] LOG:  database system was shut down at 2023-01-21 20:15:10 GMT
2023-01-21 20:15:11.217 GMT [23727] LOG:  database system is ready to accept connections
2023-01-21 20:15:39.096 GMT [23727] LOG:  received fast shutdown request
2023-01-21 20:15:39.098 GMT [23727] LOG:  aborting any active transactions
2023-01-21 20:15:39.102 GMT [23727] LOG:  background worker "logical replication launcher" (PID 23734) exited with exit code 1
2023-01-21 20:15:39.103 GMT [23729] LOG:  shutting down
2023-01-21 20:15:39.147 GMT [23727] LOG:  database system is shut down
2023-01-21 20:15:40.289 GMT [23918] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:15:40.289 GMT [23918] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:15:40.290 GMT [23918] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:15:40.295 GMT [23919] LOG:  database system was shut down at 2023-01-21 20:15:40 GMT
2023-01-21 20:15:40.300 GMT [23918] LOG:  database system is ready to accept connections
2023-01-21 20:16:12.255 GMT [23918] LOG:  received fast shutdown request
2023-01-21 20:16:12.257 GMT [23918] LOG:  aborting any active transactions
2023-01-21 20:16:12.261 GMT [23918] LOG:  background worker "logical replication launcher" (PID 23925) exited with exit code 1
2023-01-21 20:16:12.264 GMT [23920] LOG:  shutting down
2023-01-21 20:16:12.325 GMT [23918] LOG:  database system is shut down
2023-01-21 20:16:13.425 GMT [24124] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:16:13.425 GMT [24124] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:16:13.427 GMT [24124] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:16:13.435 GMT [24125] LOG:  database system was shut down at 2023-01-21 20:16:13 GMT
2023-01-21 20:16:13.440 GMT [24124] LOG:  database system is ready to accept connections
2023-01-21 20:22:47.446 GMT [24124] LOG:  received fast shutdown request
2023-01-21 20:22:47.448 GMT [24124] LOG:  aborting any active transactions
2023-01-21 20:22:47.453 GMT [24124] LOG:  background worker "logical replication launcher" (PID 24131) exited with exit code 1
2023-01-21 20:22:47.453 GMT [24126] LOG:  shutting down
2023-01-21 20:22:47.469 GMT [24124] LOG:  database system is shut down
2023-01-21 20:22:48.654 GMT [25453] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:22:48.655 GMT [25453] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:22:48.657 GMT [25453] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:22:48.663 GMT [25454] LOG:  database system was shut down at 2023-01-21 20:22:48 GMT
2023-01-21 20:22:48.673 GMT [25453] LOG:  database system is ready to accept connections
2023-01-21 20:22:49.662 GMT [25482] ERROR:  syntax error at or near "@" at character 9
2023-01-21 20:22:49.662 GMT [25482] STATEMENT:  DECLARE @id INT;
2023-01-21 20:22:49.662 GMT [25482] ERROR:  syntax error at or near "RETURNING" at character 249
2023-01-21 20:22:49.662 GMT [25482] STATEMENT:  SELECT * FROM unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text) RETURNING id INTO @id;
2023-01-21 20:22:49.663 GMT [25482] ERROR:  syntax error at or near "[" at character 95
2023-01-21 20:22:49.663 GMT [25482] STATEMENT:  SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text, [1,2,3]:int[], ['Blue', 'Wraps', 'Dogs'], 'johnsmith', 'Password123');
2023-01-21 20:25:28.166 GMT [25453] LOG:  received fast shutdown request
2023-01-21 20:25:28.168 GMT [25453] LOG:  aborting any active transactions
2023-01-21 20:25:28.172 GMT [25453] LOG:  background worker "logical replication launcher" (PID 25460) exited with exit code 1
2023-01-21 20:25:28.174 GMT [25455] LOG:  shutting down
2023-01-21 20:25:28.227 GMT [25453] LOG:  database system is shut down
2023-01-21 20:25:29.347 GMT [26069] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:25:29.348 GMT [26069] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:25:29.349 GMT [26069] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:25:29.354 GMT [26070] LOG:  database system was shut down at 2023-01-21 20:25:29 GMT
2023-01-21 20:25:29.360 GMT [26069] LOG:  database system is ready to accept connections
2023-01-21 20:25:30.378 GMT [26095] ERROR:  syntax error at or near "RETURNING" at character 290
2023-01-21 20:25:30.378 GMT [26095] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    SELECT * FROM unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text) RETURNING id INTO customer_id;
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     [1,2,3]:int[], ['Blue', 'Wraps', 'Dogs'], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:26:17.718 GMT [26069] LOG:  received fast shutdown request
2023-01-21 20:26:17.719 GMT [26069] LOG:  aborting any active transactions
2023-01-21 20:26:17.727 GMT [26069] LOG:  background worker "logical replication launcher" (PID 26076) exited with exit code 1
2023-01-21 20:26:17.727 GMT [26071] LOG:  shutting down
2023-01-21 20:26:17.784 GMT [26069] LOG:  database system is shut down
2023-01-21 20:26:18.981 GMT [26327] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:26:18.981 GMT [26327] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:26:18.982 GMT [26327] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:26:18.987 GMT [26328] LOG:  database system was shut down at 2023-01-21 20:26:18 GMT
2023-01-21 20:26:18.993 GMT [26327] LOG:  database system is ready to accept connections
2023-01-21 20:26:20.221 GMT [26356] ERROR:  syntax error at or near "RETURNING" at character 290
2023-01-21 20:26:20.221 GMT [26356] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    SELECT * FROM unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text) RETURNING * INTO customer_id;
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     [1,2,3]:int[], ['Blue', 'Wraps', 'Dogs'], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:28:07.292 GMT [26327] LOG:  received fast shutdown request
2023-01-21 20:28:07.293 GMT [26327] LOG:  aborting any active transactions
2023-01-21 20:28:07.295 GMT [26327] LOG:  background worker "logical replication launcher" (PID 26334) exited with exit code 1
2023-01-21 20:28:07.299 GMT [26329] LOG:  shutting down
2023-01-21 20:28:07.343 GMT [26327] LOG:  database system is shut down
2023-01-21 20:28:08.425 GMT [26741] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:28:08.425 GMT [26741] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:28:08.426 GMT [26741] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:28:08.430 GMT [26742] LOG:  database system was shut down at 2023-01-21 20:28:08 GMT
2023-01-21 20:28:08.436 GMT [26741] LOG:  database system is ready to accept connections
2023-01-21 20:28:09.378 GMT [26770] ERROR:  syntax error at or near "[" at character 395
2023-01-21 20:28:09.378 GMT [26770] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     [1,2,3]:int[], ['Blue', 'Wraps', 'Dogs'], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:28:59.699 GMT [26741] LOG:  received fast shutdown request
2023-01-21 20:28:59.701 GMT [26741] LOG:  aborting any active transactions
2023-01-21 20:28:59.705 GMT [26741] LOG:  background worker "logical replication launcher" (PID 26748) exited with exit code 1
2023-01-21 20:28:59.708 GMT [26743] LOG:  shutting down
2023-01-21 20:28:59.761 GMT [26741] LOG:  database system is shut down
2023-01-21 20:29:00.934 GMT [27000] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:29:00.935 GMT [27000] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:29:00.936 GMT [27000] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:29:00.940 GMT [27001] LOG:  database system was shut down at 2023-01-21 20:29:00 GMT
2023-01-21 20:29:00.945 GMT [27000] LOG:  database system is ready to accept connections
2023-01-21 20:29:02.005 GMT [27026] ERROR:  syntax error at or near "{" at character 395
2023-01-21 20:29:02.005 GMT [27026] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     {1,2,3}:int[], {'Blue', 'Wraps', 'Dogs'}, 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:29:40.732 GMT [27000] LOG:  received fast shutdown request
2023-01-21 20:29:40.734 GMT [27000] LOG:  aborting any active transactions
2023-01-21 20:29:40.741 GMT [27000] LOG:  background worker "logical replication launcher" (PID 27007) exited with exit code 1
2023-01-21 20:29:40.741 GMT [27002] LOG:  shutting down
2023-01-21 20:29:40.796 GMT [27000] LOG:  database system is shut down
2023-01-21 20:29:41.888 GMT [27251] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:29:41.888 GMT [27251] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:29:41.890 GMT [27251] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:29:41.894 GMT [27252] LOG:  database system was shut down at 2023-01-21 20:29:41 GMT
2023-01-21 20:29:41.899 GMT [27251] LOG:  database system is ready to accept connections
2023-01-21 20:29:42.866 GMT [27277] ERROR:  syntax error at or near ":" at character 404
2023-01-21 20:29:42.866 GMT [27277] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     '{1,2,3}':int[], '{'Blue', 'Wraps', 'Dogs'}'::text[], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:29:51.382 GMT [27251] LOG:  received fast shutdown request
2023-01-21 20:29:51.383 GMT [27251] LOG:  aborting any active transactions
2023-01-21 20:29:51.388 GMT [27251] LOG:  background worker "logical replication launcher" (PID 27258) exited with exit code 1
2023-01-21 20:29:51.390 GMT [27253] LOG:  shutting down
2023-01-21 20:29:51.437 GMT [27251] LOG:  database system is shut down
2023-01-21 20:29:52.436 GMT [27391] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:29:52.437 GMT [27391] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:29:52.439 GMT [27391] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:29:52.444 GMT [27392] LOG:  database system was shut down at 2023-01-21 20:29:52 GMT
2023-01-21 20:29:52.449 GMT [27391] LOG:  database system is ready to accept connections
2023-01-21 20:29:53.450 GMT [27417] ERROR:  syntax error at or near "Blue" at character 416
2023-01-21 20:29:53.450 GMT [27417] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{'Blue', 'Wraps', 'Dogs'}'::text[], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:30:32.849 GMT [27391] LOG:  received fast shutdown request
2023-01-21 20:30:32.851 GMT [27391] LOG:  aborting any active transactions
2023-01-21 20:30:32.853 GMT [27391] LOG:  background worker "logical replication launcher" (PID 27398) exited with exit code 1
2023-01-21 20:30:32.856 GMT [27393] LOG:  shutting down
2023-01-21 20:30:32.903 GMT [27391] LOG:  database system is shut down
2023-01-21 20:30:33.910 GMT [27627] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:30:33.910 GMT [27627] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:30:33.912 GMT [27627] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:30:33.919 GMT [27628] LOG:  database system was shut down at 2023-01-21 20:30:33 GMT
2023-01-21 20:30:33.924 GMT [27627] LOG:  database system is ready to accept connections
2023-01-21 20:30:34.897 GMT [27653] ERROR:  column "id" does not exist at character 62
2023-01-21 20:30:34.897 GMT [27653] QUERY:  SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith', 'Password123')
2023-01-21 20:30:34.897 GMT [27653] CONTEXT:  PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:30:34.897 GMT [27653] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(@id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:31:01.146 GMT [27627] LOG:  received fast shutdown request
2023-01-21 20:31:01.148 GMT [27627] LOG:  aborting any active transactions
2023-01-21 20:31:01.152 GMT [27627] LOG:  background worker "logical replication launcher" (PID 27634) exited with exit code 1
2023-01-21 20:31:01.153 GMT [27629] LOG:  shutting down
2023-01-21 20:31:01.200 GMT [27627] LOG:  database system is shut down
2023-01-21 20:31:02.280 GMT [27812] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:31:02.280 GMT [27812] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:31:02.282 GMT [27812] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:31:02.290 GMT [27813] LOG:  database system was shut down at 2023-01-21 20:31:02 GMT
2023-01-21 20:31:02.296 GMT [27812] LOG:  database system is ready to accept connections
2023-01-21 20:31:03.177 GMT [27838] ERROR:  function unauthenticated.create_online_account_details(integer, text, text, integer[], text[], unknown, unknown) does not exist at character 15
2023-01-21 20:31:03.177 GMT [27838] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 20:31:03.177 GMT [27838] QUERY:  SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith', 'Password123')
2023-01-21 20:31:03.177 GMT [27838] CONTEXT:  PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:31:03.177 GMT [27838] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith', 'Password123');
	END
	$$;
2023-01-21 20:31:17.933 GMT [27812] LOG:  received fast shutdown request
2023-01-21 20:31:17.935 GMT [27812] LOG:  aborting any active transactions
2023-01-21 20:31:17.939 GMT [27812] LOG:  background worker "logical replication launcher" (PID 27819) exited with exit code 1
2023-01-21 20:31:17.940 GMT [27814] LOG:  shutting down
2023-01-21 20:31:17.990 GMT [27812] LOG:  database system is shut down
2023-01-21 20:31:19.026 GMT [27962] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:31:19.027 GMT [27962] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:31:19.028 GMT [27962] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:31:19.034 GMT [27964] LOG:  database system was shut down at 2023-01-21 20:31:18 GMT
2023-01-21 20:31:19.041 GMT [27962] LOG:  database system is ready to accept connections
2023-01-21 20:31:19.993 GMT [27995] ERROR:  function unauthenticated.create_online_account_details(integer, text, text, integer[], text[], text, text) does not exist at character 15
2023-01-21 20:31:19.993 GMT [27995] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 20:31:19.993 GMT [27995] QUERY:  SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text)
2023-01-21 20:31:19.993 GMT [27995] CONTEXT:  PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:31:19.993 GMT [27995] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	     '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text);
	END
	$$;
2023-01-21 20:32:11.381 GMT [27962] LOG:  received fast shutdown request
2023-01-21 20:32:11.384 GMT [27962] LOG:  aborting any active transactions
2023-01-21 20:32:11.390 GMT [27962] LOG:  background worker "logical replication launcher" (PID 27971) exited with exit code 1
2023-01-21 20:32:11.390 GMT [27966] LOG:  shutting down
2023-01-21 20:32:11.438 GMT [27962] LOG:  database system is shut down
2023-01-21 20:32:12.474 GMT [28233] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:32:12.475 GMT [28233] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:32:12.476 GMT [28233] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:32:12.482 GMT [28234] LOG:  database system was shut down at 2023-01-21 20:32:12 GMT
2023-01-21 20:32:12.487 GMT [28233] LOG:  database system is ready to accept connections
2023-01-21 20:32:13.454 GMT [28262] ERROR:  column reference "first_name" is ambiguous at character 109
2023-01-21 20:32:13.454 GMT [28262] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-21 20:32:13.454 GMT [28262] QUERY:  NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE id = customer_id AND md5(first_name) = first_name AND md5(last_name) = last_name
	    AND md5(email_address) = email_address) AND is_verified = FALSE
2023-01-21 20:32:13.454 GMT [28262] CONTEXT:  PL/pgSQL function create_online_account_details(integer,text,text,text,integer[],text[],text,text) line 8 at IF
	SQL statement "SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	    'example@gmail.com'::text, '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text)"
	PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:32:13.454 GMT [28262] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	    'example@gmail.com'::text, '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text);
	END
	$$;
2023-01-21 20:35:51.815 GMT [28233] LOG:  received fast shutdown request
2023-01-21 20:35:51.817 GMT [28233] LOG:  aborting any active transactions
2023-01-21 20:35:51.821 GMT [28233] LOG:  background worker "logical replication launcher" (PID 28240) exited with exit code 1
2023-01-21 20:35:51.821 GMT [28235] LOG:  shutting down
2023-01-21 20:35:51.871 GMT [28233] LOG:  database system is shut down
2023-01-21 20:35:52.900 GMT [29046] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:35:52.900 GMT [29046] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:35:52.902 GMT [29046] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:35:52.907 GMT [29047] LOG:  database system was shut down at 2023-01-21 20:35:52 GMT
2023-01-21 20:35:52.912 GMT [29046] LOG:  database system is ready to accept connections
2023-01-21 20:35:53.716 GMT [29072] ERROR:  mismatched parentheses at or near ";" at character 699
2023-01-21 20:35:53.716 GMT [29072] STATEMENT:  CREATE OR REPLACE FUNCTION unauthenticated.create_online_account_details(
	    customer_id_p INT, first_name_p TEXT, last_name_p TEXT, email_address_p TEXT, question_choice_ids_p INT[], question_answers_p TEXT[], username_p TEXT, password_p TEXT)
	RETURNS INT AS $$
	DECLARE account_id INT;
	DECLARE online_account_id INT;
	DECLARE question_choice_id INT;
	BEGIN
	
	    --check customer is verified
	    IF NOT EXISTS (SELECT FROM unauthenticated.unauthenticated_personal_information WHERE id = customer_id_p AND first_name = md5(first_name_p) AND last_name = md5(last_name_p)
	    AND email_address = md5(email_address_p) AND is_verified = FALSE THEN
	        RAISE NOTICE 'CUSTOMER INFORMATION NOT VERIFIED';
	        RETURN -1;
	    END IF;
	
	    IF NOT EXISTS (SELECT FROM user_login WHERE username = username_p) THEN
	        INSERT INTO online_account (date_opened, sort_code, customer_id)
	        VALUES ((SELECT now()), (SELECT num FROM GENERATE_SERIES(1, 6) AS s(num) LIMIT 1), customer_id_p)
	        RETURNING id INTO account_id;
	
	        INSERT INTO user_login (account_id, username, password)
	        VALUES (account_id, username_p, create_md5_password(username_p, password_p))
	        RETURNING id INTO online_account_id;
	
	        FOR i IN 0..2 LOOP
	            
	            INSERT INTO user_login_security_question (question_choice_id, login_id)
	            VALUES (question_choice_ids_p[i], online_account_id)
	            RETURNING id INTO question_choice_id;
	
	            INSERT INTO security_question_answer (answer, question_id)
	            VALUES (question_answers_p[i], question_choice_id);
	
	        END LOOP;
	
	
	        INSERT INTO authentication_log (log_description, log_date, account_id) VALUES ('New online account created', now(), account_id);
	
	        RETURN account_id;
	    ELSE
	        RAISE NOTICE 'USERNAME ALREADY TAKEN';
	        RETURN NULL;
	
	    END IF;
	    RETURN 1;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-21 20:35:53.847 GMT [29072] ERROR:  function unauthenticated.create_online_account_details(integer, text, text, text, integer[], text[], text, text) does not exist at character 15
2023-01-21 20:35:53.847 GMT [29072] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 20:35:53.847 GMT [29072] QUERY:  SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	    'example@gmail.com'::text, '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text)
2023-01-21 20:35:53.847 GMT [29072] CONTEXT:  PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:35:53.847 GMT [29072] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	    'example@gmail.com'::text, '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text);
	END
	$$;
2023-01-21 20:36:39.563 GMT [29046] LOG:  received fast shutdown request
2023-01-21 20:36:39.564 GMT [29046] LOG:  aborting any active transactions
2023-01-21 20:36:39.569 GMT [29046] LOG:  background worker "logical replication launcher" (PID 29053) exited with exit code 1
2023-01-21 20:36:39.569 GMT [29048] LOG:  shutting down
2023-01-21 20:36:39.616 GMT [29046] LOG:  database system is shut down
2023-01-21 20:36:40.633 GMT [29281] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:36:40.634 GMT [29281] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:36:40.636 GMT [29281] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:36:40.641 GMT [29282] LOG:  database system was shut down at 2023-01-21 20:36:40 GMT
2023-01-21 20:36:40.647 GMT [29281] LOG:  database system is ready to accept connections
2023-01-21 20:36:41.588 GMT [29307] ERROR:  query has no destination for result data
2023-01-21 20:36:41.588 GMT [29307] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-21 20:36:41.588 GMT [29307] CONTEXT:  PL/pgSQL function inline_code_block line 9 at SQL statement
2023-01-21 20:36:41.588 GMT [29307] STATEMENT:  DO $$
	DECLARE customer_id INT;
	BEGIN
	    customer_id = unauthenticated.create_personal_info(
	    'John'::text, 'Smith'::text, '1990-01-01'::date, '01234567890'::text,
	    'example@gmail.com'::text, 'example street'::text, 'example city'::text,
	    'example county'::text, 'EX1 1EX'::text);
	
	    SELECT * FROM unauthenticated.create_online_account_details(customer_id, 'John'::text, 'Smith'::text,
	    'example@gmail.com'::text, '{1,2,3}'::int[], '{Blue, Wraps, Dogs}'::text[], 'johnsmith'::text, 'Password123'::text);
	END
	$$;
2023-01-21 20:39:33.667 GMT [29281] LOG:  received fast shutdown request
2023-01-21 20:39:33.668 GMT [29281] LOG:  aborting any active transactions
2023-01-21 20:39:33.674 GMT [29281] LOG:  background worker "logical replication launcher" (PID 29288) exited with exit code 1
2023-01-21 20:39:33.674 GMT [29283] LOG:  shutting down
2023-01-21 20:39:33.729 GMT [29281] LOG:  database system is shut down
2023-01-21 20:39:34.757 GMT [29882] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:39:34.758 GMT [29882] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:39:34.759 GMT [29882] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:39:34.765 GMT [29883] LOG:  database system was shut down at 2023-01-21 20:39:34 GMT
2023-01-21 20:39:34.772 GMT [29882] LOG:  database system is ready to accept connections
2023-01-21 20:39:55.817 GMT [29882] LOG:  received fast shutdown request
2023-01-21 20:39:55.818 GMT [29882] LOG:  aborting any active transactions
2023-01-21 20:39:55.823 GMT [29882] LOG:  background worker "logical replication launcher" (PID 29889) exited with exit code 1
2023-01-21 20:39:55.823 GMT [29884] LOG:  shutting down
2023-01-21 20:39:55.869 GMT [29882] LOG:  database system is shut down
2023-01-21 20:39:56.885 GMT [30049] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:39:56.885 GMT [30049] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:39:56.886 GMT [30049] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:39:56.891 GMT [30050] LOG:  database system was shut down at 2023-01-21 20:39:56 GMT
2023-01-21 20:39:56.897 GMT [30049] LOG:  database system is ready to accept connections
2023-01-21 20:44:17.217 GMT [30049] LOG:  received fast shutdown request
2023-01-21 20:44:17.219 GMT [30049] LOG:  aborting any active transactions
2023-01-21 20:44:17.225 GMT [30049] LOG:  background worker "logical replication launcher" (PID 30056) exited with exit code 1
2023-01-21 20:44:17.226 GMT [30051] LOG:  shutting down
2023-01-21 20:44:17.276 GMT [30049] LOG:  database system is shut down
2023-01-21 20:44:18.468 GMT [30859] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:44:18.468 GMT [30859] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:44:18.469 GMT [30859] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:44:18.475 GMT [30860] LOG:  database system was shut down at 2023-01-21 20:44:18 GMT
2023-01-21 20:44:18.482 GMT [30859] LOG:  database system is ready to accept connections
2023-01-21 20:45:22.219 GMT [30859] LOG:  received fast shutdown request
2023-01-21 20:45:22.223 GMT [30859] LOG:  aborting any active transactions
2023-01-21 20:45:22.227 GMT [30859] LOG:  background worker "logical replication launcher" (PID 30866) exited with exit code 1
2023-01-21 20:45:22.227 GMT [30861] LOG:  shutting down
2023-01-21 20:45:22.275 GMT [30859] LOG:  database system is shut down
2023-01-21 20:45:23.375 GMT [31185] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:45:23.375 GMT [31185] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:45:23.377 GMT [31185] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:45:23.383 GMT [31186] LOG:  database system was shut down at 2023-01-21 20:45:23 GMT
2023-01-21 20:45:23.388 GMT [31185] LOG:  database system is ready to accept connections
2023-01-21 20:46:12.209 GMT [31185] LOG:  received fast shutdown request
2023-01-21 20:46:12.214 GMT [31185] LOG:  aborting any active transactions
2023-01-21 20:46:12.219 GMT [31185] LOG:  background worker "logical replication launcher" (PID 31192) exited with exit code 1
2023-01-21 20:46:12.219 GMT [31187] LOG:  shutting down
2023-01-21 20:46:12.267 GMT [31185] LOG:  database system is shut down
2023-01-21 20:46:13.385 GMT [31444] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:46:13.386 GMT [31444] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:46:13.387 GMT [31444] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:46:13.391 GMT [31445] LOG:  database system was shut down at 2023-01-21 20:46:13 GMT
2023-01-21 20:46:13.397 GMT [31444] LOG:  database system is ready to accept connections
2023-01-21 20:49:47.861 GMT [31444] LOG:  received fast shutdown request
2023-01-21 20:49:47.862 GMT [31444] LOG:  aborting any active transactions
2023-01-21 20:49:47.865 GMT [31444] LOG:  background worker "logical replication launcher" (PID 31451) exited with exit code 1
2023-01-21 20:49:47.867 GMT [31446] LOG:  shutting down
2023-01-21 20:49:47.912 GMT [31444] LOG:  database system is shut down
2023-01-21 20:49:49.032 GMT [32206] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:49:49.032 GMT [32206] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:49:49.034 GMT [32206] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:49:49.040 GMT [32207] LOG:  database system was shut down at 2023-01-21 20:49:48 GMT
2023-01-21 20:49:49.045 GMT [32206] LOG:  database system is ready to accept connections
2023-01-21 20:49:50.005 GMT [32232] ERROR:  relation "client.get_account_id" does not exist at character 15
2023-01-21 20:49:50.005 GMT [32232] STATEMENT:  SELECT * FROM client.get_account_id;
2023-01-21 20:50:06.269 GMT [32206] LOG:  received fast shutdown request
2023-01-21 20:50:06.270 GMT [32206] LOG:  aborting any active transactions
2023-01-21 20:50:06.277 GMT [32206] LOG:  background worker "logical replication launcher" (PID 32213) exited with exit code 1
2023-01-21 20:50:06.277 GMT [32208] LOG:  shutting down
2023-01-21 20:50:06.331 GMT [32206] LOG:  database system is shut down
2023-01-21 20:50:07.464 GMT [32364] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:50:07.464 GMT [32364] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:50:07.466 GMT [32364] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:50:07.472 GMT [32365] LOG:  database system was shut down at 2023-01-21 20:50:07 GMT
2023-01-21 20:50:07.480 GMT [32364] LOG:  database system is ready to accept connections
2023-01-21 20:50:08.482 GMT [32390] ERROR:  permission denied for table online_account
2023-01-21 20:50:08.482 GMT [32390] CONTEXT:  SQL statement "SELECT id                 FROM online_account"
	PL/pgSQL function get_account_id() line 4 at SQL statement
2023-01-21 20:50:08.482 GMT [32390] STATEMENT:  SELECT * FROM client.get_account_id();
2023-01-21 20:50:32.473 GMT [32364] LOG:  received fast shutdown request
2023-01-21 20:50:32.474 GMT [32364] LOG:  aborting any active transactions
2023-01-21 20:50:32.478 GMT [32364] LOG:  background worker "logical replication launcher" (PID 32371) exited with exit code 1
2023-01-21 20:50:32.478 GMT [32366] LOG:  shutting down
2023-01-21 20:50:32.528 GMT [32364] LOG:  database system is shut down
2023-01-21 20:50:33.679 GMT [32552] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:50:33.679 GMT [32552] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:50:33.681 GMT [32552] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:50:33.686 GMT [32553] LOG:  database system was shut down at 2023-01-21 20:50:33 GMT
2023-01-21 20:50:33.691 GMT [32552] LOG:  database system is ready to accept connections
2023-01-21 20:50:43.671 GMT [32552] LOG:  received fast shutdown request
2023-01-21 20:50:43.673 GMT [32552] LOG:  aborting any active transactions
2023-01-21 20:50:43.677 GMT [32552] LOG:  background worker "logical replication launcher" (PID 32559) exited with exit code 1
2023-01-21 20:50:43.678 GMT [32554] LOG:  shutting down
2023-01-21 20:50:43.739 GMT [32552] LOG:  database system is shut down
2023-01-21 20:50:44.854 GMT [32694] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 20:50:44.854 GMT [32694] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 20:50:44.856 GMT [32694] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 20:50:44.862 GMT [32695] LOG:  database system was shut down at 2023-01-21 20:50:44 GMT
2023-01-21 20:50:44.867 GMT [32694] LOG:  database system is ready to accept connections
2023-01-21 21:01:57.374 GMT [32694] LOG:  received fast shutdown request
2023-01-21 21:01:57.375 GMT [32694] LOG:  aborting any active transactions
2023-01-21 21:01:57.382 GMT [32694] LOG:  background worker "logical replication launcher" (PID 32701) exited with exit code 1
2023-01-21 21:01:57.382 GMT [32696] LOG:  shutting down
2023-01-21 21:01:57.397 GMT [32694] LOG:  database system is shut down
2023-01-21 21:01:58.549 GMT [34786] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:01:58.550 GMT [34786] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:01:58.551 GMT [34786] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:01:58.559 GMT [34787] LOG:  database system was shut down at 2023-01-21 21:01:58 GMT
2023-01-21 21:01:58.569 GMT [34786] LOG:  database system is ready to accept connections
2023-01-21 21:01:59.555 GMT [34815] ERROR:  column reference "first_name" is ambiguous at character 34
2023-01-21 21:01:59.555 GMT [34815] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-21 21:01:59.555 GMT [34815] QUERY:  UPDATE customer SET first_name = first_name, last_name = last_name, date_of_birth = date_of_birth, phone_number = phone_number, email_address = email_address, address_street = address_street, address_city = address_city, address_county = address_county, address_postcode = address_postcode
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)
2023-01-21 21:01:59.555 GMT [34815] CONTEXT:  PL/pgSQL function client.update_personal_information(integer,text,text,date,text,text,text,text,text,text) line 4 at SQL statement
2023-01-21 21:01:59.555 GMT [34815] STATEMENT:  SELECT * FROM client.update_personal_information(2, 'Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:04:13.949 GMT [34786] LOG:  received fast shutdown request
2023-01-21 21:04:13.950 GMT [34786] LOG:  aborting any active transactions
2023-01-21 21:04:13.957 GMT [34786] LOG:  background worker "logical replication launcher" (PID 34796) exited with exit code 1
2023-01-21 21:04:13.958 GMT [34788] LOG:  shutting down
2023-01-21 21:04:14.014 GMT [34786] LOG:  database system is shut down
2023-01-21 21:04:15.035 GMT [35316] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:04:15.035 GMT [35316] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:04:15.037 GMT [35316] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:04:15.043 GMT [35317] LOG:  database system was shut down at 2023-01-21 21:04:14 GMT
2023-01-21 21:04:15.048 GMT [35316] LOG:  database system is ready to accept connections
2023-01-21 21:04:16.061 GMT [35342] ERROR:  permission denied for table customer
2023-01-21 21:04:16.061 GMT [35342] CONTEXT:  SQL statement "UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)"
	PL/pgSQL function client.update_personal_information(integer,text,text,date,text,text,text,text,text,text) line 4 at SQL statement
2023-01-21 21:04:16.061 GMT [35342] STATEMENT:  SELECT * FROM client.update_personal_information(2, 'Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:06:16.868 GMT [35316] LOG:  received fast shutdown request
2023-01-21 21:06:16.870 GMT [35316] LOG:  aborting any active transactions
2023-01-21 21:06:16.875 GMT [35316] LOG:  background worker "logical replication launcher" (PID 35323) exited with exit code 1
2023-01-21 21:06:16.875 GMT [35318] LOG:  shutting down
2023-01-21 21:06:16.922 GMT [35316] LOG:  database system is shut down
2023-01-21 21:06:17.956 GMT [35786] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:06:17.956 GMT [35786] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:06:17.958 GMT [35786] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:06:17.962 GMT [35787] LOG:  database system was shut down at 2023-01-21 21:06:17 GMT
2023-01-21 21:06:17.967 GMT [35786] LOG:  database system is ready to accept connections
2023-01-21 21:06:18.798 GMT [35812] ERROR:  syntax error at or near "EXISTS" at character 19
2023-01-21 21:06:18.798 GMT [35812] STATEMENT:  ALTER FUNCTION IF EXISTS client.update_personal_information(first_name_p TEXT, last_name_p TEXT, date_of_birth_p DATE, phone_number_p TEXT, email_address_p TEXT, address_street_p TEXT, address_city_p TEXT, address_county_p TEXT, address_postcode_p TEXT) OWNER TO user_banking_protection;
2023-01-21 21:06:18.966 GMT [35812] ERROR:  permission denied for table customer
2023-01-21 21:06:18.966 GMT [35812] CONTEXT:  SQL statement "UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)"
	PL/pgSQL function client.update_personal_information(integer,text,text,date,text,text,text,text,text,text) line 4 at SQL statement
2023-01-21 21:06:18.966 GMT [35812] STATEMENT:  SELECT * FROM client.update_personal_information(2, 'Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:06:43.161 GMT [35786] LOG:  received fast shutdown request
2023-01-21 21:06:43.163 GMT [35786] LOG:  aborting any active transactions
2023-01-21 21:06:43.166 GMT [35786] LOG:  background worker "logical replication launcher" (PID 35793) exited with exit code 1
2023-01-21 21:06:43.168 GMT [35788] LOG:  shutting down
2023-01-21 21:06:43.218 GMT [35786] LOG:  database system is shut down
2023-01-21 21:06:44.184 GMT [35964] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:06:44.185 GMT [35964] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:06:44.186 GMT [35964] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:06:44.191 GMT [35965] LOG:  database system was shut down at 2023-01-21 21:06:43 GMT
2023-01-21 21:06:44.198 GMT [35964] LOG:  database system is ready to accept connections
2023-01-21 21:06:45.029 GMT [35990] ERROR:  function client.update_personal_information(text, text, date, text, text, text, text, text, text) does not exist
2023-01-21 21:06:45.029 GMT [35990] STATEMENT:  ALTER FUNCTION client.update_personal_information(first_name_p TEXT, last_name_p TEXT, date_of_birth_p DATE, phone_number_p TEXT, email_address_p TEXT, address_street_p TEXT, address_city_p TEXT, address_county_p TEXT, address_postcode_p TEXT) OWNER TO user_banking_protection;
2023-01-21 21:06:45.143 GMT [35990] ERROR:  permission denied for table customer
2023-01-21 21:06:45.143 GMT [35990] CONTEXT:  SQL statement "UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)"
	PL/pgSQL function client.update_personal_information(integer,text,text,date,text,text,text,text,text,text) line 4 at SQL statement
2023-01-21 21:06:45.143 GMT [35990] STATEMENT:  SELECT * FROM client.update_personal_information(2, 'Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:07:37.686 GMT [35964] LOG:  received fast shutdown request
2023-01-21 21:07:37.688 GMT [35964] LOG:  aborting any active transactions
2023-01-21 21:07:37.694 GMT [35964] LOG:  background worker "logical replication launcher" (PID 35971) exited with exit code 1
2023-01-21 21:07:37.694 GMT [35966] LOG:  shutting down
2023-01-21 21:07:37.738 GMT [35964] LOG:  database system is shut down
2023-01-21 21:07:38.783 GMT [36215] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:07:38.783 GMT [36215] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:07:38.785 GMT [36215] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:07:38.795 GMT [36216] LOG:  database system was shut down at 2023-01-21 21:07:38 GMT
2023-01-21 21:07:38.801 GMT [36215] LOG:  database system is ready to accept connections
2023-01-21 21:07:39.699 GMT [36241] ERROR:  permission denied for table customer
2023-01-21 21:07:39.699 GMT [36241] CONTEXT:  SQL statement "UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)"
	PL/pgSQL function client.update_personal_information(integer,text,text,date,text,text,text,text,text,text) line 4 at SQL statement
2023-01-21 21:07:39.699 GMT [36241] STATEMENT:  SELECT * FROM client.update_personal_information(2, 'Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:12:52.933 GMT [36215] LOG:  received fast shutdown request
2023-01-21 21:12:52.935 GMT [36215] LOG:  aborting any active transactions
2023-01-21 21:12:52.939 GMT [36215] LOG:  background worker "logical replication launcher" (PID 36222) exited with exit code 1
2023-01-21 21:12:52.970 GMT [36217] LOG:  shutting down
2023-01-21 21:12:52.981 GMT [36215] LOG:  database system is shut down
2023-01-21 21:12:54.114 GMT [37212] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:12:54.114 GMT [37212] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:12:54.116 GMT [37212] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:12:54.120 GMT [37213] LOG:  database system was shut down at 2023-01-21 21:12:53 GMT
2023-01-21 21:12:54.127 GMT [37212] LOG:  database system is ready to accept connections
2023-01-21 21:12:54.921 GMT [37241] ERROR:  input parameters after one with a default value must also have defaults
2023-01-21 21:12:54.921 GMT [37241] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_personal_information(account_identifier INT DEFAULT client.get_account_id(), first_name_p TEXT, last_name_p TEXT, date_of_birth_p DATE, phone_number_p TEXT, email_address_p TEXT, address_street_p TEXT, address_city_p TEXT, address_county_p TEXT, address_postcode_p TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-21 21:12:55.088 GMT [37241] ERROR:  function client.update_personal_information(text, text, date, text, text, text, text, text, text) does not exist at character 15
2023-01-21 21:12:55.088 GMT [37241] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-21 21:12:55.088 GMT [37241] STATEMENT:  SELECT * FROM client.update_personal_information('Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:13:35.313 GMT [37212] LOG:  received fast shutdown request
2023-01-21 21:13:35.315 GMT [37212] LOG:  aborting any active transactions
2023-01-21 21:13:35.322 GMT [37212] LOG:  background worker "logical replication launcher" (PID 37219) exited with exit code 1
2023-01-21 21:13:35.322 GMT [37214] LOG:  shutting down
2023-01-21 21:13:35.373 GMT [37212] LOG:  database system is shut down
2023-01-21 21:13:36.466 GMT [37450] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:13:36.466 GMT [37450] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:13:36.468 GMT [37450] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:13:36.473 GMT [37451] LOG:  database system was shut down at 2023-01-21 21:13:36 GMT
2023-01-21 21:13:36.478 GMT [37450] LOG:  database system is ready to accept connections
2023-01-21 21:13:37.433 GMT [37476] ERROR:  column "rowcount" does not exist at character 22
2023-01-21 21:13:37.433 GMT [37476] QUERY:  passed = CASE WHEN @@ROWCOUNT = 1 THEN TRUE ELSE FALSE END
2023-01-21 21:13:37.433 GMT [37476] CONTEXT:  PL/pgSQL function client.update_personal_information(text,text,date,text,text,text,text,text,text,integer) line 8 at assignment
2023-01-21 21:13:37.433 GMT [37476] STATEMENT:  SELECT * FROM client.update_personal_information('Johnatahan'::text , 'Smith'::text , '1990-01-01'::date , '01234567890'::text , 'example@email.com'::text, 'example street'::text , 'example city'::text , 'example county'::text , 'EX1 1EX'::text);
2023-01-21 21:14:01.757 GMT [37450] LOG:  received fast shutdown request
2023-01-21 21:14:01.758 GMT [37450] LOG:  aborting any active transactions
2023-01-21 21:14:01.761 GMT [37450] LOG:  background worker "logical replication launcher" (PID 37457) exited with exit code 1
2023-01-21 21:14:01.762 GMT [37452] LOG:  shutting down
2023-01-21 21:14:01.815 GMT [37450] LOG:  database system is shut down
2023-01-21 21:14:02.870 GMT [37630] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:14:02.870 GMT [37630] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:14:02.872 GMT [37630] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:14:02.877 GMT [37631] LOG:  database system was shut down at 2023-01-21 21:14:02 GMT
2023-01-21 21:14:02.885 GMT [37630] LOG:  database system is ready to accept connections
2023-01-21 21:16:15.128 GMT [37630] LOG:  received fast shutdown request
2023-01-21 21:16:15.148 GMT [37630] LOG:  aborting any active transactions
2023-01-21 21:16:15.152 GMT [37630] LOG:  background worker "logical replication launcher" (PID 37637) exited with exit code 1
2023-01-21 21:16:15.152 GMT [37632] LOG:  shutting down
2023-01-21 21:16:15.209 GMT [37630] LOG:  database system is shut down
2023-01-21 21:16:16.246 GMT [38125] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:16:16.247 GMT [38125] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:16:16.248 GMT [38125] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:16:16.254 GMT [38126] LOG:  database system was shut down at 2023-01-21 21:16:16 GMT
2023-01-21 21:16:16.260 GMT [38125] LOG:  database system is ready to accept connections
2023-01-21 21:17:08.003 GMT [38125] LOG:  received fast shutdown request
2023-01-21 21:17:08.005 GMT [38125] LOG:  aborting any active transactions
2023-01-21 21:17:08.009 GMT [38125] LOG:  background worker "logical replication launcher" (PID 38132) exited with exit code 1
2023-01-21 21:17:08.010 GMT [38127] LOG:  shutting down
2023-01-21 21:17:08.060 GMT [38125] LOG:  database system is shut down
2023-01-21 21:17:09.180 GMT [38398] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:17:09.180 GMT [38398] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:17:09.182 GMT [38398] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:17:09.186 GMT [38399] LOG:  database system was shut down at 2023-01-21 21:17:08 GMT
2023-01-21 21:17:09.191 GMT [38398] LOG:  database system is ready to accept connections
2023-01-21 21:29:24.371 GMT [38398] LOG:  received fast shutdown request
2023-01-21 21:29:24.373 GMT [38398] LOG:  aborting any active transactions
2023-01-21 21:29:24.377 GMT [38398] LOG:  background worker "logical replication launcher" (PID 38405) exited with exit code 1
2023-01-21 21:29:24.378 GMT [38400] LOG:  shutting down
2023-01-21 21:29:24.393 GMT [38398] LOG:  database system is shut down
2023-01-21 21:29:25.454 GMT [40820] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:29:25.454 GMT [40820] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:29:25.456 GMT [40820] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:29:25.461 GMT [40821] LOG:  database system was shut down at 2023-01-21 21:29:25 GMT
2023-01-21 21:29:25.468 GMT [40820] LOG:  database system is ready to accept connections
2023-01-21 21:29:26.272 GMT [40849] ERROR:  missing "THEN" at end of SQL expression at character 562
2023-01-21 21:29:26.272 GMT [40849] STATEMENT:  CREATE OR REPLACE FUNCTION client.initiate_transfer(account_identifier INT, orig_account_number INT, transfer_amount NUMERIC, transfer_account_number INT, transfer_account_sort_code INT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE internal_account_id INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Initiated transfer', CURRENT_DATE);
	
	    IF EXISTS (SELECT * FROM client.accounts WHERE account_number = orig_account_number AND account_id = client.get_account_id());
	
	        SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE) INTO passed;
	
	    ELSE
	        RAISE NOTICE 'Account does not exist';
	        RETURN FALSE;
	    END IF;
	
	    RETURN passed;
	
	END;
	$$ LANGUAGE plpgsql;
2023-01-21 21:30:01.753 GMT [40820] LOG:  received fast shutdown request
2023-01-21 21:30:01.755 GMT [40820] LOG:  aborting any active transactions
2023-01-21 21:30:01.757 GMT [40820] LOG:  background worker "logical replication launcher" (PID 40827) exited with exit code 1
2023-01-21 21:30:01.760 GMT [40822] LOG:  shutting down
2023-01-21 21:30:01.806 GMT [40820] LOG:  database system is shut down
2023-01-21 21:30:02.883 GMT [41034] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:30:02.883 GMT [41034] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:30:02.885 GMT [41034] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:30:02.889 GMT [41035] LOG:  database system was shut down at 2023-01-21 21:30:02 GMT
2023-01-21 21:30:02.893 GMT [41034] LOG:  database system is ready to accept connections
2023-01-21 21:32:05.528 GMT [41034] LOG:  received fast shutdown request
2023-01-21 21:32:05.529 GMT [41034] LOG:  aborting any active transactions
2023-01-21 21:32:05.533 GMT [41034] LOG:  background worker "logical replication launcher" (PID 41041) exited with exit code 1
2023-01-21 21:32:05.534 GMT [41036] LOG:  shutting down
2023-01-21 21:32:05.581 GMT [41034] LOG:  database system is shut down
2023-01-21 21:32:06.679 GMT [41547] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:32:06.680 GMT [41547] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:32:06.689 GMT [41547] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:32:06.702 GMT [41548] LOG:  database system was shut down at 2023-01-21 21:32:06 GMT
2023-01-21 21:32:06.710 GMT [41547] LOG:  database system is ready to accept connections
2023-01-21 21:32:31.288 GMT [41547] LOG:  received fast shutdown request
2023-01-21 21:32:31.291 GMT [41547] LOG:  aborting any active transactions
2023-01-21 21:32:31.295 GMT [41547] LOG:  background worker "logical replication launcher" (PID 41554) exited with exit code 1
2023-01-21 21:32:31.296 GMT [41549] LOG:  shutting down
2023-01-21 21:32:31.354 GMT [41547] LOG:  database system is shut down
2023-01-21 21:32:32.405 GMT [41728] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:32:32.406 GMT [41728] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:32:32.407 GMT [41728] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:32:32.412 GMT [41729] LOG:  database system was shut down at 2023-01-21 21:32:32 GMT
2023-01-21 21:32:32.418 GMT [41728] LOG:  database system is ready to accept connections
2023-01-21 21:33:10.482 GMT [41728] LOG:  received fast shutdown request
2023-01-21 21:33:10.483 GMT [41728] LOG:  aborting any active transactions
2023-01-21 21:33:10.490 GMT [41728] LOG:  background worker "logical replication launcher" (PID 41735) exited with exit code 1
2023-01-21 21:33:10.490 GMT [41730] LOG:  shutting down
2023-01-21 21:33:10.549 GMT [41728] LOG:  database system is shut down
2023-01-21 21:33:11.630 GMT [41950] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:33:11.630 GMT [41950] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:33:11.632 GMT [41950] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:33:11.639 GMT [41954] LOG:  database system was shut down at 2023-01-21 21:33:11 GMT
2023-01-21 21:33:11.647 GMT [41950] LOG:  database system is ready to accept connections
2023-01-21 21:35:10.908 GMT [41950] LOG:  received fast shutdown request
2023-01-21 21:35:10.910 GMT [41950] LOG:  aborting any active transactions
2023-01-21 21:35:10.912 GMT [41950] LOG:  background worker "logical replication launcher" (PID 41960) exited with exit code 1
2023-01-21 21:35:10.915 GMT [41955] LOG:  shutting down
2023-01-21 21:35:10.968 GMT [41950] LOG:  database system is shut down
2023-01-21 21:35:12.620 GMT [42471] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:35:12.620 GMT [42471] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:35:12.622 GMT [42471] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:35:12.628 GMT [42472] LOG:  database system was shut down at 2023-01-21 21:35:11 GMT
2023-01-21 21:35:12.636 GMT [42471] LOG:  database system is ready to accept connections
2023-01-21 21:35:36.669 GMT [42471] LOG:  received fast shutdown request
2023-01-21 21:35:36.671 GMT [42471] LOG:  aborting any active transactions
2023-01-21 21:35:36.675 GMT [42471] LOG:  background worker "logical replication launcher" (PID 42478) exited with exit code 1
2023-01-21 21:35:36.675 GMT [42473] LOG:  shutting down
2023-01-21 21:35:36.731 GMT [42471] LOG:  database system is shut down
2023-01-21 21:35:37.835 GMT [42663] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:35:37.835 GMT [42663] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:35:37.837 GMT [42663] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:35:37.841 GMT [42664] LOG:  database system was shut down at 2023-01-21 21:35:37 GMT
2023-01-21 21:35:37.846 GMT [42663] LOG:  database system is ready to accept connections
2023-01-21 21:36:06.040 GMT [42663] LOG:  received fast shutdown request
2023-01-21 21:36:06.042 GMT [42663] LOG:  aborting any active transactions
2023-01-21 21:36:06.046 GMT [42663] LOG:  background worker "logical replication launcher" (PID 42670) exited with exit code 1
2023-01-21 21:36:06.046 GMT [42665] LOG:  shutting down
2023-01-21 21:36:06.097 GMT [42663] LOG:  database system is shut down
2023-01-21 21:36:07.178 GMT [42848] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:36:07.178 GMT [42848] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:36:07.180 GMT [42848] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:36:07.193 GMT [42850] LOG:  database system was shut down at 2023-01-21 21:36:06 GMT
2023-01-21 21:36:07.199 GMT [42848] LOG:  database system is ready to accept connections
2023-01-21 21:39:05.944 GMT [42848] LOG:  received fast shutdown request
2023-01-21 21:39:05.946 GMT [42848] LOG:  aborting any active transactions
2023-01-21 21:39:05.949 GMT [42848] LOG:  background worker "logical replication launcher" (PID 42858) exited with exit code 1
2023-01-21 21:39:05.950 GMT [42853] LOG:  shutting down
2023-01-21 21:39:05.996 GMT [42848] LOG:  database system is shut down
2023-01-21 21:39:07.163 GMT [43466] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:39:07.163 GMT [43466] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:39:07.165 GMT [43466] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:39:07.169 GMT [43467] LOG:  database system was shut down at 2023-01-21 21:39:06 GMT
2023-01-21 21:39:07.175 GMT [43466] LOG:  database system is ready to accept connections
2023-01-21 21:40:47.500 GMT [43466] LOG:  received fast shutdown request
2023-01-21 21:40:47.502 GMT [43466] LOG:  aborting any active transactions
2023-01-21 21:40:47.508 GMT [43466] LOG:  background worker "logical replication launcher" (PID 43473) exited with exit code 1
2023-01-21 21:40:47.508 GMT [43468] LOG:  shutting down
2023-01-21 21:40:47.557 GMT [43466] LOG:  database system is shut down
2023-01-21 21:40:48.607 GMT [43866] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:40:48.607 GMT [43866] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:40:48.609 GMT [43866] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:40:48.613 GMT [43867] LOG:  database system was shut down at 2023-01-21 21:40:48 GMT
2023-01-21 21:40:48.622 GMT [43866] LOG:  database system is ready to accept connections
2023-01-21 21:56:25.417 GMT [43866] LOG:  received fast shutdown request
2023-01-21 21:56:25.419 GMT [43866] LOG:  aborting any active transactions
2023-01-21 21:56:25.423 GMT [43866] LOG:  background worker "logical replication launcher" (PID 43873) exited with exit code 1
2023-01-21 21:56:25.426 GMT [43868] LOG:  shutting down
2023-01-21 21:56:25.441 GMT [43866] LOG:  database system is shut down
2023-01-21 21:56:29.830 GMT [46596] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:56:29.830 GMT [46596] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:56:29.832 GMT [46596] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:56:29.837 GMT [46597] LOG:  database system was shut down at 2023-01-21 21:56:29 GMT
2023-01-21 21:56:29.843 GMT [46596] LOG:  database system is ready to accept connections
2023-01-21 21:56:30.870 GMT [46634] ERROR:  query has no destination for result data
2023-01-21 21:56:30.870 GMT [46634] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-21 21:56:30.870 GMT [46634] CONTEXT:  PL/pgSQL function open_debit_account(integer) line 7 at SQL statement
2023-01-21 21:56:30.870 GMT [46634] STATEMENT:  SELECT * FROM client.open_debit_account(1);
2023-01-21 21:57:03.881 GMT [46596] LOG:  received fast shutdown request
2023-01-21 21:57:03.882 GMT [46596] LOG:  aborting any active transactions
2023-01-21 21:57:03.888 GMT [46596] LOG:  background worker "logical replication launcher" (PID 46603) exited with exit code 1
2023-01-21 21:57:03.888 GMT [46598] LOG:  shutting down
2023-01-21 21:57:03.938 GMT [46596] LOG:  database system is shut down
2023-01-21 21:57:05.118 GMT [46816] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:57:05.119 GMT [46816] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:57:05.120 GMT [46816] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:57:05.125 GMT [46817] LOG:  database system was shut down at 2023-01-21 21:57:04 GMT
2023-01-21 21:57:05.132 GMT [46816] LOG:  database system is ready to accept connections
2023-01-21 21:57:20.264 GMT [46816] LOG:  received fast shutdown request
2023-01-21 21:57:20.266 GMT [46816] LOG:  aborting any active transactions
2023-01-21 21:57:20.271 GMT [46816] LOG:  background worker "logical replication launcher" (PID 46823) exited with exit code 1
2023-01-21 21:57:20.271 GMT [46818] LOG:  shutting down
2023-01-21 21:57:20.322 GMT [46816] LOG:  database system is shut down
2023-01-21 21:57:21.338 GMT [46970] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-21 21:57:21.338 GMT [46970] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-21 21:57:21.339 GMT [46970] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-21 21:57:21.344 GMT [46971] LOG:  database system was shut down at 2023-01-21 21:57:21 GMT
2023-01-21 21:57:21.352 GMT [46970] LOG:  database system is ready to accept connections
2023-01-22 08:28:37.729 GMT [46970] LOG:  received fast shutdown request
2023-01-22 08:28:37.731 GMT [46970] LOG:  aborting any active transactions
2023-01-22 08:28:37.734 GMT [46970] LOG:  background worker "logical replication launcher" (PID 46977) exited with exit code 1
2023-01-22 08:28:37.737 GMT [46972] LOG:  shutting down
2023-01-22 08:28:37.756 GMT [46970] LOG:  database system is shut down
2023-01-22 08:28:43.811 GMT [95011] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 08:28:43.811 GMT [95011] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 08:28:43.812 GMT [95011] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 08:28:43.818 GMT [95012] LOG:  database system was shut down at 2023-01-22 08:28:43 GMT
2023-01-22 08:28:43.825 GMT [95011] LOG:  database system is ready to accept connections
2023-01-22 08:29:10.133 GMT [95011] LOG:  received fast shutdown request
2023-01-22 08:29:10.135 GMT [95011] LOG:  aborting any active transactions
2023-01-22 08:29:10.141 GMT [95011] LOG:  background worker "logical replication launcher" (PID 95018) exited with exit code 1
2023-01-22 08:29:10.143 GMT [95013] LOG:  shutting down
2023-01-22 08:29:10.194 GMT [95011] LOG:  database system is shut down
2023-01-22 08:29:11.214 GMT [95204] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 08:29:11.215 GMT [95204] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 08:29:11.216 GMT [95204] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 08:29:11.223 GMT [95205] LOG:  database system was shut down at 2023-01-22 08:29:10 GMT
2023-01-22 08:29:11.229 GMT [95204] LOG:  database system is ready to accept connections
2023-01-22 08:30:47.598 GMT [95204] LOG:  received fast shutdown request
2023-01-22 08:30:47.599 GMT [95204] LOG:  aborting any active transactions
2023-01-22 08:30:47.602 GMT [95204] LOG:  background worker "logical replication launcher" (PID 95211) exited with exit code 1
2023-01-22 08:30:47.605 GMT [95206] LOG:  shutting down
2023-01-22 08:30:47.654 GMT [95204] LOG:  database system is shut down
2023-01-22 08:30:48.836 GMT [95572] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 08:30:48.837 GMT [95572] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 08:30:48.838 GMT [95572] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 08:30:48.856 GMT [95573] LOG:  database system was shut down at 2023-01-22 08:30:48 GMT
2023-01-22 08:30:48.861 GMT [95572] LOG:  database system is ready to accept connections
2023-01-22 08:39:39.993 GMT [95572] LOG:  received fast shutdown request
2023-01-22 08:39:39.994 GMT [95572] LOG:  aborting any active transactions
2023-01-22 08:39:40.002 GMT [95572] LOG:  background worker "logical replication launcher" (PID 95579) exited with exit code 1
2023-01-22 08:39:40.003 GMT [95574] LOG:  shutting down
2023-01-22 08:39:40.017 GMT [95572] LOG:  database system is shut down
2023-01-22 08:39:41.146 GMT [97111] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 08:39:41.147 GMT [97111] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 08:39:41.149 GMT [97111] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 08:39:41.154 GMT [97112] LOG:  database system was shut down at 2023-01-22 08:39:40 GMT
2023-01-22 08:39:41.162 GMT [97111] LOG:  database system is ready to accept connections
2023-01-22 08:39:53.795 GMT [97111] LOG:  received fast shutdown request
2023-01-22 08:39:53.797 GMT [97111] LOG:  aborting any active transactions
2023-01-22 08:39:53.802 GMT [97111] LOG:  background worker "logical replication launcher" (PID 97118) exited with exit code 1
2023-01-22 08:39:53.802 GMT [97113] LOG:  shutting down
2023-01-22 08:39:53.856 GMT [97111] LOG:  database system is shut down
2023-01-22 08:39:54.995 GMT [97260] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 08:39:54.995 GMT [97260] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 08:39:54.997 GMT [97260] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 08:39:55.001 GMT [97261] LOG:  database system was shut down at 2023-01-22 08:39:54 GMT
2023-01-22 08:39:55.007 GMT [97260] LOG:  database system is ready to accept connections
2023-01-22 17:12:39.907 GMT [97260] LOG:  received fast shutdown request
2023-01-22 17:12:39.909 GMT [97260] LOG:  aborting any active transactions
2023-01-22 17:12:39.914 GMT [97260] LOG:  background worker "logical replication launcher" (PID 97267) exited with exit code 1
2023-01-22 17:12:39.916 GMT [97262] LOG:  shutting down
2023-01-22 17:12:39.943 GMT [97260] LOG:  database system is shut down
2023-01-22 17:12:44.606 GMT [138615] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:12:44.607 GMT [138615] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:12:44.609 GMT [138615] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:12:44.616 GMT [138616] LOG:  database system was shut down at 2023-01-22 17:12:44 GMT
2023-01-22 17:12:44.622 GMT [138615] LOG:  database system is ready to accept connections
2023-01-22 17:40:41.061 GMT [138615] LOG:  received fast shutdown request
2023-01-22 17:40:41.064 GMT [138615] LOG:  aborting any active transactions
2023-01-22 17:40:41.071 GMT [138615] LOG:  background worker "logical replication launcher" (PID 138622) exited with exit code 1
2023-01-22 17:40:41.071 GMT [138617] LOG:  shutting down
2023-01-22 17:40:41.090 GMT [138615] LOG:  database system is shut down
2023-01-22 17:40:45.310 GMT [143576] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:40:45.311 GMT [143576] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:40:45.319 GMT [143576] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:40:45.324 GMT [143585] LOG:  database system was shut down at 2023-01-22 17:40:45 GMT
2023-01-22 17:40:45.330 GMT [143576] LOG:  database system is ready to accept connections
2023-01-22 17:40:46.308 GMT [143615] ERROR:  schema "client" does not exist at character 287
2023-01-22 17:40:46.308 GMT [143615] STATEMENT:  CREATE OR REPLACE FUNCTION staff.update_personal_information(first_name_p TEXT, last_name_p TEXT, date_of_birth_p DATE, phone_number_p TEXT, email_address_p TEXT, address_street_p TEXT, address_city_p TEXT, address_county_p TEXT, address_postcode_p TEXT, account_identifier INT DEFAULT client.get_account_id())
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	BEGIN
	    UPDATE customer SET first_name = first_name_p, last_name = last_name_p, date_of_birth = date_of_birth_p, phone_number = phone_number_p, email_address = email_address_p, address_street = address_street_p, address_city = address_city_p, address_county = address_county_p, address_postcode = address_postcode_p
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier);
	
	    -- INSERT INTO management_log (log_description, log_date, account_id) VALUES ('Updated personal information', CURRENT_DATE, account_identifier);
	    passed = TRUE;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-22 17:51:43.428 GMT [143576] LOG:  received fast shutdown request
2023-01-22 17:51:43.429 GMT [143576] LOG:  aborting any active transactions
2023-01-22 17:51:43.432 GMT [143576] LOG:  background worker "logical replication launcher" (PID 143594) exited with exit code 1
2023-01-22 17:51:43.435 GMT [143588] LOG:  shutting down
2023-01-22 17:51:43.452 GMT [143576] LOG:  database system is shut down
2023-01-22 17:51:44.510 GMT [145843] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:51:44.510 GMT [145843] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:51:44.512 GMT [145843] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:51:44.516 GMT [145844] LOG:  database system was shut down at 2023-01-22 17:51:44 GMT
2023-01-22 17:51:44.522 GMT [145843] LOG:  database system is ready to accept connections
2023-01-22 17:51:45.515 GMT [145869] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 17:51:45.515 GMT [145869] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 17:51:45.515 GMT [145869] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 17:56:16.603 GMT [145843] LOG:  received fast shutdown request
2023-01-22 17:56:16.605 GMT [145843] LOG:  aborting any active transactions
2023-01-22 17:56:16.608 GMT [145843] LOG:  background worker "logical replication launcher" (PID 145850) exited with exit code 1
2023-01-22 17:56:16.610 GMT [145845] LOG:  shutting down
2023-01-22 17:56:16.680 GMT [145843] LOG:  database system is shut down
2023-01-22 17:56:17.805 GMT [146730] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:56:17.805 GMT [146730] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:56:17.807 GMT [146730] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:56:17.813 GMT [146731] LOG:  database system was shut down at 2023-01-22 17:56:17 GMT
2023-01-22 17:56:17.818 GMT [146730] LOG:  database system is ready to accept connections
2023-01-22 17:56:19.001 GMT [146759] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 17:56:19.001 GMT [146759] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 17:56:19.001 GMT [146759] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 17:56:19.011 GMT [146759] ERROR:  invalid input syntax for type integer: "t"
2023-01-22 17:56:19.011 GMT [146759] CONTEXT:  PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 17:56:19.011 GMT [146759] STATEMENT:  DO $$
	DECLARE result INT;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 17:57:03.970 GMT [146730] LOG:  received fast shutdown request
2023-01-22 17:57:03.972 GMT [146730] LOG:  aborting any active transactions
2023-01-22 17:57:03.977 GMT [146730] LOG:  background worker "logical replication launcher" (PID 146737) exited with exit code 1
2023-01-22 17:57:03.977 GMT [146732] LOG:  shutting down
2023-01-22 17:57:04.028 GMT [146730] LOG:  database system is shut down
2023-01-22 17:57:05.141 GMT [146957] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:57:05.141 GMT [146957] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:57:05.143 GMT [146957] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:57:05.149 GMT [146958] LOG:  database system was shut down at 2023-01-22 17:57:04 GMT
2023-01-22 17:57:05.155 GMT [146957] LOG:  database system is ready to accept connections
2023-01-22 17:57:06.152 GMT [146983] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 17:57:06.152 GMT [146983] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 17:57:06.152 GMT [146983] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 17:58:35.776 GMT [146957] LOG:  received fast shutdown request
2023-01-22 17:58:35.778 GMT [146957] LOG:  aborting any active transactions
2023-01-22 17:58:35.784 GMT [146957] LOG:  background worker "logical replication launcher" (PID 146964) exited with exit code 1
2023-01-22 17:58:35.785 GMT [146959] LOG:  shutting down
2023-01-22 17:58:35.835 GMT [146957] LOG:  database system is shut down
2023-01-22 17:58:38.464 GMT [147366] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 17:58:38.464 GMT [147366] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 17:58:38.466 GMT [147366] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 17:58:38.472 GMT [147367] LOG:  database system was shut down at 2023-01-22 17:58:35 GMT
2023-01-22 17:58:38.479 GMT [147366] LOG:  database system is ready to accept connections
2023-01-22 17:58:44.820 GMT [147415] FATAL:  password authentication failed for user "parallels"
2023-01-22 17:58:44.820 GMT [147415] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-22 17:58:44.821 GMT [147415] LOG:  could not send data to client: Broken pipe
2023-01-22 17:58:49.975 GMT [147455] FATAL:  password authentication failed for user "parallels"
2023-01-22 17:58:49.975 GMT [147455] DETAIL:  User "parallels" has no password assigned.
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-22 17:58:49.975 GMT [147455] LOG:  could not send data to client: Broken pipe
2023-01-22 17:59:21.686 GMT [147634] FATAL:  password authentication failed for user "johnsmith"
2023-01-22 17:59:21.686 GMT [147634] DETAIL:  Password does not match for user "johnsmith".
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-22 18:04:41.919 GMT [147366] LOG:  received fast shutdown request
2023-01-22 18:04:41.921 GMT [147366] LOG:  aborting any active transactions
2023-01-22 18:04:41.928 GMT [147366] LOG:  background worker "logical replication launcher" (PID 147373) exited with exit code 1
2023-01-22 18:04:41.928 GMT [147368] LOG:  shutting down
2023-01-22 18:04:41.942 GMT [147366] LOG:  database system is shut down
2023-01-22 18:04:43.141 GMT [148703] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:04:43.142 GMT [148703] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:04:43.144 GMT [148703] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:04:43.149 GMT [148704] LOG:  database system was shut down at 2023-01-22 18:04:42 GMT
2023-01-22 18:04:43.156 GMT [148703] LOG:  database system is ready to accept connections
2023-01-22 18:04:44.201 GMT [148732] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:04:44.201 GMT [148732] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:04:44.201 GMT [148732] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:04:44.208 GMT [148732] ERROR:  column reference "password" is ambiguous at character 68
2023-01-22 18:04:44.208 GMT [148732] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-22 18:04:44.208 GMT [148732] QUERY:  UPDATE user_login SET password = create_md5_password(session_user, password)
	    WHERE account_id = account_identifier
2023-01-22 18:04:44.208 GMT [148732] CONTEXT:  PL/pgSQL function client.update_password(text) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:04:44.208 GMT [148732] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:05:17.829 GMT [148703] LOG:  received fast shutdown request
2023-01-22 18:05:17.832 GMT [148703] LOG:  aborting any active transactions
2023-01-22 18:05:17.838 GMT [148703] LOG:  background worker "logical replication launcher" (PID 148710) exited with exit code 1
2023-01-22 18:05:17.840 GMT [148705] LOG:  shutting down
2023-01-22 18:05:17.897 GMT [148703] LOG:  database system is shut down
2023-01-22 18:05:18.979 GMT [148923] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:05:18.979 GMT [148923] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:05:18.980 GMT [148923] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:05:18.987 GMT [148924] LOG:  database system was shut down at 2023-01-22 18:05:18 GMT
2023-01-22 18:05:18.992 GMT [148923] LOG:  database system is ready to accept connections
2023-01-22 18:05:19.809 GMT [148949] ERROR:  "password" is not a known variable at character 259
2023-01-22 18:05:19.809 GMT [148949] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_password(new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE account_identifier INT;
	DECLARE md5_password TEXT;
	DECLARE ROW_COUNT INT;
	
	BEGIN
	    account_identifier = client.get_account_id();
	    password = create_md5_password(session_user, new_password);
	
	    UPDATE user_login SET password = create_md5_password(session_user, md5_password)
	    WHERE account_id = account_identifier;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    EXECUTE 'ALTER USER % SET password '%'', session_user, create_md5_password(session_user, md5_password);
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-22 18:05:20.008 GMT [148949] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:05:20.008 GMT [148949] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:05:20.008 GMT [148949] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:05:20.011 GMT [148949] ERROR:  function client.update_password(text) does not exist at character 25
2023-01-22 18:05:20.011 GMT [148949] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:05:20.011 GMT [148949] QUERY:  result = (SELECT * FROM client.update_password('Password1234'::text))
2023-01-22 18:05:20.011 GMT [148949] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:05:20.011 GMT [148949] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:05:47.934 GMT [148923] LOG:  received fast shutdown request
2023-01-22 18:05:47.936 GMT [148923] LOG:  aborting any active transactions
2023-01-22 18:05:47.939 GMT [148923] LOG:  background worker "logical replication launcher" (PID 148930) exited with exit code 1
2023-01-22 18:05:47.941 GMT [148925] LOG:  shutting down
2023-01-22 18:05:48.003 GMT [148923] LOG:  database system is shut down
2023-01-22 18:05:48.975 GMT [149107] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:05:48.976 GMT [149107] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:05:48.977 GMT [149107] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:05:48.989 GMT [149111] LOG:  database system was shut down at 2023-01-22 18:05:48 GMT
2023-01-22 18:05:48.995 GMT [149107] LOG:  database system is ready to accept connections
2023-01-22 18:05:50.100 GMT [149136] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:05:50.100 GMT [149136] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:05:50.100 GMT [149136] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:05:50.111 GMT [149136] ERROR:  operator is not unique: unknown % unknown at character 29
2023-01-22 18:05:50.111 GMT [149136] HINT:  Could not choose a best candidate operator. You might need to add explicit type casts.
2023-01-22 18:05:50.111 GMT [149136] QUERY:  'ALTER USER % SET password '%'', session_user, create_md5_password(session_user, md5_password)
2023-01-22 18:05:50.111 GMT [149136] CONTEXT:  PL/pgSQL function client.update_password(text) line 14 at EXECUTE
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:05:50.111 GMT [149136] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:08:45.404 GMT [149107] LOG:  received fast shutdown request
2023-01-22 18:08:45.405 GMT [149107] LOG:  aborting any active transactions
2023-01-22 18:08:45.407 GMT [149107] LOG:  background worker "logical replication launcher" (PID 149117) exited with exit code 1
2023-01-22 18:08:45.410 GMT [149112] LOG:  shutting down
2023-01-22 18:08:45.463 GMT [149107] LOG:  database system is shut down
2023-01-22 18:08:46.713 GMT [149717] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:08:46.714 GMT [149717] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:08:46.719 GMT [149717] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:08:46.723 GMT [149718] LOG:  database system was shut down at 2023-01-22 18:08:46 GMT
2023-01-22 18:08:46.730 GMT [149717] LOG:  database system is ready to accept connections
2023-01-22 18:08:47.926 GMT [149743] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:08:47.926 GMT [149743] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:08:47.926 GMT [149743] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:08:47.933 GMT [149743] ERROR:  query returned 3 columns
2023-01-22 18:08:47.933 GMT [149743] CONTEXT:  query: 'ALTER USER % SET password %', session_user, create_md5_password(session_user, md5_password)
	PL/pgSQL function client.update_password(text) line 14 at EXECUTE
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:08:47.933 GMT [149743] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:11:20.200 GMT [149717] LOG:  received fast shutdown request
2023-01-22 18:11:20.202 GMT [149717] LOG:  aborting any active transactions
2023-01-22 18:11:20.205 GMT [149717] LOG:  background worker "logical replication launcher" (PID 149724) exited with exit code 1
2023-01-22 18:11:20.206 GMT [149719] LOG:  shutting down
2023-01-22 18:11:20.252 GMT [149717] LOG:  database system is shut down
2023-01-22 18:11:21.413 GMT [150266] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:11:21.413 GMT [150266] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:11:21.415 GMT [150266] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:11:21.419 GMT [150267] LOG:  database system was shut down at 2023-01-22 18:11:21 GMT
2023-01-22 18:11:21.425 GMT [150266] LOG:  database system is ready to accept connections
2023-01-22 18:11:22.572 GMT [150292] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:11:22.572 GMT [150292] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:11:22.572 GMT [150292] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:11:22.575 GMT [150292] ERROR:  syntax error at or near "'md5e4024b63e04509fbec164bd86de40e4a'" at character 35
2023-01-22 18:11:22.575 GMT [150292] STATEMENT:  ALTER USER johnsmith SET PASSWORD 'md5e4024b63e04509fbec164bd86de40e4a';
2023-01-22 18:11:22.578 GMT [150292] ERROR:  query returned 3 columns
2023-01-22 18:11:22.578 GMT [150292] CONTEXT:  query: 'ALTER USER % SET password %', session_user, create_md5_password(session_user, md5_password)
	PL/pgSQL function client.update_password(text) line 14 at EXECUTE
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:11:22.578 GMT [150292] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:12:04.994 GMT [150266] LOG:  received fast shutdown request
2023-01-22 18:12:04.996 GMT [150266] LOG:  aborting any active transactions
2023-01-22 18:12:05.000 GMT [150266] LOG:  background worker "logical replication launcher" (PID 150273) exited with exit code 1
2023-01-22 18:12:05.000 GMT [150268] LOG:  shutting down
2023-01-22 18:12:05.055 GMT [150266] LOG:  database system is shut down
2023-01-22 18:12:06.188 GMT [150522] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:12:06.188 GMT [150522] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:12:06.190 GMT [150522] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:12:06.195 GMT [150523] LOG:  database system was shut down at 2023-01-22 18:12:05 GMT
2023-01-22 18:12:06.200 GMT [150522] LOG:  database system is ready to accept connections
2023-01-22 18:12:07.325 GMT [150548] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:12:07.325 GMT [150548] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:12:07.325 GMT [150548] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:12:07.329 GMT [150548] ERROR:  syntax error at or near "'md5e4024b63e04509fbec164bd86de40e4a'" at character 35
2023-01-22 18:12:07.329 GMT [150548] STATEMENT:  ALTER USER johnsmith SET PASSWORD 'md5e4024b63e04509fbec164bd86de40e4a';
2023-01-22 18:12:07.335 GMT [150548] ERROR:  query returned 3 columns
2023-01-22 18:12:07.335 GMT [150548] CONTEXT:  query: 'ALTER USER % WITH PASSWORD %', session_user, create_md5_password(session_user, md5_password)
	PL/pgSQL function client.update_password(text) line 14 at EXECUTE
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:12:07.335 GMT [150548] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:12:25.778 GMT [150522] LOG:  received fast shutdown request
2023-01-22 18:12:25.780 GMT [150522] LOG:  aborting any active transactions
2023-01-22 18:12:25.786 GMT [150522] LOG:  background worker "logical replication launcher" (PID 150529) exited with exit code 1
2023-01-22 18:12:25.787 GMT [150524] LOG:  shutting down
2023-01-22 18:12:25.839 GMT [150522] LOG:  database system is shut down
2023-01-22 18:12:26.983 GMT [150686] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:12:26.983 GMT [150686] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:12:26.985 GMT [150686] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:12:26.990 GMT [150687] LOG:  database system was shut down at 2023-01-22 18:12:26 GMT
2023-01-22 18:12:26.995 GMT [150686] LOG:  database system is ready to accept connections
2023-01-22 18:12:28.030 GMT [150712] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:12:28.030 GMT [150712] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:12:28.030 GMT [150712] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:12:28.043 GMT [150712] ERROR:  query returned 3 columns
2023-01-22 18:12:28.043 GMT [150712] CONTEXT:  query: 'ALTER USER % WITH PASSWORD %', session_user, create_md5_password(session_user, md5_password)
	PL/pgSQL function client.update_password(text) line 14 at EXECUTE
	PL/pgSQL assignment "result = (SELECT * FROM client.update_password('Password1234'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:12:28.043 GMT [150712] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:13:10.103 GMT [150686] LOG:  received fast shutdown request
2023-01-22 18:13:10.105 GMT [150686] LOG:  aborting any active transactions
2023-01-22 18:13:10.109 GMT [150686] LOG:  background worker "logical replication launcher" (PID 150693) exited with exit code 1
2023-01-22 18:13:10.110 GMT [150688] LOG:  shutting down
2023-01-22 18:13:10.156 GMT [150686] LOG:  database system is shut down
2023-01-22 18:13:11.244 GMT [150935] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:13:11.245 GMT [150935] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:13:11.247 GMT [150935] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:13:11.252 GMT [150936] LOG:  database system was shut down at 2023-01-22 18:13:10 GMT
2023-01-22 18:13:11.259 GMT [150935] LOG:  database system is ready to accept connections
2023-01-22 18:13:12.105 GMT [150961] ERROR:  syntax error at or near "md5_password" at character 537
2023-01-22 18:13:12.105 GMT [150961] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_password(new_password TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE account_identifier INT;
	DECLARE md5_password TEXT;
	DECLARE ROW_COUNT INT;
	
	BEGIN
	    account_identifier = client.get_account_id();
	    md5_password = create_md5_password(session_user, new_password);
	
	    UPDATE user_login SET password = create_md5_password(session_user, md5_password)
	    WHERE account_id = account_identifier;
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	    ALTER USER session_user WITH PASSWORD md5_password;
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated password', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql SECURITY DEFINER;
2023-01-22 18:13:12.298 GMT [150961] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:13:12.298 GMT [150961] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:13:12.298 GMT [150961] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:13:12.309 GMT [150961] ERROR:  function client.update_password(text) does not exist at character 25
2023-01-22 18:13:12.309 GMT [150961] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:13:12.309 GMT [150961] QUERY:  result = (SELECT * FROM client.update_password('Password1234'::text))
2023-01-22 18:13:12.309 GMT [150961] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:13:12.309 GMT [150961] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_password('Password1234'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:14:02.642 GMT [150935] LOG:  received fast shutdown request
2023-01-22 18:14:02.643 GMT [150935] LOG:  aborting any active transactions
2023-01-22 18:14:02.648 GMT [150935] LOG:  background worker "logical replication launcher" (PID 150942) exited with exit code 1
2023-01-22 18:14:02.649 GMT [150937] LOG:  shutting down
2023-01-22 18:14:02.697 GMT [150935] LOG:  database system is shut down
2023-01-22 18:14:03.904 GMT [151192] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:14:03.904 GMT [151192] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:14:03.906 GMT [151192] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:14:03.911 GMT [151193] LOG:  database system was shut down at 2023-01-22 18:14:03 GMT
2023-01-22 18:14:03.916 GMT [151192] LOG:  database system is ready to accept connections
2023-01-22 18:14:05.117 GMT [151221] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:14:05.117 GMT [151221] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:14:05.117 GMT [151221] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:15:05.835 GMT [151192] LOG:  received fast shutdown request
2023-01-22 18:15:05.838 GMT [151192] LOG:  aborting any active transactions
2023-01-22 18:15:05.842 GMT [151192] LOG:  background worker "logical replication launcher" (PID 151199) exited with exit code 1
2023-01-22 18:15:05.842 GMT [151194] LOG:  shutting down
2023-01-22 18:15:05.895 GMT [151192] LOG:  database system is shut down
2023-01-22 18:15:08.484 GMT [151511] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:15:08.485 GMT [151511] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:15:08.487 GMT [151511] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:15:08.492 GMT [151512] LOG:  database system was shut down at 2023-01-22 18:15:05 GMT
2023-01-22 18:15:08.499 GMT [151511] LOG:  database system is ready to accept connections
2023-01-22 18:15:14.277 GMT [151511] LOG:  received fast shutdown request
2023-01-22 18:15:14.279 GMT [151511] LOG:  aborting any active transactions
2023-01-22 18:15:14.284 GMT [151511] LOG:  background worker "logical replication launcher" (PID 151518) exited with exit code 1
2023-01-22 18:15:14.284 GMT [151513] LOG:  shutting down
2023-01-22 18:15:14.304 GMT [151511] LOG:  database system is shut down
2023-01-22 18:15:31.187 GMT [151678] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:15:31.187 GMT [151678] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:15:31.189 GMT [151678] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:15:31.194 GMT [151679] LOG:  database system was shut down at 2023-01-22 18:15:14 GMT
2023-01-22 18:15:31.200 GMT [151678] LOG:  database system is ready to accept connections
2023-01-22 18:15:55.065 GMT [151875] FATAL:  password authentication failed for user "johnsmith"
2023-01-22 18:15:55.065 GMT [151875] DETAIL:  Password does not match for user "johnsmith".
	Connection matched pg_hba.conf line 89: "local   all             all                                     md5"
2023-01-22 18:16:19.635 GMT [151678] LOG:  received fast shutdown request
2023-01-22 18:16:19.638 GMT [151678] LOG:  aborting any active transactions
2023-01-22 18:16:19.644 GMT [151678] LOG:  background worker "logical replication launcher" (PID 151685) exited with exit code 1
2023-01-22 18:16:19.644 GMT [151680] LOG:  shutting down
2023-01-22 18:16:19.665 GMT [151678] LOG:  database system is shut down
2023-01-22 18:16:20.832 GMT [152029] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:16:20.832 GMT [152029] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:16:20.834 GMT [152029] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:16:20.839 GMT [152030] LOG:  database system was shut down at 2023-01-22 18:16:20 GMT
2023-01-22 18:16:20.846 GMT [152029] LOG:  database system is ready to accept connections
2023-01-22 18:16:21.927 GMT [152058] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:16:21.927 GMT [152058] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:16:21.927 GMT [152058] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:19:23.824 GMT [152029] LOG:  received fast shutdown request
2023-01-22 18:19:23.826 GMT [152029] LOG:  aborting any active transactions
2023-01-22 18:19:23.829 GMT [152029] LOG:  background worker "logical replication launcher" (PID 152036) exited with exit code 1
2023-01-22 18:19:23.830 GMT [152031] LOG:  shutting down
2023-01-22 18:19:23.878 GMT [152029] LOG:  database system is shut down
2023-01-22 18:19:25.054 GMT [152696] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:19:25.055 GMT [152696] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:19:25.057 GMT [152696] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:19:25.062 GMT [152697] LOG:  database system was shut down at 2023-01-22 18:19:24 GMT
2023-01-22 18:19:25.068 GMT [152696] LOG:  database system is ready to accept connections
2023-01-22 18:19:26.222 GMT [152722] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:19:26.222 GMT [152722] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:19:26.222 GMT [152722] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:19:26.242 GMT [152722] ERROR:  column "email" of relation "user_login" does not exist at character 23
2023-01-22 18:19:26.242 GMT [152722] QUERY:  UPDATE user_login SET email = new_email
	    WHERE account_id = account_identifier
2023-01-22 18:19:26.242 GMT [152722] CONTEXT:  PL/pgSQL function client.update_email(text) line 9 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.update_email('example@email.com'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:19:26.242 GMT [152722] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_email('example@email.com'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:20:46.944 GMT [152696] LOG:  received fast shutdown request
2023-01-22 18:20:46.946 GMT [152696] LOG:  aborting any active transactions
2023-01-22 18:20:46.951 GMT [152696] LOG:  background worker "logical replication launcher" (PID 152703) exited with exit code 1
2023-01-22 18:20:46.952 GMT [152698] LOG:  shutting down
2023-01-22 18:20:47.002 GMT [152696] LOG:  database system is shut down
2023-01-22 18:20:48.134 GMT [153071] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:20:48.134 GMT [153071] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:20:48.137 GMT [153071] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:20:48.142 GMT [153072] LOG:  database system was shut down at 2023-01-22 18:20:47 GMT
2023-01-22 18:20:48.148 GMT [153071] LOG:  database system is ready to accept connections
2023-01-22 18:20:49.057 GMT [153097] ERROR:  syntax error at or near "INNER" at character 278
2023-01-22 18:20:49.057 GMT [153097] STATEMENT:  CREATE OR REPLACE FUNCTION client.update_email(new_email TEXT)
	RETURNS BOOLEAN AS $$
	DECLARE passed BOOLEAN;
	DECLARE account_identifier INT;
	DECLARE ROW_COUNT INT;
	BEGIN
	
	    account_identifier = client.get_account_id();
	
	    UPDATE customer SET customer.email = new_email
	    INNER JOIN online_account ON customer.id = online_account.customer_id
	    WHERE online_account.account_id = account_identifier;
	
	    GET DIAGNOSTICS ROW_COUNT = ROW_COUNT;
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Updated email', CURRENT_DATE);
	    passed = CASE WHEN ROW_COUNT = 1 THEN TRUE ELSE FALSE END;
	    RETURN passed;
	END;
	$$ LANGUAGE plpgsql;
2023-01-22 18:20:49.224 GMT [153097] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:20:49.224 GMT [153097] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:20:49.224 GMT [153097] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:20:49.232 GMT [153097] ERROR:  function client.update_email(text) does not exist at character 25
2023-01-22 18:20:49.232 GMT [153097] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:20:49.232 GMT [153097] QUERY:  result = (SELECT * FROM client.update_email('example@email.com'::text))
2023-01-22 18:20:49.232 GMT [153097] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:20:49.232 GMT [153097] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_email('example@email.com'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:22:52.219 GMT [153071] LOG:  received fast shutdown request
2023-01-22 18:22:52.221 GMT [153071] LOG:  aborting any active transactions
2023-01-22 18:22:52.227 GMT [153071] LOG:  background worker "logical replication launcher" (PID 153078) exited with exit code 1
2023-01-22 18:22:52.227 GMT [153073] LOG:  shutting down
2023-01-22 18:22:52.273 GMT [153071] LOG:  database system is shut down
2023-01-22 18:22:53.381 GMT [153539] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:22:53.381 GMT [153539] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:22:53.383 GMT [153539] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:22:53.388 GMT [153540] LOG:  database system was shut down at 2023-01-22 18:22:53 GMT
2023-01-22 18:22:53.394 GMT [153539] LOG:  database system is ready to accept connections
2023-01-22 18:22:54.515 GMT [153567] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:22:54.515 GMT [153567] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:22:54.515 GMT [153567] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:22:54.526 GMT [153567] ERROR:  column "customer" of relation "customer" does not exist at character 21
2023-01-22 18:22:54.526 GMT [153567] QUERY:  UPDATE customer SET customer.email = new_email
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)
2023-01-22 18:22:54.526 GMT [153567] CONTEXT:  PL/pgSQL function client.update_email(text) line 9 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.update_email('example@email.com'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:22:54.526 GMT [153567] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_email('example@email.com'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:23:10.612 GMT [153539] LOG:  received fast shutdown request
2023-01-22 18:23:10.615 GMT [153539] LOG:  aborting any active transactions
2023-01-22 18:23:10.617 GMT [153539] LOG:  background worker "logical replication launcher" (PID 153546) exited with exit code 1
2023-01-22 18:23:10.620 GMT [153541] LOG:  shutting down
2023-01-22 18:23:10.671 GMT [153539] LOG:  database system is shut down
2023-01-22 18:23:11.893 GMT [153701] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:23:11.893 GMT [153701] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:23:11.896 GMT [153701] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:23:11.903 GMT [153702] LOG:  database system was shut down at 2023-01-22 18:23:11 GMT
2023-01-22 18:23:11.911 GMT [153701] LOG:  database system is ready to accept connections
2023-01-22 18:23:13.047 GMT [153730] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:23:13.047 GMT [153730] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:23:13.047 GMT [153730] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:23:13.057 GMT [153730] ERROR:  column "email" of relation "customer" does not exist at character 21
2023-01-22 18:23:13.057 GMT [153730] QUERY:  UPDATE customer SET email = new_email
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)
2023-01-22 18:23:13.057 GMT [153730] CONTEXT:  PL/pgSQL function client.update_email(text) line 9 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.update_email('example@email.com'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:23:13.057 GMT [153730] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_email('example@email.com'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:23:37.574 GMT [153701] LOG:  received fast shutdown request
2023-01-22 18:23:37.576 GMT [153701] LOG:  aborting any active transactions
2023-01-22 18:23:37.581 GMT [153701] LOG:  background worker "logical replication launcher" (PID 153708) exited with exit code 1
2023-01-22 18:23:37.581 GMT [153703] LOG:  shutting down
2023-01-22 18:23:37.637 GMT [153701] LOG:  database system is shut down
2023-01-22 18:23:38.773 GMT [153883] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:23:38.773 GMT [153883] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:23:38.776 GMT [153883] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:23:38.781 GMT [153884] LOG:  database system was shut down at 2023-01-22 18:23:38 GMT
2023-01-22 18:23:38.788 GMT [153883] LOG:  database system is ready to accept connections
2023-01-22 18:23:39.845 GMT [153909] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:23:39.845 GMT [153909] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:23:39.845 GMT [153909] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:23:39.852 GMT [153909] ERROR:  permission denied for table customer
2023-01-22 18:23:39.852 GMT [153909] CONTEXT:  SQL statement "UPDATE customer SET email_address = new_email
	    WHERE id = (SELECT customer_id FROM online_account WHERE id = account_identifier)"
	PL/pgSQL function client.update_email(text) line 9 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.update_email('example@email.com'::text))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:23:39.852 GMT [153909] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.update_email('example@email.com'::text));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:23:47.319 GMT [153883] LOG:  received fast shutdown request
2023-01-22 18:23:47.321 GMT [153883] LOG:  aborting any active transactions
2023-01-22 18:23:47.330 GMT [153883] LOG:  background worker "logical replication launcher" (PID 153890) exited with exit code 1
2023-01-22 18:23:47.330 GMT [153885] LOG:  shutting down
2023-01-22 18:23:47.390 GMT [153883] LOG:  database system is shut down
2023-01-22 18:23:48.500 GMT [154021] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:23:48.500 GMT [154021] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:23:48.502 GMT [154021] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:23:48.507 GMT [154022] LOG:  database system was shut down at 2023-01-22 18:23:48 GMT
2023-01-22 18:23:48.515 GMT [154021] LOG:  database system is ready to accept connections
2023-01-22 18:23:49.493 GMT [154047] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:23:49.493 GMT [154047] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:23:49.493 GMT [154047] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:29:35.667 GMT [154436] ERROR:  permission denied to set role "postgres"
2023-01-22 18:29:35.667 GMT [154436] STATEMENT:  SET ROLE postgres;
2023-01-22 18:29:54.532 GMT [154436] ERROR:  permission denied to set session authorization
2023-01-22 18:29:54.532 GMT [154436] STATEMENT:  SET SESSION AUTHORIZATION janedoe;
2023-01-22 18:35:32.160 GMT [154021] LOG:  received fast shutdown request
2023-01-22 18:35:32.162 GMT [154021] LOG:  aborting any active transactions
2023-01-22 18:35:32.167 GMT [154021] LOG:  background worker "logical replication launcher" (PID 154028) exited with exit code 1
2023-01-22 18:35:32.167 GMT [154023] LOG:  shutting down
2023-01-22 18:35:32.184 GMT [154021] LOG:  database system is shut down
2023-01-22 18:35:33.872 GMT [156296] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:35:33.873 GMT [156296] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:35:33.875 GMT [156296] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:35:33.881 GMT [156297] LOG:  database system was shut down at 2023-01-22 18:35:33 GMT
2023-01-22 18:35:33.887 GMT [156296] LOG:  database system is ready to accept connections
2023-01-22 18:35:35.188 GMT [156335] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:35:35.188 GMT [156335] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:35:35.188 GMT [156335] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:36:46.551 GMT [156296] LOG:  received fast shutdown request
2023-01-22 18:36:46.552 GMT [156296] LOG:  aborting any active transactions
2023-01-22 18:36:46.560 GMT [156296] LOG:  background worker "logical replication launcher" (PID 156303) exited with exit code 1
2023-01-22 18:36:46.561 GMT [156298] LOG:  shutting down
2023-01-22 18:36:46.620 GMT [156296] LOG:  database system is shut down
2023-01-22 18:36:47.850 GMT [156642] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:36:47.850 GMT [156642] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:36:47.852 GMT [156642] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:36:47.856 GMT [156643] LOG:  database system was shut down at 2023-01-22 18:36:47 GMT
2023-01-22 18:36:47.863 GMT [156642] LOG:  database system is ready to accept connections
2023-01-22 18:36:49.030 GMT [156668] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:36:49.030 GMT [156668] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:36:49.030 GMT [156668] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:40:05.139 GMT [156642] LOG:  received fast shutdown request
2023-01-22 18:40:05.141 GMT [156642] LOG:  aborting any active transactions
2023-01-22 18:40:05.145 GMT [156642] LOG:  background worker "logical replication launcher" (PID 156649) exited with exit code 1
2023-01-22 18:40:05.146 GMT [156644] LOG:  shutting down
2023-01-22 18:40:05.203 GMT [156642] LOG:  database system is shut down
2023-01-22 18:40:06.254 GMT [157309] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:40:06.255 GMT [157309] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:40:06.257 GMT [157309] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:40:06.262 GMT [157310] LOG:  database system was shut down at 2023-01-22 18:40:05 GMT
2023-01-22 18:40:06.270 GMT [157309] LOG:  database system is ready to accept connections
2023-01-22 18:40:07.423 GMT [157335] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:40:07.423 GMT [157335] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:40:07.423 GMT [157335] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:41:34.837 GMT [157309] LOG:  received fast shutdown request
2023-01-22 18:41:34.839 GMT [157309] LOG:  aborting any active transactions
2023-01-22 18:41:34.844 GMT [157309] LOG:  background worker "logical replication launcher" (PID 157316) exited with exit code 1
2023-01-22 18:41:34.845 GMT [157311] LOG:  shutting down
2023-01-22 18:41:34.908 GMT [157309] LOG:  database system is shut down
2023-01-22 18:41:36.024 GMT [157673] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:41:36.024 GMT [157673] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:41:36.026 GMT [157673] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:41:36.031 GMT [157674] LOG:  database system was shut down at 2023-01-22 18:41:35 GMT
2023-01-22 18:41:36.037 GMT [157673] LOG:  database system is ready to accept connections
2023-01-22 18:41:37.138 GMT [157699] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:41:37.138 GMT [157699] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:41:37.138 GMT [157699] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:41:37.167 GMT [157699] ERROR:  function client.start_loan(numeric, integer) does not exist at character 25
2023-01-22 18:41:37.167 GMT [157699] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:41:37.167 GMT [157699] QUERY:  result = (SELECT * FROM client.start_loan(1000.00, 12))
2023-01-22 18:41:37.167 GMT [157699] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:41:37.167 GMT [157699] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.start_loan(1000.00, 12));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:41:50.019 GMT [157673] LOG:  received fast shutdown request
2023-01-22 18:41:50.021 GMT [157673] LOG:  aborting any active transactions
2023-01-22 18:41:50.025 GMT [157673] LOG:  background worker "logical replication launcher" (PID 157680) exited with exit code 1
2023-01-22 18:41:50.028 GMT [157675] LOG:  shutting down
2023-01-22 18:41:50.081 GMT [157673] LOG:  database system is shut down
2023-01-22 18:41:51.230 GMT [157825] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:41:51.230 GMT [157825] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:41:51.232 GMT [157825] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:41:51.241 GMT [157826] LOG:  database system was shut down at 2023-01-22 18:41:50 GMT
2023-01-22 18:41:51.248 GMT [157825] LOG:  database system is ready to accept connections
2023-01-22 18:41:52.398 GMT [157851] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:41:52.398 GMT [157851] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:41:52.398 GMT [157851] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:41:52.434 GMT [157851] ERROR:  function client.open_loan(numeric, integer) does not exist at character 25
2023-01-22 18:41:52.434 GMT [157851] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:41:52.434 GMT [157851] QUERY:  result = (SELECT * FROM client.open_loan(1000.00, 12))
2023-01-22 18:41:52.434 GMT [157851] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:41:52.434 GMT [157851] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.open_loan(1000.00, 12));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:42:56.981 GMT [157825] LOG:  received fast shutdown request
2023-01-22 18:42:56.983 GMT [157825] LOG:  aborting any active transactions
2023-01-22 18:42:56.991 GMT [157825] LOG:  background worker "logical replication launcher" (PID 157832) exited with exit code 1
2023-01-22 18:42:56.991 GMT [157827] LOG:  shutting down
2023-01-22 18:42:57.049 GMT [157825] LOG:  database system is shut down
2023-01-22 18:42:58.284 GMT [158156] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:42:58.285 GMT [158156] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:42:58.286 GMT [158156] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:42:58.296 GMT [158157] LOG:  database system was shut down at 2023-01-22 18:42:58 GMT
2023-01-22 18:42:58.304 GMT [158156] LOG:  database system is ready to accept connections
2023-01-22 18:42:59.519 GMT [158185] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:42:59.519 GMT [158185] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:42:59.519 GMT [158185] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:42:59.549 GMT [158185] ERROR:  function client.open_loan(numeric, integer, unknown, numeric) does not exist at character 25
2023-01-22 18:42:59.549 GMT [158185] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:42:59.549 GMT [158185] QUERY:  result = (SELECT * FROM client.open_loan(1000.00, 22-12-2025, 'VEHICLE', 29.9))
2023-01-22 18:42:59.549 GMT [158185] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:42:59.549 GMT [158185] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.open_loan(1000.00, 22-12-2025, 'VEHICLE', 29.9));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:43:17.644 GMT [158156] LOG:  received fast shutdown request
2023-01-22 18:43:17.646 GMT [158156] LOG:  aborting any active transactions
2023-01-22 18:43:17.650 GMT [158156] LOG:  background worker "logical replication launcher" (PID 158163) exited with exit code 1
2023-01-22 18:43:17.650 GMT [158158] LOG:  shutting down
2023-01-22 18:43:17.711 GMT [158156] LOG:  database system is shut down
2023-01-22 18:43:18.900 GMT [158329] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:43:18.901 GMT [158329] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:43:18.902 GMT [158329] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:43:18.908 GMT [158330] LOG:  database system was shut down at 2023-01-22 18:43:18 GMT
2023-01-22 18:43:18.915 GMT [158329] LOG:  database system is ready to accept connections
2023-01-22 18:43:19.955 GMT [158355] ERROR:  function client.open_savings_account(integer) does not exist at character 15
2023-01-22 18:43:19.955 GMT [158355] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-22 18:43:19.955 GMT [158355] STATEMENT:  SELECT * FROM client.open_savings_account(1);
2023-01-22 18:46:05.302 GMT [158329] LOG:  received fast shutdown request
2023-01-22 18:46:05.304 GMT [158329] LOG:  aborting any active transactions
2023-01-22 18:46:05.310 GMT [158329] LOG:  background worker "logical replication launcher" (PID 158336) exited with exit code 1
2023-01-22 18:46:05.310 GMT [158331] LOG:  shutting down
2023-01-22 18:46:05.367 GMT [158329] LOG:  database system is shut down
2023-01-22 18:46:06.515 GMT [158944] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:46:06.515 GMT [158944] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:46:06.516 GMT [158944] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:46:06.522 GMT [158945] LOG:  database system was shut down at 2023-01-22 18:46:06 GMT
2023-01-22 18:46:06.528 GMT [158944] LOG:  database system is ready to accept connections
2023-01-22 18:46:07.611 GMT [158973] ERROR:  subquery must return only one column at character 10
2023-01-22 18:46:07.611 GMT [158973] QUERY:  result = (SELECT * FROM client.view_accounts())
2023-01-22 18:46:07.611 GMT [158973] CONTEXT:  PL/pgSQL function inline_code_block line 4 at assignment
2023-01-22 18:46:07.611 GMT [158973] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.view_accounts());
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:46:38.795 GMT [158944] LOG:  received fast shutdown request
2023-01-22 18:46:38.796 GMT [158944] LOG:  aborting any active transactions
2023-01-22 18:46:38.804 GMT [158944] LOG:  background worker "logical replication launcher" (PID 158951) exited with exit code 1
2023-01-22 18:46:38.804 GMT [158946] LOG:  shutting down
2023-01-22 18:46:38.857 GMT [158944] LOG:  database system is shut down
2023-01-22 18:46:39.952 GMT [159150] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:46:39.953 GMT [159150] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:46:39.954 GMT [159150] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:46:39.959 GMT [159151] LOG:  database system was shut down at 2023-01-22 18:46:39 GMT
2023-01-22 18:46:39.966 GMT [159150] LOG:  database system is ready to accept connections
2023-01-22 18:46:41.023 GMT [159179] ERROR:  query has no destination for result data
2023-01-22 18:46:41.023 GMT [159179] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-22 18:46:41.023 GMT [159179] CONTEXT:  PL/pgSQL function inline_code_block line 3 at SQL statement
2023-01-22 18:46:41.023 GMT [159179] STATEMENT:  DO $$
	BEGIN
	    SELECT * FROM client.view_accounts();
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-22 18:47:56.486 GMT [159150] LOG:  received fast shutdown request
2023-01-22 18:47:56.487 GMT [159150] LOG:  aborting any active transactions
2023-01-22 18:47:56.493 GMT [159150] LOG:  background worker "logical replication launcher" (PID 159157) exited with exit code 1
2023-01-22 18:47:56.493 GMT [159152] LOG:  shutting down
2023-01-22 18:47:56.556 GMT [159150] LOG:  database system is shut down
2023-01-22 18:47:57.633 GMT [159472] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:47:57.633 GMT [159472] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:47:57.635 GMT [159472] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:47:57.642 GMT [159473] LOG:  database system was shut down at 2023-01-22 18:47:57 GMT
2023-01-22 18:47:57.651 GMT [159472] LOG:  database system is ready to accept connections
2023-01-22 18:48:58.290 GMT [159472] LOG:  received fast shutdown request
2023-01-22 18:48:58.292 GMT [159472] LOG:  aborting any active transactions
2023-01-22 18:48:58.297 GMT [159472] LOG:  background worker "logical replication launcher" (PID 159479) exited with exit code 1
2023-01-22 18:48:58.297 GMT [159474] LOG:  shutting down
2023-01-22 18:48:58.351 GMT [159472] LOG:  database system is shut down
2023-01-22 18:48:59.411 GMT [159760] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:48:59.411 GMT [159760] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:48:59.413 GMT [159760] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:48:59.418 GMT [159761] LOG:  database system was shut down at 2023-01-22 18:48:59 GMT
2023-01-22 18:48:59.424 GMT [159760] LOG:  database system is ready to accept connections
2023-01-22 18:51:14.046 GMT [159760] LOG:  received fast shutdown request
2023-01-22 18:51:14.047 GMT [159760] LOG:  aborting any active transactions
2023-01-22 18:51:14.050 GMT [159760] LOG:  background worker "logical replication launcher" (PID 159767) exited with exit code 1
2023-01-22 18:51:14.053 GMT [159762] LOG:  shutting down
2023-01-22 18:51:14.124 GMT [159760] LOG:  database system is shut down
2023-01-22 18:51:15.161 GMT [160241] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 18:51:15.161 GMT [160241] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 18:51:15.163 GMT [160241] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 18:51:15.169 GMT [160242] LOG:  database system was shut down at 2023-01-22 18:51:14 GMT
2023-01-22 18:51:15.175 GMT [160241] LOG:  database system is ready to accept connections
2023-01-22 19:00:40.583 GMT [160241] LOG:  received fast shutdown request
2023-01-22 19:00:40.585 GMT [160241] LOG:  aborting any active transactions
2023-01-22 19:00:40.587 GMT [160241] LOG:  background worker "logical replication launcher" (PID 160248) exited with exit code 1
2023-01-22 19:00:40.591 GMT [160243] LOG:  shutting down
2023-01-22 19:00:40.606 GMT [160241] LOG:  database system is shut down
2023-01-22 19:00:41.935 GMT [161894] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:00:41.935 GMT [161894] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:00:41.937 GMT [161894] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:00:41.942 GMT [161895] LOG:  database system was shut down at 2023-01-22 19:00:41 GMT
2023-01-22 19:00:41.948 GMT [161894] LOG:  database system is ready to accept connections
2023-01-22 19:00:43.108 GMT [161923] ERROR:  column reference "account_id" is ambiguous at character 43
2023-01-22 19:00:43.108 GMT [161923] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-22 19:00:43.108 GMT [161923] QUERY:  SELECT * FROM client.debit_accounts WHERE account_id = account_id
2023-01-22 19:00:43.108 GMT [161923] CONTEXT:  PL/pgSQL function view_debit_accounts() line 9 at RETURN QUERY
2023-01-22 19:00:43.108 GMT [161923] STATEMENT:  SELECT * FROM client.view_debit_accounts();
2023-01-22 19:02:12.183 GMT [161894] LOG:  received fast shutdown request
2023-01-22 19:02:12.185 GMT [161894] LOG:  aborting any active transactions
2023-01-22 19:02:12.189 GMT [161894] LOG:  background worker "logical replication launcher" (PID 161901) exited with exit code 1
2023-01-22 19:02:12.190 GMT [161896] LOG:  shutting down
2023-01-22 19:02:12.242 GMT [161894] LOG:  database system is shut down
2023-01-22 19:02:13.353 GMT [162251] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:02:13.353 GMT [162251] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:02:13.355 GMT [162251] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:02:13.363 GMT [162252] LOG:  database system was shut down at 2023-01-22 19:02:13 GMT
2023-01-22 19:02:13.368 GMT [162251] LOG:  database system is ready to accept connections
2023-01-22 19:02:14.528 GMT [162277] ERROR:  structure of query does not match function result type
2023-01-22 19:02:14.528 GMT [162277] DETAIL:  Returned type integer does not match expected type numeric in column 2.
2023-01-22 19:02:14.528 GMT [162277] CONTEXT:  SQL statement "SELECT * FROM client.debit_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_debit_accounts() line 9 at RETURN QUERY
2023-01-22 19:02:14.528 GMT [162277] STATEMENT:  SELECT * FROM client.view_debit_accounts();
2023-01-22 19:03:43.997 GMT [162251] LOG:  received fast shutdown request
2023-01-22 19:03:43.999 GMT [162251] LOG:  aborting any active transactions
2023-01-22 19:03:44.005 GMT [162251] LOG:  background worker "logical replication launcher" (PID 162258) exited with exit code 1
2023-01-22 19:03:44.007 GMT [162253] LOG:  shutting down
2023-01-22 19:03:44.068 GMT [162251] LOG:  database system is shut down
2023-01-22 19:03:45.207 GMT [162647] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:03:45.208 GMT [162647] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:03:45.210 GMT [162647] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:03:45.215 GMT [162648] LOG:  database system was shut down at 2023-01-22 19:03:44 GMT
2023-01-22 19:03:45.221 GMT [162647] LOG:  database system is ready to accept connections
2023-01-22 19:03:46.289 GMT [162673] ERROR:  structure of query does not match function result type
2023-01-22 19:03:46.289 GMT [162673] DETAIL:  Returned type boolean does not match expected type integer in column 8.
2023-01-22 19:03:46.289 GMT [162673] CONTEXT:  SQL statement "SELECT * FROM client.debit_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_debit_accounts() line 9 at RETURN QUERY
2023-01-22 19:03:46.289 GMT [162673] STATEMENT:  SELECT * FROM client.view_debit_accounts();
2023-01-22 19:04:04.396 GMT [162647] LOG:  received fast shutdown request
2023-01-22 19:04:04.397 GMT [162647] LOG:  aborting any active transactions
2023-01-22 19:04:04.404 GMT [162647] LOG:  background worker "logical replication launcher" (PID 162654) exited with exit code 1
2023-01-22 19:04:04.405 GMT [162649] LOG:  shutting down
2023-01-22 19:04:04.465 GMT [162647] LOG:  database system is shut down
2023-01-22 19:04:05.637 GMT [162812] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:04:05.638 GMT [162812] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:04:05.639 GMT [162812] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:04:05.644 GMT [162813] LOG:  database system was shut down at 2023-01-22 19:04:05 GMT
2023-01-22 19:04:05.650 GMT [162812] LOG:  database system is ready to accept connections
2023-01-22 19:04:06.707 GMT [162841] ERROR:  structure of query does not match function result type
2023-01-22 19:04:06.707 GMT [162841] DETAIL:  Returned type boolean does not match expected type integer in column 8.
2023-01-22 19:04:06.707 GMT [162841] CONTEXT:  SQL statement "SELECT * FROM client.debit_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_debit_accounts() line 9 at RETURN QUERY
2023-01-22 19:04:06.707 GMT [162841] STATEMENT:  SELECT * FROM client.view_debit_accounts();
2023-01-22 19:04:40.506 GMT [162812] LOG:  received fast shutdown request
2023-01-22 19:04:40.509 GMT [162812] LOG:  aborting any active transactions
2023-01-22 19:04:40.512 GMT [162812] LOG:  background worker "logical replication launcher" (PID 162819) exited with exit code 1
2023-01-22 19:04:40.514 GMT [162814] LOG:  shutting down
2023-01-22 19:04:40.573 GMT [162812] LOG:  database system is shut down
2023-01-22 19:04:41.803 GMT [163026] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:04:41.803 GMT [163026] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:04:41.805 GMT [163026] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:04:41.814 GMT [163027] LOG:  database system was shut down at 2023-01-22 19:04:41 GMT
2023-01-22 19:04:41.822 GMT [163026] LOG:  database system is ready to accept connections
2023-01-22 19:13:56.713 GMT [163026] LOG:  received fast shutdown request
2023-01-22 19:13:56.715 GMT [163026] LOG:  aborting any active transactions
2023-01-22 19:13:56.719 GMT [163026] LOG:  background worker "logical replication launcher" (PID 163033) exited with exit code 1
2023-01-22 19:13:56.720 GMT [163028] LOG:  shutting down
2023-01-22 19:13:56.740 GMT [163026] LOG:  database system is shut down
2023-01-22 19:13:57.843 GMT [164600] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:13:57.843 GMT [164600] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:13:57.845 GMT [164600] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:13:57.850 GMT [164601] LOG:  database system was shut down at 2023-01-22 19:13:57 GMT
2023-01-22 19:13:57.858 GMT [164600] LOG:  database system is ready to accept connections
2023-01-22 19:13:58.945 GMT [164630] ERROR:  column reference "account_id" is ambiguous at character 44
2023-01-22 19:13:58.945 GMT [164630] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-22 19:13:58.945 GMT [164630] QUERY:  SELECT * FROM client.credit_accounts WHERE account_id = account_id
2023-01-22 19:13:58.945 GMT [164630] CONTEXT:  PL/pgSQL function view_credit_accounts() line 9 at RETURN QUERY
2023-01-22 19:13:58.945 GMT [164630] STATEMENT:  SELECT * FROM client.view_credit_accounts();
2023-01-22 19:14:56.163 GMT [164600] LOG:  received fast shutdown request
2023-01-22 19:14:56.164 GMT [164600] LOG:  aborting any active transactions
2023-01-22 19:14:56.168 GMT [164600] LOG:  background worker "logical replication launcher" (PID 164607) exited with exit code 1
2023-01-22 19:14:56.169 GMT [164602] LOG:  shutting down
2023-01-22 19:14:56.225 GMT [164600] LOG:  database system is shut down
2023-01-22 19:14:57.342 GMT [164881] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:14:57.342 GMT [164881] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:14:57.343 GMT [164881] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:14:57.348 GMT [164882] LOG:  database system was shut down at 2023-01-22 19:14:57 GMT
2023-01-22 19:14:57.361 GMT [164881] LOG:  database system is ready to accept connections
2023-01-22 19:14:58.528 GMT [164910] ERROR:  structure of query does not match function result type
2023-01-22 19:14:58.528 GMT [164910] DETAIL:  Returned type integer does not match expected type numeric in column 2.
2023-01-22 19:14:58.528 GMT [164910] CONTEXT:  SQL statement "SELECT * FROM client.credit_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_credit_accounts() line 9 at RETURN QUERY
2023-01-22 19:14:58.528 GMT [164910] STATEMENT:  SELECT * FROM client.view_credit_accounts();
2023-01-22 19:15:46.799 GMT [164881] LOG:  received fast shutdown request
2023-01-22 19:15:46.800 GMT [164881] LOG:  aborting any active transactions
2023-01-22 19:15:46.806 GMT [164881] LOG:  background worker "logical replication launcher" (PID 164888) exited with exit code 1
2023-01-22 19:15:46.807 GMT [164883] LOG:  shutting down
2023-01-22 19:15:46.860 GMT [164881] LOG:  database system is shut down
2023-01-22 19:15:48.064 GMT [165133] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:15:48.064 GMT [165133] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:15:48.065 GMT [165133] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:15:48.071 GMT [165134] LOG:  database system was shut down at 2023-01-22 19:15:47 GMT
2023-01-22 19:15:48.078 GMT [165133] LOG:  database system is ready to accept connections
2023-01-22 19:15:49.214 GMT [165159] ERROR:  structure of query does not match function result type
2023-01-22 19:15:49.214 GMT [165159] DETAIL:  Returned type character varying does not match expected type text in column 6.
2023-01-22 19:15:49.214 GMT [165159] CONTEXT:  SQL statement "SELECT * FROM client.credit_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_credit_accounts() line 9 at RETURN QUERY
2023-01-22 19:15:49.214 GMT [165159] STATEMENT:  SELECT * FROM client.view_credit_accounts();
2023-01-22 19:16:21.495 GMT [165133] LOG:  received fast shutdown request
2023-01-22 19:16:21.496 GMT [165133] LOG:  aborting any active transactions
2023-01-22 19:16:21.501 GMT [165133] LOG:  background worker "logical replication launcher" (PID 165140) exited with exit code 1
2023-01-22 19:16:21.501 GMT [165135] LOG:  shutting down
2023-01-22 19:16:21.559 GMT [165133] LOG:  database system is shut down
2023-01-22 19:16:22.762 GMT [165340] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:16:22.763 GMT [165340] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:16:22.764 GMT [165340] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:16:22.769 GMT [165341] LOG:  database system was shut down at 2023-01-22 19:16:22 GMT
2023-01-22 19:16:22.774 GMT [165340] LOG:  database system is ready to accept connections
2023-01-22 19:19:38.621 GMT [165340] LOG:  received fast shutdown request
2023-01-22 19:19:38.622 GMT [165340] LOG:  aborting any active transactions
2023-01-22 19:19:38.629 GMT [165340] LOG:  background worker "logical replication launcher" (PID 165347) exited with exit code 1
2023-01-22 19:19:38.629 GMT [165342] LOG:  shutting down
2023-01-22 19:19:38.697 GMT [165340] LOG:  database system is shut down
2023-01-22 19:19:40.039 GMT [166005] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:19:40.040 GMT [166005] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:19:40.042 GMT [166005] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:19:40.047 GMT [166006] LOG:  database system was shut down at 2023-01-22 19:19:39 GMT
2023-01-22 19:19:40.053 GMT [166005] LOG:  database system is ready to accept connections
2023-01-22 19:19:41.274 GMT [166048] ERROR:  column reference "account_id" is ambiguous at character 45
2023-01-22 19:19:41.274 GMT [166048] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-22 19:19:41.274 GMT [166048] QUERY:  SELECT * FROM client.savings_accounts WHERE account_id = account_id
2023-01-22 19:19:41.274 GMT [166048] CONTEXT:  PL/pgSQL function view_savings_accounts() line 9 at RETURN QUERY
2023-01-22 19:19:41.274 GMT [166048] STATEMENT:  SELECT * FROM client.view_savings_accounts();
2023-01-22 19:19:59.582 GMT [166005] LOG:  received fast shutdown request
2023-01-22 19:19:59.583 GMT [166005] LOG:  aborting any active transactions
2023-01-22 19:19:59.587 GMT [166005] LOG:  background worker "logical replication launcher" (PID 166012) exited with exit code 1
2023-01-22 19:19:59.588 GMT [166007] LOG:  shutting down
2023-01-22 19:19:59.647 GMT [166005] LOG:  database system is shut down
2023-01-22 19:20:00.763 GMT [166199] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:20:00.764 GMT [166199] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:20:00.766 GMT [166199] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:20:00.771 GMT [166200] LOG:  database system was shut down at 2023-01-22 19:20:00 GMT
2023-01-22 19:20:00.776 GMT [166199] LOG:  database system is ready to accept connections
2023-01-22 19:20:01.923 GMT [166229] ERROR:  structure of query does not match function result type
2023-01-22 19:20:01.923 GMT [166229] DETAIL:  Returned type integer does not match expected type numeric in column 2.
2023-01-22 19:20:01.923 GMT [166229] CONTEXT:  SQL statement "SELECT * FROM client.savings_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_savings_accounts() line 9 at RETURN QUERY
2023-01-22 19:20:01.923 GMT [166229] STATEMENT:  SELECT * FROM client.view_savings_accounts();
2023-01-22 19:20:15.774 GMT [166199] LOG:  received fast shutdown request
2023-01-22 19:20:15.776 GMT [166199] LOG:  aborting any active transactions
2023-01-22 19:20:15.783 GMT [166199] LOG:  background worker "logical replication launcher" (PID 166206) exited with exit code 1
2023-01-22 19:20:15.783 GMT [166201] LOG:  shutting down
2023-01-22 19:20:15.835 GMT [166199] LOG:  database system is shut down
2023-01-22 19:20:16.903 GMT [166359] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:20:16.903 GMT [166359] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:20:16.905 GMT [166359] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:20:16.911 GMT [166360] LOG:  database system was shut down at 2023-01-22 19:20:16 GMT
2023-01-22 19:20:16.916 GMT [166359] LOG:  database system is ready to accept connections
2023-01-22 19:20:18.051 GMT [166388] ERROR:  structure of query does not match function result type
2023-01-22 19:20:18.051 GMT [166388] DETAIL:  Number of returned columns (4) does not match expected column count (5).
2023-01-22 19:20:18.051 GMT [166388] CONTEXT:  SQL statement "SELECT * FROM client.savings_accounts WHERE account_id = account_identifier"
	PL/pgSQL function view_savings_accounts() line 9 at RETURN QUERY
2023-01-22 19:20:18.051 GMT [166388] STATEMENT:  SELECT * FROM client.view_savings_accounts();
2023-01-22 19:20:31.491 GMT [166359] LOG:  received fast shutdown request
2023-01-22 19:20:31.492 GMT [166359] LOG:  aborting any active transactions
2023-01-22 19:20:31.497 GMT [166359] LOG:  background worker "logical replication launcher" (PID 166366) exited with exit code 1
2023-01-22 19:20:31.499 GMT [166361] LOG:  shutting down
2023-01-22 19:20:31.547 GMT [166359] LOG:  database system is shut down
2023-01-22 19:20:32.629 GMT [166507] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:20:32.629 GMT [166507] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:20:32.631 GMT [166507] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:20:32.636 GMT [166508] LOG:  database system was shut down at 2023-01-22 19:20:32 GMT
2023-01-22 19:20:32.642 GMT [166507] LOG:  database system is ready to accept connections
2023-01-22 19:22:44.428 GMT [166507] LOG:  received fast shutdown request
2023-01-22 19:22:44.429 GMT [166507] LOG:  aborting any active transactions
2023-01-22 19:22:44.433 GMT [166507] LOG:  background worker "logical replication launcher" (PID 166514) exited with exit code 1
2023-01-22 19:22:44.434 GMT [166509] LOG:  shutting down
2023-01-22 19:22:44.491 GMT [166507] LOG:  database system is shut down
2023-01-22 19:22:45.724 GMT [166961] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:22:45.725 GMT [166961] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:22:45.726 GMT [166961] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:22:45.730 GMT [166962] LOG:  database system was shut down at 2023-01-22 19:22:45 GMT
2023-01-22 19:22:45.736 GMT [166961] LOG:  database system is ready to accept connections
2023-01-22 19:22:46.904 GMT [166990] ERROR:  column reference "account_id" is ambiguous at character 34
2023-01-22 19:22:46.904 GMT [166990] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-22 19:22:46.904 GMT [166990] QUERY:  SELECT * FROM client.loans WHERE account_id = account_id
2023-01-22 19:22:46.904 GMT [166990] CONTEXT:  PL/pgSQL function view_loans() line 9 at RETURN QUERY
2023-01-22 19:22:46.904 GMT [166990] STATEMENT:  SELECT * FROM client.view_loans();
2023-01-22 19:23:09.830 GMT [166961] LOG:  received fast shutdown request
2023-01-22 19:23:09.832 GMT [166961] LOG:  aborting any active transactions
2023-01-22 19:23:09.839 GMT [166961] LOG:  background worker "logical replication launcher" (PID 166968) exited with exit code 1
2023-01-22 19:23:09.839 GMT [166963] LOG:  shutting down
2023-01-22 19:23:09.891 GMT [166961] LOG:  database system is shut down
2023-01-22 19:23:11.229 GMT [167173] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:23:11.229 GMT [167173] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:23:11.231 GMT [167173] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:23:11.236 GMT [167174] LOG:  database system was shut down at 2023-01-22 19:23:10 GMT
2023-01-22 19:23:11.241 GMT [167173] LOG:  database system is ready to accept connections
2023-01-22 19:23:12.429 GMT [167202] ERROR:  structure of query does not match function result type
2023-01-22 19:23:12.429 GMT [167202] DETAIL:  Returned type integer does not match expected type numeric in column 2.
2023-01-22 19:23:12.429 GMT [167202] CONTEXT:  SQL statement "SELECT * FROM client.loans WHERE account_id = account_identifier"
	PL/pgSQL function view_loans() line 9 at RETURN QUERY
2023-01-22 19:23:12.429 GMT [167202] STATEMENT:  SELECT * FROM client.view_loans();
2023-01-22 19:23:58.243 GMT [167173] LOG:  received fast shutdown request
2023-01-22 19:23:58.245 GMT [167173] LOG:  aborting any active transactions
2023-01-22 19:23:58.249 GMT [167173] LOG:  background worker "logical replication launcher" (PID 167180) exited with exit code 1
2023-01-22 19:23:58.251 GMT [167175] LOG:  shutting down
2023-01-22 19:23:58.301 GMT [167173] LOG:  database system is shut down
2023-01-22 19:23:59.394 GMT [167420] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:23:59.395 GMT [167420] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:23:59.396 GMT [167420] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:23:59.401 GMT [167421] LOG:  database system was shut down at 2023-01-22 19:23:59 GMT
2023-01-22 19:23:59.410 GMT [167420] LOG:  database system is ready to accept connections
2023-01-22 19:24:00.470 GMT [167446] ERROR:  structure of query does not match function result type
2023-01-22 19:24:00.470 GMT [167446] DETAIL:  Returned type numeric(5,2) does not match expected type date in column 4.
2023-01-22 19:24:00.470 GMT [167446] CONTEXT:  SQL statement "SELECT * FROM client.loans WHERE account_id = account_identifier"
	PL/pgSQL function view_loans() line 9 at RETURN QUERY
2023-01-22 19:24:00.470 GMT [167446] STATEMENT:  SELECT * FROM client.view_loans();
2023-01-22 19:25:05.343 GMT [167420] LOG:  received fast shutdown request
2023-01-22 19:25:05.346 GMT [167420] LOG:  aborting any active transactions
2023-01-22 19:25:05.348 GMT [167420] LOG:  background worker "logical replication launcher" (PID 167427) exited with exit code 1
2023-01-22 19:25:05.351 GMT [167422] LOG:  shutting down
2023-01-22 19:25:05.405 GMT [167420] LOG:  database system is shut down
2023-01-22 19:25:06.409 GMT [167723] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:25:06.410 GMT [167723] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:25:06.412 GMT [167723] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:25:06.417 GMT [167724] LOG:  database system was shut down at 2023-01-22 19:25:06 GMT
2023-01-22 19:25:06.424 GMT [167723] LOG:  database system is ready to accept connections
2023-01-22 19:25:07.515 GMT [167752] ERROR:  structure of query does not match function result type
2023-01-22 19:25:07.515 GMT [167752] DETAIL:  Returned type character varying does not match expected type text in column 5.
2023-01-22 19:25:07.515 GMT [167752] CONTEXT:  SQL statement "SELECT * FROM client.loans WHERE account_id = account_identifier"
	PL/pgSQL function view_loans() line 9 at RETURN QUERY
2023-01-22 19:25:07.515 GMT [167752] STATEMENT:  SELECT * FROM client.view_loans();
2023-01-22 19:25:23.240 GMT [167723] LOG:  received fast shutdown request
2023-01-22 19:25:23.242 GMT [167723] LOG:  aborting any active transactions
2023-01-22 19:25:23.246 GMT [167723] LOG:  background worker "logical replication launcher" (PID 167730) exited with exit code 1
2023-01-22 19:25:23.246 GMT [167725] LOG:  shutting down
2023-01-22 19:25:23.306 GMT [167723] LOG:  database system is shut down
2023-01-22 19:25:24.480 GMT [167886] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:25:24.480 GMT [167886] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:25:24.482 GMT [167886] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:25:24.487 GMT [167887] LOG:  database system was shut down at 2023-01-22 19:25:24 GMT
2023-01-22 19:25:24.493 GMT [167886] LOG:  database system is ready to accept connections
2023-01-22 19:26:04.058 GMT [167886] LOG:  received fast shutdown request
2023-01-22 19:26:04.059 GMT [167886] LOG:  aborting any active transactions
2023-01-22 19:26:04.064 GMT [167886] LOG:  background worker "logical replication launcher" (PID 167893) exited with exit code 1
2023-01-22 19:26:04.071 GMT [167888] LOG:  shutting down
2023-01-22 19:26:04.148 GMT [167886] LOG:  database system is shut down
2023-01-22 19:26:05.235 GMT [168136] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-22 19:26:05.236 GMT [168136] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-22 19:26:05.237 GMT [168136] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-22 19:26:05.243 GMT [168137] LOG:  database system was shut down at 2023-01-22 19:26:04 GMT
2023-01-22 19:26:05.249 GMT [168136] LOG:  database system is ready to accept connections
2023-01-23 14:32:16.795 GMT [27422] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 14:32:16.795 GMT [27422] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 14:32:16.798 GMT [27422] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 14:32:16.804 GMT [27423] LOG:  database system was shut down at 2023-01-23 14:32:16 GMT
2023-01-23 14:32:16.810 GMT [27422] LOG:  database system is ready to accept connections
2023-01-23 14:36:08.714 GMT [27422] LOG:  received fast shutdown request
2023-01-23 14:36:08.716 GMT [27422] LOG:  aborting any active transactions
2023-01-23 14:36:08.721 GMT [27422] LOG:  background worker "logical replication launcher" (PID 27429) exited with exit code 1
2023-01-23 14:36:08.721 GMT [27424] LOG:  shutting down
2023-01-23 14:36:08.804 GMT [27422] LOG:  database system is shut down
2023-01-23 14:36:10.548 GMT [28413] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 14:36:10.548 GMT [28413] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 14:36:10.550 GMT [28413] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 14:36:10.554 GMT [28414] LOG:  database system was shut down at 2023-01-23 14:36:10 GMT
2023-01-23 14:36:10.560 GMT [28413] LOG:  database system is ready to accept connections
2023-01-23 14:37:04.314 GMT [28637] ERROR:  syntax error at or near "johnsmith" at character 27
2023-01-23 14:37:04.314 GMT [28637] STATEMENT:  SET session_authorization johnsmith;
2023-01-23 14:37:32.554 GMT [28637] ERROR:  function open_debit_account() does not exist at character 15
2023-01-23 14:37:32.554 GMT [28637] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 14:37:32.554 GMT [28637] STATEMENT:  SELECT * FROM open_debit_account();
2023-01-23 16:28:01.874 GMT [12476] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:28:01.878 GMT [12476] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:28:01.879 GMT [12476] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:28:01.888 GMT [12477] LOG:  database system was shut down at 2023-01-23 16:28:01 GMT
2023-01-23 16:28:01.897 GMT [12476] LOG:  database system is ready to accept connections
2023-01-23 16:33:34.063 GMT [12476] LOG:  received fast shutdown request
2023-01-23 16:33:34.067 GMT [12476] LOG:  aborting any active transactions
2023-01-23 16:33:34.072 GMT [12476] LOG:  background worker "logical replication launcher" (PID 12483) exited with exit code 1
2023-01-23 16:33:34.098 GMT [12478] LOG:  shutting down
2023-01-23 16:33:34.126 GMT [12476] LOG:  database system is shut down
2023-01-23 16:33:35.917 GMT [14488] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:33:35.918 GMT [14488] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:33:35.919 GMT [14488] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:33:35.927 GMT [14489] LOG:  database system was shut down at 2023-01-23 16:33:35 GMT
2023-01-23 16:33:35.932 GMT [14488] LOG:  database system is ready to accept connections
2023-01-23 16:33:51.792 GMT [14488] LOG:  received fast shutdown request
2023-01-23 16:33:51.794 GMT [14488] LOG:  aborting any active transactions
2023-01-23 16:33:51.796 GMT [14488] LOG:  background worker "logical replication launcher" (PID 14495) exited with exit code 1
2023-01-23 16:33:51.800 GMT [14490] LOG:  shutting down
2023-01-23 16:33:51.869 GMT [14488] LOG:  database system is shut down
2023-01-23 16:33:53.347 GMT [14664] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:33:53.347 GMT [14664] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:33:53.352 GMT [14664] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:33:53.379 GMT [14665] LOG:  database system was shut down at 2023-01-23 16:33:53 GMT
2023-01-23 16:33:53.393 GMT [14664] LOG:  database system is ready to accept connections
2023-01-23 16:34:03.287 GMT [14664] LOG:  received fast shutdown request
2023-01-23 16:34:03.289 GMT [14664] LOG:  aborting any active transactions
2023-01-23 16:34:03.293 GMT [14664] LOG:  background worker "logical replication launcher" (PID 14671) exited with exit code 1
2023-01-23 16:34:03.294 GMT [14666] LOG:  shutting down
2023-01-23 16:34:03.353 GMT [14664] LOG:  database system is shut down
2023-01-23 16:34:04.494 GMT [14818] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:34:04.494 GMT [14818] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:34:04.497 GMT [14818] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:34:04.507 GMT [14819] LOG:  database system was shut down at 2023-01-23 16:34:04 GMT
2023-01-23 16:34:04.513 GMT [14818] LOG:  database system is ready to accept connections
2023-01-23 16:34:05.819 GMT [14844] ERROR:  syntax error at or near "NOTICE" at character 137
2023-01-23 16:34:05.819 GMT [14844] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:34:15.090 GMT [14818] LOG:  received fast shutdown request
2023-01-23 16:34:15.092 GMT [14818] LOG:  aborting any active transactions
2023-01-23 16:34:15.100 GMT [14818] LOG:  background worker "logical replication launcher" (PID 14825) exited with exit code 1
2023-01-23 16:34:15.100 GMT [14820] LOG:  shutting down
2023-01-23 16:34:15.171 GMT [14818] LOG:  database system is shut down
2023-01-23 16:34:16.576 GMT [14964] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:34:16.579 GMT [14964] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:34:16.587 GMT [14964] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:34:16.593 GMT [14965] LOG:  database system was shut down at 2023-01-23 16:34:16 GMT
2023-01-23 16:34:16.605 GMT [14964] LOG:  database system is ready to accept connections
2023-01-23 16:34:17.891 GMT [15000] ERROR:  syntax error at or near "NOTICE" at character 137
2023-01-23 16:34:17.891 GMT [15000] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:36:27.448 GMT [14964] LOG:  received fast shutdown request
2023-01-23 16:36:27.450 GMT [14964] LOG:  aborting any active transactions
2023-01-23 16:36:27.452 GMT [14964] LOG:  background worker "logical replication launcher" (PID 14971) exited with exit code 1
2023-01-23 16:36:27.457 GMT [14966] LOG:  shutting down
2023-01-23 16:36:27.529 GMT [14964] LOG:  database system is shut down
2023-01-23 16:36:28.878 GMT [15478] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:36:28.878 GMT [15478] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:36:28.880 GMT [15478] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:36:28.884 GMT [15479] LOG:  database system was shut down at 2023-01-23 16:36:28 GMT
2023-01-23 16:36:28.890 GMT [15478] LOG:  database system is ready to accept connections
2023-01-23 16:36:30.280 GMT [15517] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-23 16:36:30.280 GMT [15517] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 16:36:30.280 GMT [15517] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)
2023-01-23 16:36:30.280 GMT [15517] CONTEXT:  PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:36:30.280 GMT [15517] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:37:42.398 GMT [15478] LOG:  received fast shutdown request
2023-01-23 16:37:42.399 GMT [15478] LOG:  aborting any active transactions
2023-01-23 16:37:42.404 GMT [15478] LOG:  background worker "logical replication launcher" (PID 15485) exited with exit code 1
2023-01-23 16:37:42.404 GMT [15480] LOG:  shutting down
2023-01-23 16:37:42.458 GMT [15478] LOG:  database system is shut down
2023-01-23 16:37:43.833 GMT [15801] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:37:43.834 GMT [15801] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:37:43.838 GMT [15801] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:37:43.866 GMT [15802] LOG:  database system was shut down at 2023-01-23 16:37:43 GMT
2023-01-23 16:37:43.874 GMT [15801] LOG:  database system is ready to accept connections
2023-01-23 16:37:45.230 GMT [15837] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-23 16:37:45.230 GMT [15837] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 16:37:45.230 GMT [15837] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)
2023-01-23 16:37:45.230 GMT [15837] CONTEXT:  PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:37:45.230 GMT [15837] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:40:27.642 GMT [15801] LOG:  received fast shutdown request
2023-01-23 16:40:27.643 GMT [15801] LOG:  aborting any active transactions
2023-01-23 16:40:27.646 GMT [15801] LOG:  background worker "logical replication launcher" (PID 15808) exited with exit code 1
2023-01-23 16:40:27.649 GMT [15803] LOG:  shutting down
2023-01-23 16:40:27.751 GMT [15801] LOG:  database system is shut down
2023-01-23 16:40:29.081 GMT [16399] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:40:29.081 GMT [16399] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:40:29.083 GMT [16399] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:40:29.088 GMT [16400] LOG:  database system was shut down at 2023-01-23 16:40:28 GMT
2023-01-23 16:40:29.095 GMT [16399] LOG:  database system is ready to accept connections
2023-01-23 16:40:30.333 GMT [16438] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-23 16:40:30.333 GMT [16438] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 16:40:30.333 GMT [16438] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, transfer_account_number, transfer_amount, transfer_account_sort_code, FALSE)
2023-01-23 16:40:30.333 GMT [16438] CONTEXT:  PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:40:30.333 GMT [16438] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:40:34.125 GMT [16399] LOG:  received fast shutdown request
2023-01-23 16:40:34.127 GMT [16399] LOG:  aborting any active transactions
2023-01-23 16:40:34.133 GMT [16399] LOG:  background worker "logical replication launcher" (PID 16406) exited with exit code 1
2023-01-23 16:40:34.134 GMT [16401] LOG:  shutting down
2023-01-23 16:40:34.212 GMT [16399] LOG:  database system is shut down
2023-01-23 16:40:36.036 GMT [16533] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:40:36.036 GMT [16533] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:40:36.038 GMT [16533] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:40:36.043 GMT [16534] LOG:  database system was shut down at 2023-01-23 16:40:35 GMT
2023-01-23 16:40:36.049 GMT [16533] LOG:  database system is ready to accept connections
2023-01-23 16:40:37.627 GMT [16576] ERROR:  function client.get_or_create_statement(integer, integer) does not exist at character 15
2023-01-23 16:40:37.627 GMT [16576] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 16:40:37.627 GMT [16576] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)
2023-01-23 16:40:37.627 GMT [16576] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:40:37.627 GMT [16576] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:41:14.889 GMT [16533] LOG:  received fast shutdown request
2023-01-23 16:41:14.891 GMT [16533] LOG:  aborting any active transactions
2023-01-23 16:41:14.897 GMT [16533] LOG:  background worker "logical replication launcher" (PID 16540) exited with exit code 1
2023-01-23 16:41:14.898 GMT [16535] LOG:  shutting down
2023-01-23 16:41:14.967 GMT [16533] LOG:  database system is shut down
2023-01-23 16:41:16.271 GMT [16786] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:41:16.271 GMT [16786] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:41:16.277 GMT [16786] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:41:16.281 GMT [16787] LOG:  database system was shut down at 2023-01-23 16:41:15 GMT
2023-01-23 16:41:16.286 GMT [16786] LOG:  database system is ready to accept connections
2023-01-23 16:41:17.823 GMT [16826] ERROR:  function client.get_or_create_statement(integer, integer) does not exist at character 15
2023-01-23 16:41:17.823 GMT [16826] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 16:41:17.823 GMT [16826] QUERY:  SELECT * FROM client.get_or_create_statement(account_identifier, orig_account_number)
2023-01-23 16:41:17.823 GMT [16826] CONTEXT:  PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:41:17.823 GMT [16826] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:41:28.225 GMT [16786] LOG:  received fast shutdown request
2023-01-23 16:41:28.227 GMT [16786] LOG:  aborting any active transactions
2023-01-23 16:41:28.245 GMT [16786] LOG:  background worker "logical replication launcher" (PID 16793) exited with exit code 1
2023-01-23 16:41:28.245 GMT [16788] LOG:  shutting down
2023-01-23 16:41:28.305 GMT [16786] LOG:  database system is shut down
2023-01-23 16:41:29.504 GMT [16942] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:41:29.504 GMT [16942] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:41:29.506 GMT [16942] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:41:29.509 GMT [16943] LOG:  database system was shut down at 2023-01-23 16:41:29 GMT
2023-01-23 16:41:29.526 GMT [16942] LOG:  database system is ready to accept connections
2023-01-23 16:41:30.794 GMT [16968] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-23 16:41:30.794 GMT [16968] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 23 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:41:30.794 GMT [16968] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:47:47.783 GMT [16942] LOG:  received fast shutdown request
2023-01-23 16:47:47.784 GMT [16942] LOG:  aborting any active transactions
2023-01-23 16:47:47.786 GMT [16942] LOG:  background worker "logical replication launcher" (PID 16949) exited with exit code 1
2023-01-23 16:47:47.790 GMT [16944] LOG:  shutting down
2023-01-23 16:47:47.803 GMT [16942] LOG:  database system is shut down
2023-01-23 16:47:49.092 GMT [18150] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:47:49.092 GMT [18150] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:47:49.093 GMT [18150] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:47:49.098 GMT [18151] LOG:  database system was shut down at 2023-01-23 16:47:48 GMT
2023-01-23 16:47:49.104 GMT [18150] LOG:  database system is ready to accept connections
2023-01-23 16:47:50.652 GMT [18176] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-23 16:47:50.652 GMT [18176] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 23 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:47:50.652 GMT [18176] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:48:37.549 GMT [18150] LOG:  received fast shutdown request
2023-01-23 16:48:37.551 GMT [18150] LOG:  aborting any active transactions
2023-01-23 16:48:37.556 GMT [18150] LOG:  background worker "logical replication launcher" (PID 18157) exited with exit code 1
2023-01-23 16:48:37.560 GMT [18152] LOG:  shutting down
2023-01-23 16:48:37.666 GMT [18150] LOG:  database system is shut down
2023-01-23 16:48:39.198 GMT [18418] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:48:39.198 GMT [18418] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:48:39.200 GMT [18418] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:48:39.205 GMT [18419] LOG:  database system was shut down at 2023-01-23 16:48:38 GMT
2023-01-23 16:48:39.214 GMT [18418] LOG:  database system is ready to accept connections
2023-01-23 16:48:40.896 GMT [18457] ERROR:  CREDIT LIMIT EXCEEDED
2023-01-23 16:48:40.896 GMT [18457] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 25 at RAISE
	SQL expression "bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 23 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 16:48:40.896 GMT [18457] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 16:48:45.856 GMT [18418] LOG:  received fast shutdown request
2023-01-23 16:48:45.857 GMT [18418] LOG:  aborting any active transactions
2023-01-23 16:48:45.865 GMT [18418] LOG:  background worker "logical replication launcher" (PID 18425) exited with exit code 1
2023-01-23 16:48:45.865 GMT [18420] LOG:  shutting down
2023-01-23 16:48:45.924 GMT [18418] LOG:  database system is shut down
2023-01-23 16:48:47.801 GMT [18561] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:48:47.801 GMT [18561] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:48:47.803 GMT [18561] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:48:47.816 GMT [18562] LOG:  database system was shut down at 2023-01-23 16:48:47 GMT
2023-01-23 16:48:47.834 GMT [18561] LOG:  database system is ready to accept connections
2023-01-23 16:51:20.862 GMT [18561] LOG:  received fast shutdown request
2023-01-23 16:51:20.864 GMT [18561] LOG:  aborting any active transactions
2023-01-23 16:51:20.870 GMT [18561] LOG:  background worker "logical replication launcher" (PID 18568) exited with exit code 1
2023-01-23 16:51:20.871 GMT [18563] LOG:  shutting down
2023-01-23 16:51:20.934 GMT [18561] LOG:  database system is shut down
2023-01-23 16:51:22.407 GMT [19152] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:51:22.407 GMT [19152] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:51:22.408 GMT [19152] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:51:22.413 GMT [19153] LOG:  database system was shut down at 2023-01-23 16:51:22 GMT
2023-01-23 16:51:22.420 GMT [19152] LOG:  database system is ready to accept connections
2023-01-23 16:51:27.655 GMT [19152] LOG:  received fast shutdown request
2023-01-23 16:51:27.657 GMT [19152] LOG:  aborting any active transactions
2023-01-23 16:51:27.661 GMT [19152] LOG:  background worker "logical replication launcher" (PID 19159) exited with exit code 1
2023-01-23 16:51:27.661 GMT [19154] LOG:  shutting down
2023-01-23 16:51:27.751 GMT [19152] LOG:  database system is shut down
2023-01-23 16:51:28.917 GMT [19282] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:51:28.918 GMT [19282] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:51:28.920 GMT [19282] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:51:28.930 GMT [19283] LOG:  database system was shut down at 2023-01-23 16:51:28 GMT
2023-01-23 16:51:28.943 GMT [19282] LOG:  database system is ready to accept connections
2023-01-23 16:51:44.798 GMT [19282] LOG:  received fast shutdown request
2023-01-23 16:51:44.800 GMT [19282] LOG:  aborting any active transactions
2023-01-23 16:51:44.803 GMT [19282] LOG:  background worker "logical replication launcher" (PID 19289) exited with exit code 1
2023-01-23 16:51:44.804 GMT [19284] LOG:  shutting down
2023-01-23 16:51:44.885 GMT [19282] LOG:  database system is shut down
2023-01-23 16:51:46.153 GMT [19442] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:51:46.153 GMT [19442] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:51:46.155 GMT [19442] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:51:46.193 GMT [19443] LOG:  database system was shut down at 2023-01-23 16:51:45 GMT
2023-01-23 16:51:46.202 GMT [19442] LOG:  database system is ready to accept connections
2023-01-23 16:51:49.897 GMT [19442] LOG:  received fast shutdown request
2023-01-23 16:51:49.899 GMT [19442] LOG:  aborting any active transactions
2023-01-23 16:51:49.912 GMT [19442] LOG:  background worker "logical replication launcher" (PID 19449) exited with exit code 1
2023-01-23 16:51:49.912 GMT [19444] LOG:  shutting down
2023-01-23 16:51:49.990 GMT [19442] LOG:  database system is shut down
2023-01-23 16:51:51.218 GMT [19559] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:51:51.218 GMT [19559] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:51:51.220 GMT [19559] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:51:51.224 GMT [19560] LOG:  database system was shut down at 2023-01-23 16:51:50 GMT
2023-01-23 16:51:51.229 GMT [19559] LOG:  database system is ready to accept connections
2023-01-23 16:51:52.724 GMT [19595] ERROR:  permission denied to set role "postgres"
2023-01-23 16:51:52.724 GMT [19595] STATEMENT:  SET ROLE postgres;
2023-01-23 16:54:43.360 GMT [19559] LOG:  received fast shutdown request
2023-01-23 16:54:43.361 GMT [19559] LOG:  aborting any active transactions
2023-01-23 16:54:43.368 GMT [19559] LOG:  background worker "logical replication launcher" (PID 19566) exited with exit code 1
2023-01-23 16:54:43.372 GMT [19561] LOG:  shutting down
2023-01-23 16:54:43.439 GMT [19559] LOG:  database system is shut down
2023-01-23 16:54:44.829 GMT [20161] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:54:44.829 GMT [20161] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:54:44.830 GMT [20161] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:54:44.839 GMT [20162] LOG:  database system was shut down at 2023-01-23 16:54:44 GMT
2023-01-23 16:54:44.844 GMT [20161] LOG:  database system is ready to accept connections
2023-01-23 16:54:46.349 GMT [20200] ERROR:  permission denied to set role "postgres"
2023-01-23 16:54:46.349 GMT [20200] STATEMENT:  SET ROLE postgres;
2023-01-23 16:55:13.948 GMT [20161] LOG:  received fast shutdown request
2023-01-23 16:55:13.951 GMT [20161] LOG:  aborting any active transactions
2023-01-23 16:55:13.957 GMT [20161] LOG:  background worker "logical replication launcher" (PID 20168) exited with exit code 1
2023-01-23 16:55:13.958 GMT [20163] LOG:  shutting down
2023-01-23 16:55:14.060 GMT [20161] LOG:  database system is shut down
2023-01-23 16:55:15.401 GMT [20368] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:55:15.401 GMT [20368] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:55:15.402 GMT [20368] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:55:15.407 GMT [20369] LOG:  database system was shut down at 2023-01-23 16:55:15 GMT
2023-01-23 16:55:15.413 GMT [20368] LOG:  database system is ready to accept connections
2023-01-23 16:55:16.907 GMT [20404] ERROR:  syntax error at or near "postgres" at character 12
2023-01-23 16:55:16.907 GMT [20404] STATEMENT:  RESET ROLE postgres;
2023-01-23 16:57:31.593 GMT [20368] LOG:  received fast shutdown request
2023-01-23 16:57:31.596 GMT [20368] LOG:  aborting any active transactions
2023-01-23 16:57:31.601 GMT [20368] LOG:  background worker "logical replication launcher" (PID 20375) exited with exit code 1
2023-01-23 16:57:31.602 GMT [20370] LOG:  shutting down
2023-01-23 16:57:31.691 GMT [20368] LOG:  database system is shut down
2023-01-23 16:57:32.815 GMT [21065] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:57:32.815 GMT [21065] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:57:32.817 GMT [21065] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:57:32.820 GMT [21066] LOG:  database system was shut down at 2023-01-23 16:57:32 GMT
2023-01-23 16:57:32.827 GMT [21065] LOG:  database system is ready to accept connections
2023-01-23 16:57:34.114 GMT [21105] ERROR:  syntax error at or near "postgres" at character 12
2023-01-23 16:57:34.114 GMT [21105] STATEMENT:  RESET ROLE postgres;
2023-01-23 16:57:34.115 GMT [21105] ERROR:  permission denied for table customer
2023-01-23 16:57:34.115 GMT [21105] STATEMENT:  SELECT * FROM customer;
2023-01-23 16:57:41.387 GMT [21065] LOG:  received fast shutdown request
2023-01-23 16:57:41.389 GMT [21065] LOG:  aborting any active transactions
2023-01-23 16:57:41.393 GMT [21065] LOG:  background worker "logical replication launcher" (PID 21072) exited with exit code 1
2023-01-23 16:57:41.395 GMT [21067] LOG:  shutting down
2023-01-23 16:57:41.461 GMT [21065] LOG:  database system is shut down
2023-01-23 16:57:42.674 GMT [21205] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 16:57:42.674 GMT [21205] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 16:57:42.679 GMT [21205] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 16:57:42.688 GMT [21206] LOG:  database system was shut down at 2023-01-23 16:57:42 GMT
2023-01-23 16:57:42.694 GMT [21205] LOG:  database system is ready to accept connections
2023-01-23 16:57:43.995 GMT [21231] ERROR:  permission denied for table customer
2023-01-23 16:57:43.995 GMT [21231] STATEMENT:  SELECT * FROM customer;
2023-01-23 17:00:38.090 GMT [21205] LOG:  received fast shutdown request
2023-01-23 17:00:38.093 GMT [21205] LOG:  aborting any active transactions
2023-01-23 17:00:38.099 GMT [21205] LOG:  background worker "logical replication launcher" (PID 21212) exited with exit code 1
2023-01-23 17:00:38.101 GMT [21207] LOG:  shutting down
2023-01-23 17:00:38.161 GMT [21205] LOG:  database system is shut down
2023-01-23 17:00:39.438 GMT [21831] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:00:39.439 GMT [21831] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:00:39.440 GMT [21831] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:00:39.443 GMT [21832] LOG:  database system was shut down at 2023-01-23 17:00:39 GMT
2023-01-23 17:00:39.448 GMT [21831] LOG:  database system is ready to accept connections
2023-01-23 17:00:48.482 GMT [21831] LOG:  received fast shutdown request
2023-01-23 17:00:48.484 GMT [21831] LOG:  aborting any active transactions
2023-01-23 17:00:48.491 GMT [21831] LOG:  background worker "logical replication launcher" (PID 21838) exited with exit code 1
2023-01-23 17:00:48.491 GMT [21833] LOG:  shutting down
2023-01-23 17:00:48.574 GMT [21831] LOG:  database system is shut down
2023-01-23 17:00:49.829 GMT [21981] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:00:49.829 GMT [21981] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:00:49.830 GMT [21981] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:00:49.834 GMT [21982] LOG:  database system was shut down at 2023-01-23 17:00:49 GMT
2023-01-23 17:00:49.839 GMT [21981] LOG:  database system is ready to accept connections
2023-01-23 17:01:04.232 GMT [21981] LOG:  received fast shutdown request
2023-01-23 17:01:04.233 GMT [21981] LOG:  aborting any active transactions
2023-01-23 17:01:04.241 GMT [21981] LOG:  background worker "logical replication launcher" (PID 21988) exited with exit code 1
2023-01-23 17:01:04.241 GMT [21983] LOG:  shutting down
2023-01-23 17:01:04.306 GMT [21981] LOG:  database system is shut down
2023-01-23 17:01:05.574 GMT [22150] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:01:05.574 GMT [22150] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:01:05.576 GMT [22150] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:01:05.580 GMT [22151] LOG:  database system was shut down at 2023-01-23 17:01:05 GMT
2023-01-23 17:01:05.585 GMT [22150] LOG:  database system is ready to accept connections
2023-01-23 17:04:19.907 GMT [22150] LOG:  received fast shutdown request
2023-01-23 17:04:19.909 GMT [22150] LOG:  aborting any active transactions
2023-01-23 17:04:19.911 GMT [22150] LOG:  background worker "logical replication launcher" (PID 22157) exited with exit code 1
2023-01-23 17:04:19.916 GMT [22152] LOG:  shutting down
2023-01-23 17:04:19.985 GMT [22150] LOG:  database system is shut down
2023-01-23 17:04:21.417 GMT [22903] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:04:21.418 GMT [22903] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:04:21.426 GMT [22903] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:04:21.431 GMT [22904] LOG:  database system was shut down at 2023-01-23 17:04:21 GMT
2023-01-23 17:04:21.437 GMT [22903] LOG:  database system is ready to accept connections
2023-01-23 17:04:22.723 GMT [22943] ERROR:  invalid input syntax for type boolean: "APPROVED" at character 76
2023-01-23 17:04:22.723 GMT [22943] QUERY:  result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, 'APPROVED'))
2023-01-23 17:04:22.723 GMT [22943] CONTEXT:  PL/pgSQL function inline_code_block line 12 at assignment
2023-01-23 17:04:22.723 GMT [22943] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, 'APPROVED'));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:04:36.927 GMT [22903] LOG:  received fast shutdown request
2023-01-23 17:04:36.930 GMT [22903] LOG:  aborting any active transactions
2023-01-23 17:04:36.932 GMT [22903] LOG:  background worker "logical replication launcher" (PID 22910) exited with exit code 1
2023-01-23 17:04:36.934 GMT [22905] LOG:  shutting down
2023-01-23 17:04:37.032 GMT [22903] LOG:  database system is shut down
2023-01-23 17:04:38.271 GMT [23073] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:04:38.271 GMT [23073] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:04:38.272 GMT [23073] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:04:38.277 GMT [23074] LOG:  database system was shut down at 2023-01-23 17:04:37 GMT
2023-01-23 17:04:38.282 GMT [23073] LOG:  database system is ready to accept connections
2023-01-23 17:04:39.569 GMT [23102] ERROR:  relation "staff.credit_card_applications" does not exist at character 23
2023-01-23 17:04:39.569 GMT [23102] QUERY:  EXISTS (SELECT * FROM staff.credit_card_applications WHERE account_number = account_number)
2023-01-23 17:04:39.569 GMT [23102] CONTEXT:  PL/pgSQL function approve_or_deny_credit_application(integer,boolean) line 4 at IF
	PL/pgSQL assignment "result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE))"
	PL/pgSQL function inline_code_block line 12 at assignment
2023-01-23 17:04:39.569 GMT [23102] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:05:25.889 GMT [23073] LOG:  received fast shutdown request
2023-01-23 17:05:25.890 GMT [23073] LOG:  aborting any active transactions
2023-01-23 17:05:25.895 GMT [23073] LOG:  background worker "logical replication launcher" (PID 23080) exited with exit code 1
2023-01-23 17:05:25.898 GMT [23075] LOG:  shutting down
2023-01-23 17:05:25.979 GMT [23073] LOG:  database system is shut down
2023-01-23 17:05:27.214 GMT [23341] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:05:27.218 GMT [23341] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:05:27.220 GMT [23341] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:05:27.226 GMT [23342] LOG:  database system was shut down at 2023-01-23 17:05:26 GMT
2023-01-23 17:05:27.238 GMT [23341] LOG:  database system is ready to accept connections
2023-01-23 17:05:28.843 GMT [23380] ERROR:  column reference "account_number" is ambiguous at character 63
2023-01-23 17:05:28.843 GMT [23380] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 17:05:28.843 GMT [23380] QUERY:  EXISTS (SELECT * FROM staff.credit_account_applications WHERE account_number = account_number)
2023-01-23 17:05:28.843 GMT [23380] CONTEXT:  PL/pgSQL function approve_or_deny_credit_application(integer,boolean) line 4 at IF
	PL/pgSQL assignment "result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE))"
	PL/pgSQL function inline_code_block line 12 at assignment
2023-01-23 17:05:28.843 GMT [23380] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:06:01.659 GMT [23341] LOG:  received fast shutdown request
2023-01-23 17:06:01.661 GMT [23341] LOG:  aborting any active transactions
2023-01-23 17:06:01.665 GMT [23341] LOG:  background worker "logical replication launcher" (PID 23348) exited with exit code 1
2023-01-23 17:06:01.666 GMT [23343] LOG:  shutting down
2023-01-23 17:06:01.708 GMT [23341] LOG:  database system is shut down
2023-01-23 17:06:02.947 GMT [23594] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:06:02.947 GMT [23594] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:06:02.952 GMT [23594] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:06:02.957 GMT [23595] LOG:  database system was shut down at 2023-01-23 17:06:02 GMT
2023-01-23 17:06:02.963 GMT [23594] LOG:  database system is ready to accept connections
2023-01-23 17:06:04.390 GMT [23621] ERROR:  permission denied for table credit_account_application
2023-01-23 17:06:04.390 GMT [23621] CONTEXT:  SQL statement "UPDATE credit_account_application
	            SET application_status = 'DENIED'
	            WHERE account_number = account_number_p"
	PL/pgSQL function approve_or_deny_credit_application(integer,boolean) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE))"
	PL/pgSQL function inline_code_block line 12 at assignment
2023-01-23 17:06:04.390 GMT [23621] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:06:28.609 GMT [23594] LOG:  received fast shutdown request
2023-01-23 17:06:28.611 GMT [23594] LOG:  aborting any active transactions
2023-01-23 17:06:28.615 GMT [23594] LOG:  background worker "logical replication launcher" (PID 23601) exited with exit code 1
2023-01-23 17:06:28.617 GMT [23596] LOG:  shutting down
2023-01-23 17:06:28.690 GMT [23594] LOG:  database system is shut down
2023-01-23 17:06:29.999 GMT [23805] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:06:30.000 GMT [23805] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:06:30.004 GMT [23805] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:06:30.009 GMT [23806] LOG:  database system was shut down at 2023-01-23 17:06:29 GMT
2023-01-23 17:06:30.026 GMT [23805] LOG:  database system is ready to accept connections
2023-01-23 17:07:14.884 GMT [23805] LOG:  received fast shutdown request
2023-01-23 17:07:14.890 GMT [23805] LOG:  aborting any active transactions
2023-01-23 17:07:14.895 GMT [23805] LOG:  background worker "logical replication launcher" (PID 23812) exited with exit code 1
2023-01-23 17:07:14.897 GMT [23807] LOG:  shutting down
2023-01-23 17:07:14.975 GMT [23805] LOG:  database system is shut down
2023-01-23 17:07:16.212 GMT [24058] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:07:16.213 GMT [24058] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:07:16.214 GMT [24058] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:07:16.218 GMT [24059] LOG:  database system was shut down at 2023-01-23 17:07:15 GMT
2023-01-23 17:07:16.223 GMT [24058] LOG:  database system is ready to accept connections
2023-01-23 17:07:17.561 GMT [24087] ERROR:  query has no destination for result data
2023-01-23 17:07:17.561 GMT [24087] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-23 17:07:17.561 GMT [24087] CONTEXT:  PL/pgSQL function inline_code_block line 10 at SQL statement
2023-01-23 17:07:17.561 GMT [24087] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SELECT * FROM staff.credit_account_applications;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:08:01.434 GMT [24058] LOG:  received fast shutdown request
2023-01-23 17:08:01.435 GMT [24058] LOG:  aborting any active transactions
2023-01-23 17:08:01.440 GMT [24058] LOG:  background worker "logical replication launcher" (PID 24065) exited with exit code 1
2023-01-23 17:08:01.440 GMT [24060] LOG:  shutting down
2023-01-23 17:08:01.516 GMT [24058] LOG:  database system is shut down
2023-01-23 17:08:02.759 GMT [24359] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:08:02.759 GMT [24359] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:08:02.761 GMT [24359] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:08:02.766 GMT [24360] LOG:  database system was shut down at 2023-01-23 17:08:02 GMT
2023-01-23 17:08:02.775 GMT [24359] LOG:  database system is ready to accept connections
2023-01-23 17:09:03.812 GMT [24359] LOG:  received fast shutdown request
2023-01-23 17:09:03.813 GMT [24359] LOG:  aborting any active transactions
2023-01-23 17:09:03.818 GMT [24359] LOG:  background worker "logical replication launcher" (PID 24366) exited with exit code 1
2023-01-23 17:09:03.821 GMT [24361] LOG:  shutting down
2023-01-23 17:09:03.885 GMT [24359] LOG:  database system is shut down
2023-01-23 17:09:05.178 GMT [24687] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:09:05.179 GMT [24687] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:09:05.180 GMT [24687] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:09:05.192 GMT [24688] LOG:  database system was shut down at 2023-01-23 17:09:04 GMT
2023-01-23 17:09:05.198 GMT [24687] LOG:  database system is ready to accept connections
2023-01-23 17:33:48.364 GMT [24687] LOG:  received fast shutdown request
2023-01-23 17:33:48.366 GMT [24687] LOG:  aborting any active transactions
2023-01-23 17:33:48.372 GMT [24687] LOG:  background worker "logical replication launcher" (PID 24694) exited with exit code 1
2023-01-23 17:33:48.375 GMT [24689] LOG:  shutting down
2023-01-23 17:33:48.419 GMT [24687] LOG:  database system is shut down
2023-01-23 17:33:53.502 GMT [63311] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:33:53.502 GMT [63311] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:33:53.504 GMT [63311] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:33:53.516 GMT [63312] LOG:  database system was shut down at 2023-01-23 17:33:53 GMT
2023-01-23 17:33:53.524 GMT [63311] LOG:  database system is ready to accept connections
2023-01-23 17:35:49.711 GMT [63311] LOG:  received fast shutdown request
2023-01-23 17:35:49.713 GMT [63311] LOG:  aborting any active transactions
2023-01-23 17:35:49.717 GMT [63311] LOG:  background worker "logical replication launcher" (PID 63318) exited with exit code 1
2023-01-23 17:35:49.718 GMT [63313] LOG:  shutting down
2023-01-23 17:35:49.830 GMT [63311] LOG:  database system is shut down
2023-01-23 17:35:51.187 GMT [63804] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:35:51.188 GMT [63804] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:35:51.189 GMT [63804] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:35:51.196 GMT [63805] LOG:  database system was shut down at 2023-01-23 17:35:50 GMT
2023-01-23 17:35:51.201 GMT [63804] LOG:  database system is ready to accept connections
2023-01-23 17:36:27.431 GMT [63804] LOG:  received fast shutdown request
2023-01-23 17:36:27.434 GMT [63804] LOG:  aborting any active transactions
2023-01-23 17:36:27.441 GMT [63804] LOG:  background worker "logical replication launcher" (PID 63811) exited with exit code 1
2023-01-23 17:36:27.442 GMT [63806] LOG:  shutting down
2023-01-23 17:36:27.521 GMT [63804] LOG:  database system is shut down
2023-01-23 17:36:28.768 GMT [64054] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:36:28.772 GMT [64054] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:36:28.776 GMT [64054] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:36:28.782 GMT [64055] LOG:  database system was shut down at 2023-01-23 17:36:28 GMT
2023-01-23 17:36:28.787 GMT [64054] LOG:  database system is ready to accept connections
2023-01-23 17:36:30.180 GMT [64081] ERROR:  query has no destination for result data
2023-01-23 17:36:30.180 GMT [64081] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-23 17:36:30.180 GMT [64081] CONTEXT:  PL/pgSQL function inline_code_block line 19 at SQL statement
2023-01-23 17:36:30.180 GMT [64081] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	
	    SELECT * FROM current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:37:12.215 GMT [64054] LOG:  received fast shutdown request
2023-01-23 17:37:12.219 GMT [64054] LOG:  aborting any active transactions
2023-01-23 17:37:12.225 GMT [64054] LOG:  background worker "logical replication launcher" (PID 64061) exited with exit code 1
2023-01-23 17:37:12.225 GMT [64056] LOG:  shutting down
2023-01-23 17:37:12.283 GMT [64054] LOG:  database system is shut down
2023-01-23 17:37:13.665 GMT [64345] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:37:13.665 GMT [64345] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:37:13.667 GMT [64345] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:37:13.676 GMT [64346] LOG:  database system was shut down at 2023-01-23 17:37:13 GMT
2023-01-23 17:37:13.682 GMT [64345] LOG:  database system is ready to accept connections
2023-01-23 17:37:15.098 GMT [64381] ERROR:  syntax error at or near "user" at character 432
2023-01-23 17:37:15.098 GMT [64381] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	DECLARE user TEXT;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	
	    user = (SELECT * FROM current_user);
	    RAISE NOTICE 'User: %', user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	END
	$$;
2023-01-23 17:37:45.808 GMT [64345] LOG:  received fast shutdown request
2023-01-23 17:37:45.809 GMT [64345] LOG:  aborting any active transactions
2023-01-23 17:37:45.812 GMT [64345] LOG:  background worker "logical replication launcher" (PID 64352) exited with exit code 1
2023-01-23 17:37:45.813 GMT [64347] LOG:  shutting down
2023-01-23 17:37:45.885 GMT [64345] LOG:  database system is shut down
2023-01-23 17:37:47.111 GMT [64566] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:37:47.111 GMT [64566] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:37:47.112 GMT [64566] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:37:47.120 GMT [64567] LOG:  database system was shut down at 2023-01-23 17:37:46 GMT
2023-01-23 17:37:47.127 GMT [64566] LOG:  database system is ready to accept connections
2023-01-23 17:38:31.154 GMT [64566] LOG:  received fast shutdown request
2023-01-23 17:38:31.157 GMT [64566] LOG:  aborting any active transactions
2023-01-23 17:38:31.164 GMT [64566] LOG:  background worker "logical replication launcher" (PID 64573) exited with exit code 1
2023-01-23 17:38:31.164 GMT [64568] LOG:  shutting down
2023-01-23 17:38:31.253 GMT [64566] LOG:  database system is shut down
2023-01-23 17:38:32.537 GMT [64808] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:38:32.537 GMT [64808] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:38:32.539 GMT [64808] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:38:32.546 GMT [64809] LOG:  database system was shut down at 2023-01-23 17:38:32 GMT
2023-01-23 17:38:32.552 GMT [64808] LOG:  database system is ready to accept connections
2023-01-23 17:41:12.571 GMT [64808] LOG:  received fast shutdown request
2023-01-23 17:41:12.572 GMT [64808] LOG:  aborting any active transactions
2023-01-23 17:41:12.576 GMT [64808] LOG:  background worker "logical replication launcher" (PID 64815) exited with exit code 1
2023-01-23 17:41:12.576 GMT [64810] LOG:  shutting down
2023-01-23 17:41:12.672 GMT [64808] LOG:  database system is shut down
2023-01-23 17:41:13.956 GMT [65390] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:41:13.963 GMT [65390] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:41:13.964 GMT [65390] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:41:13.968 GMT [65391] LOG:  database system was shut down at 2023-01-23 17:41:13 GMT
2023-01-23 17:41:13.973 GMT [65390] LOG:  database system is ready to accept connections
2023-01-23 17:41:45.161 GMT [65390] LOG:  received fast shutdown request
2023-01-23 17:41:45.163 GMT [65390] LOG:  aborting any active transactions
2023-01-23 17:41:45.169 GMT [65390] LOG:  background worker "logical replication launcher" (PID 65397) exited with exit code 1
2023-01-23 17:41:45.178 GMT [65392] LOG:  shutting down
2023-01-23 17:41:45.260 GMT [65390] LOG:  database system is shut down
2023-01-23 17:41:46.819 GMT [65615] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:41:46.819 GMT [65615] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:41:46.825 GMT [65615] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:41:46.838 GMT [65616] LOG:  database system was shut down at 2023-01-23 17:41:46 GMT
2023-01-23 17:41:46.844 GMT [65615] LOG:  database system is ready to accept connections
2023-01-23 17:42:53.647 GMT [65615] LOG:  received fast shutdown request
2023-01-23 17:42:53.649 GMT [65615] LOG:  aborting any active transactions
2023-01-23 17:42:53.651 GMT [65615] LOG:  background worker "logical replication launcher" (PID 65622) exited with exit code 1
2023-01-23 17:42:53.659 GMT [65617] LOG:  shutting down
2023-01-23 17:42:53.748 GMT [65615] LOG:  database system is shut down
2023-01-23 17:42:55.224 GMT [65958] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:42:55.224 GMT [65958] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:42:55.225 GMT [65958] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:42:55.229 GMT [65959] LOG:  database system was shut down at 2023-01-23 17:42:54 GMT
2023-01-23 17:42:55.234 GMT [65958] LOG:  database system is ready to accept connections
2023-01-23 17:44:08.057 GMT [65958] LOG:  received fast shutdown request
2023-01-23 17:44:08.058 GMT [65958] LOG:  aborting any active transactions
2023-01-23 17:44:08.062 GMT [65958] LOG:  background worker "logical replication launcher" (PID 65965) exited with exit code 1
2023-01-23 17:44:08.062 GMT [65960] LOG:  shutting down
2023-01-23 17:44:08.140 GMT [65958] LOG:  database system is shut down
2023-01-23 17:44:09.371 GMT [66297] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:44:09.371 GMT [66297] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:44:09.373 GMT [66297] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:44:09.377 GMT [66298] LOG:  database system was shut down at 2023-01-23 17:44:09 GMT
2023-01-23 17:44:09.385 GMT [66297] LOG:  database system is ready to accept connections
2023-01-23 17:44:10.840 GMT [66323] ERROR:  query has no destination for result data
2023-01-23 17:44:10.840 GMT [66323] HINT:  If you want to discard the results of a SELECT, use PERFORM instead.
2023-01-23 17:44:10.840 GMT [66323] CONTEXT:  PL/pgSQL function inline_code_block line 25 at SQL statement
2023-01-23 17:44:10.840 GMT [66323] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    SELECT * FROM client.view_accounts();
	
	END
	$$;
2023-01-23 17:44:26.594 GMT [66297] LOG:  received fast shutdown request
2023-01-23 17:44:26.596 GMT [66297] LOG:  aborting any active transactions
2023-01-23 17:44:26.599 GMT [66297] LOG:  background worker "logical replication launcher" (PID 66304) exited with exit code 1
2023-01-23 17:44:26.603 GMT [66299] LOG:  shutting down
2023-01-23 17:44:26.664 GMT [66297] LOG:  database system is shut down
2023-01-23 17:44:27.990 GMT [66470] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:44:27.990 GMT [66470] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:44:27.991 GMT [66470] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:44:27.997 GMT [66471] LOG:  database system was shut down at 2023-01-23 17:44:27 GMT
2023-01-23 17:44:28.008 GMT [66470] LOG:  database system is ready to accept connections
2023-01-23 17:45:41.126 GMT [66470] LOG:  received fast shutdown request
2023-01-23 17:45:41.127 GMT [66470] LOG:  aborting any active transactions
2023-01-23 17:45:41.132 GMT [66470] LOG:  background worker "logical replication launcher" (PID 66477) exited with exit code 1
2023-01-23 17:45:41.133 GMT [66472] LOG:  shutting down
2023-01-23 17:45:41.185 GMT [66470] LOG:  database system is shut down
2023-01-23 17:45:42.693 GMT [66808] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:45:42.694 GMT [66808] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:45:42.704 GMT [66808] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:45:42.710 GMT [66810] LOG:  database system was shut down at 2023-01-23 17:45:42 GMT
2023-01-23 17:45:42.720 GMT [66808] LOG:  database system is ready to accept connections
2023-01-23 17:46:38.053 GMT [66808] LOG:  received fast shutdown request
2023-01-23 17:46:38.055 GMT [66808] LOG:  aborting any active transactions
2023-01-23 17:46:38.063 GMT [66808] LOG:  background worker "logical replication launcher" (PID 66816) exited with exit code 1
2023-01-23 17:46:38.064 GMT [66811] LOG:  shutting down
2023-01-23 17:46:38.120 GMT [66808] LOG:  database system is shut down
2023-01-23 17:46:39.353 GMT [67127] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:46:39.353 GMT [67127] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:46:39.356 GMT [67127] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:46:39.371 GMT [67128] LOG:  database system was shut down at 2023-01-23 17:46:39 GMT
2023-01-23 17:46:39.390 GMT [67127] LOG:  database system is ready to accept connections
2023-01-23 17:47:14.707 GMT [67127] LOG:  received fast shutdown request
2023-01-23 17:47:14.708 GMT [67127] LOG:  aborting any active transactions
2023-01-23 17:47:14.711 GMT [67127] LOG:  background worker "logical replication launcher" (PID 67134) exited with exit code 1
2023-01-23 17:47:14.713 GMT [67129] LOG:  shutting down
2023-01-23 17:47:14.781 GMT [67127] LOG:  database system is shut down
2023-01-23 17:47:16.151 GMT [67346] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:47:16.151 GMT [67346] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:47:16.153 GMT [67346] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:47:16.160 GMT [67347] LOG:  database system was shut down at 2023-01-23 17:47:15 GMT
2023-01-23 17:47:16.178 GMT [67346] LOG:  database system is ready to accept connections
2023-01-23 17:48:04.973 GMT [67346] LOG:  received fast shutdown request
2023-01-23 17:48:04.975 GMT [67346] LOG:  aborting any active transactions
2023-01-23 17:48:04.981 GMT [67346] LOG:  background worker "logical replication launcher" (PID 67353) exited with exit code 1
2023-01-23 17:48:04.981 GMT [67348] LOG:  shutting down
2023-01-23 17:48:05.054 GMT [67346] LOG:  database system is shut down
2023-01-23 17:48:06.473 GMT [67619] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:48:06.473 GMT [67619] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:48:06.475 GMT [67619] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:48:06.479 GMT [67620] LOG:  database system was shut down at 2023-01-23 17:48:06 GMT
2023-01-23 17:48:06.484 GMT [67619] LOG:  database system is ready to accept connections
2023-01-23 17:48:44.547 GMT [67619] LOG:  received fast shutdown request
2023-01-23 17:48:44.549 GMT [67619] LOG:  aborting any active transactions
2023-01-23 17:48:44.555 GMT [67619] LOG:  background worker "logical replication launcher" (PID 67626) exited with exit code 1
2023-01-23 17:48:44.555 GMT [67621] LOG:  shutting down
2023-01-23 17:48:44.689 GMT [67619] LOG:  database system is shut down
2023-01-23 17:48:45.997 GMT [67881] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:48:45.997 GMT [67881] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:48:45.998 GMT [67881] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:48:46.029 GMT [67882] LOG:  database system was shut down at 2023-01-23 17:48:45 GMT
2023-01-23 17:48:46.051 GMT [67881] LOG:  database system is ready to accept connections
2023-01-23 17:50:06.716 GMT [67881] LOG:  received fast shutdown request
2023-01-23 17:50:06.718 GMT [67881] LOG:  aborting any active transactions
2023-01-23 17:50:06.722 GMT [67881] LOG:  background worker "logical replication launcher" (PID 67888) exited with exit code 1
2023-01-23 17:50:06.723 GMT [67883] LOG:  shutting down
2023-01-23 17:50:06.800 GMT [67881] LOG:  database system is shut down
2023-01-23 17:50:08.124 GMT [68260] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:50:08.124 GMT [68260] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:50:08.132 GMT [68260] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:50:08.143 GMT [68261] LOG:  database system was shut down at 2023-01-23 17:50:07 GMT
2023-01-23 17:50:08.154 GMT [68260] LOG:  database system is ready to accept connections
2023-01-23 17:50:27.314 GMT [68260] LOG:  received fast shutdown request
2023-01-23 17:50:27.316 GMT [68260] LOG:  aborting any active transactions
2023-01-23 17:50:27.320 GMT [68260] LOG:  background worker "logical replication launcher" (PID 68267) exited with exit code 1
2023-01-23 17:50:27.320 GMT [68262] LOG:  shutting down
2023-01-23 17:50:27.394 GMT [68260] LOG:  database system is shut down
2023-01-23 17:50:28.722 GMT [68434] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:50:28.722 GMT [68434] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:50:28.725 GMT [68434] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:50:28.732 GMT [68435] LOG:  database system was shut down at 2023-01-23 17:50:28 GMT
2023-01-23 17:50:28.737 GMT [68434] LOG:  database system is ready to accept connections
2023-01-23 17:51:59.740 GMT [68434] LOG:  received fast shutdown request
2023-01-23 17:51:59.743 GMT [68434] LOG:  aborting any active transactions
2023-01-23 17:51:59.749 GMT [68434] LOG:  background worker "logical replication launcher" (PID 68441) exited with exit code 1
2023-01-23 17:51:59.749 GMT [68436] LOG:  shutting down
2023-01-23 17:51:59.832 GMT [68434] LOG:  database system is shut down
2023-01-23 17:52:01.162 GMT [68886] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:52:01.162 GMT [68886] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:52:01.163 GMT [68886] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:52:01.168 GMT [68887] LOG:  database system was shut down at 2023-01-23 17:52:00 GMT
2023-01-23 17:52:01.175 GMT [68886] LOG:  database system is ready to accept connections
2023-01-23 17:52:49.343 GMT [68886] LOG:  received fast shutdown request
2023-01-23 17:52:49.345 GMT [68886] LOG:  aborting any active transactions
2023-01-23 17:52:49.349 GMT [68886] LOG:  background worker "logical replication launcher" (PID 68893) exited with exit code 1
2023-01-23 17:52:49.349 GMT [68888] LOG:  shutting down
2023-01-23 17:52:49.401 GMT [68886] LOG:  database system is shut down
2023-01-23 17:52:50.738 GMT [69163] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:52:50.738 GMT [69163] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:52:50.745 GMT [69163] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:52:50.763 GMT [69164] LOG:  database system was shut down at 2023-01-23 17:52:50 GMT
2023-01-23 17:52:50.768 GMT [69163] LOG:  database system is ready to accept connections
2023-01-23 17:54:36.488 GMT [69163] LOG:  received fast shutdown request
2023-01-23 17:54:36.490 GMT [69163] LOG:  aborting any active transactions
2023-01-23 17:54:36.497 GMT [69163] LOG:  background worker "logical replication launcher" (PID 69170) exited with exit code 1
2023-01-23 17:54:36.497 GMT [69165] LOG:  shutting down
2023-01-23 17:54:36.605 GMT [69163] LOG:  database system is shut down
2023-01-23 17:54:38.134 GMT [69583] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:54:38.134 GMT [69583] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:54:38.136 GMT [69583] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:54:38.141 GMT [69584] LOG:  database system was shut down at 2023-01-23 17:54:37 GMT
2023-01-23 17:54:38.146 GMT [69583] LOG:  database system is ready to accept connections
2023-01-23 17:54:39.100 GMT [69622] ERROR:  syntax error at or near "SELECT" at character 406
2023-01-23 17:54:39.100 GMT [69622] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
	    IF account_type = 'DEBIT' THEN
	
	        RAISE NOTICE 'NEW BALANCE FOR DEBIT ACCOUNT %', (SELECT (current_balance + (SELECT COALESCE (0, SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE))) FROM debit_account WHERE account_number = account_number_identifier);
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND (current_balance + (SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE)) - amount >= 0) THEN
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance + amount WHERE account_number = account_number_identifier;
	            UPDATE debit_overdraft SET overdraft_usage = overdraft_usage - (SELECT SUM(current_balance*-1) FROM debit_account WHERE account_number = account_number_identifier) WHERE account_number = account_number_identifier AND approved = TRUE;
	            UPDATE debit_account SET current_balance = 0 WHERE account_number = account_number_identifier AND current_balance < 0;
	            balances_updated = TRUE;
	        ELSE
	            RAISE NOTICE 'INSUFFICIENT FUNDS';
	            RAISE NOTICE 'AMOUNT REQUESTED: %', amount;
	            balances_updated = FALSE;
	        END IF;
	
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT credit_account.* FROM credit_account INNER JOIN credit_account_application ON credit_account.account_number = credit_account_application.account_number WHERE credit_account.account_number = account_number_identifier AND credit_account.outstanding_balance + amount < credit_account.credit_limit AND credit_account_application.application_status = 'APPROVED') THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET outstanding_balance = outstanding_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE NOTICE 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE NOTICE 'INSUFFICIENT FUNDS';
	            
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET current_balance = current_balance + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 17:54:39.563 GMT [69622] ERROR:  function bank.update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-23 17:54:39.563 GMT [69622] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 17:54:39.563 GMT [69622] QUERY:  bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-23 17:54:39.563 GMT [69622] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 23 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 17:54:39.563 GMT [69622] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 17:55:25.217 GMT [69583] LOG:  received fast shutdown request
2023-01-23 17:55:25.220 GMT [69583] LOG:  aborting any active transactions
2023-01-23 17:55:25.227 GMT [69583] LOG:  background worker "logical replication launcher" (PID 69590) exited with exit code 1
2023-01-23 17:55:25.228 GMT [69585] LOG:  shutting down
2023-01-23 17:55:25.303 GMT [69583] LOG:  database system is shut down
2023-01-23 17:55:26.563 GMT [69863] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:55:26.574 GMT [69863] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:55:26.575 GMT [69863] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:55:26.589 GMT [69864] LOG:  database system was shut down at 2023-01-23 17:55:26 GMT
2023-01-23 17:55:26.594 GMT [69863] LOG:  database system is ready to accept connections
2023-01-23 17:55:27.445 GMT [69892] ERROR:  syntax error at or near "SELECT" at character 405
2023-01-23 17:55:27.445 GMT [69892] STATEMENT:  CREATE OR REPLACE FUNCTION bank.update_balance_amounts(account_number_identifier INT, amount NUMERIC)
	RETURNS BOOLEAN AS $$
	DECLARE balances_updated BOOLEAN;
	DECLARE account_type TEXT;
	BEGIN
	    SELECT get_account_type(account_number_identifier) INTO account_type;
	    IF account_type = 'DEBIT' THEN
	
	        RAISE NOTICE 'NEW BALANCE FOR DEBIT ACCOUNT %', (SELECT (current_balance + (SELECT COALESCE(0, SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE))) FROM debit_account WHERE account_number = account_number_identifier);
	        IF EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND (current_balance + (SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE)) - amount >= 0) THEN
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE debit_account SET current_balance = current_balance + amount WHERE account_number = account_number_identifier;
	            UPDATE debit_overdraft SET overdraft_usage = overdraft_usage - (SELECT SUM(current_balance*-1) FROM debit_account WHERE account_number = account_number_identifier) WHERE account_number = account_number_identifier AND approved = TRUE;
	            UPDATE debit_account SET current_balance = 0 WHERE account_number = account_number_identifier AND current_balance < 0;
	            balances_updated = TRUE;
	        ELSE
	            RAISE NOTICE 'INSUFFICIENT FUNDS';
	            RAISE NOTICE 'AMOUNT REQUESTED: %', amount;
	            balances_updated = FALSE;
	        END IF;
	
	    ELSIF account_type = 'CREDIT' THEN
	        IF EXISTS (SELECT credit_account.* FROM credit_account INNER JOIN credit_account_application ON credit_account.account_number = credit_account_application.account_number WHERE credit_account.account_number = account_number_identifier AND credit_account.outstanding_balance + amount < credit_account.credit_limit AND credit_account_application.application_status = 'APPROVED') THEN
	            RAISE NOTICE 'SUFFICIENT CREDIT';
	            UPDATE credit_account SET outstanding_balance = outstanding_balance - amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        ELSE
	            RAISE NOTICE 'CREDIT LIMIT EXCEEDED';
	            balances_updated = FALSE;
	        END IF;
	    ELSIF account_type = 'SAVINGS' THEN
	        IF EXISTS (SELECT * FROM savings_account WHERE account_number = account_number_identifier AND current_balance - amount < 0) THEN
	            RAISE NOTICE 'INSUFFICIENT FUNDS';
	            
	            balances_updated = FALSE;
	        ELSE
	            RAISE NOTICE 'SUFFICIENT FUNDS';
	            UPDATE savings_account SET current_balance = current_balance + amount WHERE account_number = account_number_identifier;
	            balances_updated = TRUE;
	        END IF;
	    END IF;
	    RETURN balances_updated;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 17:55:27.671 GMT [69892] ERROR:  function bank.update_balance_amounts(integer, numeric) does not exist at character 1
2023-01-23 17:55:27.671 GMT [69892] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 17:55:27.671 GMT [69892] QUERY:  bank.update_balance_amounts((SELECT origin_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT amount FROM bank.pending_transactions WHERE id = pending_transaction_id)) = TRUE
2023-01-23 17:55:27.671 GMT [69892] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 23 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 17:55:27.671 GMT [69892] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 17:55:48.706 GMT [69863] LOG:  received fast shutdown request
2023-01-23 17:55:48.708 GMT [69863] LOG:  aborting any active transactions
2023-01-23 17:55:48.710 GMT [69863] LOG:  background worker "logical replication launcher" (PID 69870) exited with exit code 1
2023-01-23 17:55:48.713 GMT [69865] LOG:  shutting down
2023-01-23 17:55:48.815 GMT [69863] LOG:  database system is shut down
2023-01-23 17:55:50.259 GMT [70044] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:55:50.259 GMT [70044] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:55:50.268 GMT [70044] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:55:50.285 GMT [70045] LOG:  database system was shut down at 2023-01-23 17:55:49 GMT
2023-01-23 17:55:50.294 GMT [70044] LOG:  database system is ready to accept connections
2023-01-23 17:56:36.941 GMT [70044] LOG:  received fast shutdown request
2023-01-23 17:56:36.942 GMT [70044] LOG:  aborting any active transactions
2023-01-23 17:56:36.946 GMT [70044] LOG:  background worker "logical replication launcher" (PID 70051) exited with exit code 1
2023-01-23 17:56:36.946 GMT [70046] LOG:  shutting down
2023-01-23 17:56:37.018 GMT [70044] LOG:  database system is shut down
2023-01-23 17:56:38.309 GMT [70307] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:56:38.309 GMT [70307] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:56:38.311 GMT [70307] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:56:38.324 GMT [70308] LOG:  database system was shut down at 2023-01-23 17:56:37 GMT
2023-01-23 17:56:38.329 GMT [70307] LOG:  database system is ready to accept connections
2023-01-23 17:56:39.644 GMT [70343] ERROR:  function client.get_or_create_statement(integer, integer) does not exist at character 15
2023-01-23 17:56:39.644 GMT [70343] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 17:56:39.644 GMT [70343] QUERY:  SELECT * FROM client.get_or_create_statement((SELECT account_id FROM account WHERE account_number = (SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id)), (SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id))
2023-01-23 17:56:39.644 GMT [70343] CONTEXT:  PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 25 at SQL statement
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 22 at assignment
2023-01-23 17:56:39.644 GMT [70343] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 17:59:16.623 GMT [70307] LOG:  received fast shutdown request
2023-01-23 17:59:16.626 GMT [70307] LOG:  aborting any active transactions
2023-01-23 17:59:16.630 GMT [70307] LOG:  background worker "logical replication launcher" (PID 70314) exited with exit code 1
2023-01-23 17:59:16.630 GMT [70309] LOG:  shutting down
2023-01-23 17:59:16.708 GMT [70307] LOG:  database system is shut down
2023-01-23 17:59:18.002 GMT [70935] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:59:18.002 GMT [70935] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:59:18.004 GMT [70935] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:59:18.016 GMT [70936] LOG:  database system was shut down at 2023-01-23 17:59:17 GMT
2023-01-23 17:59:18.022 GMT [70935] LOG:  database system is ready to accept connections
2023-01-23 17:59:19.424 GMT [70970] ERROR:  column "account_identifier" does not exist at character 56
2023-01-23 17:59:19.424 GMT [70970] QUERY:  EXISTS (SELECT * FROM debit_account WHERE account_id = account_identifier AND account_number = orig_account_number)
2023-01-23 17:59:19.424 GMT [70970] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) line 5 at CASE
	SQL statement "SELECT * FROM client.get_or_create_statement(orig_account_number)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 21 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 4 at assignment
2023-01-23 17:59:19.424 GMT [70970] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 17:59:43.777 GMT [70935] LOG:  received fast shutdown request
2023-01-23 17:59:43.779 GMT [70935] LOG:  aborting any active transactions
2023-01-23 17:59:43.789 GMT [70935] LOG:  background worker "logical replication launcher" (PID 70942) exited with exit code 1
2023-01-23 17:59:43.790 GMT [70937] LOG:  shutting down
2023-01-23 17:59:43.846 GMT [70935] LOG:  database system is shut down
2023-01-23 17:59:45.185 GMT [71130] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 17:59:45.186 GMT [71130] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 17:59:45.187 GMT [71130] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 17:59:45.212 GMT [71131] LOG:  database system was shut down at 2023-01-23 17:59:44 GMT
2023-01-23 17:59:45.220 GMT [71130] LOG:  database system is ready to accept connections
2023-01-23 17:59:46.721 GMT [71169] ERROR:  case not found
2023-01-23 17:59:46.721 GMT [71169] HINT:  CASE statement is missing ELSE part.
2023-01-23 17:59:46.721 GMT [71169] CONTEXT:  PL/pgSQL function get_or_create_statement(integer,integer) line 5 at CASE
	SQL statement "SELECT * FROM client.get_or_create_statement((SELECT account_id FROM account WHERE account_number = (SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id)), (SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id))"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 25 at SQL statement
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 22 at assignment
2023-01-23 17:59:46.721 GMT [71169] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 18:00:54.770 GMT [71130] LOG:  received fast shutdown request
2023-01-23 18:00:54.773 GMT [71130] LOG:  aborting any active transactions
2023-01-23 18:00:54.782 GMT [71130] LOG:  background worker "logical replication launcher" (PID 71137) exited with exit code 1
2023-01-23 18:00:54.782 GMT [71132] LOG:  shutting down
2023-01-23 18:00:54.844 GMT [71130] LOG:  database system is shut down
2023-01-23 18:00:56.161 GMT [71477] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:00:56.161 GMT [71477] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:00:56.162 GMT [71477] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:00:56.168 GMT [71478] LOG:  database system was shut down at 2023-01-23 18:00:55 GMT
2023-01-23 18:00:56.184 GMT [71477] LOG:  database system is ready to accept connections
2023-01-23 18:05:33.303 GMT [71477] LOG:  received fast shutdown request
2023-01-23 18:05:33.305 GMT [71477] LOG:  aborting any active transactions
2023-01-23 18:05:33.310 GMT [71477] LOG:  background worker "logical replication launcher" (PID 71484) exited with exit code 1
2023-01-23 18:05:33.311 GMT [71479] LOG:  shutting down
2023-01-23 18:05:33.387 GMT [71477] LOG:  database system is shut down
2023-01-23 18:05:34.752 GMT [72387] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:05:34.752 GMT [72387] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:05:34.754 GMT [72387] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:05:34.762 GMT [72388] LOG:  database system was shut down at 2023-01-23 18:05:34 GMT
2023-01-23 18:05:34.769 GMT [72387] LOG:  database system is ready to accept connections
2023-01-23 18:07:47.222 GMT [72387] LOG:  received fast shutdown request
2023-01-23 18:07:47.223 GMT [72387] LOG:  aborting any active transactions
2023-01-23 18:07:47.227 GMT [72387] LOG:  background worker "logical replication launcher" (PID 72394) exited with exit code 1
2023-01-23 18:07:47.229 GMT [72389] LOG:  shutting down
2023-01-23 18:07:47.307 GMT [72387] LOG:  database system is shut down
2023-01-23 18:07:48.638 GMT [72973] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:07:48.638 GMT [72973] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:07:48.639 GMT [72973] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:07:48.644 GMT [72974] LOG:  database system was shut down at 2023-01-23 18:07:48 GMT
2023-01-23 18:07:48.649 GMT [72973] LOG:  database system is ready to accept connections
2023-01-23 18:07:49.956 GMT [73008] ERROR:  column reference "current_balance" is ambiguous at character 91
2023-01-23 18:07:49.956 GMT [73008] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 18:07:49.956 GMT [73008] QUERY:  EXISTS (SELECT * FROM debit_account WHERE account_number = account_number_identifier AND (current_balance + (SELECT COALESCE(0, (SELECT overdraft_limit - overdraft_usage FROM debit_overdraft WHERE account_number = account_number_identifier AND approved = TRUE)))) - amount >= 0)
2023-01-23 18:07:49.956 GMT [73008] CONTEXT:  PL/pgSQL function update_balance_amounts(integer,numeric) line 9 at IF
	SQL expression "bank.update_balance_amounts((SELECT dest_account_id FROM transaction WHERE id = pending_transaction_id), (SELECT SUM(amount*-1) FROM bank.pending_transactions WHERE id = pending_transaction_id))"
	PL/pgSQL function verify_and_update_transaction_amounts(integer,boolean,boolean) line 24 at IF
	SQL statement "SELECT * FROM bank.verify_and_update_transaction_amounts(pending_transaction_id, TRUE, FALSE)"
	PL/pgSQL function verify_transaction_type(integer) line 10 at SQL statement
	PL/pgSQL function verify_transaction(integer) line 6 at IF
	SQL statement "SELECT * FROM bank.verify_transaction(NEW.id)"
	PL/pgSQL function transaction_verification() line 5 at SQL statement
	SQL statement "INSERT INTO pending_transaction (id, account_id, is_transfer, is_loan_payment) VALUES (transaction_id, orig_account_number, true, loan_payment)"
	PL/pgSQL function place_transaction_into_account(integer,integer,numeric,integer,boolean) line 24 at SQL statement
	SQL statement "SELECT * FROM client.place_transaction_into_account(orig_account_number::INT, transfer_account_number::INT, transfer_amount::NUMERIC, transfer_account_sort_code::INT, FALSE::BOOLEAN)"
	PL/pgSQL function initiate_transfer(integer,numeric,integer,integer) line 11 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456))"
	PL/pgSQL function inline_code_block line 22 at assignment
2023-01-23 18:07:49.956 GMT [73008] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_credit_application(10000001, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    RAISE NOTICE 'Current user: %', current_user;
	
	    result = (SELECT * FROM client.initiate_transfer(10000001, 100.00, 10000000, 123456));
	    RAISE NOTICE 'Result: %', result;
	
	
	END
	$$;
2023-01-23 18:08:36.055 GMT [72973] LOG:  received fast shutdown request
2023-01-23 18:08:36.057 GMT [72973] LOG:  aborting any active transactions
2023-01-23 18:08:36.066 GMT [72973] LOG:  background worker "logical replication launcher" (PID 72980) exited with exit code 1
2023-01-23 18:08:36.066 GMT [72975] LOG:  shutting down
2023-01-23 18:08:36.116 GMT [72973] LOG:  database system is shut down
2023-01-23 18:08:37.405 GMT [73249] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:08:37.406 GMT [73249] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:08:37.412 GMT [73249] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:08:37.422 GMT [73253] LOG:  database system was shut down at 2023-01-23 18:08:37 GMT
2023-01-23 18:08:37.434 GMT [73249] LOG:  database system is ready to accept connections
2023-01-23 18:09:54.182 GMT [73249] LOG:  received fast shutdown request
2023-01-23 18:09:54.184 GMT [73249] LOG:  aborting any active transactions
2023-01-23 18:09:54.187 GMT [73249] LOG:  background worker "logical replication launcher" (PID 73259) exited with exit code 1
2023-01-23 18:09:54.188 GMT [73254] LOG:  shutting down
2023-01-23 18:09:54.286 GMT [73249] LOG:  database system is shut down
2023-01-23 18:09:55.635 GMT [73617] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:09:55.636 GMT [73617] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:09:55.637 GMT [73617] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:09:55.642 GMT [73618] LOG:  database system was shut down at 2023-01-23 18:09:55 GMT
2023-01-23 18:09:55.648 GMT [73617] LOG:  database system is ready to accept connections
2023-01-23 18:11:40.764 GMT [73617] LOG:  received fast shutdown request
2023-01-23 18:11:40.766 GMT [73617] LOG:  aborting any active transactions
2023-01-23 18:11:40.771 GMT [73617] LOG:  background worker "logical replication launcher" (PID 73624) exited with exit code 1
2023-01-23 18:11:40.771 GMT [73619] LOG:  shutting down
2023-01-23 18:11:40.826 GMT [73617] LOG:  database system is shut down
2023-01-23 18:11:42.206 GMT [74076] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:11:42.213 GMT [74076] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:11:42.215 GMT [74076] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:11:42.219 GMT [74077] LOG:  database system was shut down at 2023-01-23 18:11:41 GMT
2023-01-23 18:11:42.225 GMT [74076] LOG:  database system is ready to accept connections
2023-01-23 18:12:55.136 GMT [74076] LOG:  received fast shutdown request
2023-01-23 18:12:55.137 GMT [74076] LOG:  aborting any active transactions
2023-01-23 18:12:55.141 GMT [74076] LOG:  background worker "logical replication launcher" (PID 74083) exited with exit code 1
2023-01-23 18:12:55.141 GMT [74078] LOG:  shutting down
2023-01-23 18:12:55.201 GMT [74076] LOG:  database system is shut down
2023-01-23 18:12:56.501 GMT [74428] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:12:56.501 GMT [74428] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:12:56.503 GMT [74428] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:12:56.507 GMT [74429] LOG:  database system was shut down at 2023-01-23 18:12:56 GMT
2023-01-23 18:12:56.512 GMT [74428] LOG:  database system is ready to accept connections
2023-01-23 18:13:10.617 GMT [74428] LOG:  received fast shutdown request
2023-01-23 18:13:10.619 GMT [74428] LOG:  aborting any active transactions
2023-01-23 18:13:10.625 GMT [74428] LOG:  background worker "logical replication launcher" (PID 74435) exited with exit code 1
2023-01-23 18:13:10.625 GMT [74430] LOG:  shutting down
2023-01-23 18:13:10.719 GMT [74428] LOG:  database system is shut down
2023-01-23 18:13:12.060 GMT [74592] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 18:13:12.060 GMT [74592] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 18:13:12.061 GMT [74592] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 18:13:12.067 GMT [74593] LOG:  database system was shut down at 2023-01-23 18:13:11 GMT
2023-01-23 18:13:12.077 GMT [74592] LOG:  database system is ready to accept connections
2023-01-23 19:46:43.958 GMT [74592] LOG:  received fast shutdown request
2023-01-23 19:46:43.972 GMT [74592] LOG:  aborting any active transactions
2023-01-23 19:46:43.996 GMT [74592] LOG:  background worker "logical replication launcher" (PID 74599) exited with exit code 1
2023-01-23 19:46:44.001 GMT [74594] LOG:  shutting down
2023-01-23 19:46:44.056 GMT [74592] LOG:  database system is shut down
2023-01-23 19:46:56.159 GMT [90785] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 19:46:56.159 GMT [90785] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 19:46:56.160 GMT [90785] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 19:46:56.165 GMT [90786] LOG:  database system was shut down at 2023-01-23 19:46:55 GMT
2023-01-23 19:46:56.180 GMT [90785] LOG:  database system is ready to accept connections
2023-01-23 19:50:17.038 GMT [90785] LOG:  received fast shutdown request
2023-01-23 19:50:17.040 GMT [90785] LOG:  aborting any active transactions
2023-01-23 19:50:17.042 GMT [90785] LOG:  background worker "logical replication launcher" (PID 90792) exited with exit code 1
2023-01-23 19:50:17.046 GMT [90787] LOG:  shutting down
2023-01-23 19:50:17.120 GMT [90785] LOG:  database system is shut down
2023-01-23 19:50:18.366 GMT [91517] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 19:50:18.366 GMT [91517] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 19:50:18.367 GMT [91517] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 19:50:18.373 GMT [91518] LOG:  database system was shut down at 2023-01-23 19:50:18 GMT
2023-01-23 19:50:18.380 GMT [91517] LOG:  database system is ready to accept connections
2023-01-23 19:51:00.285 GMT [91517] LOG:  received fast shutdown request
2023-01-23 19:51:00.287 GMT [91517] LOG:  aborting any active transactions
2023-01-23 19:51:00.291 GMT [91517] LOG:  background worker "logical replication launcher" (PID 91524) exited with exit code 1
2023-01-23 19:51:00.291 GMT [91519] LOG:  shutting down
2023-01-23 19:51:00.363 GMT [91517] LOG:  database system is shut down
2023-01-23 19:51:01.746 GMT [91763] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 19:51:01.747 GMT [91763] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 19:51:01.748 GMT [91763] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 19:51:01.753 GMT [91764] LOG:  database system was shut down at 2023-01-23 19:51:01 GMT
2023-01-23 19:51:01.759 GMT [91763] LOG:  database system is ready to accept connections
2023-01-23 19:56:43.590 GMT [91763] LOG:  received fast shutdown request
2023-01-23 19:56:43.592 GMT [91763] LOG:  aborting any active transactions
2023-01-23 19:56:43.597 GMT [91763] LOG:  background worker "logical replication launcher" (PID 91770) exited with exit code 1
2023-01-23 19:56:43.599 GMT [91765] LOG:  shutting down
2023-01-23 19:56:43.617 GMT [91763] LOG:  database system is shut down
2023-01-23 19:56:45.041 GMT [92946] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 19:56:45.041 GMT [92946] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 19:56:45.042 GMT [92946] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 19:56:45.050 GMT [92947] LOG:  database system was shut down at 2023-01-23 19:56:44 GMT
2023-01-23 19:56:45.055 GMT [92946] LOG:  database system is ready to accept connections
2023-01-23 20:00:56.044 GMT [92946] LOG:  received fast shutdown request
2023-01-23 20:00:56.046 GMT [92946] LOG:  aborting any active transactions
2023-01-23 20:00:56.052 GMT [92946] LOG:  background worker "logical replication launcher" (PID 92953) exited with exit code 1
2023-01-23 20:00:56.053 GMT [92948] LOG:  shutting down
2023-01-23 20:00:56.117 GMT [92946] LOG:  database system is shut down
2023-01-23 20:00:57.344 GMT [93870] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:00:57.344 GMT [93870] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:00:57.348 GMT [93870] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:00:57.356 GMT [93871] LOG:  database system was shut down at 2023-01-23 20:00:57 GMT
2023-01-23 20:00:57.362 GMT [93870] LOG:  database system is ready to accept connections
2023-01-23 20:00:58.741 GMT [93899] ERROR:  permission denied for table loan_application
2023-01-23 20:00:58.741 GMT [93899] CONTEXT:  SQL statement "UPDATE loan_application
	            SET application_status = 'APPROVED'
	            WHERE id = loan_id_p"
	PL/pgSQL function approve_or_deny_loan_application(integer,boolean) line 6 at SQL statement
	PL/pgSQL assignment "result = (SELECT * FROM staff.approve_or_deny_loan_application(1, TRUE))"
	PL/pgSQL function inline_code_block line 12 at assignment
2023-01-23 20:00:58.741 GMT [93899] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result =  (SELECT * FROM client.initiate_loan_payment(10000001, 100.00, 1));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_loan_application(1, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    result =  (SELECT * FROM client.initiate_loan_payment(10000001, 100.00, 1));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 20:01:09.035 GMT [93870] LOG:  received fast shutdown request
2023-01-23 20:01:09.037 GMT [93870] LOG:  aborting any active transactions
2023-01-23 20:01:09.043 GMT [93870] LOG:  background worker "logical replication launcher" (PID 93877) exited with exit code 1
2023-01-23 20:01:09.043 GMT [93872] LOG:  shutting down
2023-01-23 20:01:09.116 GMT [93870] LOG:  database system is shut down
2023-01-23 20:01:10.549 GMT [94033] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:01:10.549 GMT [94033] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:01:10.557 GMT [94033] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:01:10.570 GMT [94034] LOG:  database system was shut down at 2023-01-23 20:01:10 GMT
2023-01-23 20:01:10.578 GMT [94033] LOG:  database system is ready to accept connections
2023-01-23 20:01:11.890 GMT [94072] ERROR:  function client.place_transaction_into_account(integer, integer, integer, numeric, integer, boolean) does not exist at character 15
2023-01-23 20:01:11.890 GMT [94072] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 20:01:11.890 GMT [94072] QUERY:  SELECT * FROM client.place_transaction_into_account(account_identifier, orig_account_number, loan_id, payment_amount, 0, TRUE)
2023-01-23 20:01:11.890 GMT [94072] CONTEXT:  PL/pgSQL function initiate_loan_payment(integer,numeric,integer) line 16 at SQL statement
	PL/pgSQL assignment "result =  (SELECT * FROM client.initiate_loan_payment(10000001, 100.00, 1))"
	PL/pgSQL function inline_code_block line 20 at assignment
2023-01-23 20:01:11.890 GMT [94072] STATEMENT:  DO $$
	DECLARE result BOOLEAN;
	BEGIN
	    result =  (SELECT * FROM client.initiate_loan_payment(10000001, 100.00, 1));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET SESSION AUTHORIZATION;
	    RESET ROLE;
	
	    SET ROLE employee;
	
	    result = (SELECT * FROM staff.approve_or_deny_loan_application(1, TRUE));
	    RAISE NOTICE 'Result: %', result;
	
	    RESET ROLE;
	
	    SET ROLE johnsmith;
	    SET SESSION AUTHORIZATION johnsmith;
	
	    result =  (SELECT * FROM client.initiate_loan_payment(10000001, 100.00, 1));
	    RAISE NOTICE 'Result: %', result;
	END
	$$;
2023-01-23 20:01:59.304 GMT [94033] LOG:  received fast shutdown request
2023-01-23 20:01:59.306 GMT [94033] LOG:  aborting any active transactions
2023-01-23 20:01:59.310 GMT [94033] LOG:  background worker "logical replication launcher" (PID 94040) exited with exit code 1
2023-01-23 20:01:59.311 GMT [94035] LOG:  shutting down
2023-01-23 20:01:59.388 GMT [94033] LOG:  database system is shut down
2023-01-23 20:02:00.794 GMT [94305] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:02:00.794 GMT [94305] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:02:00.795 GMT [94305] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:02:00.799 GMT [94306] LOG:  database system was shut down at 2023-01-23 20:02:00 GMT
2023-01-23 20:02:00.803 GMT [94305] LOG:  database system is ready to accept connections
2023-01-23 20:10:35.712 GMT [94305] LOG:  received fast shutdown request
2023-01-23 20:10:35.714 GMT [94305] LOG:  aborting any active transactions
2023-01-23 20:10:35.719 GMT [94305] LOG:  background worker "logical replication launcher" (PID 94312) exited with exit code 1
2023-01-23 20:10:35.719 GMT [94307] LOG:  shutting down
2023-01-23 20:10:35.733 GMT [94305] LOG:  database system is shut down
2023-01-23 20:10:37.191 GMT [95933] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:10:37.193 GMT [95933] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:10:37.195 GMT [95933] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:10:37.205 GMT [95934] LOG:  database system was shut down at 2023-01-23 20:10:36 GMT
2023-01-23 20:10:37.213 GMT [95933] LOG:  database system is ready to accept connections
2023-01-23 20:10:38.520 GMT [95965] ERROR:  function client.view_credit_statement(integer) does not exist at character 15
2023-01-23 20:10:38.520 GMT [95965] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 20:10:38.520 GMT [95965] STATEMENT:  SELECT * FROM client.view_credit_statement(10000001);
2023-01-23 20:11:01.608 GMT [95933] LOG:  received fast shutdown request
2023-01-23 20:11:01.610 GMT [95933] LOG:  aborting any active transactions
2023-01-23 20:11:01.618 GMT [95933] LOG:  background worker "logical replication launcher" (PID 95940) exited with exit code 1
2023-01-23 20:11:01.619 GMT [95935] LOG:  shutting down
2023-01-23 20:11:01.697 GMT [95933] LOG:  database system is shut down
2023-01-23 20:11:03.073 GMT [96134] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:11:03.074 GMT [96134] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:11:03.080 GMT [96134] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:11:03.084 GMT [96135] LOG:  database system was shut down at 2023-01-23 20:11:02 GMT
2023-01-23 20:11:03.095 GMT [96134] LOG:  database system is ready to accept connections
2023-01-23 20:11:04.285 GMT [96174] ERROR:  column reference "account_number" is ambiguous at character 371
2023-01-23 20:11:04.285 GMT [96174] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 20:11:04.285 GMT [96174] QUERY:  SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id
2023-01-23 20:11:04.285 GMT [96174] CONTEXT:  PL/pgSQL function view_credit_statement(integer,integer) line 9 at RETURN QUERY
2023-01-23 20:11:04.285 GMT [96174] STATEMENT:  SELECT * FROM client.view_credit_statement(10000001, 1);
2023-01-23 20:14:41.258 GMT [96134] LOG:  received fast shutdown request
2023-01-23 20:14:41.260 GMT [96134] LOG:  aborting any active transactions
2023-01-23 20:14:41.264 GMT [96134] LOG:  background worker "logical replication launcher" (PID 96141) exited with exit code 1
2023-01-23 20:14:41.264 GMT [96136] LOG:  shutting down
2023-01-23 20:14:41.330 GMT [96134] LOG:  database system is shut down
2023-01-23 20:14:42.520 GMT [96947] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:14:42.520 GMT [96947] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:14:42.521 GMT [96947] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:14:42.525 GMT [96948] LOG:  database system was shut down at 2023-01-23 20:14:42 GMT
2023-01-23 20:14:42.530 GMT [96947] LOG:  database system is ready to accept connections
2023-01-23 20:14:43.858 GMT [96973] ERROR:  column credit_accounts_statement.statement_id does not exist at character 405
2023-01-23 20:14:43.858 GMT [96973] QUERY:  SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_number_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.statement_id = statement_id
2023-01-23 20:14:43.858 GMT [96973] CONTEXT:  PL/pgSQL function view_credit_statement(integer,integer) line 9 at RETURN QUERY
2023-01-23 20:14:43.858 GMT [96973] STATEMENT:  SELECT * FROM client.view_credit_statement(10000001, 1);
2023-01-23 20:16:58.430 GMT [96947] LOG:  received fast shutdown request
2023-01-23 20:16:58.432 GMT [96947] LOG:  aborting any active transactions
2023-01-23 20:16:58.437 GMT [96947] LOG:  background worker "logical replication launcher" (PID 96954) exited with exit code 1
2023-01-23 20:16:58.438 GMT [96949] LOG:  shutting down
2023-01-23 20:16:58.497 GMT [96947] LOG:  database system is shut down
2023-01-23 20:16:59.795 GMT [97471] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:16:59.796 GMT [97471] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:16:59.797 GMT [97471] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:16:59.802 GMT [97472] LOG:  database system was shut down at 2023-01-23 20:16:59 GMT
2023-01-23 20:16:59.807 GMT [97471] LOG:  database system is ready to accept connections
2023-01-23 20:17:01.531 GMT [97512] ERROR:  structure of query does not match function result type
2023-01-23 20:17:01.531 GMT [97512] DETAIL:  Returned type integer does not match expected type date in column 1.
2023-01-23 20:17:01.531 GMT [97512] CONTEXT:  SQL statement "SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_number_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.id = statement_id"
	PL/pgSQL function view_credit_statement(integer,integer) line 9 at RETURN QUERY
2023-01-23 20:17:01.531 GMT [97512] STATEMENT:  SELECT * FROM client.view_credit_statement(10000001, 1);
2023-01-23 20:18:16.812 GMT [97471] LOG:  received fast shutdown request
2023-01-23 20:18:16.813 GMT [97471] LOG:  aborting any active transactions
2023-01-23 20:18:16.815 GMT [97471] LOG:  background worker "logical replication launcher" (PID 97478) exited with exit code 1
2023-01-23 20:18:16.821 GMT [97473] LOG:  shutting down
2023-01-23 20:18:16.896 GMT [97471] LOG:  database system is shut down
2023-01-23 20:18:18.100 GMT [97852] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:18:18.100 GMT [97852] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:18:18.102 GMT [97852] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:18:18.108 GMT [97853] LOG:  database system was shut down at 2023-01-23 20:18:17 GMT
2023-01-23 20:18:18.140 GMT [97852] LOG:  database system is ready to accept connections
2023-01-23 20:18:19.602 GMT [97878] ERROR:  column reference "account_number" is ambiguous at character 378
2023-01-23 20:18:19.602 GMT [97878] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 20:18:19.602 GMT [97878] QUERY:  SELECT credit_accounts_statement.account_id, credit_accounts_statement.account_number, credit_accounts_statement.starting_date, credit_accounts_statement.end_date, credit_accounts_statement.amount
	        FROM client.credit_accounts_statement
	        WHERE credit_accounts_statement.account_id = account_number_identifier
	        AND credit_accounts_statement.account_number = account_number
	        AND credit_accounts_statement.id = statement_id
2023-01-23 20:18:19.602 GMT [97878] CONTEXT:  PL/pgSQL function view_credit_statement(integer,integer) line 9 at RETURN QUERY
2023-01-23 20:18:19.602 GMT [97878] STATEMENT:  SELECT * FROM client.view_credit_statement(10000001, 1);
2023-01-23 20:18:45.033 GMT [97852] LOG:  received fast shutdown request
2023-01-23 20:18:45.035 GMT [97852] LOG:  aborting any active transactions
2023-01-23 20:18:45.041 GMT [97852] LOG:  background worker "logical replication launcher" (PID 97859) exited with exit code 1
2023-01-23 20:18:45.043 GMT [97854] LOG:  shutting down
2023-01-23 20:18:45.102 GMT [97852] LOG:  database system is shut down
2023-01-23 20:18:46.225 GMT [98041] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:18:46.227 GMT [98041] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:18:46.229 GMT [98041] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:18:46.233 GMT [98042] LOG:  database system was shut down at 2023-01-23 20:18:45 GMT
2023-01-23 20:18:46.244 GMT [98041] LOG:  database system is ready to accept connections
2023-01-23 20:19:47.530 GMT [98041] LOG:  received fast shutdown request
2023-01-23 20:19:47.532 GMT [98041] LOG:  aborting any active transactions
2023-01-23 20:19:47.544 GMT [98041] LOG:  background worker "logical replication launcher" (PID 98048) exited with exit code 1
2023-01-23 20:19:47.544 GMT [98043] LOG:  shutting down
2023-01-23 20:19:47.627 GMT [98041] LOG:  database system is shut down
2023-01-23 20:19:49.003 GMT [98353] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:19:49.003 GMT [98353] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:19:49.005 GMT [98353] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:19:49.015 GMT [98354] LOG:  database system was shut down at 2023-01-23 20:19:48 GMT
2023-01-23 20:19:49.021 GMT [98353] LOG:  database system is ready to accept connections
2023-01-23 20:20:36.907 GMT [98353] LOG:  received fast shutdown request
2023-01-23 20:20:36.909 GMT [98353] LOG:  aborting any active transactions
2023-01-23 20:20:36.914 GMT [98353] LOG:  background worker "logical replication launcher" (PID 98360) exited with exit code 1
2023-01-23 20:20:36.914 GMT [98355] LOG:  shutting down
2023-01-23 20:20:36.965 GMT [98353] LOG:  database system is shut down
2023-01-23 20:20:38.157 GMT [98613] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:20:38.157 GMT [98613] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:20:38.159 GMT [98613] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:20:38.162 GMT [98614] LOG:  database system was shut down at 2023-01-23 20:20:37 GMT
2023-01-23 20:20:38.167 GMT [98613] LOG:  database system is ready to accept connections
2023-01-23 20:22:19.091 GMT [98613] LOG:  received fast shutdown request
2023-01-23 20:22:19.094 GMT [98613] LOG:  aborting any active transactions
2023-01-23 20:22:19.099 GMT [98613] LOG:  background worker "logical replication launcher" (PID 98620) exited with exit code 1
2023-01-23 20:22:19.099 GMT [98615] LOG:  shutting down
2023-01-23 20:22:19.154 GMT [98613] LOG:  database system is shut down
2023-01-23 20:22:20.594 GMT [99040] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:22:20.600 GMT [99040] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:22:20.602 GMT [99040] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:22:20.607 GMT [99041] LOG:  database system was shut down at 2023-01-23 20:22:20 GMT
2023-01-23 20:22:20.628 GMT [99040] LOG:  database system is ready to accept connections
2023-01-23 20:23:34.759 GMT [99040] LOG:  received fast shutdown request
2023-01-23 20:23:34.762 GMT [99040] LOG:  aborting any active transactions
2023-01-23 20:23:34.771 GMT [99040] LOG:  background worker "logical replication launcher" (PID 99047) exited with exit code 1
2023-01-23 20:23:34.775 GMT [99042] LOG:  shutting down
2023-01-23 20:23:34.913 GMT [99040] LOG:  database system is shut down
2023-01-23 20:23:36.516 GMT [99408] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:23:36.524 GMT [99408] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:23:36.526 GMT [99408] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:23:36.542 GMT [99409] LOG:  database system was shut down at 2023-01-23 20:23:36 GMT
2023-01-23 20:23:36.553 GMT [99408] LOG:  database system is ready to accept connections
2023-01-23 20:24:47.356 GMT [99408] LOG:  received fast shutdown request
2023-01-23 20:24:47.359 GMT [99408] LOG:  aborting any active transactions
2023-01-23 20:24:47.365 GMT [99408] LOG:  background worker "logical replication launcher" (PID 99415) exited with exit code 1
2023-01-23 20:24:47.371 GMT [99410] LOG:  shutting down
2023-01-23 20:24:47.447 GMT [99408] LOG:  database system is shut down
2023-01-23 20:24:48.726 GMT [99753] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:24:48.726 GMT [99753] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:24:48.727 GMT [99753] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:24:48.731 GMT [99754] LOG:  database system was shut down at 2023-01-23 20:24:48 GMT
2023-01-23 20:24:48.738 GMT [99753] LOG:  database system is ready to accept connections
2023-01-23 20:28:46.396 GMT [99753] LOG:  received fast shutdown request
2023-01-23 20:28:46.397 GMT [99753] LOG:  aborting any active transactions
2023-01-23 20:28:46.402 GMT [99753] LOG:  background worker "logical replication launcher" (PID 99760) exited with exit code 1
2023-01-23 20:28:46.403 GMT [99755] LOG:  shutting down
2023-01-23 20:28:46.467 GMT [99753] LOG:  database system is shut down
2023-01-23 20:28:47.815 GMT [100622] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:28:47.815 GMT [100622] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:28:47.817 GMT [100622] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:28:47.822 GMT [100623] LOG:  database system was shut down at 2023-01-23 20:28:47 GMT
2023-01-23 20:28:47.831 GMT [100622] LOG:  database system is ready to accept connections
2023-01-23 20:29:13.372 GMT [100622] LOG:  received fast shutdown request
2023-01-23 20:29:13.373 GMT [100622] LOG:  aborting any active transactions
2023-01-23 20:29:13.377 GMT [100622] LOG:  background worker "logical replication launcher" (PID 100629) exited with exit code 1
2023-01-23 20:29:13.378 GMT [100624] LOG:  shutting down
2023-01-23 20:29:13.453 GMT [100622] LOG:  database system is shut down
2023-01-23 20:29:15.032 GMT [100833] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:29:15.032 GMT [100833] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:29:15.033 GMT [100833] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:29:15.038 GMT [100834] LOG:  database system was shut down at 2023-01-23 20:29:14 GMT
2023-01-23 20:29:15.044 GMT [100833] LOG:  database system is ready to accept connections
2023-01-23 20:30:58.451 GMT [100833] LOG:  received fast shutdown request
2023-01-23 20:30:58.452 GMT [100833] LOG:  aborting any active transactions
2023-01-23 20:30:58.457 GMT [100833] LOG:  background worker "logical replication launcher" (PID 100840) exited with exit code 1
2023-01-23 20:30:58.457 GMT [100835] LOG:  shutting down
2023-01-23 20:30:58.534 GMT [100833] LOG:  database system is shut down
2023-01-23 20:30:59.818 GMT [101285] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:30:59.818 GMT [101285] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:30:59.819 GMT [101285] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:30:59.830 GMT [101286] LOG:  database system was shut down at 2023-01-23 20:30:59 GMT
2023-01-23 20:30:59.837 GMT [101285] LOG:  database system is ready to accept connections
2023-01-23 20:31:01.007 GMT [101320] ERROR:  syntax error at or near ")" at character 228
2023-01-23 20:31:01.007 GMT [101320] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statement(account_number_identifier INT, statement_id INT)
	RETURNS TABLE (account_id INT, account_number INT, starting_date DATE, end_date DATE, amount NUMERIC, dest_account_number) AS $$
	DECLARE account_identifier INT;
	BEGIN
	
	    account_identifier = client.get_account_id();
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_id, 'Viewed savings statement', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statement.account_id, savings_accounts_statement.account_number, savings_accounts_statement.starting_date, savings_accounts_statement.end_date, savings_accounts_statement.amount, savings_accounts_statement.dest_account_id
	        FROM client.savings_accounts_statement
	        WHERE savings_accounts_statement.account_id = account_identifier
	        AND savings_accounts_statement.account_number = account_number_identifier
	        AND savings_accounts_statement.id = statement_id;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 20:33:15.574 GMT [101285] LOG:  received fast shutdown request
2023-01-23 20:33:15.575 GMT [101285] LOG:  aborting any active transactions
2023-01-23 20:33:15.582 GMT [101285] LOG:  background worker "logical replication launcher" (PID 101292) exited with exit code 1
2023-01-23 20:33:15.582 GMT [101287] LOG:  shutting down
2023-01-23 20:33:15.672 GMT [101285] LOG:  database system is shut down
2023-01-23 20:33:16.977 GMT [101866] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:33:16.977 GMT [101866] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:33:16.978 GMT [101866] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:33:16.982 GMT [101867] LOG:  database system was shut down at 2023-01-23 20:33:16 GMT
2023-01-23 20:33:16.987 GMT [101866] LOG:  database system is ready to accept connections
2023-01-23 20:34:10.459 GMT [101866] LOG:  received fast shutdown request
2023-01-23 20:34:10.461 GMT [101866] LOG:  aborting any active transactions
2023-01-23 20:34:10.466 GMT [101866] LOG:  background worker "logical replication launcher" (PID 101873) exited with exit code 1
2023-01-23 20:34:10.466 GMT [101868] LOG:  shutting down
2023-01-23 20:34:10.564 GMT [101866] LOG:  database system is shut down
2023-01-23 20:34:12.514 GMT [102171] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:34:12.514 GMT [102171] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:34:12.516 GMT [102171] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:34:12.536 GMT [102172] LOG:  database system was shut down at 2023-01-23 20:34:12 GMT
2023-01-23 20:34:12.547 GMT [102171] LOG:  database system is ready to accept connections
2023-01-23 20:34:14.237 GMT [102210] ERROR:  structure of query does not match function result type
2023-01-23 20:34:14.237 GMT [102210] DETAIL:  Returned type integer does not match expected type date in column 1.
2023-01-23 20:34:14.237 GMT [102210] CONTEXT:  SQL statement "SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number_identifier
	        AND credit_accounts_statements.account_id = account_identifier"
	PL/pgSQL function view_credit_statements(integer) line 9 at RETURN QUERY
2023-01-23 20:34:14.237 GMT [102210] STATEMENT:  SELECT * FROM client.view_credit_statements(10000001)
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
2023-01-23 20:34:19.688 GMT [102171] LOG:  received fast shutdown request
2023-01-23 20:34:19.691 GMT [102171] LOG:  aborting any active transactions
2023-01-23 20:34:19.699 GMT [102171] LOG:  background worker "logical replication launcher" (PID 102178) exited with exit code 1
2023-01-23 20:34:19.699 GMT [102173] LOG:  shutting down
2023-01-23 20:34:19.810 GMT [102171] LOG:  database system is shut down
2023-01-23 20:34:20.989 GMT [102312] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:34:20.990 GMT [102312] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:34:20.992 GMT [102312] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:34:20.998 GMT [102314] LOG:  database system was shut down at 2023-01-23 20:34:20 GMT
2023-01-23 20:34:21.004 GMT [102312] LOG:  database system is ready to accept connections
2023-01-23 20:34:22.226 GMT [102348] ERROR:  structure of query does not match function result type
2023-01-23 20:34:22.226 GMT [102348] DETAIL:  Returned type integer does not match expected type date in column 1.
2023-01-23 20:34:22.226 GMT [102348] CONTEXT:  SQL statement "SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number_identifier
	        AND credit_accounts_statements.account_id = account_identifier"
	PL/pgSQL function view_credit_statements(integer) line 9 at RETURN QUERY
2023-01-23 20:34:22.226 GMT [102348] STATEMENT:  SELECT * FROM client.view_credit_statements(10000001);
2023-01-23 20:36:07.899 GMT [102312] LOG:  received fast shutdown request
2023-01-23 20:36:07.901 GMT [102312] LOG:  aborting any active transactions
2023-01-23 20:36:07.905 GMT [102312] LOG:  background worker "logical replication launcher" (PID 102320) exited with exit code 1
2023-01-23 20:36:07.906 GMT [102315] LOG:  shutting down
2023-01-23 20:36:07.961 GMT [102312] LOG:  database system is shut down
2023-01-23 20:36:09.284 GMT [102813] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:36:09.285 GMT [102813] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:36:09.288 GMT [102813] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:36:09.292 GMT [102814] LOG:  database system was shut down at 2023-01-23 20:36:09 GMT
2023-01-23 20:36:09.302 GMT [102813] LOG:  database system is ready to accept connections
2023-01-23 20:36:10.508 GMT [102852] ERROR:  parameter name "account_id" used more than once
2023-01-23 20:36:10.508 GMT [102852] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_savings_statements(account_number_identifier INT)
	RETURNS TABLE (account_id INT, account_number INT, starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	DECLARE account_identifier INT;
	BEGIN
	
	    account_identifier = client.get_account_id();
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed savings statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT savings_accounts_statements.starting_date, savings_accounts_statements.end_date, savings_accounts_statements.amount, savings_accounts_statements.account_id
	        FROM client.savings_accounts_statements
	        WHERE savings_accounts_statements.account_number = account_number_identifier
	        AND savings_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 20:36:10.509 GMT [102852] ERROR:  parameter name "account_id" used more than once
2023-01-23 20:36:10.509 GMT [102852] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_debit_statements(account_number_identifier INT)
	RETURNS TABLE (account_id INT, account_number INT, starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	DECLARE account_identifier INT;
	BEGIN
	
	    account_identifier = client.get_account_id();
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed debit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT debit_accounts_statements.account_id, debit_accounts_statements.account_number, debit_accounts_statements.starting_date, debit_accounts_statements.end_date, debit_accounts_statements.amount
	        FROM client.debit_accounts_statements
	        WHERE debit_accounts_statements.account_number = account_number_identifier
	        AND debit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 20:36:10.509 GMT [102852] ERROR:  parameter name "account_id" used more than once
2023-01-23 20:36:10.509 GMT [102852] STATEMENT:  CREATE OR REPLACE FUNCTION client.view_credit_statements(account_number_identifier INT)
	RETURNS TABLE (account_id INT, account_number INT, starting_date DATE, end_date DATE, amount NUMERIC, account_id INT) AS $$
	DECLARE account_identifier INT;
	BEGIN
	
	    account_identifier = client.get_account_id();
	
	    INSERT INTO management_log (account_id, log_description, log_date) VALUES (account_identifier, 'Viewed credit statements', CURRENT_DATE);
	
	    RETURN QUERY
	        SELECT credit_accounts_statements.account_id, credit_accounts_statements.account_number, credit_accounts_statements.starting_date, credit_accounts_statements.end_date, credit_accounts_statements.amount
	        FROM client.credit_accounts_statements
	        WHERE credit_accounts_statements.account_number = account_number_identifier
	        AND credit_accounts_statements.account_id = account_identifier;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 20:36:10.732 GMT [102852] ERROR:  function client.view_credit_statements(integer) does not exist at character 15
2023-01-23 20:36:10.732 GMT [102852] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 20:36:10.732 GMT [102852] STATEMENT:  SELECT * FROM client.view_credit_statements(10000001);
2023-01-23 20:37:06.458 GMT [102813] LOG:  received fast shutdown request
2023-01-23 20:37:06.460 GMT [102813] LOG:  aborting any active transactions
2023-01-23 20:37:06.465 GMT [102813] LOG:  background worker "logical replication launcher" (PID 102820) exited with exit code 1
2023-01-23 20:37:06.472 GMT [102815] LOG:  shutting down
2023-01-23 20:37:06.571 GMT [102813] LOG:  database system is shut down
2023-01-23 20:37:07.996 GMT [103102] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:37:07.996 GMT [103102] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:37:07.997 GMT [103102] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:37:08.009 GMT [103103] LOG:  database system was shut down at 2023-01-23 20:37:07 GMT
2023-01-23 20:37:08.032 GMT [103102] LOG:  database system is ready to accept connections
2023-01-23 20:39:21.769 GMT [103102] LOG:  received fast shutdown request
2023-01-23 20:39:21.772 GMT [103102] LOG:  aborting any active transactions
2023-01-23 20:39:21.777 GMT [103102] LOG:  background worker "logical replication launcher" (PID 103109) exited with exit code 1
2023-01-23 20:39:21.777 GMT [103104] LOG:  shutting down
2023-01-23 20:39:21.851 GMT [103102] LOG:  database system is shut down
2023-01-23 20:39:23.187 GMT [103630] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 20:39:23.188 GMT [103630] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 20:39:23.190 GMT [103630] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 20:39:23.198 GMT [103631] LOG:  database system was shut down at 2023-01-23 20:39:22 GMT
2023-01-23 20:39:23.228 GMT [103630] LOG:  database system is ready to accept connections
2023-01-23 21:02:38.645 GMT [103630] LOG:  received fast shutdown request
2023-01-23 21:02:38.648 GMT [103630] LOG:  aborting any active transactions
2023-01-23 21:02:38.651 GMT [103630] LOG:  background worker "logical replication launcher" (PID 103637) exited with exit code 1
2023-01-23 21:02:38.654 GMT [103632] LOG:  shutting down
2023-01-23 21:02:38.674 GMT [103630] LOG:  database system is shut down
2023-01-23 21:02:43.354 GMT [107824] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:02:43.355 GMT [107824] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:02:43.357 GMT [107824] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:02:43.362 GMT [107827] LOG:  database system was shut down at 2023-01-23 21:02:43 GMT
2023-01-23 21:02:43.367 GMT [107824] LOG:  database system is ready to accept connections
2023-01-23 21:11:44.750 GMT [107824] LOG:  received fast shutdown request
2023-01-23 21:11:44.752 GMT [107824] LOG:  aborting any active transactions
2023-01-23 21:11:44.754 GMT [107824] LOG:  background worker "logical replication launcher" (PID 107833) exited with exit code 1
2023-01-23 21:11:44.760 GMT [107828] LOG:  shutting down
2023-01-23 21:11:44.773 GMT [107824] LOG:  database system is shut down
2023-01-23 21:11:46.064 GMT [109747] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:11:46.064 GMT [109747] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:11:46.065 GMT [109747] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:11:46.069 GMT [109748] LOG:  database system was shut down at 2023-01-23 21:11:45 GMT
2023-01-23 21:11:46.073 GMT [109747] LOG:  database system is ready to accept connections
2023-01-23 21:22:44.395 GMT [109747] LOG:  received fast shutdown request
2023-01-23 21:22:44.397 GMT [109747] LOG:  aborting any active transactions
2023-01-23 21:22:44.403 GMT [109747] LOG:  background worker "logical replication launcher" (PID 109754) exited with exit code 1
2023-01-23 21:22:44.404 GMT [109749] LOG:  shutting down
2023-01-23 21:22:44.420 GMT [109747] LOG:  database system is shut down
2023-01-23 21:22:45.662 GMT [111773] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:22:45.663 GMT [111773] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:22:45.664 GMT [111773] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:22:45.672 GMT [111774] LOG:  database system was shut down at 2023-01-23 21:22:45 GMT
2023-01-23 21:22:45.682 GMT [111773] LOG:  database system is ready to accept connections
2023-01-23 21:22:46.871 GMT [111799] ERROR:  column reference "first_name" is ambiguous at character 8
2023-01-23 21:22:46.871 GMT [111799] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 21:22:46.871 GMT [111799] QUERY:  SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE
2023-01-23 21:22:46.871 GMT [111799] CONTEXT:  PL/pgSQL function review_unverified_customer_personal_information() line 3 at RETURN QUERY
2023-01-23 21:22:46.871 GMT [111799] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:23:55.916 GMT [111773] LOG:  received fast shutdown request
2023-01-23 21:23:55.918 GMT [111773] LOG:  aborting any active transactions
2023-01-23 21:23:55.922 GMT [111773] LOG:  background worker "logical replication launcher" (PID 111780) exited with exit code 1
2023-01-23 21:23:55.922 GMT [111775] LOG:  shutting down
2023-01-23 21:23:55.981 GMT [111773] LOG:  database system is shut down
2023-01-23 21:23:57.232 GMT [112143] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:23:57.233 GMT [112143] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:23:57.234 GMT [112143] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:23:57.240 GMT [112144] LOG:  database system was shut down at 2023-01-23 21:23:56 GMT
2023-01-23 21:23:57.245 GMT [112143] LOG:  database system is ready to accept connections
2023-01-23 21:23:58.692 GMT [112172] ERROR:  column "address" does not exist at character 46
2023-01-23 21:23:58.692 GMT [112172] QUERY:  SELECT first_name, last_name, date_of_birth, address, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE
2023-01-23 21:23:58.692 GMT [112172] CONTEXT:  PL/pgSQL function review_unverified_customer_personal_information() line 3 at RETURN QUERY
2023-01-23 21:23:58.692 GMT [112172] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:24:15.715 GMT [112143] LOG:  received fast shutdown request
2023-01-23 21:24:15.717 GMT [112143] LOG:  aborting any active transactions
2023-01-23 21:24:15.728 GMT [112143] LOG:  background worker "logical replication launcher" (PID 112150) exited with exit code 1
2023-01-23 21:24:15.729 GMT [112145] LOG:  shutting down
2023-01-23 21:24:15.791 GMT [112143] LOG:  database system is shut down
2023-01-23 21:24:17.081 GMT [112319] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:24:17.081 GMT [112319] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:24:17.083 GMT [112319] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:24:17.088 GMT [112320] LOG:  database system was shut down at 2023-01-23 21:24:16 GMT
2023-01-23 21:24:17.093 GMT [112319] LOG:  database system is ready to accept connections
2023-01-23 21:24:18.624 GMT [112345] ERROR:  column "email" does not exist at character 46
2023-01-23 21:24:18.624 GMT [112345] QUERY:  SELECT first_name, last_name, date_of_birth, email, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE
2023-01-23 21:24:18.624 GMT [112345] CONTEXT:  PL/pgSQL function review_unverified_customer_personal_information() line 3 at RETURN QUERY
2023-01-23 21:24:18.624 GMT [112345] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:24:27.676 GMT [112319] LOG:  received fast shutdown request
2023-01-23 21:24:27.677 GMT [112319] LOG:  aborting any active transactions
2023-01-23 21:24:27.681 GMT [112319] LOG:  background worker "logical replication launcher" (PID 112326) exited with exit code 1
2023-01-23 21:24:27.681 GMT [112321] LOG:  shutting down
2023-01-23 21:24:27.759 GMT [112319] LOG:  database system is shut down
2023-01-23 21:24:29.085 GMT [112465] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:24:29.085 GMT [112465] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:24:29.086 GMT [112465] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:24:29.090 GMT [112466] LOG:  database system was shut down at 2023-01-23 21:24:28 GMT
2023-01-23 21:24:29.096 GMT [112465] LOG:  database system is ready to accept connections
2023-01-23 21:24:30.433 GMT [112504] ERROR:  structure of query does not match function result type
2023-01-23 21:24:30.433 GMT [112504] DETAIL:  Returned type character varying(255) does not match expected type text in column 1.
2023-01-23 21:24:30.433 GMT [112504] CONTEXT:  SQL statement "SELECT first_name, last_name, date_of_birth, email_address, phone_number
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE"
	PL/pgSQL function review_unverified_customer_personal_information() line 3 at RETURN QUERY
2023-01-23 21:24:30.433 GMT [112504] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:26:12.375 GMT [112465] LOG:  received fast shutdown request
2023-01-23 21:26:12.376 GMT [112465] LOG:  aborting any active transactions
2023-01-23 21:26:12.381 GMT [112465] LOG:  background worker "logical replication launcher" (PID 112472) exited with exit code 1
2023-01-23 21:26:12.386 GMT [112467] LOG:  shutting down
2023-01-23 21:26:12.439 GMT [112465] LOG:  database system is shut down
2023-01-23 21:26:13.819 GMT [112935] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:26:13.820 GMT [112935] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:26:13.822 GMT [112935] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:26:13.826 GMT [112936] LOG:  database system was shut down at 2023-01-23 21:26:13 GMT
2023-01-23 21:26:13.833 GMT [112935] LOG:  database system is ready to accept connections
2023-01-23 21:26:14.860 GMT [112974] ERROR:  syntax error at or near "PRIMARY" at character 108
2023-01-23 21:26:14.860 GMT [112974] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURNS TABLE(id SERIAL PRIMARY KEY,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    email_address VARCHAR(255),
	    address_street VARCHAR(255),
	    address_city VARCHAR(255),
	    address_county VARCHAR(255),
	    address_postcode VARCHAR(255),
	    is_verified BOOLEAN DEFAULT FALSE) AS $$
	BEGIN
	    RETURN QUERY SELECT *
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 21:26:15.316 GMT [112974] ERROR:  function staff.review_unverified_customer_personal_information() does not exist at character 15
2023-01-23 21:26:15.316 GMT [112974] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 21:26:15.316 GMT [112974] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:26:48.267 GMT [112935] LOG:  received fast shutdown request
2023-01-23 21:26:48.270 GMT [112935] LOG:  aborting any active transactions
2023-01-23 21:26:48.274 GMT [112935] LOG:  background worker "logical replication launcher" (PID 112942) exited with exit code 1
2023-01-23 21:26:48.274 GMT [112937] LOG:  shutting down
2023-01-23 21:26:48.347 GMT [112935] LOG:  database system is shut down
2023-01-23 21:26:49.646 GMT [113157] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:26:49.646 GMT [113157] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:26:49.648 GMT [113157] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:26:49.652 GMT [113158] LOG:  database system was shut down at 2023-01-23 21:26:49 GMT
2023-01-23 21:26:49.657 GMT [113157] LOG:  database system is ready to accept connections
2023-01-23 21:26:50.619 GMT [113190] ERROR:  type serial does not exist
2023-01-23 21:26:50.619 GMT [113190] STATEMENT:  CREATE OR REPLACE FUNCTION staff.review_unverified_customer_personal_information()
	RETURNS TABLE(id SERIAl,
	    first_name VARCHAR(255),
	    last_name VARCHAR(255),
	    date_of_birth DATE,
	    phone_number VARCHAR(255),
	    email_address VARCHAR(255),
	    address_street VARCHAR(255),
	    address_city VARCHAR(255),
	    address_county VARCHAR(255),
	    address_postcode VARCHAR(255),
	    is_verified BOOLEAN) AS $$
	BEGIN
	    RETURN QUERY SELECT *
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE;
	END;
	$$ LANGUAGE plpgsql;
2023-01-23 21:26:51.141 GMT [113190] ERROR:  function staff.review_unverified_customer_personal_information() does not exist at character 15
2023-01-23 21:26:51.141 GMT [113190] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2023-01-23 21:26:51.141 GMT [113190] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:27:07.469 GMT [113157] LOG:  received fast shutdown request
2023-01-23 21:27:07.470 GMT [113157] LOG:  aborting any active transactions
2023-01-23 21:27:07.472 GMT [113157] LOG:  background worker "logical replication launcher" (PID 113164) exited with exit code 1
2023-01-23 21:27:07.476 GMT [113159] LOG:  shutting down
2023-01-23 21:27:07.542 GMT [113157] LOG:  database system is shut down
2023-01-23 21:27:08.650 GMT [113328] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:27:08.650 GMT [113328] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:27:08.662 GMT [113328] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:27:08.678 GMT [113329] LOG:  database system was shut down at 2023-01-23 21:27:08 GMT
2023-01-23 21:27:08.684 GMT [113328] LOG:  database system is ready to accept connections
2023-01-23 21:27:10.495 GMT [113365] ERROR:  column reference "is_verified" is ambiguous at character 65
2023-01-23 21:27:10.495 GMT [113365] DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2023-01-23 21:27:10.495 GMT [113365] QUERY:  SELECT *
	    FROM staff.customer_personal_information
	    WHERE is_verified = FALSE
2023-01-23 21:27:10.495 GMT [113365] CONTEXT:  PL/pgSQL function review_unverified_customer_personal_information() line 3 at RETURN QUERY
2023-01-23 21:27:10.495 GMT [113365] STATEMENT:  SELECT * FROM staff.review_unverified_customer_personal_information();
2023-01-23 21:27:34.010 GMT [113328] LOG:  received fast shutdown request
2023-01-23 21:27:34.012 GMT [113328] LOG:  aborting any active transactions
2023-01-23 21:27:34.015 GMT [113328] LOG:  background worker "logical replication launcher" (PID 113335) exited with exit code 1
2023-01-23 21:27:34.016 GMT [113330] LOG:  shutting down
2023-01-23 21:27:34.099 GMT [113328] LOG:  database system is shut down
2023-01-23 21:27:35.452 GMT [113527] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:27:35.453 GMT [113527] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:27:35.455 GMT [113527] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:27:35.460 GMT [113528] LOG:  database system was shut down at 2023-01-23 21:27:35 GMT
2023-01-23 21:27:35.465 GMT [113527] LOG:  database system is ready to accept connections
2023-01-23 21:28:17.866 GMT [113527] LOG:  received fast shutdown request
2023-01-23 21:28:17.869 GMT [113527] LOG:  aborting any active transactions
2023-01-23 21:28:17.873 GMT [113527] LOG:  background worker "logical replication launcher" (PID 113534) exited with exit code 1
2023-01-23 21:28:17.873 GMT [113529] LOG:  shutting down
2023-01-23 21:28:17.952 GMT [113527] LOG:  database system is shut down
2023-01-23 21:28:19.559 GMT [113790] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:28:19.559 GMT [113790] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:28:19.564 GMT [113790] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:28:19.570 GMT [113791] LOG:  database system was shut down at 2023-01-23 21:28:19 GMT
2023-01-23 21:28:19.583 GMT [113790] LOG:  database system is ready to accept connections
2023-01-23 21:28:21.179 GMT [113827] ERROR:  permission denied for table customer
2023-01-23 21:28:21.179 GMT [113827] CONTEXT:  SQL statement "UPDATE customer
	        SET is_verified = TRUE
	        WHERE id = customer_id"
	PL/pgSQL function verify_customer_personal_information(integer) line 5 at SQL statement
2023-01-23 21:28:21.179 GMT [113827] STATEMENT:  SELECT * FROM staff.verify_customer_personal_information(1);
2023-01-23 21:28:33.875 GMT [113790] LOG:  received fast shutdown request
2023-01-23 21:28:33.876 GMT [113790] LOG:  aborting any active transactions
2023-01-23 21:28:33.881 GMT [113790] LOG:  background worker "logical replication launcher" (PID 113797) exited with exit code 1
2023-01-23 21:28:33.883 GMT [113792] LOG:  shutting down
2023-01-23 21:28:33.957 GMT [113790] LOG:  database system is shut down
2023-01-23 21:28:35.235 GMT [113955] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:28:35.235 GMT [113955] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:28:35.247 GMT [113955] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:28:35.255 GMT [113956] LOG:  database system was shut down at 2023-01-23 21:28:34 GMT
2023-01-23 21:28:35.260 GMT [113955] LOG:  database system is ready to accept connections
2023-01-23 21:28:49.602 GMT [113955] LOG:  received fast shutdown request
2023-01-23 21:28:49.603 GMT [113955] LOG:  aborting any active transactions
2023-01-23 21:28:49.609 GMT [113955] LOG:  background worker "logical replication launcher" (PID 113962) exited with exit code 1
2023-01-23 21:28:49.610 GMT [113957] LOG:  shutting down
2023-01-23 21:28:49.677 GMT [113955] LOG:  database system is shut down
2023-01-23 21:28:50.942 GMT [114120] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:28:50.943 GMT [114120] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:28:50.944 GMT [114120] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:28:50.959 GMT [114121] LOG:  database system was shut down at 2023-01-23 21:28:50 GMT
2023-01-23 21:28:50.967 GMT [114120] LOG:  database system is ready to accept connections
2023-01-23 21:29:40.663 GMT [114120] LOG:  received fast shutdown request
2023-01-23 21:29:40.664 GMT [114120] LOG:  aborting any active transactions
2023-01-23 21:29:40.670 GMT [114120] LOG:  background worker "logical replication launcher" (PID 114127) exited with exit code 1
2023-01-23 21:29:40.670 GMT [114122] LOG:  shutting down
2023-01-23 21:29:40.730 GMT [114120] LOG:  database system is shut down
2023-01-23 21:29:41.967 GMT [114412] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:29:41.977 GMT [114412] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:29:41.982 GMT [114412] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:29:41.987 GMT [114413] LOG:  database system was shut down at 2023-01-23 21:29:41 GMT
2023-01-23 21:29:41.992 GMT [114412] LOG:  database system is ready to accept connections
2023-01-23 21:49:41.091 GMT [114412] LOG:  received fast shutdown request
2023-01-23 21:49:41.092 GMT [114412] LOG:  aborting any active transactions
2023-01-23 21:49:41.095 GMT [114412] LOG:  background worker "logical replication launcher" (PID 114419) exited with exit code 1
2023-01-23 21:49:41.098 GMT [114414] LOG:  shutting down
2023-01-23 21:49:41.116 GMT [114412] LOG:  database system is shut down
2023-01-23 21:49:51.157 GMT [118061] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:49:51.158 GMT [118061] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:49:51.160 GMT [118061] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:49:51.164 GMT [118062] LOG:  database system was shut down at 2023-01-23 21:49:50 GMT
2023-01-23 21:49:51.169 GMT [118061] LOG:  database system is ready to accept connections
2023-01-23 21:50:41.229 GMT [118061] LOG:  received fast shutdown request
2023-01-23 21:50:41.231 GMT [118061] LOG:  aborting any active transactions
2023-01-23 21:50:41.238 GMT [118061] LOG:  background worker "logical replication launcher" (PID 118068) exited with exit code 1
2023-01-23 21:50:41.238 GMT [118063] LOG:  shutting down
2023-01-23 21:50:41.311 GMT [118061] LOG:  database system is shut down
2023-01-23 21:50:42.689 GMT [118354] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 21:50:42.689 GMT [118354] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 21:50:42.690 GMT [118354] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 21:50:42.694 GMT [118355] LOG:  database system was shut down at 2023-01-23 21:50:42 GMT
2023-01-23 21:50:42.699 GMT [118354] LOG:  database system is ready to accept connections
2023-01-23 22:01:05.811 GMT [118354] LOG:  received fast shutdown request
2023-01-23 22:01:05.812 GMT [118354] LOG:  aborting any active transactions
2023-01-23 22:01:05.816 GMT [118354] LOG:  background worker "logical replication launcher" (PID 118361) exited with exit code 1
2023-01-23 22:01:05.817 GMT [118356] LOG:  shutting down
2023-01-23 22:01:05.836 GMT [118354] LOG:  database system is shut down
2023-01-23 22:01:07.125 GMT [120162] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:01:07.125 GMT [120162] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:01:07.127 GMT [120162] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:01:07.130 GMT [120164] LOG:  database system was shut down at 2023-01-23 22:01:06 GMT
2023-01-23 22:01:07.143 GMT [120162] LOG:  database system is ready to accept connections
2023-01-23 22:01:18.432 GMT [120162] LOG:  received fast shutdown request
2023-01-23 22:01:18.434 GMT [120162] LOG:  aborting any active transactions
2023-01-23 22:01:18.439 GMT [120162] LOG:  background worker "logical replication launcher" (PID 120171) exited with exit code 1
2023-01-23 22:01:18.439 GMT [120166] LOG:  shutting down
2023-01-23 22:01:18.514 GMT [120162] LOG:  database system is shut down
2023-01-23 22:01:19.867 GMT [120320] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:01:19.868 GMT [120320] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:01:19.874 GMT [120320] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:01:19.887 GMT [120321] LOG:  database system was shut down at 2023-01-23 22:01:19 GMT
2023-01-23 22:01:19.894 GMT [120320] LOG:  database system is ready to accept connections
2023-01-23 22:07:10.520 GMT [120320] LOG:  received fast shutdown request
2023-01-23 22:07:10.522 GMT [120320] LOG:  aborting any active transactions
2023-01-23 22:07:10.526 GMT [120320] LOG:  background worker "logical replication launcher" (PID 120327) exited with exit code 1
2023-01-23 22:07:10.528 GMT [120322] LOG:  shutting down
2023-01-23 22:07:10.543 GMT [120320] LOG:  database system is shut down
2023-01-23 22:07:11.952 GMT [121459] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:07:11.952 GMT [121459] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:07:11.953 GMT [121459] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:07:11.967 GMT [121460] LOG:  database system was shut down at 2023-01-23 22:07:11 GMT
2023-01-23 22:07:11.972 GMT [121459] LOG:  database system is ready to accept connections
2023-01-23 22:07:36.926 GMT [121459] LOG:  received fast shutdown request
2023-01-23 22:07:36.929 GMT [121459] LOG:  aborting any active transactions
2023-01-23 22:07:36.931 GMT [121459] LOG:  background worker "logical replication launcher" (PID 121466) exited with exit code 1
2023-01-23 22:07:36.935 GMT [121461] LOG:  shutting down
2023-01-23 22:07:37.057 GMT [121459] LOG:  database system is shut down
2023-01-23 22:07:38.527 GMT [121657] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:07:38.527 GMT [121657] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:07:38.537 GMT [121657] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:07:38.544 GMT [121661] LOG:  database system was shut down at 2023-01-23 22:07:38 GMT
2023-01-23 22:07:38.550 GMT [121657] LOG:  database system is ready to accept connections
2023-01-23 22:07:39.921 GMT [121696] ERROR:  relation "overdraft" does not exist at character 8
2023-01-23 22:07:39.921 GMT [121696] QUERY:  UPDATE overdraft
	            SET overdraft_approved = FALSE
	            WHERE id = overdraft_id
2023-01-23 22:07:39.921 GMT [121696] CONTEXT:  PL/pgSQL function approve_or_deny_overdraft_application(integer,boolean) line 11 at SQL statement
2023-01-23 22:07:39.921 GMT [121696] STATEMENT:  SELECT * FROM staff.approve_or_deny_overdraft_application(1, FALSE);
2023-01-23 22:08:14.329 GMT [121657] LOG:  received fast shutdown request
2023-01-23 22:08:14.335 GMT [121657] LOG:  aborting any active transactions
2023-01-23 22:08:14.339 GMT [121657] LOG:  background worker "logical replication launcher" (PID 121667) exited with exit code 1
2023-01-23 22:08:14.339 GMT [121662] LOG:  shutting down
2023-01-23 22:08:14.421 GMT [121657] LOG:  database system is shut down
2023-01-23 22:08:15.681 GMT [121892] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:08:15.682 GMT [121892] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:08:15.683 GMT [121892] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:08:15.692 GMT [121893] LOG:  database system was shut down at 2023-01-23 22:08:15 GMT
2023-01-23 22:08:15.703 GMT [121892] LOG:  database system is ready to accept connections
2023-01-23 22:08:17.181 GMT [121918] ERROR:  relation "overdraft" does not exist at character 8
2023-01-23 22:08:17.181 GMT [121918] QUERY:  UPDATE overdraft
	            SET approved = FALSE
	            WHERE id = overdraft_id
2023-01-23 22:08:17.181 GMT [121918] CONTEXT:  PL/pgSQL function approve_or_deny_overdraft_application(integer,boolean) line 11 at SQL statement
2023-01-23 22:08:17.181 GMT [121918] STATEMENT:  SELECT * FROM staff.approve_or_deny_overdraft_application(1, FALSE);
2023-01-23 22:08:24.411 GMT [121892] LOG:  received fast shutdown request
2023-01-23 22:08:24.413 GMT [121892] LOG:  aborting any active transactions
2023-01-23 22:08:24.423 GMT [121892] LOG:  background worker "logical replication launcher" (PID 121899) exited with exit code 1
2023-01-23 22:08:24.423 GMT [121894] LOG:  shutting down
2023-01-23 22:08:24.479 GMT [121892] LOG:  database system is shut down
2023-01-23 22:08:25.725 GMT [122035] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:08:25.725 GMT [122035] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:08:25.727 GMT [122035] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:08:25.731 GMT [122036] LOG:  database system was shut down at 2023-01-23 22:08:25 GMT
2023-01-23 22:08:25.736 GMT [122035] LOG:  database system is ready to accept connections
2023-01-23 22:08:27.135 GMT [122064] ERROR:  permission denied for table debit_overdraft
2023-01-23 22:08:27.135 GMT [122064] CONTEXT:  SQL statement "UPDATE debit_overdraft
	            SET approved = FALSE
	            WHERE id = overdraft_id"
	PL/pgSQL function approve_or_deny_overdraft_application(integer,boolean) line 11 at SQL statement
2023-01-23 22:08:27.135 GMT [122064] STATEMENT:  SELECT * FROM staff.approve_or_deny_overdraft_application(1, FALSE);
2023-01-23 22:08:39.463 GMT [122035] LOG:  received fast shutdown request
2023-01-23 22:08:39.465 GMT [122035] LOG:  aborting any active transactions
2023-01-23 22:08:39.468 GMT [122035] LOG:  background worker "logical replication launcher" (PID 122042) exited with exit code 1
2023-01-23 22:08:39.469 GMT [122037] LOG:  shutting down
2023-01-23 22:08:39.570 GMT [122035] LOG:  database system is shut down
2023-01-23 22:08:40.934 GMT [122215] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-23 22:08:40.934 GMT [122215] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-23 22:08:40.937 GMT [122215] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-23 22:08:40.941 GMT [122216] LOG:  database system was shut down at 2023-01-23 22:08:40 GMT
2023-01-23 22:08:40.946 GMT [122215] LOG:  database system is ready to accept connections
2023-01-24 07:30:55.508 GMT [5563] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-24 07:30:55.511 GMT [5563] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-24 07:30:55.512 GMT [5563] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-24 07:30:55.521 GMT [5564] LOG:  database system was shut down at 2023-01-24 07:30:55 GMT
2023-01-24 07:30:55.526 GMT [5563] LOG:  database system is ready to accept connections
2023-01-24 07:31:36.970 GMT [5563] LOG:  received fast shutdown request
2023-01-24 07:31:36.971 GMT [5563] LOG:  aborting any active transactions
2023-01-24 07:31:36.973 GMT [5563] LOG:  background worker "logical replication launcher" (PID 5570) exited with exit code 1
2023-01-24 07:31:36.978 GMT [5565] LOG:  shutting down
2023-01-24 07:31:37.043 GMT [5563] LOG:  database system is shut down
2023-01-24 07:31:38.521 GMT [5900] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-24 07:31:38.522 GMT [5900] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-24 07:31:38.523 GMT [5900] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-24 07:31:38.528 GMT [5901] LOG:  database system was shut down at 2023-01-24 07:31:38 GMT
2023-01-24 07:31:38.537 GMT [5900] LOG:  database system is ready to accept connections
2023-01-24 07:31:57.275 GMT [5900] LOG:  received fast shutdown request
2023-01-24 07:31:57.276 GMT [5900] LOG:  aborting any active transactions
2023-01-24 07:31:57.283 GMT [5900] LOG:  background worker "logical replication launcher" (PID 5907) exited with exit code 1
2023-01-24 07:31:57.285 GMT [5902] LOG:  shutting down
2023-01-24 07:31:57.349 GMT [5900] LOG:  database system is shut down
2023-01-24 07:31:58.644 GMT [6081] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-24 07:31:58.644 GMT [6081] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-24 07:31:58.645 GMT [6081] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-24 07:31:58.651 GMT [6082] LOG:  database system was shut down at 2023-01-24 07:31:58 GMT
2023-01-24 07:31:58.656 GMT [6081] LOG:  database system is ready to accept connections
2023-01-24 08:14:48.795 GMT [6081] LOG:  received smart shutdown request
2023-01-24 08:14:48.875 GMT [6081] LOG:  background worker "logical replication launcher" (PID 6088) exited with exit code 1
2023-01-24 08:14:48.875 GMT [6083] LOG:  shutting down
2023-01-24 08:14:48.921 GMT [6081] LOG:  database system is shut down
2023-01-24 16:35:18.302 GMT [8619] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-24 16:35:18.305 GMT [8619] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-24 16:35:18.306 GMT [8619] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-24 16:35:18.310 GMT [8620] LOG:  database system was shut down at 2023-01-24 16:35:17 GMT
2023-01-24 16:35:18.317 GMT [8619] LOG:  database system is ready to accept connections
2023-01-24 16:38:23.703 GMT [8698] ERROR:  syntax error at or near "management_audit" at character 24
2023-01-24 16:38:23.703 GMT [8698] STATEMENT:  COPY management_log TO management_audit.csv;
2023-01-24 16:38:34.865 GMT [8698] ERROR:  relative path not allowed for COPY to file
2023-01-24 16:38:34.865 GMT [8698] STATEMENT:  COPY management_log TO 'management_audit.csv';
2023-01-24 16:38:56.287 GMT [8698] ERROR:  could not open file "/Warwick/IM/cw1/management_audit.csv" for writing: No such file or directory
2023-01-24 16:38:56.287 GMT [8698] HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.
2023-01-24 16:38:56.287 GMT [8698] STATEMENT:  COPY management_log TO '/Warwick/IM/cw1/management_audit.csv';
2023-01-24 18:33:05.113 GMT [8619] LOG:  received fast shutdown request
2023-01-24 18:33:05.115 GMT [8619] LOG:  aborting any active transactions
2023-01-24 18:33:05.118 GMT [8619] LOG:  background worker "logical replication launcher" (PID 8626) exited with exit code 1
2023-01-24 18:33:05.120 GMT [8621] LOG:  shutting down
2023-01-24 18:33:05.134 GMT [8619] LOG:  database system is shut down
2023-01-24 18:33:10.513 GMT [31280] LOG:  starting PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit
2023-01-24 18:33:10.513 GMT [31280] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-24 18:33:10.515 GMT [31280] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-01-24 18:33:10.528 GMT [31281] LOG:  database system was shut down at 2023-01-24 18:33:10 GMT
2023-01-24 18:33:10.539 GMT [31280] LOG:  database system is ready to accept connections
2023-01-24 18:33:11.881 GMT [31306] ERROR:  new row for relation "savings_account" violates check constraint "account_number_8_digits"
2023-01-24 18:33:11.881 GMT [31306] DETAIL:  Failing row contains (1, 1, 2000.00, 2.05).
2023-01-24 18:33:11.881 GMT [31306] STATEMENT:  INSERT INTO savings_account (current_balance, interest_rate, account_id)
	VALUES (2000.00, 2.05, 1),
	(1000.00, 2.05, 2),
	(5000.00, 2.05, 3),
	(10000.00, 2.05, 4),
	(20000.00, 2.05, 5),
	(50000.00, 2.05, 6),
	(100000.00, 2.05, 7),
	(200000.00, 2.05, 8);
2023-01-24 18:33:11.882 GMT [31306] ERROR:  new row for relation "credit_account" violates check constraint "account_number_8_digits"
2023-01-24 18:33:11.882 GMT [31306] DETAIL:  Failing row contains (2, 1, 55.43, 2000.00, 4.22).
2023-01-24 18:33:11.882 GMT [31306] STATEMENT:  INSERT INTO credit_account (outstanding_balance, credit_limit, interest_rate, account_id)
	VALUES (55.43, 2000.00, 4.22, 1),
	(100.00, 1000.00, 4.22, 2),
	(200.00, 5000.00, 4.22, 3),
	(300.00, 10000.00, 4.22, 4),
	(400.00, 20000.00, 4.22, 5),
	(500.00, 50000.00, 4.22, 6),
	(600.00, 100000.00, 4.22, 7),
	(700.00, 200000.00, 4.22, 8);
2023-01-24 18:33:11.883 GMT [31306] ERROR:  new row for relation "debit_account" violates check constraint "account_number_8_digits"
2023-01-24 18:33:11.883 GMT [31306] DETAIL:  Failing row contains (3, 1, 3465.43, 0.05).
2023-01-24 18:33:11.883 GMT [31306] STATEMENT:  INSERT INTO debit_account (current_balance, interest_rate, account_id)
	VALUES (3465.43, 0.05, 1),
	(1000.00, 0.05, 1),
	(5000.00, 0.05, 2),
	(10000.00, 0.05, 3),
	(20000.00, 0.05, 4),
	(50000.00, 0.05, 5),
	(100000.00, 0.05, 6),
	(200000.00, 0.05, 9);
